var se=Object.defineProperty;var oe=(t,e,n)=>e in t?se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var h=(t,e,n)=>(oe(t,typeof e!="symbol"?e+"":e,n),n);import{B as I,au as _,av as ie,S as ae,i as le,s as ce,e as S,b as O,f as p,g as V,t as y,d as x,h as U,a0 as ue,o as fe,v as B,w as C,x as z,y as $,R as W,a3 as G,z as L,H as de,E as X,a9 as me}from"./index-b2ce7586.js";function pe(t){return t===Object(t)}function he(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=e(t[r]),n},{})}function M(t,e){return t&&(t.is_store?e(t):Array.isArray(t)?t.map(n=>M(n,e)):pe(t)?he(t,n=>M(n,e)):e(t))}function _e(t){const{subscribe:e,set:n,update:r}=I(t),s=I(0);return{subscribe:e,update:r,set:(o,l=!0)=>{n(o),l&&s.update(c=>c+1)},triggerStore:s,storeId:null,backendStore:null}}const m=new Map,xe=t=>M(t,e=>{if(!e)return e;if(e.store_id!==void 0){if(!m.has(e.store_id)){let n=_e(e.value);n.storeId=e.store_id,n.backendStore=e.has_children,m.set(e.store_id,n)}return m.get(e.store_id)}else if(e.refId!==void 0)return m.has(e.refId)||m.set(e.refId,I(e)),m.get(e.refId);return e});async function E(t,e){const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await n.json();if(!n.ok)throw console.log("HTTP status "+n.status+": "+n.statusText+`
 url: `+t+`
 data: `+JSON.stringify(e)),new Error("HTTP status "+n.status+": "+r.detail);return r}async function ge(t,e){const n=await E(t,e);return Y(n)}function Y(t){for(const e of t)if(e.type==="ref"){if(!m.has(e.id))continue;m.get(e.id).update(r=>(r.scope=e.scope,r))}else if(e.type==="store"){const n=m.get(e.id);if(n===void 0){console.log("Store is not maintained on the frontend. Only stores passed as props to a component are maintained in `globalStores`.",e.id);continue}if(!("triggerStore"in n))throw"Must use `meerkatWritable` for backend stores.";e.value!==_(n)&&n.set(e.value,!1)}}function ye(t,e,n,r){var s,a,i=!1,o="withOld"in n,l=(f,u)=>{if(s=u,o&&(a=f),!i){let g=e(f,u);if(e.length<2)u(g);else return g}i=!1},c=ie(t,l,r),D=!Array.isArray(t),A=f=>{D?(i=!0,t.set(f)):f.forEach((u,g)=>{i=!0,t[g].set(u)}),i=!1};o&&(n=n.withOld);var ee=n.length>=(o?3:2),P=null;function te(f){if(P&&(P(),P=null),o)var u=n(f,a,A);else var u=n(f,A);ee?typeof u=="function"&&(P=u):A(u)}var T=!1;function H(f){var u,g,N,b;if(T){b=f(_(c)),s(b);return}var ne=c.subscribe(re=>{T?u?g=!0:u=!0:N=re});b=f(N),T=!0,s(b),ne(),T=!1,g&&(b=_(c)),u&&te(b)}return{subscribe:c.subscribe,set(f){H(()=>f)},update:H}}const we=20,w=I([]),j=I(null),R=new Map,K=t=>{if(R.has(t))return;const e=setTimeout(()=>{R.delete(t),Z(t)},1e3);R.set(t,e)},be=t=>{const e=R.get(t);e&&clearTimeout(e)};function Ie(t){t.id&&be(t.id),w.update(e=>e.map(n=>n.id===t.id?{...n,...t}:n))}function Se(t){w.update(e=>[t,...e].slice(0,we))}function ke(t){_(w).find(e=>e.id===t.id)?Ie(t):Se(t)}function De(t){w.update(e=>(t?K(t):e.forEach(n=>{K(n.id)}),e.map(n=>n.id===t||t===void 0?{...n,visible:!1}:n)))}function Z(t){w.update(e=>t===void 0?[]:e.filter(n=>n.id!==t))}function Ue(t){j.set(t)}function je(t){let e;j.update(n=>(e=t-(n||0),null)),w.update(n=>n.map(r=>({...r,pauseDuration:r.pauseDuration+e})))}const Pe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3};function He(t={}){return{toasts:ye(w,n=>n.map(r=>{var s,a;return{...t,...t[r.type],...r,duration:r.duration||((s=t[r.type])==null?void 0:s.duration)||(t==null?void 0:t.duration)||Pe[r.type],style:[t.style,(a=t[r.type])==null?void 0:a.style,r.style].join(";")}}),n=>n),pausedAt:j}}const Te=t=>typeof t=="function",Q=(t,e)=>Te(t)?t(e):t,Re=(()=>{let t=0;return()=>(t+=1,t.toString())})(),Ne=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){const e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),Ee=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||Re()}),k=t=>(e,n)=>{const r=Ee(e,t,n);return ke(r),r.id},d=(t,e)=>k("blank")(t,e);d.error=k("error");d.success=k("success");d.loading=k("loading");d.custom=k("custom");d.dismiss=t=>{De(t)};d.remove=t=>Z(t);d.promise=(t,e,n)=>{const r=d.loading(e.loading,{...n,...n==null?void 0:n.loading});return t.then(s=>(d.success(Q(e.success,s),{id:r,...n,...n==null?void 0:n.success}),s)).catch(s=>{d.error(Q(e.error,s),{id:r,...n,...n==null?void 0:n.error})}),t};const ve=d,v=I({VITE_API_URL_PLACEHOLDER:"http://meerkat.dummy",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_API_URL||"http://127.0.0.1:5002");class Ae{constructor(e,n,r,s,a){h(this,"columnInfos");h(this,"columns");h(this,"posidxs");h(this,"keyidxs");h(this,"rows");h(this,"fullLength");h(this,"primaryKey");this.columnInfos=e,this.columns=this.columnInfos.map(o=>o.name),this.posidxs=n,this.rows=r,this.fullLength=s,this.primaryKey=a;let i=this.columns.findIndex(o=>o===a);this.keyidxs=this.rows.map(o=>o[i])}getCell(e,n){let r=this.columns.indexOf(n),s=this.columnInfos[r];return{data:this.rows[e][this.columns.indexOf(n)],cellComponent:s.cellComponent,cellProps:s.cellProps,cellDataProp:s.cellDataProp,column:n}}getColumn(e){let n=this.columns.indexOf(e),r=this.columnInfos[n];return{data:this.rows.map(s=>s[n]),cellComponent:r.cellComponent,cellProps:r.cellProps,cellDataProp:r.cellDataProp,column:e}}getRow(e){let n={};for(let r=0;r<this.columns.length;r++)n[this.columns[r]]=this.rows[e][r];return n}getRows(){let e=[];for(let n=0;n<this.rows.length;n++)e.push(this.getRow(n));return e}length(){return this.rows.length}}const Be=async(t,e)=>await ge(`${_(v)}/store/${t}/update`,{value:e}),Ke=async(t,e={})=>{if(t===null)return;const n=E(`${_(v)}/endpoint/${t}/dispatch`,e).catch(i=>{throw console.log(i),ve.error(i.message),i}),{result:r,modifications:s,error:a}=await n;return Y(s),r},Qe=async({df:t,columns:e=null,formatter:n=null})=>await E(`${_(v)}/df/${t.refId}/schema`,{columns:e,formatter:n}),Fe=async({df:t,columns:e=null,start:n=null,end:r=null,posidxs:s=null,keyidxs:a=null,keyColumn:i=null,formatter:o=null,shuffle:l=null})=>{const c=await E(`${_(v)}/df/${t.refId}/rows`,{start:n,end:r,posidxs:s,key_column:i,keyidxs:a,columns:e,formatter:o,shuffle:l});return new Ae(c.columnInfos,c.posidxs,c.rows,c.fullLength,c.primaryKey)};function F(t,e,n){const r=t.slice();return r[6]=e[n],r}function J(t){let e,n,r;const s=[t[0]];var a=t[2];function i(o){let l={$$slots:{default:[Ce]},$$scope:{ctx:o}};for(let c=0;c<s.length;c+=1)l=X(l,s[c]);return{props:l}}return a&&(e=B(a,i(t)),e.$on("edit",t[4])),{c(){e&&C(e.$$.fragment),n=S()},l(o){e&&z(e.$$.fragment,o),n=S()},m(o,l){e&&$(e,o,l),O(o,n,l),r=!0},p(o,l){const c=l&1?W(s,[G(o[0])]):{};if(l&514&&(c.$$scope={dirty:l,ctx:o}),a!==(a=o[2])){if(e){V();const D=e;y(D.$$.fragment,1,0,()=>{L(D,1)}),x()}a?(e=B(a,i(o)),e.$on("edit",o[4]),C(e.$$.fragment),p(e.$$.fragment,1),$(e,n.parentNode,n)):e=null}else a&&e.$set(c)},i(o){r||(e&&p(e.$$.fragment,o),r=!0)},o(o){e&&y(e.$$.fragment,o),r=!1},d(o){o&&U(n),e&&L(e,o)}}}function q(t){let e,n;const r=[t[6]];let s={};for(let a=0;a<r.length;a+=1)s=X(s,r[a]);return e=new Me({props:s}),{c(){C(e.$$.fragment)},l(a){z(e.$$.fragment,a)},m(a,i){$(e,a,i),n=!0},p(a,i){const o=i&2?W(r,[G(a[6])]):{};e.$set(o)},i(a){n||(p(e.$$.fragment,a),n=!0)},o(a){y(e.$$.fragment,a),n=!1},d(a){L(e,a)}}}function Ce(t){let e,n,r=t[1],s=[];for(let i=0;i<r.length;i+=1)s[i]=q(F(t,r,i));const a=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=S()},l(i){for(let o=0;o<s.length;o+=1)s[o].l(i);e=S()},m(i,o){for(let l=0;l<s.length;l+=1)s[l].m(i,o);O(i,e,o),n=!0},p(i,o){if(o&2){r=i[1];let l;for(l=0;l<r.length;l+=1){const c=F(i,r,l);s[l]?(s[l].p(c,o),p(s[l],1)):(s[l]=q(c),s[l].c(),p(s[l],1),s[l].m(e.parentNode,e))}for(V(),l=r.length;l<s.length;l+=1)a(l);x()}},i(i){if(!n){for(let o=0;o<r.length;o+=1)p(s[o]);n=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)y(s[o]);n=!1},d(i){me(s,i),i&&U(e)}}}function $e(t){let e,n,r=t[2]&&J(t);return{c(){r&&r.c(),e=S()},l(s){r&&r.l(s),e=S()},m(s,a){r&&r.m(s,a),O(s,e,a),n=!0},p(s,[a]){s[2]?r?(r.p(s,a),a&4&&p(r,1)):(r=J(s),r.c(),p(r,1),r.m(e.parentNode,e)):r&&(V(),y(r,1,1,()=>{r=null}),x())},i(s){n||(p(r),n=!0)},o(s){y(r),n=!1},d(s){r&&r.d(s),s&&U(e)}}}function Le(t,e,n){const r=ue("Components");let{name:s}=e,{props:a}=e,{slots:i=[]}=e,o;fe(async()=>{if(s in r){n(2,o=r[s]);return}else console.log(`Component ${s} was not imported and added to the Components context.`)});function l(c){de.call(this,t,c)}return t.$$set=c=>{"name"in c&&n(3,s=c.name),"props"in c&&n(0,a=c.props),"slots"in c&&n(1,i=c.slots)},t.$$.update=()=>{t.$$.dirty&8&&n(2,o=r[s])},[a,i,o,s,l]}class Me extends ae{constructor(e){super(),le(this,e,Le,$e,ce,{name:3,props:0,slots:1})}}export{v as A,Me as D,Qe as a,Ie as b,Be as c,Ke as d,je as e,Fe as f,m as g,xe as h,Ne as p,Ue as s,ve as t,He as u};
