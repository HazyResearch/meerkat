
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>meerkat.dataframe &#8212; ðŸ”® v0.4.0a1</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../_static/meerkat_logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"><div class='topnav'></div></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/meerkat_banner_padded.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ðŸ”® v0.4.0a1</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Welcome to Meerkat ðŸ”®
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../start/install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../start/quickstart-df.html">
   Quickstart: Data Frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../start/quickstart-interactive.html">
   Quickstart: Interactive Apps
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../start/tutorials/index.html">
   Tutorials
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-data-frames.html">
     Tutorial 1: Data Frames (Wrangling an Image Dataset)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-image-gallery.html">
     Tutorial 2: Basic Interactive Apps (Building an Image Gallery)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-simple-counter.html">
     Tutorial 3: Basic Interactive Apps (Building A Simple Counter)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-reactive-viewer.html">
     Tutorial 4: Reactive Functions (Reactive Image Viewer)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-query-llm.html">
     Tutorial 5: Endpoints (Query a Large Language Model)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-search-engine.html">
     Tutorial 6: Complex Components (Embedding Based Search Engine)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../start/tutorials/tutorial-filter-sort.html">
     Tutorial 7: Complex Components (Gallery with Filter and Sort)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../user-guide/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../user-guide/dataframe/index.html">
   DataFrame
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/dataframe/selection.html">
     Data Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/dataframe/column/index.html">
     Column
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/dataframe/ops/index.html">
     Operations
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/dataframe/ops/mapping.html">
       Mapping:
       <code class="docutils literal notranslate">
        <span class="pre">
         map
        </span>
       </code>
       and
       <code class="docutils literal notranslate">
        <span class="pre">
         defer
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/dataframe/ops/combining.html">
       Combining:
       <code class="docutils literal notranslate">
        <span class="pre">
         concat
        </span>
       </code>
       and
       <code class="docutils literal notranslate">
        <span class="pre">
         merge
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/dataframe/ops/grouping.html">
       Grouping:
       <code class="docutils literal notranslate">
        <span class="pre">
         groupby
        </span>
       </code>
       and
       <code class="docutils literal notranslate">
        <span class="pre">
         clusterby
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/dataframe/io.html">
     I/O
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/dataframe/advanced/index.html">
     Advanced
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/dataframe/advanced/copying.html">
       Copy vs. View Behavior
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/dataframe/advanced/blocks.html">
       Blocks and the BlockManager
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../user-guide/interactive/index.html">
   Interactive
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/interactive/running-meerkat-interfaces.html">
     Running Meerkat Interfaces
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/interactive/reactive-functions/index.html">
     Reactive Functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/creating.html">
       Creating Reactive Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/markables.html">
       Markables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/chaining.html">
       Chaining Reactive Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/turning-off.html">
       Turning Off Reactivity
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/inbuilts.html">
       Reactive Functions in Meerkat
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.abs.html">
         meerkat.abs
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.all.html">
         meerkat.all
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.any.html">
         meerkat.any
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.bool.html">
         meerkat.bool
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.complex.html">
         meerkat.complex
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.dict.html">
         meerkat.dict
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.float.html">
         meerkat.float
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.hex.html">
         meerkat.hex
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.int.html">
         meerkat.int
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.len.html">
         meerkat.len
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.list.html">
         meerkat.list
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.oct.html">
         meerkat.oct
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.range.html">
         meerkat.range
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.set.html">
         meerkat.set
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.str.html">
         meerkat.str
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.sum.html">
         meerkat.sum
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.tuple.html">
         meerkat.tuple
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.cand.html">
         meerkat.cand
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.cnot.html">
         meerkat.cnot
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.cor.html">
         meerkat.cor
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.aggregate.html">
         meerkat.aggregate
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.clusterby.html">
         meerkat.clusterby
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.concat.html">
         meerkat.concat
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.explainby.html">
         meerkat.explainby
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.groupby.html">
         meerkat.groupby
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.merge.html">
         meerkat.merge
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.sample.html">
         meerkat.sample
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.shuffle.html">
         meerkat.shuffle
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.sort.html">
         meerkat.sort
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/guidelines.html">
       Guidelines
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/reactive-functions/faqs.html">
       FAQs
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/interactive/stores/index.html">
     Stores
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/stores/subtleties.html">
       Subtleties with Stores
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/stores/inbuilts.html">
       Inbuilt Store Operators
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/stores/faqs.html">
       FAQs
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/interactive/components/index.html">
     Components
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/components/display.html">
       Displaying data frames
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/components/custom-components.html">
       Custom Components
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../user-guide/interactive/components/inbuilts.html">
       Meerkat Components
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Button.html">
         meerkat.interactive.app.src.lib.component.core.Button
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Caption.html">
         meerkat.interactive.app.src.lib.component.core.Caption
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Carousel.html">
         meerkat.interactive.app.src.lib.component.core.Carousel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Chat.html">
         meerkat.interactive.app.src.lib.component.core.Chat
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Checkbox.html">
         meerkat.interactive.app.src.lib.component.core.Checkbox
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Code.html">
         meerkat.interactive.app.src.lib.component.core.Code
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.CodeCell.html">
         meerkat.interactive.app.src.lib.component.core.CodeCell
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.CopyButton.html">
         meerkat.interactive.app.src.lib.component.core.CopyButton
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Document.html">
         meerkat.interactive.app.src.lib.component.core.Document
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Editor.html">
         meerkat.interactive.app.src.lib.component.core.Editor
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.FileUpload.html">
         meerkat.interactive.app.src.lib.component.core.FileUpload
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Filter.html">
         meerkat.interactive.app.src.lib.component.core.Filter
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Gallery.html">
         meerkat.interactive.app.src.lib.component.core.Gallery
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Header.html">
         meerkat.interactive.app.src.lib.component.core.Header
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Icon.html">
         meerkat.interactive.app.src.lib.component.core.Icon
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Image.html">
         meerkat.interactive.app.src.lib.component.core.Image
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Json.html">
         meerkat.interactive.app.src.lib.component.core.Json
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Markdown.html">
         meerkat.interactive.app.src.lib.component.core.Markdown
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Match.html">
         meerkat.interactive.app.src.lib.component.core.Match
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Number.html">
         meerkat.interactive.app.src.lib.component.core.Number
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.NumberInput.html">
         meerkat.interactive.app.src.lib.component.core.NumberInput
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.PDF.html">
         meerkat.interactive.app.src.lib.component.core.PDF
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Put.html">
         meerkat.interactive.app.src.lib.component.core.Put
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Radio.html">
         meerkat.interactive.app.src.lib.component.core.Radio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.RadioGroup.html">
         meerkat.interactive.app.src.lib.component.core.RadioGroup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.RawHTML.html">
         meerkat.interactive.app.src.lib.component.core.RawHTML
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Select.html">
         meerkat.interactive.app.src.lib.component.core.Select
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Slider.html">
         meerkat.interactive.app.src.lib.component.core.Slider
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Sort.html">
         meerkat.interactive.app.src.lib.component.core.Sort
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Stats.html">
         meerkat.interactive.app.src.lib.component.core.Stats
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Subheader.html">
         meerkat.interactive.app.src.lib.component.core.Subheader
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Table.html">
         meerkat.interactive.app.src.lib.component.core.Table
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Text.html">
         meerkat.interactive.app.src.lib.component.core.Text
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Textbox.html">
         meerkat.interactive.app.src.lib.component.core.Textbox
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Title.html">
         meerkat.interactive.app.src.lib.component.core.Title
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Toggle.html">
         meerkat.interactive.app.src.lib.component.core.Toggle
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.core.Vega.html">
         meerkat.interactive.app.src.lib.component.core.Vega
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.Component.html">
         meerkat.interactive.app.src.lib.component.html.Component
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.a.html">
         meerkat.interactive.app.src.lib.component.html.a
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.button.html">
         meerkat.interactive.app.src.lib.component.html.button
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.div.html">
         meerkat.interactive.app.src.lib.component.html.div
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.flex.html">
         meerkat.interactive.app.src.lib.component.html.flex
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.flexcol.html">
         meerkat.interactive.app.src.lib.component.html.flexcol
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.form.html">
         meerkat.interactive.app.src.lib.component.html.form
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.grid.html">
         meerkat.interactive.app.src.lib.component.html.grid
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.gridcols2.html">
         meerkat.interactive.app.src.lib.component.html.gridcols2
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.gridcols3.html">
         meerkat.interactive.app.src.lib.component.html.gridcols3
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.gridcols4.html">
         meerkat.interactive.app.src.lib.component.html.gridcols4
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.h1.html">
         meerkat.interactive.app.src.lib.component.html.h1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.h2.html">
         meerkat.interactive.app.src.lib.component.html.h2
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.h3.html">
         meerkat.interactive.app.src.lib.component.html.h3
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.h4.html">
         meerkat.interactive.app.src.lib.component.html.h4
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.h5.html">
         meerkat.interactive.app.src.lib.component.html.h5
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.h6.html">
         meerkat.interactive.app.src.lib.component.html.h6
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.li.html">
         meerkat.interactive.app.src.lib.component.html.li
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.ol.html">
         meerkat.interactive.app.src.lib.component.html.ol
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.p.html">
         meerkat.interactive.app.src.lib.component.html.p
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.path.html">
         meerkat.interactive.app.src.lib.component.html.path
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.select.html">
         meerkat.interactive.app.src.lib.component.html.select
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.span.html">
         meerkat.interactive.app.src.lib.component.html.span
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.svg.html">
         meerkat.interactive.app.src.lib.component.html.svg
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.table.html">
         meerkat.interactive.app.src.lib.component.html.table
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.tbody.html">
         meerkat.interactive.app.src.lib.component.html.tbody
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.td.html">
         meerkat.interactive.app.src.lib.component.html.td
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.textarea.html">
         meerkat.interactive.app.src.lib.component.html.textarea
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.th.html">
         meerkat.interactive.app.src.lib.component.html.th
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.thead.html">
         meerkat.interactive.app.src.lib.component.html.thead
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.tr.html">
         meerkat.interactive.app.src.lib.component.html.tr
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.html.ul.html">
         meerkat.interactive.app.src.lib.component.html.ul
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.plotly.BarPlot.html">
         meerkat.interactive.app.src.lib.component.plotly.BarPlot
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.plotly.Plot.html">
         meerkat.interactive.app.src.lib.component.plotly.Plot
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.plotly.ScatterPlot.html">
         meerkat.interactive.app.src.lib.component.plotly.ScatterPlot
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.A.html">
         meerkat.interactive.app.src.lib.component.flowbite.A
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Accordion.html">
         meerkat.interactive.app.src.lib.component.flowbite.Accordion
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.AccordionItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.AccordionItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Activity.html">
         meerkat.interactive.app.src.lib.component.flowbite.Activity
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ActivityItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.ActivityItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.AdvancedRating.html">
         meerkat.interactive.app.src.lib.component.flowbite.AdvancedRating
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Alert.html">
         meerkat.interactive.app.src.lib.component.flowbite.Alert
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyDown.html">
         meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyDown
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyLeft.html">
         meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyLeft
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyRight.html">
         meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyRight
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyUp.html">
         meerkat.interactive.app.src.lib.component.flowbite.ArrowKeyUp
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Avatar.html">
         meerkat.interactive.app.src.lib.component.flowbite.Avatar
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Badge.html">
         meerkat.interactive.app.src.lib.component.flowbite.Badge
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Blockquote.html">
         meerkat.interactive.app.src.lib.component.flowbite.Blockquote
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Breadcrumb.html">
         meerkat.interactive.app.src.lib.component.flowbite.Breadcrumb
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.BreadcrumbItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.BreadcrumbItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Button.html">
         meerkat.interactive.app.src.lib.component.flowbite.Button
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ButtonGroup.html">
         meerkat.interactive.app.src.lib.component.flowbite.ButtonGroup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Card.html">
         meerkat.interactive.app.src.lib.component.flowbite.Card
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Carousel.html">
         meerkat.interactive.app.src.lib.component.flowbite.Carousel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.CarouselTransition.html">
         meerkat.interactive.app.src.lib.component.flowbite.CarouselTransition
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Checkbox.html">
         meerkat.interactive.app.src.lib.component.flowbite.Checkbox
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Component.html">
         meerkat.interactive.app.src.lib.component.flowbite.Component
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.DarkMode.html">
         meerkat.interactive.app.src.lib.component.flowbite.DarkMode
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.DescriptionList.html">
         meerkat.interactive.app.src.lib.component.flowbite.DescriptionList
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Drawer.html">
         meerkat.interactive.app.src.lib.component.flowbite.Drawer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Dropdown.html">
         meerkat.interactive.app.src.lib.component.flowbite.Dropdown
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.DropdownDivider.html">
         meerkat.interactive.app.src.lib.component.flowbite.DropdownDivider
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.DropdownHeader.html">
         meerkat.interactive.app.src.lib.component.flowbite.DropdownHeader
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.DropdownItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.DropdownItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.FloatingLabelInput.html">
         meerkat.interactive.app.src.lib.component.flowbite.FloatingLabelInput
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Footer.html">
         meerkat.interactive.app.src.lib.component.flowbite.Footer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.FooterBrand.html">
         meerkat.interactive.app.src.lib.component.flowbite.FooterBrand
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.FooterCopyright.html">
         meerkat.interactive.app.src.lib.component.flowbite.FooterCopyright
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.FooterIcon.html">
         meerkat.interactive.app.src.lib.component.flowbite.FooterIcon
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.FooterLink.html">
         meerkat.interactive.app.src.lib.component.flowbite.FooterLink
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.FooterLinkGroup.html">
         meerkat.interactive.app.src.lib.component.flowbite.FooterLinkGroup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Group.html">
         meerkat.interactive.app.src.lib.component.flowbite.Group
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.GroupItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.GroupItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Heading.html">
         meerkat.interactive.app.src.lib.component.flowbite.Heading
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Hr.html">
         meerkat.interactive.app.src.lib.component.flowbite.Hr
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Indicator.html">
         meerkat.interactive.app.src.lib.component.flowbite.Indicator
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Kbd.html">
         meerkat.interactive.app.src.lib.component.flowbite.Kbd
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Layout.html">
         meerkat.interactive.app.src.lib.component.flowbite.Layout
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Li.html">
         meerkat.interactive.app.src.lib.component.flowbite.Li
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.List.html">
         meerkat.interactive.app.src.lib.component.flowbite.List
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Mark.html">
         meerkat.interactive.app.src.lib.component.flowbite.Mark
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.MegaMenu.html">
         meerkat.interactive.app.src.lib.component.flowbite.MegaMenu
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Modal.html">
         meerkat.interactive.app.src.lib.component.flowbite.Modal
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.NavBrand.html">
         meerkat.interactive.app.src.lib.component.flowbite.NavBrand
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.NavLi.html">
         meerkat.interactive.app.src.lib.component.flowbite.NavLi
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.NavUl.html">
         meerkat.interactive.app.src.lib.component.flowbite.NavUl
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Navbar.html">
         meerkat.interactive.app.src.lib.component.flowbite.Navbar
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.P.html">
         meerkat.interactive.app.src.lib.component.flowbite.P
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Pagination.html">
         meerkat.interactive.app.src.lib.component.flowbite.Pagination
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.PaginationItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.PaginationItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Popover.html">
         meerkat.interactive.app.src.lib.component.flowbite.Popover
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Progressbar.html">
         meerkat.interactive.app.src.lib.component.flowbite.Progressbar
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Radio.html">
         meerkat.interactive.app.src.lib.component.flowbite.Radio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Range.html">
         meerkat.interactive.app.src.lib.component.flowbite.Range
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Rating.html">
         meerkat.interactive.app.src.lib.component.flowbite.Rating
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.RatingComment.html">
         meerkat.interactive.app.src.lib.component.flowbite.RatingComment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Review.html">
         meerkat.interactive.app.src.lib.component.flowbite.Review
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.ScoreRating.html">
         meerkat.interactive.app.src.lib.component.flowbite.ScoreRating
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Search.html">
         meerkat.interactive.app.src.lib.component.flowbite.Search
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Secondary.html">
         meerkat.interactive.app.src.lib.component.flowbite.Secondary
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Select.html">
         meerkat.interactive.app.src.lib.component.flowbite.Select
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Sidebar.html">
         meerkat.interactive.app.src.lib.component.flowbite.Sidebar
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarBrand.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarBrand
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarCta.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarCta
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarDropdownItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarDropdownItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarDropdownWrapper.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarDropdownWrapper
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarGroup.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarGroup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SidebarWrapper.html">
         meerkat.interactive.app.src.lib.component.flowbite.SidebarWrapper
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Span.html">
         meerkat.interactive.app.src.lib.component.flowbite.Span
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SpeedDial.html">
         meerkat.interactive.app.src.lib.component.flowbite.SpeedDial
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.SpeedDialButton.html">
         meerkat.interactive.app.src.lib.component.flowbite.SpeedDialButton
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Spinner.html">
         meerkat.interactive.app.src.lib.component.flowbite.Spinner
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TabItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.TabItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Table.html">
         meerkat.interactive.app.src.lib.component.flowbite.Table
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TableBodyCell.html">
         meerkat.interactive.app.src.lib.component.flowbite.TableBodyCell
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TableBodyRow.html">
         meerkat.interactive.app.src.lib.component.flowbite.TableBodyRow
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TableHead.html">
         meerkat.interactive.app.src.lib.component.flowbite.TableHead
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TableSearch.html">
         meerkat.interactive.app.src.lib.component.flowbite.TableSearch
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Tabs.html">
         meerkat.interactive.app.src.lib.component.flowbite.Tabs
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Textarea.html">
         meerkat.interactive.app.src.lib.component.flowbite.Textarea
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Timeline.html">
         meerkat.interactive.app.src.lib.component.flowbite.Timeline
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TimelineHorizontal.html">
         meerkat.interactive.app.src.lib.component.flowbite.TimelineHorizontal
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TimelineItem.html">
         meerkat.interactive.app.src.lib.component.flowbite.TimelineItem
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.TimelineItemHorizontal.html">
         meerkat.interactive.app.src.lib.component.flowbite.TimelineItemHorizontal
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Toast.html">
         meerkat.interactive.app.src.lib.component.flowbite.Toast
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Toggle.html">
         meerkat.interactive.app.src.lib.component.flowbite.Toggle
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../user-guide/apidocs/generated/meerkat.interactive.app.src.lib.component.flowbite.Tooltip.html">
         meerkat.interactive.app.src.lib.component.flowbite.Tooltip
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/interactive/endpoints/index.html">
     Endpoints
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/endpoints/reactive-vs-endpoints.html">
       Endpoints vs. Reactive Functions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/interactive/formatters/index.html">
     Formatters
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../user-guide/interactive/advanced/index.html">
     Advanced
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/advanced/sharing.html">
       Sharing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../user-guide/interactive/advanced/under-the-hood.html">
       Under the Hood
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/interactive/faqs.html">
     FAQs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../user-guide/cheat-sheet.html">
   Cheat Sheet
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../advanced/magic-contexts/index.html">
   Magic Contexts
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/magic-contexts/limitations.html">
     Limitations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../advanced/configuring.html">
   Configuring Meerkat
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ecosystem
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../datasets/index.html">
   Datasets
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../datasets/contributing-datasets.html">
     Contributing Datasets
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../examples/index.html">
   Examples
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../examples/meerkat-in-5-minutes.html">
     Meerkat in 5 Minutes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../examples/image-search.html">
     Building image search
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apidocs/index.html">
   API Reference
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apidocs/dataframe.html">
     DataFrame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apidocs/columns.html">
     Columns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apidocs/interactive.html">
     Interactive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apidocs/ops.html">
     Operations
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/hazyresearch/meerkat/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/hazyresearch/meerkat//issues/new?title=Issue%20on%20page%20%2F_modules/meerkat/dataframe.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <h1>Source code for meerkat.dataframe</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;DataFrame class.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TYPE_CHECKING</span><span class="p">,</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">Collection</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">Mapping</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">Sequence</span><span class="p">,</span>
    <span class="n">Set</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">cytoolz</span> <span class="k">as</span> <span class="nn">tz</span>
<span class="kn">import</span> <span class="nn">dill</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">from</span> <span class="nn">pandas._libs</span> <span class="kn">import</span> <span class="n">lib</span>

<span class="kn">import</span> <span class="nn">meerkat</span>
<span class="kn">from</span> <span class="nn">meerkat.block.manager</span> <span class="kn">import</span> <span class="n">BlockManager</span>
<span class="kn">from</span> <span class="nn">meerkat.columns.abstract</span> <span class="kn">import</span> <span class="n">Column</span>
<span class="kn">from</span> <span class="nn">meerkat.columns.scalar.abstract</span> <span class="kn">import</span> <span class="n">ScalarColumn</span>
<span class="kn">from</span> <span class="nn">meerkat.columns.scalar.arrow</span> <span class="kn">import</span> <span class="n">ArrowScalarColumn</span>
<span class="kn">from</span> <span class="nn">meerkat.errors</span> <span class="kn">import</span> <span class="n">ConversionError</span>
<span class="kn">from</span> <span class="nn">meerkat.interactive.graph.marking</span> <span class="kn">import</span> <span class="n">is_unmarked_context</span><span class="p">,</span> <span class="n">unmarked</span>
<span class="kn">from</span> <span class="nn">meerkat.interactive.graph.reactivity</span> <span class="kn">import</span> <span class="n">reactive</span>
<span class="kn">from</span> <span class="nn">meerkat.interactive.modification</span> <span class="kn">import</span> <span class="n">DataFrameModification</span>
<span class="kn">from</span> <span class="nn">meerkat.interactive.node</span> <span class="kn">import</span> <span class="n">NodeMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.mixins.cloneable</span> <span class="kn">import</span> <span class="n">CloneableMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.mixins.deferable</span> <span class="kn">import</span> <span class="n">DeferrableMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.mixins.identifiable</span> <span class="kn">import</span> <span class="n">IdentifiableMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.mixins.indexing</span> <span class="kn">import</span> <span class="n">IndexerMixin</span><span class="p">,</span> <span class="n">MaterializationMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.mixins.inspect_fn</span> <span class="kn">import</span> <span class="n">FunctionInspectorMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.mixins.reactifiable</span> <span class="kn">import</span> <span class="n">ReactifiableMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.provenance</span> <span class="kn">import</span> <span class="n">ProvenanceMixin</span>
<span class="kn">from</span> <span class="nn">meerkat.row</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="kn">from</span> <span class="nn">meerkat.tools.lazy_loader</span> <span class="kn">import</span> <span class="n">LazyLoader</span>
<span class="kn">from</span> <span class="nn">meerkat.tools.utils</span> <span class="kn">import</span> <span class="n">convert_to_batch_fn</span><span class="p">,</span> <span class="n">dump_yaml</span><span class="p">,</span> <span class="n">load_yaml</span>

<span class="n">torch</span> <span class="o">=</span> <span class="n">LazyLoader</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Literal</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">meerkat.interactive.formatter.base</span> <span class="kn">import</span> <span class="n">FormatterGroup</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">Example</span> <span class="o">=</span> <span class="n">Dict</span>
<span class="n">Batch</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="n">Column</span><span class="p">]]</span>
<span class="n">BatchOrDataset</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Batch</span><span class="p">,</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="DataFrame"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame">[docs]</a><span class="k">class</span> <span class="nc">DataFrame</span><span class="p">(</span>
    <span class="n">CloneableMixin</span><span class="p">,</span>
    <span class="n">FunctionInspectorMixin</span><span class="p">,</span>
    <span class="n">IdentifiableMixin</span><span class="p">,</span>
    <span class="n">NodeMixin</span><span class="p">,</span>
    <span class="n">DeferrableMixin</span><span class="p">,</span>
    <span class="n">MaterializationMixin</span><span class="p">,</span>
    <span class="n">IndexerMixin</span><span class="p">,</span>
    <span class="n">ProvenanceMixin</span><span class="p">,</span>
    <span class="n">ReactifiableMixin</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A collection of equal length columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[dict, list]): A dictionary of columns or a list of dictionaries.</span>
<span class="sd">        primary_key (str, optional): The name of the primary key column.</span>
<span class="sd">            Defaults to ``None``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_self_identifiable_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;dataframes&quot;</span>

    <span class="c1"># Path to a log directory</span>
    <span class="n">logdir</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;meerkat/&quot;</span>

    <span class="c1"># Create a directory</span>
    <span class="n">logdir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">primary_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_infer_primary_key</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_react</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts the object to a reactive object in-place.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_marked</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mark</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_no_react</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts the object to a non-reactive object in-place.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_marked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unmark</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat.interactive.gui</span> <span class="kn">import</span> <span class="n">DataFrameGUI</span>

        <span class="k">return</span> <span class="n">DataFrameGUI</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrame.format"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.format">[docs]</a>    <span class="nd">@reactive</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FormatterGroup</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a view of the DataFrame with formatted columns.</span>

<span class="sd">        Example</span>

<span class="sd">        Args:</span>
<span class="sd">            formatters (Dict[str, FormatterGroup]): A dictionary mapping column names to</span>
<span class="sd">                FormatterGroups.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A view of the DataFrame with formatted columns.</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # assume df is a DataFrame with columns &quot;img&quot;, &quot;text&quot;, &quot;id&quot;</span>

<span class="sd">            gallery = mk.Gallery(</span>
<span class="sd">                df=df.format(</span>
<span class="sd">                    img={&quot;thumbnail&quot;: ImageFormatter(max_size=(48, 48))},</span>
<span class="sd">                    text={&quot;icon&quot;: TextFormatter()},</span>
<span class="sd">                )</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">formatters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> not found in DataFrame.&quot;</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span></div>

    <span class="nd">@unmarked</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_repr_pandas_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="n">meerkat</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span>

        <span class="n">df</span><span class="p">,</span> <span class="n">formatters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_repr_pandas_</span><span class="p">(</span><span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">)</span>
        <span class="n">rename</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">rename</span><span class="p">),</span>
            <span class="p">{</span><span class="n">rename</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">formatters</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="p">)</span>

    <span class="nd">@unmarked</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_ipython_display_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>

        <span class="kn">from</span> <span class="nn">meerkat.state</span> <span class="kn">import</span> <span class="n">state</span>

        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">frontend_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="n">meerkat</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span>
            <span class="n">df</span><span class="p">,</span> <span class="n">formatters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repr_pandas_</span><span class="p">(</span><span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">display</span><span class="p">(</span>
                <span class="n">HTML</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">formatters</span><span class="o">=</span><span class="n">formatters</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">table</span><span class="p">()</span><span class="o">.</span><span class="n">_ipython_display_</span><span class="p">()</span>

    <span class="nd">@unmarked</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;(nrows: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">, ncols: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># __len__ is required to return an int. It cannot return a Store[int].</span>
        <span class="c1"># As such, it cannot be wrapped in `@reactive` decorator.</span>
        <span class="c1"># To get the length of a DataFrame in a reactive way, use `df.nrows`.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reactive_warning</span><span class="p">(</span><span class="s2">&quot;len&quot;</span><span class="p">,</span> <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;df&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">unmarked</span><span class="p">():</span>
            <span class="n">_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="k">return</span> <span class="n">_len</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="c1"># __contains__ is called when using the `in` keyword.</span>
        <span class="c1"># `in` casts the output to a boolean (i.e. `bool(self.__contains__(item))`).</span>
        <span class="c1"># Store.__bool__ is not reactive because __bool__ has to return</span>
        <span class="c1"># a bool (not a Store). Thus, we cannot wrap __contains__ in</span>
        <span class="c1"># `@reactive` decorator.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_unmarked_context</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">marked</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `in` operator is not reactive. Use `df.contains(...)`:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&gt;&gt;&gt; df.contains(item)&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BlockManager</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying data (excluding invisible rows).</span>

<span class="sd">        To access underlying data with invisible rows, use `_data`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="k">def</span> <span class="nf">_set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BlockManager</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BlockManager</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot set DataFrame `data` to a Sequence containing object of &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">. Must be a Sequence of Mapping.&quot;</span>
                <span class="p">)</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">fast_unique_multiple_list_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">dicts_to_array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
            <span class="c1"># Assert all columns are the same length</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">column</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">])</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">)}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot set DataFrame `data` to object of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># check that the primary key is still valid after data reset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="o">.</span><span class="n">_is_valid_primary_key</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_data</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Column names in the DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">primary_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarColumn</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The column acting as the primary key.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">primary_key_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the column acting as the primary key.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span>

<div class="viewcode-block" id="DataFrame.set_primary_key"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.set_primary_key">[docs]</a>    <span class="k">def</span> <span class="nf">set_primary_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the DataFrame&#39;s primary key using an existing column. This is an</span>
<span class="sd">        out-of-place operation. For more information on primary keys, see the</span>
<span class="sd">        User Guide.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): The name of an existing column to set as the primary key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Must pass the name of an existing column to `set_primary_key`.&quot;</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&quot; not in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">_is_valid_primary_key</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Column &quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&quot; cannot be used as a primary key. Ensure that &#39;</span>
                    <span class="s2">&quot;columns of this type can be used as primary keys and </span><span class="se">\</span>
<span class="s2">                    that the values in the column are unique.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span> <span class="o">=</span> <span class="n">column</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone</span><span class="p">(</span><span class="n">_primary_key</span><span class="o">=</span><span class="n">column</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.create_primary_key"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.create_primary_key">[docs]</a>    <span class="k">def</span> <span class="nf">create_primary_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a primary key of contiguous integers.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): The name of the column to create.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_infer_primary_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Infer the primary key from the data.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">_is_valid_primary_key</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">column</span>
        <span class="k">if</span> <span class="n">create</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_primary_key</span><span class="p">(</span><span class="s2">&quot;pkey&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;pkey&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of rows in the DataFrame.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">nrows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of rows in the DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ncols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shape of the DataFrame (num_rows, num_columns).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

<div class="viewcode-block" id="DataFrame.size"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.size">[docs]</a>    <span class="nd">@reactive</span><span class="p">(</span><span class="n">nested_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shape of the DataFrame (num_rows, num_columns).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span></div>

<div class="viewcode-block" id="DataFrame.add_column"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.add_column">[docs]</a>    <span class="k">def</span> <span class="nf">add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Column</span><span class="o">.</span><span class="n">Columnable</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a column to the DataFrame.&quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="nb">str</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Column name must of type `str`, not `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">`.&quot;</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Column with name `</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">` already exists, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;set `overwrite=True` to overwrite.&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_listlike</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">column</span> <span class="o">=</span> <span class="n">Column</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`add_column` failed. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Values length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span><span class="si">}</span><span class="s2"> != dataset length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Add the column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added column `</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">` with length `</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.remove_column"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.remove_column">[docs]</a>    <span class="k">def</span> <span class="nf">remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a column from the dataset.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Column `</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">` does not exist.&quot;</span>

        <span class="c1"># Remove the column</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span><span class="p">:</span>
            <span class="c1"># need to reset the primary key if we remove the column</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removed column `</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span></div>

    <span class="c1"># @capture_provenance(capture_args=[&quot;axis&quot;])</span>
<div class="viewcode-block" id="DataFrame.append"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.append">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rows&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Append a batch of data to the dataset.</span>

<span class="sd">        `example_or_batch` must have the same columns as the dataset</span>
<span class="sd">        (regardless of what columns are visible).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">meerkat</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.head"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.head">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first `n` examples of the DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="DataFrame.tail"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.tail">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last `n` examples of the DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">:]</span></div>

    <span class="k">def</span> <span class="nf">_get_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyidx</span><span class="p">,</span> <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot use `loc` without a primary key. Set a primary key using &quot;</span>
                <span class="s2">&quot;`set_primary_key`.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">keyidx</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Column</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">posidxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="o">.</span><span class="n">_keyidxs_to_posidxs</span><span class="p">(</span><span class="n">keyidx</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;_get&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">posidxs</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">posidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="o">.</span><span class="n">_keyidx_to_posidx</span><span class="p">(</span><span class="n">keyidx</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;_get&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">posidx</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">_set_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyidx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">any</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot use `loc` without a primary key. Set a primary key using &quot;</span>
                <span class="s2">&quot;`set_primary_key`.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">keyidx</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Column</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">posidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="o">.</span><span class="n">_keyidx_to_posidx</span><span class="p">(</span><span class="n">keyidx</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">][</span><span class="n">posidx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_inode</span><span class="p">():</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="n">DataFrameModification</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inode</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                <span class="n">mod</span><span class="o">.</span><span class="n">add_to_queue</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posidx</span><span class="p">,</span> <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># str index =&gt; column selection (AbstractColumn)</span>
            <span class="k">if</span> <span class="n">posidx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">posidx</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column `</span><span class="si">{</span><span class="n">posidx</span><span class="si">}</span><span class="s2">` does not exist.&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># int index =&gt; single row (dict)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;_get&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">posidx</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Row</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>

        <span class="c1"># cases where `index` returns a dataframe</span>
        <span class="n">index_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="c1"># slice index =&gt; multiple row selection (DataFrame)</span>
            <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;row&quot;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">posidx</span><span class="p">):</span>
            <span class="c1"># tuple or list index =&gt; multiple row selection (DataFrame)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;column&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;row&quot;</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">posidx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Index must have 1 axis, not </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">posidx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="c1"># numpy array index =&gt; multiple row selection (DataFrame)</span>
            <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;row&quot;</span>

        <span class="k">elif</span> <span class="n">torch</span><span class="o">.</span><span class="n">is_tensor</span><span class="p">(</span><span class="n">posidx</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">posidx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Index must have 1 axis, not </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">posidx</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="c1"># torch tensor index =&gt; multiple row selection (DataFrame)</span>
            <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;row&quot;</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;row&quot;</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="n">Column</span><span class="p">):</span>
            <span class="c1"># column index =&gt; multiple row selection (DataFrame)</span>
            <span class="n">index_type</span> <span class="o">=</span> <span class="s2">&quot;row&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid index type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">posidx</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">index_type</span> <span class="o">==</span> <span class="s2">&quot;column&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">posidx</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">missing_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">posidx</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame does not have columns </span><span class="si">{</span><span class="n">missing_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">posidx</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">df</span>
        <span class="k">elif</span> <span class="n">index_type</span> <span class="o">==</span> <span class="s2">&quot;row&quot;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;_get&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">posidx</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># @capture_provenance(capture_args=[])</span>
    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">posidx</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posidx</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">posidx</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># This condition will issue modifications even if we&#39;re outside an endpoint</span>
        <span class="c1"># but those modifications will be cleared by the endpoint before it is</span>
        <span class="c1"># run.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_inode</span><span class="p">():</span>
            <span class="c1"># Add a modification if it&#39;s on the graph</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">DataFrameModification</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">mod</span><span class="o">.</span><span class="n">add_to_queue</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">materialize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrame.set"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the data of this DataFrame to the data of another DataFrame.</span>

<span class="sd">        This is used inside endpoints to tell Meerkat when a DataFrame</span>
<span class="sd">        has been modified. Calling this method outside of an endpoint</span>
<span class="sd">        will not have any effect on the graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_data</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_state</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">_get_state</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_inode</span><span class="p">():</span>
            <span class="c1"># Add a modification if it&#39;s on the graph</span>
            <span class="c1"># TODO: think about what the scope should be.</span>
            <span class="c1">#   How does `scope` relate to the the skip_fn mechanism</span>
            <span class="c1">#   in Operation?</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">DataFrameModification</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inode</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">mod</span><span class="o">.</span><span class="n">add_to_queue</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">consolidate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">consolidate</span><span class="p">()</span>

<div class="viewcode-block" id="DataFrame.from_batch"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_batch">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance()</span>
    <span class="k">def</span> <span class="nf">from_batch</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">batch</span><span class="p">:</span> <span class="n">Batch</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a batch to a Dataset.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.from_batches"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_batches">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance()</span>
    <span class="k">def</span> <span class="nf">from_batches</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">batches</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Batch</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a list of batches to a dataset.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_batch</span><span class="p">(</span>
            <span class="n">tz</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span>
                <span class="n">tz</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">tz</span><span class="o">.</span><span class="n">concat</span><span class="p">),</span>
                <span class="o">*</span><span class="n">batches</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.from_pandas"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_pandas">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance()</span>
    <span class="k">def</span> <span class="nf">from_pandas</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Meerkat DataFrame from a Pandas DataFrame.</span>

<span class="sd">        .. warning::</span>

<span class="sd">            In Meerkat, column names must be strings, so non-string column</span>
<span class="sd">            names in the Pandas DataFrame will be converted.</span>

<span class="sd">        Args:</span>
<span class="sd">            df: The Pandas DataFrame to convert.</span>
<span class="sd">            index: Whether to include the index of the Pandas DataFrame as a</span>
<span class="sd">                column in the Meerkat DataFrame.</span>
<span class="sd">            primary_key: The name of the column to use as the primary key.</span>
<span class="sd">                If `index` is True and `primary_key` is None, the index will</span>
<span class="sd">                be used as the primary key. If `index` is False, then no</span>
<span class="sd">                primary key will be set. Optional default is None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: The Meerkat DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># column names must be str in meerkat</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">mapper</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
        <span class="n">pandas_df</span> <span class="o">=</span> <span class="n">df</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_batch</span><span class="p">(</span>
            <span class="n">pandas_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;series&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandas_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">primary_key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.from_arrow"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_arrow">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance()</span>
    <span class="k">def</span> <span class="nf">from_arrow</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Dataset from a pandas DataFrame.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">meerkat.block.arrow_block</span> <span class="kn">import</span> <span class="n">ArrowBlock</span>
        <span class="kn">from</span> <span class="nn">meerkat.columns.scalar.arrow</span> <span class="kn">import</span> <span class="n">ArrowScalarColumn</span>

        <span class="n">block_views</span> <span class="o">=</span> <span class="n">ArrowBlock</span><span class="o">.</span><span class="n">from_block_data</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_batch</span><span class="p">(</span>
            <span class="p">{</span><span class="n">view</span><span class="o">.</span><span class="n">block_index</span><span class="p">:</span> <span class="n">ArrowScalarColumn</span><span class="p">(</span><span class="n">view</span><span class="p">)</span> <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">block_views</span><span class="p">}</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.from_huggingface"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_huggingface">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_huggingface</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Huggingface dataset as a DataFrame.</span>

<span class="sd">        Use this to replace `datasets.load_dataset`, so</span>

<span class="sd">        &gt;&gt;&gt; dict_of_datasets = datasets.load_dataset(&#39;boolq&#39;)</span>

<span class="sd">        becomes</span>

<span class="sd">        &gt;&gt;&gt; dict_of_dataframes = DataFrame.from_huggingface(&#39;boolq&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">datasets</span>

        <span class="c1"># Load the dataset</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_data</span><span class="p">)),</span>
                    <span class="n">dataset</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.from_csv"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_csv">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance(capture_args=[&quot;filepath&quot;])</span>
    <span class="k">def</span> <span class="nf">from_csv</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a DataFrame from a csv file. All of the columns will be</span>
<span class="sd">        :class:`meerkat.ScalarColumn` with backend Pandas.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path or buffer to load from.</span>
<span class="sd">                Same as :func:`pandas.read_csv`.</span>
<span class="sd">            *args: Argument list for :func:`pandas.read_csv`.</span>
<span class="sd">            **kwargs: Keyword arguments forwarded to :func:`pandas.read_csv`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: The constructed dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pandas&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;arrow&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">primary_key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.from_feather"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_feather">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance()</span>
    <span class="k">def</span> <span class="nf">from_feather</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_threads</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a DataFrame from a feather file. All of the columns will be</span>
<span class="sd">        :class:`meerkat.ScalarColumn` with backend Pandas.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path or buffer to load from.</span>
<span class="sd">                Same as :func:`pandas.read_feather`.</span>
<span class="sd">            columns (Optional[Sequence[str]]): The columns to load.</span>
<span class="sd">                Same as :func:`pandas.read_feather`.</span>
<span class="sd">            use_threads (bool): Whether to use threads to read the file.</span>
<span class="sd">                Same as :func:`pandas.read_feather`.</span>
<span class="sd">            **kwargs: Keyword arguments forwarded to :func:`pandas.read_feather`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: The constructed dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span>
                <span class="n">filepath</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">use_threads</span><span class="o">=</span><span class="n">use_threads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">),</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">primary_key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.from_parquet"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_parquet">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="c1"># @capture_provenance()</span>
    <span class="k">def</span> <span class="nf">from_parquet</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a DataFrame from a parquet file. All of the columns will be</span>
<span class="sd">        :class:`meerkat.ScalarColumn` with backend Pandas.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path or buffer to load from.</span>
<span class="sd">                Same as :func:`pandas.read_parquet`.</span>
<span class="sd">            engine (str): The parquet engine to use.</span>
<span class="sd">                Same as :func:`pandas.read_parquet`.</span>
<span class="sd">            columns (Optional[Sequence[str]]): The columns to load.</span>
<span class="sd">                Same as :func:`pandas.read_parquet`.</span>
<span class="sd">            **kwargs: Keyword arguments forwarded to :func:`pandas.read_parquet`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: The constructed dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">primary_key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.from_json"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.from_json">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">orient</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;records&quot;</span><span class="p">,</span>
        <span class="n">lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a DataFrame from a json file.</span>

<span class="sd">        By default, data in the JSON file should be a list of dictionaries, each with</span>
<span class="sd">        an entry for each column. This is the ``orient=&quot;records&quot;`` format. If the data</span>
<span class="sd">        is in a different format in the JSON, you can specify the ``orient`` parameter.</span>
<span class="sd">        See :func:`pandas.read_json` for more details.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path or buffer to load from.</span>
<span class="sd">                Same as :func:`pandas.read_json`.</span>
<span class="sd">            orient (str): The expected JSON string format. Options are:</span>
<span class="sd">                &quot;split&quot;, &quot;records&quot;, &quot;index&quot;, &quot;columns&quot;, &quot;values&quot;.</span>
<span class="sd">                Same as :func:`pandas.read_json`.</span>
<span class="sd">            lines (bool): Whether the json file is a jsonl file.</span>
<span class="sd">                Same as :func:`pandas.read_json`.</span>
<span class="sd">            backend (str): The backend to use for the loading and reuslting columns.</span>
<span class="sd">            **kwargs: Keyword arguments forwarded to :func:`pandas.read_json`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: The constructed dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pyarrow</span> <span class="kn">import</span> <span class="n">json</span>

        <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;arrow&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Arrow backend only supports lines=True.&quot;</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pandas&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">orient</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
                <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">primary_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_primary_key</span><span class="p">(</span><span class="n">primary_key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span></div>

    <span class="k">def</span> <span class="nf">_to_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method to convert a Meerkat DataFrame to a base format.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">converted_column</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;to_</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ConversionError</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could not convert column </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">column</span><span class="p">)</span><span class="si">}</span><span class="s2">, it will &quot;</span>
                    <span class="s2">&quot;be dropped from the output.&quot;</span>
                <span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">converted_column</span>
        <span class="k">return</span> <span class="n">data</span>

<div class="viewcode-block" id="DataFrame.to_pandas"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.to_pandas">[docs]</a>    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_objects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a Meerkat DataFrame to a Pandas DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            index (bool): Use the primary key as the index of the Pandas</span>
<span class="sd">                DataFrame. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: The constructed dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_base</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;pandas&quot;</span><span class="p">,</span> <span class="n">allow_objects</span><span class="o">=</span><span class="n">allow_objects</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.to_arrow"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.to_arrow">[docs]</a>    <span class="k">def</span> <span class="nf">to_arrow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a Meerkat DataFrame to an Arrow Table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pa.Table: The constructed table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_base</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;arrow&quot;</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_choose_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Choose which library to use for export.</span>

<span class="sd">        If any of the columns are ArrowScalarColumn, then use Arrow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">ArrowScalarColumn</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;arrow&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;pandas&quot;</span>

<div class="viewcode-block" id="DataFrame.to_csv"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.to_csv">[docs]</a>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a DataFrame to a csv file.</span>

<span class="sd">        The engine used to write the csv to disk.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path to save to.</span>
<span class="sd">            engine (str): The library to use to write the csv. One of [&quot;pandas&quot;,</span>
<span class="sd">                &quot;arrow&quot;, &quot;auto&quot;]. If &quot;auto&quot;, then the library will be chosen based on</span>
<span class="sd">                the column types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_engine</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;arrow&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pyarrow.csv</span> <span class="kn">import</span> <span class="n">write_csv</span>

            <span class="n">write_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">(),</span> <span class="n">filepath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.to_feather"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.to_feather">[docs]</a>    <span class="k">def</span> <span class="nf">to_feather</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a DataFrame to a feather file.</span>

<span class="sd">        The engine used to write the feather to disk.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path to save to.</span>
<span class="sd">            engine (str): The library to use to write the feather. One of [&quot;pandas&quot;,</span>
<span class="sd">                &quot;arrow&quot;, &quot;auto&quot;]. If &quot;auto&quot;, then the library will be chosen based on</span>
<span class="sd">                the column types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_engine</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;arrow&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pyarrow.feather</span> <span class="kn">import</span> <span class="n">write_feather</span>

            <span class="n">write_feather</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">(),</span> <span class="n">filepath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.to_parquet"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.to_parquet">[docs]</a>    <span class="k">def</span> <span class="nf">to_parquet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a DataFrame to a parquet file.</span>

<span class="sd">        The engine used to write the parquet to disk.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path to save to.</span>
<span class="sd">            engine (str): The library to use to write the parquet. One of [&quot;pandas&quot;,</span>
<span class="sd">                &quot;arrow&quot;, &quot;auto&quot;]. If &quot;auto&quot;, then the library will be chosen based on</span>
<span class="sd">                the column types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_engine</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;arrow&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pyarrow.parquet</span> <span class="kn">import</span> <span class="n">write_table</span>

            <span class="n">write_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">(),</span> <span class="n">filepath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.to_json"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;records&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a Dataset to a json file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath (str): The file path to save to.</span>
<span class="sd">            lines (bool): Whether to write the json file as a jsonl file.</span>
<span class="sd">            orient (str): The orientation of the json file.</span>
<span class="sd">                Same as :func:`pandas.DataFrame.to_json`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">orient</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_collate_fns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">columns</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">collate</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">_collate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">tz</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="o">*</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">column_to_collate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_collate_fns</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">new_batch</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_batch</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">column_to_collate</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">values</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">new_batch</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_convert_to_batch_fn</span><span class="p">(</span>
        <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">with_indices</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">callable</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">convert_to_batch_fn</span><span class="p">(</span>
            <span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span>
            <span class="n">with_indices</span><span class="o">=</span><span class="n">with_indices</span><span class="p">,</span>
            <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DataFrame.batch"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.batch">[docs]</a>    <span class="k">def</span> <span class="nf">batch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">drop_last_batch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Batch the dataset.</span>
<span class="sd">        TODO:</span>

<span class="sd">        Args:</span>
<span class="sd">            batch_size: integer batch size</span>
<span class="sd">            drop_last_batch: drop the last batch if its smaller than batch_size</span>

<span class="sd">        Returns:</span>
<span class="sd">            batches of data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cell_columns</span><span class="p">,</span> <span class="n">batch_columns</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="kn">from</span> <span class="nn">meerkat.columns.deferred.base</span> <span class="kn">import</span> <span class="n">DeferredColumn</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">DeferredColumn</span><span class="p">)</span> <span class="ow">and</span> <span class="n">materialize</span><span class="p">:</span>
                <span class="n">cell_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">batch_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">batch_columns</span><span class="p">:</span>
            <span class="n">batch_indices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">drop_last_batch</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">batch_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">])</span>
            <span class="n">batch_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">batch_columns</span><span class="p">],</span>
                <span class="n">sampler</span><span class="o">=</span><span class="n">batch_indices</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">batch_sampler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">drop_last</span><span class="o">=</span><span class="n">drop_last_batch</span><span class="p">,</span>
                <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">cell_columns</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">cell_columns</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">shuffle</span> <span class="k">else</span> <span class="bp">self</span><span class="p">[</span><span class="n">cell_columns</span><span class="p">][</span><span class="n">indices</span><span class="p">]</span>
            <span class="n">cell_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
                <span class="n">df</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate</span><span class="p">,</span>
                <span class="n">drop_last</span><span class="o">=</span><span class="n">drop_last_batch</span><span class="p">,</span>
                <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">batch_columns</span> <span class="ow">and</span> <span class="n">cell_columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cell_batch</span><span class="p">,</span> <span class="n">batch_batch</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cell_dl</span><span class="p">,</span> <span class="n">batch_dl</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">cell_batch</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">batch_batch</span><span class="o">.</span><span class="n">data</span><span class="p">})</span>
                <span class="k">yield</span> <span class="n">out</span><span class="p">()</span> <span class="k">if</span> <span class="n">materialize</span> <span class="k">else</span> <span class="n">out</span>
        <span class="k">elif</span> <span class="n">batch_columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">batch_batch</span> <span class="ow">in</span> <span class="n">batch_dl</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">batch_batch</span><span class="p">()</span> <span class="k">if</span> <span class="n">materialize</span> <span class="k">else</span> <span class="n">batch_batch</span>
        <span class="k">elif</span> <span class="n">cell_columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cell_batch</span> <span class="ow">in</span> <span class="n">cell_dl</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">cell_batch</span><span class="p">()</span> <span class="k">if</span> <span class="n">materialize</span> <span class="k">else</span> <span class="n">cell_batch</span></div>

    <span class="c1"># @capture_provenance(capture_args=[&quot;with_indices&quot;])</span>
<div class="viewcode-block" id="DataFrame.update"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">function</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">with_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">input_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_batched_fn</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">remove_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">output_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mmap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mmap_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">pbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the columns of the dataset.&quot;&quot;&quot;</span>
        <span class="c1"># TODO(karan): make this fn go faster</span>
        <span class="c1"># most of the time is spent on the merge, speed it up further</span>

        <span class="c1"># Return if `self` has no examples</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dataset empty, returning None.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># Get some information about the function</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">input_columns</span><span class="p">]</span> <span class="k">if</span> <span class="n">input_columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span>
        <span class="n">function_properties</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_inspect_function</span><span class="p">(</span>
            <span class="n">function</span><span class="p">,</span> <span class="n">with_indices</span><span class="p">,</span> <span class="n">is_batched_fn</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">function_properties</span><span class="o">.</span><span class="n">dict_output</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;`function` </span><span class="si">{</span><span class="n">function</span><span class="si">}</span><span class="s2"> must return dict.&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_batched_fn</span><span class="p">:</span>
            <span class="c1"># Convert to a batch function</span>
            <span class="n">function</span> <span class="o">=</span> <span class="n">convert_to_batch_fn</span><span class="p">(</span>
                <span class="n">function</span><span class="p">,</span> <span class="n">with_indices</span><span class="o">=</span><span class="n">with_indices</span><span class="p">,</span> <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converting `function` </span><span class="si">{</span><span class="n">function</span><span class="si">}</span><span class="s2"> to batched function.&quot;</span><span class="p">)</span>

        <span class="c1"># Update always returns a new dataset</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running update, a new dataset will be returned.&quot;</span><span class="p">)</span>

        <span class="c1"># Copy the ._data dict with a reference to the actual columns</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>

        <span class="c1"># Calculate the values for the new columns using a .map()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span>
            <span class="n">with_indices</span><span class="o">=</span><span class="n">with_indices</span><span class="p">,</span>
            <span class="n">is_batched_fn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
            <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
            <span class="n">input_columns</span><span class="o">=</span><span class="n">input_columns</span><span class="p">,</span>
            <span class="n">mmap</span><span class="o">=</span><span class="n">mmap</span><span class="p">,</span>
            <span class="n">mmap_path</span><span class="o">=</span><span class="n">mmap_path</span><span class="p">,</span>
            <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span>
            <span class="n">pbar</span><span class="o">=</span><span class="n">pbar</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Add new columns for the update</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_df</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Remove columns</span>
        <span class="k">if</span> <span class="n">remove_columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">remove_columns</span><span class="p">:</span>
                <span class="n">new_df</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removed columns </span><span class="si">{</span><span class="n">remove_columns</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_df</span></div>

    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">is_batched_fn</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">any</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Column&quot;</span><span class="p">]],</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Column&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Column</span><span class="p">]]:</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.map</span> <span class="kn">import</span> <span class="nb">map</span>

        <span class="k">return</span> <span class="nb">map</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span>
            <span class="n">is_batched_fn</span><span class="o">=</span><span class="n">is_batched_fn</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
            <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
            <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
            <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># @capture_provenance(capture_args=[&quot;function&quot;])</span>
<div class="viewcode-block" id="DataFrame.filter"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.filter">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">function</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">with_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">input_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_batched_fn</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">drop_last_batch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">materialize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">pbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter operation on the DataFrame.&quot;&quot;&quot;</span>

        <span class="c1"># Return if `self` has no examples</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;DataFrame empty, returning None.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Get some information about the function</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">input_columns</span><span class="p">]</span> <span class="k">if</span> <span class="n">input_columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span>
        <span class="n">function_properties</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_inspect_function</span><span class="p">(</span>
            <span class="n">function</span><span class="p">,</span>
            <span class="n">with_indices</span><span class="p">,</span>
            <span class="n">is_batched_fn</span><span class="o">=</span><span class="n">is_batched_fn</span><span class="p">,</span>
            <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">function_properties</span><span class="o">.</span><span class="n">bool_output</span><span class="p">,</span> <span class="s2">&quot;function must return boolean.&quot;</span>

        <span class="c1"># Map to get the boolean outputs and indices</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running `filter`, a new DataFrame will be returned.&quot;</span><span class="p">)</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span>
            <span class="n">with_indices</span><span class="o">=</span><span class="n">with_indices</span><span class="p">,</span>
            <span class="n">input_columns</span><span class="o">=</span><span class="n">input_columns</span><span class="p">,</span>
            <span class="n">is_batched_fn</span><span class="o">=</span><span class="n">is_batched_fn</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">drop_last_batch</span><span class="o">=</span><span class="n">drop_last_batch</span><span class="p">,</span>
            <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
            <span class="n">materialize</span><span class="o">=</span><span class="n">materialize</span><span class="p">,</span>
            <span class="n">pbar</span><span class="o">=</span><span class="n">pbar</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">outputs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># filter returns a new dataframe</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span></div>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">right</span><span class="p">:</span> <span class="n">meerkat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span>
        <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">left_on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">right_on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
        <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat</span> <span class="kn">import</span> <span class="n">merge</span>

        <span class="k">return</span> <span class="n">merge</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">right</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span>
            <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span><span class="p">,</span>
            <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DataFrame.sort"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.sort">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">ascending</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;quicksort&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the DataFrame by the values in the specified columns. Similar</span>
<span class="sd">        to ``sort_values`` in pandas.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, List[str]]): The columns to sort by.</span>
<span class="sd">            ascending (Union[bool, List[bool]]): Whether to sort in ascending or</span>
<span class="sd">                descending order. If a list, must be the same length as `by`.Defaults</span>
<span class="sd">                to True.</span>
<span class="sd">            kind (str): The kind of sort to use. Defaults to &#39;quicksort&#39;. Options</span>
<span class="sd">                include &#39;quicksort&#39;, &#39;mergesort&#39;, &#39;heapsort&#39;, &#39;stable&#39;.</span>

<span class="sd">        Return:</span>
<span class="sd">            DataFrame: A sorted view of DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">meerkat</span> <span class="kn">import</span> <span class="n">sort</span>

        <span class="k">return</span> <span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.sample"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.sample">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">frac</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select a random sample of rows from DataFrame. Roughly equivalent to</span>
<span class="sd">        ``sample`` in Pandas https://pandas.pydata.org/docs/reference/api/panda</span>
<span class="sd">        s.DataFrame.sample.html.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Number of samples to draw. If `frac` is specified, this parameter</span>
<span class="sd">                should not be passed. Defaults to 1 if `frac` is not passed.</span>
<span class="sd">            frac (float): Fraction of rows to sample. If `n` is specified, this</span>
<span class="sd">                parameter should not be passed.</span>
<span class="sd">            replace (bool): Sample with or without replacement. Defaults to False.</span>
<span class="sd">            weights (Union[str, np.ndarray]): Weights to use for sampling. If `None`</span>
<span class="sd">                (default), the rows will be sampled uniformly. If a numpy array, the</span>
<span class="sd">                sample will be weighted accordingly. If a string, the weights will be</span>
<span class="sd">                applied to the rows based on the column with the name specified. If</span>
<span class="sd">                weights do not sum to 1 they will be normalized to sum to 1.</span>
<span class="sd">            random_state (Union[int, np.random.RandomState]): Random state or seed to</span>
<span class="sd">                use for sampling.</span>

<span class="sd">        Return:</span>
<span class="sd">            DataFrame: A random sample of rows from the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">meerkat</span> <span class="kn">import</span> <span class="n">sample</span>

        <span class="k">return</span> <span class="n">sample</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">,</span>
            <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.shuffle"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.shuffle">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shuffle the rows of the DataFrame out-of-place.</span>

<span class="sd">        Args:</span>
<span class="sd">            seed (int): Random seed to use for shuffling.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A shuffled view of the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">meerkat</span> <span class="kn">import</span> <span class="n">shuffle</span>

        <span class="k">return</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.rename"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.rename">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mapper</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;raise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new DataFrame with the specified column labels renamed.</span>

<span class="sd">        Dictionary values must be unique (1-to-1). Labels not specified will be</span>
<span class="sd">        left unchanged. Extra labels will not throw an error.</span>

<span class="sd">        Args:</span>
<span class="sd">            mapper (Union[Dict, Callable], optional): Dict-like of function</span>
<span class="sd">                transformations to apply to the values of the columns. Defaults</span>
<span class="sd">                to None.</span>
<span class="sd">            errors (Literal[&#39;ignore&#39;, &#39;raise&#39;], optional): If &#39;raise&#39;, raise a</span>
<span class="sd">                KeyError when the Dict contains labels that do not exist in the</span>
<span class="sd">                DataFrame. If &#39;ignore&#39;, extra keys will be ignored. Defaults to</span>
<span class="sd">                &#39;ignore&#39;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A new DataFrame with the specified column labels renamed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Copy the ._data dict with a reference to the actual columns</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">Dict</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mapper</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">mapper</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">),</span> <span class="s2">&quot;Dictionary values must be unique (1-to-1).&quot;</span>

            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># used to preserve order of columns</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mapper</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">old_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Cannot rename nonexistent column `</span><span class="si">{</span><span class="n">old_name</span><span class="si">}</span><span class="s2">`.&quot;</span>
                        <span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">old_name</span> <span class="o">==</span> <span class="n">new_name</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Copy old column into new column</span>
                <span class="n">new_df</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span>
                <span class="n">new_df</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
                <span class="n">names</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">old_name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">new_name</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">names</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">old_name</span> <span class="ow">in</span> <span class="n">new_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">new_name</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">old_name</span> <span class="o">==</span> <span class="n">new_name</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Copy old column into new column</span>
                <span class="n">new_df</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span>
                <span class="n">new_df</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Mapper type is not one of Dict or Callable: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span><span class="si">}</span><span class="s2">. Returning&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">new_df</span></div>

<div class="viewcode-block" id="DataFrame.drop"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.drop">[docs]</a>    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">check_exists</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new DataFrame with the specified columns dropped.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns (Union[str, Collection[str]]): The columns to drop.</span>

<span class="sd">        Return:</span>
<span class="sd">            DataFrame: A new DataFrame with the specified columns dropped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">check_exists</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot drop nonexistent column &#39;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&#39; from DataFrame.&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]]</span></div>

    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: Add support for decorating iterators with reactive.</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>

    <span class="k">def</span> <span class="nf">iterrows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: Add support for decorating iterators with reactive.</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<div class="viewcode-block" id="DataFrame.read"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.read">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a DataFrame stored on disk.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">meerkat.datasets.utils</span> <span class="kn">import</span> <span class="n">download_df</span><span class="p">,</span> <span class="n">extract_tar_file</span>

        <span class="c1"># URL</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">download_df</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path does not exist: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Compressed file.</span>
        <span class="c1"># TODO: Add support for other compressed formats.</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tar.gz&quot;</span><span class="p">):</span>
            <span class="n">download_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="s2">&quot;.mktemp&quot;</span><span class="p">)</span>
            <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">download_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.tar.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">extract_tar_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="n">download_dir</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">download_dir</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">df</span>

        <span class="c1"># Load the metadata</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_yaml</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;meta.yaml&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;state&quot;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># backwards compatability to dill dataframes</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">dill</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;state.dill&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">_set_id</span><span class="p">()</span>  <span class="c1"># TODO: consider if we want to persist this id</span>
        <span class="n">df</span><span class="o">.</span><span class="n">_set_inode</span><span class="p">()</span>  <span class="c1"># FIXME: this seems hacky</span>
        <span class="n">df</span><span class="o">.</span><span class="n">_set_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="c1"># Load the the manager</span>
        <span class="n">mgr_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;mgr&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">mgr_dir</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mgr_dir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># backwards compatability to pre-manager dataframes</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">name</span><span class="p">:</span> <span class="n">dtype</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;column_dtypes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

        <span class="n">df</span><span class="o">.</span><span class="n">_set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.write"><a class="viewcode-back" href="../../apidocs/dataframe.html#meerkat.DataFrame.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a DataFrame to disk.&quot;&quot;&quot;</span>
        <span class="c1"># Make all the directories to the path</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Get the DataFrame state</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_state</span><span class="p">()</span>

        <span class="c1"># Get the metadata</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s2">&quot;column_dtypes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="s2">&quot;len&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># write the block manager</span>
        <span class="n">mgr_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;mgr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mgr_dir</span><span class="p">)</span>

        <span class="c1"># Save the metadata as a yaml file</span>
        <span class="n">metadata_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;meta.yaml&quot;</span><span class="p">)</span>
        <span class="n">dump_yaml</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">metadata_path</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_state_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of attributes that describe the state of the object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;_primary_key&quot;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">_set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="c1"># backwards compatibility for old dataframes</span>
        <span class="k">if</span> <span class="s2">&quot;_primary_key&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_primary_key</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_view_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_copy_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.sliceby.groupby</span> <span class="kn">import</span> <span class="n">groupby</span>

        <span class="k">return</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sliceby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.sliceby.sliceby</span> <span class="kn">import</span> <span class="n">sliceby</span>

        <span class="k">return</span> <span class="n">sliceby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">clusterby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.sliceby.clusterby</span> <span class="kn">import</span> <span class="n">clusterby</span>

        <span class="k">return</span> <span class="n">clusterby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">explainby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.sliceby.explainby</span> <span class="kn">import</span> <span class="n">explainby</span>

        <span class="k">return</span> <span class="n">explainby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">nuisance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.aggregate.aggregate</span> <span class="kn">import</span> <span class="n">aggregate</span>

        <span class="k">return</span> <span class="n">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@reactive</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">nuisance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">meerkat.ops.aggregate.aggregate</span> <span class="kn">import</span> <span class="n">aggregate</span>

        <span class="k">return</span> <span class="n">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">nuisance</span><span class="o">=</span><span class="n">nuisance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">is_listlike</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the object is listlike.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj (object): The object to check.</span>

<span class="sd">    Return:</span>
<span class="sd">        bool: True if the object is listlike, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_column</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Column</span><span class="p">)</span>
    <span class="n">is_sequential</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">is_column</span> <span class="ow">or</span> <span class="n">is_sequential</span>


<span class="n">DataFrame</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">_react</span>
<span class="n">DataFrame</span><span class="o">.</span><span class="n">unmark</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">_no_react</span>
</pre></div>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Meerkat Team<br/>
  
      &copy; Copyright 2023 Meerkat.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>