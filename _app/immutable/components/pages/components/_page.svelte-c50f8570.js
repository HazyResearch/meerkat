var _r=Object.defineProperty;var yr=(e,n,i)=>n in e?_r(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i;var at=(e,n,i)=>(yr(e,typeof n!="symbol"?n+"":n,i),i),Jn=(e,n,i)=>{if(!n.has(e))throw TypeError("Cannot "+i)};var le=(e,n,i)=>(Jn(e,n,"read from private field"),i?i.call(e):n.get(e)),De=(e,n,i)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,i)},Ue=(e,n,i,r)=>(Jn(e,n,"write to private field"),r?r.call(e,i):n.set(e,i),i),ei=(e,n,i,r)=>({set _(s){Ue(e,n,s,i)},get _(){return le(e,n,r)}}),Pe=(e,n,i)=>(Jn(e,n,"access private method"),i);import{S as SvelteComponent,i as init$1,s as safe_not_equal,K as assign,_ as svg_element,$ as claim_svg_element,m as children$2,h as detach,a0 as set_svg_attributes,b as insert_hydration,R as listen,T as get_spread_update,B as noop$6,I as compute_rest_props,L as exclude_internal_props,M as bubble,n as attr$6,G as append_hydration,C as create_slot,k as element$2,l as claim_element,D as update_slot_base,E as get_all_dirty_from_scope,F as get_slot_changes,f as transition_in,t as transition_out,a3 as compute_slots,e as empty,g as group_outros,d as check_outros,P as set_attributes,a1 as src_url_equal,a as space,c as claim_space,O as set_custom_element_data_map,w as create_component,x as claim_component,y as mount_component,Z as get_spread_object,z as destroy_component,Q as action_destroyer,N as binding_callbacks,Y as getContext$1,V as run_all,U as is_function,a4 as set_input_value,q as text$3,r as claim_text,u as set_data,W as add_render_callback,X as create_bidirectional_transition,o as onMount,v as construct_svelte_component,a5 as destroy_each,a6 as get_store_value,a2 as toggle_class,a7 as handle_promise,a8 as bind$3,a9 as update_await_block_branch,aa as add_flush_callback,ab as createEventDispatcher,ac as head_selector,p as set_style,ad as select_option,ae as select_value,af as to_number,J as setContext}from"../../../chunks/index-ea933268.js";import{c as classNames,q as quintOut,s as slide,B as Button$1,N as Nav,F as Footer}from"../../../chunks/Footer-50035759.js";import{w as writable}from"../../../chunks/index-004a8daa.js";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var i=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var o=Function.bind.apply(n,s);return new o}return n.apply(this,arguments)};i.prototype=n.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),i}function create_fragment$R(e){let n,i,r,s,o=[{xmlns:"http://www.w3.org/2000/svg"},{width:e[0]},{height:e[0]},{class:i=e[4].class},e[5],{"aria-label":e[1]},{fill:"none"},{viewBox:e[2]},{"stroke-width":"2"}],l={};for(let f=0;f<o.length;f+=1)l=assign(l,o[f]);return{c(){n=svg_element("svg"),this.h()},l(f){n=claim_svg_element(f,"svg",{xmlns:!0,width:!0,height:!0,class:!0,"aria-label":!0,fill:!0,viewBox:!0,"stroke-width":!0});var d=children$2(n);d.forEach(detach),this.h()},h(){set_svg_attributes(n,l)},m(f,d){insert_hydration(f,n,d),n.innerHTML=e[3],r||(s=listen(n,"click",e[8]),r=!0)},p(f,[d]){d&8&&(n.innerHTML=f[3]),set_svg_attributes(n,l=get_spread_update(o,[{xmlns:"http://www.w3.org/2000/svg"},d&1&&{width:f[0]},d&1&&{height:f[0]},d&16&&i!==(i=f[4].class)&&{class:i},d&32&&f[5],d&2&&{"aria-label":f[1]},{fill:"none"},d&4&&{viewBox:f[2]},{"stroke-width":"2"}]))},i:noop$6,o:noop$6,d(f){f&&detach(n),r=!1,s()}}}function instance$R(e,n,i){const r=["size","color","variation","ariaLabel"];let s=compute_rest_props(n,r),{size:o="24"}=n,{color:l="currentColor"}=n,{variation:f="outline"}=n,d,p,g=`<path d="M19.5 8.25L12 15.75L4.5 8.25" stroke="${l}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> `,v=`<path fill-rule="evenodd" clip-rule="evenodd" d="M12.5303 16.2803C12.2374 16.5732 11.7626 16.5732 11.4697 16.2803L3.96967 8.78033C3.67678 8.48744 3.67678 8.01256 3.96967 7.71967C4.26256 7.42678 4.73744 7.42678 5.03033 7.71967L12 14.6893L18.9697 7.71967C19.2626 7.42678 19.7374 7.42678 20.0303 7.71967C20.3232 8.01256 20.3232 8.48744 20.0303 8.78033L12.5303 16.2803Z" fill="${l}"/> `,{ariaLabel:S="chevron down"}=n;function T(k){bubble.call(this,e,k)}return e.$$set=k=>{i(4,n=assign(assign({},n),exclude_internal_props(k))),i(5,s=compute_rest_props(n,r)),"size"in k&&i(0,o=k.size),"color"in k&&i(6,l=k.color),"variation"in k&&i(7,f=k.variation),"ariaLabel"in k&&i(1,S=k.ariaLabel)},e.$$.update=()=>{if(e.$$.dirty&128)switch(f){case"outline":i(3,p=g),i(2,d="0 0 24 24");break;case"solid":i(3,p=v),i(2,d="0 0 24 24");break;default:i(3,p=g),i(2,d="0 0 24 24")}},n=exclude_internal_props(n),[o,S,d,p,n,s,l,f,T]}class ChevronDown extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$R,create_fragment$R,safe_not_equal,{size:0,color:6,variation:7,ariaLabel:1})}}function create_fragment$Q(e){let n,i,r,s,o=[{xmlns:"http://www.w3.org/2000/svg"},{width:e[0]},{height:e[0]},{class:i=e[4].class},e[5],{"aria-label":e[1]},{fill:"none"},{viewBox:e[2]},{"stroke-width":"2"}],l={};for(let f=0;f<o.length;f+=1)l=assign(l,o[f]);return{c(){n=svg_element("svg"),this.h()},l(f){n=claim_svg_element(f,"svg",{xmlns:!0,width:!0,height:!0,class:!0,"aria-label":!0,fill:!0,viewBox:!0,"stroke-width":!0});var d=children$2(n);d.forEach(detach),this.h()},h(){set_svg_attributes(n,l)},m(f,d){insert_hydration(f,n,d),n.innerHTML=e[3],r||(s=listen(n,"click",e[8]),r=!0)},p(f,[d]){d&8&&(n.innerHTML=f[3]),set_svg_attributes(n,l=get_spread_update(o,[{xmlns:"http://www.w3.org/2000/svg"},d&1&&{width:f[0]},d&1&&{height:f[0]},d&16&&i!==(i=f[4].class)&&{class:i},d&32&&f[5],d&2&&{"aria-label":f[1]},{fill:"none"},d&4&&{viewBox:f[2]},{"stroke-width":"2"}]))},i:noop$6,o:noop$6,d(f){f&&detach(n),r=!1,s()}}}function instance$Q(e,n,i){const r=["size","color","variation","ariaLabel"];let s=compute_rest_props(n,r),{size:o="24"}=n,{color:l="currentColor"}=n,{variation:f="outline"}=n,d,p,g=`<path d="M4.5 15.75L12 8.25L19.5 15.75" stroke="${l}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> `,v=`<path fill-rule="evenodd" clip-rule="evenodd" d="M11.4697 7.71967C11.7626 7.42678 12.2374 7.42678 12.5303 7.71967L20.0303 15.2197C20.3232 15.5126 20.3232 15.9874 20.0303 16.2803C19.7374 16.5732 19.2626 16.5732 18.9697 16.2803L12 9.31066L5.03033 16.2803C4.73744 16.5732 4.26256 16.5732 3.96967 16.2803C3.67678 15.9874 3.67678 15.5126 3.96967 15.2197L11.4697 7.71967Z" fill="${l}"/> `,{ariaLabel:S="chevron up"}=n;function T(k){bubble.call(this,e,k)}return e.$$set=k=>{i(4,n=assign(assign({},n),exclude_internal_props(k))),i(5,s=compute_rest_props(n,r)),"size"in k&&i(0,o=k.size),"color"in k&&i(6,l=k.color),"variation"in k&&i(7,f=k.variation),"ariaLabel"in k&&i(1,S=k.ariaLabel)},e.$$.update=()=>{if(e.$$.dirty&128)switch(f){case"outline":i(3,p=g),i(2,d="0 0 24 24");break;case"solid":i(3,p=v),i(2,d="0 0 24 24");break;default:i(3,p=g),i(2,d="0 0 24 24")}},n=exclude_internal_props(n),[o,S,d,p,n,s,l,f,T]}class ChevronUp extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$Q,create_fragment$Q,safe_not_equal,{size:0,color:6,variation:7,ariaLabel:1})}}function create_fragment$P(e){let n,i,r;return{c(){n=svg_element("svg"),i=svg_element("path"),this.h()},l(s){n=claim_svg_element(s,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=children$2(n);i=claim_svg_element(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),children$2(i).forEach(detach),o.forEach(detach),this.h()},h(){attr$6(i,"fill-rule","evenodd"),attr$6(i,"d","M8 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"),attr$6(i,"clip-rule","evenodd"),attr$6(n,"class",r="text-gray-400 bg-gray-100 dark:bg-gray-600 "+(e[0]?"rounded":"rounded-full")),attr$6(n,"fill","currentColor"),attr$6(n,"viewBox","0 0 16 16"),attr$6(n,"xmlns","http://www.w3.org/2000/svg")},m(s,o){insert_hydration(s,n,o),append_hydration(n,i)},p(s,[o]){o&1&&r!==(r="text-gray-400 bg-gray-100 dark:bg-gray-600 "+(s[0]?"rounded":"rounded-full"))&&attr$6(n,"class",r)},i:noop$6,o:noop$6,d(s){s&&detach(n)}}}function instance$P(e,n,i){let{rounded:r=!1}=n;return e.$$set=s=>{"rounded"in s&&i(0,r=s.rounded)},[r]}class Placeholder extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$P,create_fragment$P,safe_not_equal,{rounded:0})}}function create_fragment$O(e){let n,i;const r=e[8].default,s=create_slot(r,e,e[7],null);return{c(){n=element$2("div"),s&&s.c(),this.h()},l(o){n=claim_element(o,"DIV",{class:!0});var l=children$2(n);s&&s.l(l),l.forEach(detach),this.h()},h(){attr$6(n,"class",e[0])},m(o,l){insert_hydration(o,n,l),s&&s.m(n,null),i=!0},p(o,[l]){s&&s.p&&(!i||l&128)&&update_slot_base(s,r,o,o[7],i?get_slot_changes(r,o[7],l,null):get_all_dirty_from_scope(o[7]),null),(!i||l&1)&&attr$6(n,"class",o[0])},i(o){i||(transition_in(s,o),i=!0)},o(o){transition_out(s,o),i=!1},d(o){o&&detach(n),s&&s.d(o)}}}function instance$O(e,n,i){let{$$slots:r={},$$scope:s}=n;const o=compute_slots(r);let{color:l="gray"}=n,{rounded:f=!1}=n,{size:d="md"}=n,{border:p=!1}=n,{placement:g=void 0}=n,{offset:v=!0}=n;const S={gray:"bg-gray-200",dark:"bg-gray-900 dark:bg-gray-700",blue:"bg-blue-600",green:"bg-green-500",red:"bg-red-500",purple:"bg-purple-500",indigo:"bg-indigo-500",yellow:"bg-yellow-300",teal:"bg-teal-500",none:""},T={xs:"w-2 h-2",sm:"w-2.5 h-2.5",md:"w-3 h-3",lg:"w-3.5 h-3.5",xl:"w-6 h-6"},k={"top-left":"top-0 left-0","top-center":"top-0 left-1/2 -translate-x-1/2","top-right":"top-0 right-0","center-left":"top-1/2 -translate-y-1/2 left-0",center:"top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2","center-right":"top-1/2 -translate-y-1/2 right-0","bottom-left":"bottom-0 left-0","bottom-center":"bottom-0 left-1/2 -translate-x-1/2","bottom-right":"bottom-0 right-0"},O={"top-left":"-translate-x-1/3 -translate-y-1/3","top-center":"-translate-y-1/3","top-right":"translate-x-1/3 -translate-y-1/3","center-left":"-translate-x-1/3",center:"","center-right":"translate-x-1/3","bottom-left":"-translate-x-1/3 translate-y-1/3","bottom-center":"translate-y-1/3","bottom-right":"translate-x-1/3 translate-y-1/3"};let R;return e.$$set=P=>{i(13,n=assign(assign({},n),exclude_internal_props(P))),"color"in P&&i(1,l=P.color),"rounded"in P&&i(2,f=P.rounded),"size"in P&&i(3,d=P.size),"border"in P&&i(4,p=P.border),"placement"in P&&i(5,g=P.placement),"offset"in P&&i(6,v=P.offset),"$$scope"in P&&i(7,s=P.$$scope)},e.$$.update=()=>{i(0,R=classNames("flex-shrink-0",f?"rounded":"rounded-full",p&&"border-2 border-white dark:border-gray-800",T[d],S[l],o.default&&"inline-flex items-center justify-center",g&&"absolute "+k[g],g&&v&&O[g],n.class))},n=exclude_internal_props(n),[R,l,f,d,p,g,v,s,r]}class Indicator extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$O,create_fragment$O,safe_not_equal,{color:1,rounded:2,size:3,border:4,placement:5,offset:6})}}function create_else_block_1$2(e){let n,i,r=[{alt:e[4]},{src:i=e[1]},e[7],{class:e[5]}],s={};for(let o=0;o<r.length;o+=1)s=assign(s,r[o]);return{c(){n=element$2("img"),this.h()},l(o){n=claim_element(o,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){set_attributes(n,s)},m(o,l){insert_hydration(o,n,l)},p(o,l){set_attributes(n,s=get_spread_update(r,[l&16&&{alt:o[4]},l&2&&!src_url_equal(n.src,i=o[1])&&{src:i},l&128&&o[7],l&32&&{class:o[5]}]))},i:noop$6,o:noop$6,d(o){o&&detach(n)}}}function create_if_block$c(e){let n=e[2]?"a":"div",i,r,s=(e[2]?"a":"div")&&create_dynamic_element$1(e);return{c(){s&&s.c(),i=empty()},l(o){s&&s.l(o),i=empty()},m(o,l){s&&s.m(o,l),insert_hydration(o,i,l),r=!0},p(o,l){o[2],n?safe_not_equal(n,o[2]?"a":"div")?(s.d(1),s=create_dynamic_element$1(o),s.c(),s.m(i.parentNode,i)):s.p(o,l):(s=create_dynamic_element$1(o),s.c(),s.m(i.parentNode,i)),n=o[2]?"a":"div"},i(o){r||(transition_in(s),r=!0)},o(o){transition_out(s),r=!1},d(o){o&&detach(i),s&&s.d(o)}}}function create_else_block$6(e){let n;const i=e[12].default,r=create_slot(i,e,e[11],null),s=r||fallback_block$2(e);return{c(){s&&s.c()},l(o){s&&s.l(o)},m(o,l){s&&s.m(o,l),n=!0},p(o,l){r?r.p&&(!n||l&2048)&&update_slot_base(r,i,o,o[11],n?get_slot_changes(i,o[11],l,null):get_all_dirty_from_scope(o[11]),null):s&&s.p&&(!n||l&8)&&s.p(o,n?l:-1)},i(o){n||(transition_in(s,o),n=!0)},o(o){transition_out(s,o),n=!1},d(o){s&&s.d(o)}}}function create_if_block_2$3(e){let n,i,r;return{c(){n=element$2("img"),this.h()},l(s){n=claim_element(s,"IMG",{alt:!0,src:!0,class:!0}),this.h()},h(){attr$6(n,"alt",e[4]),src_url_equal(n.src,i=e[1])||attr$6(n,"src",i),attr$6(n,"class",r=e[3]?"rounded":"rounded-full")},m(s,o){insert_hydration(s,n,o)},p(s,o){o&16&&attr$6(n,"alt",s[4]),o&2&&!src_url_equal(n.src,i=s[1])&&attr$6(n,"src",i),o&8&&r!==(r=s[3]?"rounded":"rounded-full")&&attr$6(n,"class",r)},i:noop$6,o:noop$6,d(s){s&&detach(n)}}}function fallback_block$2(e){let n,i;return n=new Placeholder({props:{rounded:e[3]}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s&8&&(o.rounded=r[3]),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_if_block_1$6(e){let n,i;const r=[{border:!0},{offset:e[3]},e[0]];let s={};for(let o=0;o<r.length;o+=1)s=assign(s,r[o]);return n=new Indicator({props:s}),{c(){create_component(n.$$.fragment)},l(o){claim_component(n.$$.fragment,o)},m(o,l){mount_component(n,o,l),i=!0},p(o,l){const f=l&9?get_spread_update(r,[r[0],l&8&&{offset:o[3]},l&1&&get_spread_object(o[0])]):{};n.$set(f)},i(o){i||(transition_in(n.$$.fragment,o),i=!0)},o(o){transition_out(n.$$.fragment,o),i=!1},d(o){destroy_component(n,o)}}}function create_dynamic_element$1(e){let n,i,r,s,o,l;const f=[create_if_block_2$3,create_else_block$6],d=[];function p(T,k){return T[1]?0:1}i=p(e),r=d[i]=f[i](e);let g=e[0]&&create_if_block_1$6(e),v=[{href:e[2]},e[7],{class:o="relative flex justify-center items-center "+e[5]}],S={};for(let T=0;T<v.length;T+=1)S=assign(S,v[T]);return{c(){n=element$2(e[2]?"a":"div"),r.c(),s=space(),g&&g.c(),this.h()},l(T){n=claim_element(T,((e[2]?"a":"div")||"null").toUpperCase(),{href:!0,class:!0});var k=children$2(n);r.l(k),s=claim_space(k),g&&g.l(k),k.forEach(detach),this.h()},h(){/-/.test(e[2]?"a":"div")?set_custom_element_data_map(n,S):set_attributes(n,S)},m(T,k){insert_hydration(T,n,k),d[i].m(n,null),append_hydration(n,s),g&&g.m(n,null),l=!0},p(T,k){let O=i;i=p(T),i===O?d[i].p(T,k):(group_outros(),transition_out(d[O],1,1,()=>{d[O]=null}),check_outros(),r=d[i],r?r.p(T,k):(r=d[i]=f[i](T),r.c()),transition_in(r,1),r.m(n,s)),T[0]?g?(g.p(T,k),k&1&&transition_in(g,1)):(g=create_if_block_1$6(T),g.c(),transition_in(g,1),g.m(n,null)):g&&(group_outros(),transition_out(g,1,1,()=>{g=null}),check_outros()),S=get_spread_update(v,[(!l||k&4)&&{href:T[2]},k&128&&T[7],(!l||k&32&&o!==(o="relative flex justify-center items-center "+T[5]))&&{class:o}]),/-/.test(T[2]?"a":"div")?set_custom_element_data_map(n,S):set_attributes(n,S)},i(T){l||(transition_in(r),transition_in(g),l=!0)},o(T){transition_out(r),transition_out(g),l=!1},d(T){T&&detach(n),d[i].d(),g&&g.d()}}}function create_fragment$N(e){let n,i,r,s;const o=[create_if_block$c,create_else_block_1$2],l=[];function f(d,p){return!d[1]||d[2]||d[6].default||d[0]?0:1}return n=f(e),i=l[n]=o[n](e),{c(){i.c(),r=empty()},l(d){i.l(d),r=empty()},m(d,p){l[n].m(d,p),insert_hydration(d,r,p),s=!0},p(d,[p]){let g=n;n=f(d),n===g?l[n].p(d,p):(group_outros(),transition_out(l[g],1,1,()=>{l[g]=null}),check_outros(),i=l[n],i?i.p(d,p):(i=l[n]=o[n](d),i.c()),transition_in(i,1),i.m(r.parentNode,r))},i(d){s||(transition_in(i),s=!0)},o(d){transition_out(i),s=!1},d(d){l[n].d(d),d&&detach(r)}}}function instance$N(e,n,i){const r=["src","href","rounded","border","stacked","dot","alt","size"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;const f=compute_slots(o);let{src:d=""}=n,{href:p=void 0}=n,{rounded:g=!1}=n,{border:v=!1}=n,{stacked:S=!1}=n,{dot:T=void 0}=n,{alt:k=""}=n,{size:O="md"}=n;const R={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-10 h-10",lg:"w-20 h-20",xl:"w-36 h-36"};let P;return e.$$set=F=>{i(14,n=assign(assign({},n),exclude_internal_props(F))),i(7,s=compute_rest_props(n,r)),"src"in F&&i(1,d=F.src),"href"in F&&i(2,p=F.href),"rounded"in F&&i(3,g=F.rounded),"border"in F&&i(8,v=F.border),"stacked"in F&&i(9,S=F.stacked),"dot"in F&&i(0,T=F.dot),"alt"in F&&i(4,k=F.alt),"size"in F&&i(10,O=F.size),"$$scope"in F&&i(11,l=F.$$scope)},e.$$.update=()=>{e.$$.dirty&1&&i(0,T=T&&{placement:"top-right",color:"gray",size:"lg",...T}),e.$$.dirty&1&&T&&console.log(T),i(5,P=classNames(g?"rounded":"rounded-full",v&&"p-1 ring-2 ring-gray-300 dark:ring-gray-500",R[O],S&&"border-2 -ml-4 border-white dark:border-gray-800","bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300",n.class))},n=exclude_internal_props(n),[T,d,p,g,k,P,f,s,v,S,O,l,o]}class Avatar extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$N,create_fragment$N,safe_not_equal,{src:1,href:2,rounded:3,border:8,stacked:9,dot:0,alt:4,size:10})}}function create_else_block$5(e){let n;const i=e[5].default,r=create_slot(i,e,e[4],null);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&16)&&update_slot_base(r,i,s,s[4],n?get_slot_changes(i,s[4],o,null):get_all_dirty_from_scope(s[4]),null)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_if_block$b(e){let n=e[0],i,r,s=e[0]&&create_dynamic_element(e);return{c(){s&&s.c(),i=empty()},l(o){s&&s.l(o),i=empty()},m(o,l){s&&s.m(o,l),insert_hydration(o,i,l),r=!0},p(o,l){o[0]?n?safe_not_equal(n,o[0])?(s.d(1),s=create_dynamic_element(o),s.c(),s.m(i.parentNode,i)):s.p(o,l):(s=create_dynamic_element(o),s.c(),s.m(i.parentNode,i)):n&&(s.d(1),s=null),n=o[0]},i(o){r||(transition_in(s),r=!0)},o(o){transition_out(s),r=!1},d(o){o&&detach(i),s&&s.d(o)}}}function create_dynamic_element(e){let n,i,r,s;const o=e[5].default,l=create_slot(o,e,e[4],null);let f=[e[3]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=element$2(e[0]),l&&l.c(),this.h()},l(p){n=claim_element(p,(e[0]||"null").toUpperCase(),{});var g=children$2(n);l&&l.l(g),g.forEach(detach),this.h()},h(){/-/.test(e[0])?set_custom_element_data_map(n,d):set_attributes(n,d)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),i=!0,r||(s=action_destroyer(e[2].call(null,n)),r=!0)},p(p,g){l&&l.p&&(!i||g&16)&&update_slot_base(l,o,p,p[4],i?get_slot_changes(o,p[4],g,null):get_all_dirty_from_scope(p[4]),null),d=get_spread_update(f,[g&8&&p[3]]),/-/.test(p[0])?set_custom_element_data_map(n,d):set_attributes(n,d)},i(p){i||(transition_in(l,p),i=!0)},o(p){transition_out(l,p),i=!1},d(p){p&&detach(n),l&&l.d(p),r=!1,s()}}}function create_fragment$M(e){let n,i,r,s;const o=[create_if_block$b,create_else_block$5],l=[];function f(d,p){return d[1]?0:1}return n=f(e),i=l[n]=o[n](e),{c(){i.c(),r=empty()},l(d){i.l(d),r=empty()},m(d,p){l[n].m(d,p),insert_hydration(d,r,p),s=!0},p(d,[p]){let g=n;n=f(d),n===g?l[n].p(d,p):(group_outros(),transition_out(l[g],1,1,()=>{l[g]=null}),check_outros(),i=l[n],i?i.p(d,p):(i=l[n]=o[n](d),i.c()),transition_in(i,1),i.m(r.parentNode,r))},i(d){s||(transition_in(i),s=!0)},o(d){transition_out(i),s=!1},d(d){l[n].d(d),d&&detach(r)}}}function instance$M(e,n,i){const r=["tag","show","use"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n,{tag:f="div"}=n,{show:d}=n,{use:p=()=>{}}=n;return e.$$set=g=>{n=assign(assign({},n),exclude_internal_props(g)),i(3,s=compute_rest_props(n,r)),"tag"in g&&i(0,f=g.tag),"show"in g&&i(1,d=g.show),"use"in g&&i(2,p=g.use),"$$scope"in g&&i(4,l=g.$$scope)},[f,d,p,s,l,o]}class Wrapper extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$M,create_fragment$M,safe_not_equal,{tag:0,show:1,use:2})}}function create_else_block$4(e){let n;const i=e[7].default,r=create_slot(i,e,e[6],null);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&64)&&update_slot_base(r,i,s,s[6],n?get_slot_changes(i,s[6],o,null):get_all_dirty_from_scope(s[6]),null)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_if_block$a(e){let n,i;const r=e[7].default,s=create_slot(r,e,e[6],null);let o=[e[3],{class:e[2]}],l={};for(let f=0;f<o.length;f+=1)l=assign(l,o[f]);return{c(){n=element$2("label"),s&&s.c(),this.h()},l(f){n=claim_element(f,"LABEL",{class:!0});var d=children$2(n);s&&s.l(d),d.forEach(detach),this.h()},h(){set_attributes(n,l)},m(f,d){insert_hydration(f,n,d),s&&s.m(n,null),e[8](n),i=!0},p(f,d){s&&s.p&&(!i||d&64)&&update_slot_base(s,r,f,f[6],i?get_slot_changes(r,f[6],d,null):get_all_dirty_from_scope(f[6]),null),set_attributes(n,l=get_spread_update(o,[d&8&&f[3],(!i||d&4)&&{class:f[2]}]))},i(f){i||(transition_in(s,f),i=!0)},o(f){transition_out(s,f),i=!1},d(f){f&&detach(n),s&&s.d(f),e[8](null)}}}function create_fragment$L(e){let n,i,r,s;const o=[create_if_block$a,create_else_block$4],l=[];function f(d,p){return d[0]?0:1}return n=f(e),i=l[n]=o[n](e),{c(){i.c(),r=empty()},l(d){i.l(d),r=empty()},m(d,p){l[n].m(d,p),insert_hydration(d,r,p),s=!0},p(d,[p]){let g=n;n=f(d),n===g?l[n].p(d,p):(group_outros(),transition_out(l[g],1,1,()=>{l[g]=null}),check_outros(),i=l[n],i?i.p(d,p):(i=l[n]=o[n](d),i.c()),transition_in(i,1),i.m(r.parentNode,r))},i(d){s||(transition_in(i),s=!0)},o(d){transition_out(i),s=!1},d(d){l[n].d(d),d&&detach(r)}}}function instance$L(e,n,i){let r;const s=["color","defaultClass","show"];let o=compute_rest_props(n,s),{$$slots:l={},$$scope:f}=n,{color:d="gray"}=n,{defaultClass:p="text-sm font-medium block"}=n,{show:g=!0}=n,v;const S={gray:"text-gray-900 dark:text-gray-300",green:"text-green-700 dark:text-green-500",red:"text-red-700 dark:text-red-500",disabled:"text-gray-400 dark:text-gray-500"};function T(k){binding_callbacks[k?"unshift":"push"](()=>{v=k,i(1,v)})}return e.$$set=k=>{i(10,n=assign(assign({},n),exclude_internal_props(k))),i(3,o=compute_rest_props(n,s)),"color"in k&&i(4,d=k.color),"defaultClass"in k&&i(5,p=k.defaultClass),"show"in k&&i(0,g=k.show),"$$scope"in k&&i(6,f=k.$$scope)},e.$$.update=()=>{if(e.$$.dirty&18){const k=v==null?void 0:v.control;i(4,d=k!=null&&k.disabled?"disabled":d)}i(2,r=classNames(p,S[d],n.class))},n=exclude_internal_props(n),[g,v,r,o,d,p,f,l,T]}let Label$2=class extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$L,create_fragment$L,safe_not_equal,{color:4,defaultClass:5,show:0})}};function create_default_slot$a(e){let n,i,r,s,o,l=[{type:"radio"},{__value:e[4]},e[8],{class:i=inputClass(e[2],e[1],!1,e[5],e[7].default||e[6].class)}],f={};for(let g=0;g<l.length;g+=1)f=assign(f,l[g]);const d=e[9].default,p=create_slot(d,e,e[23],null);return{c(){n=element$2("input"),p&&p.c(),this.h()},l(g){n=claim_element(g,"INPUT",{type:!0,class:!0}),p&&p.l(g),this.h()},h(){set_attributes(n,f),e[22][0].push(n)},m(g,v){insert_hydration(g,n,v),n.autofocus&&n.focus(),n.checked=n.__value===e[0],p&&p.m(g,v),r=!0,s||(o=[listen(n,"change",e[21]),listen(n,"blur",e[10]),listen(n,"change",e[11]),listen(n,"click",e[12]),listen(n,"focus",e[13]),listen(n,"keydown",e[14]),listen(n,"keypress",e[15]),listen(n,"keyup",e[16]),listen(n,"mouseenter",e[17]),listen(n,"mouseleave",e[18]),listen(n,"mouseover",e[19]),listen(n,"paste",e[20])],s=!0)},p(g,v){set_attributes(n,f=get_spread_update(l,[{type:"radio"},(!r||v&16)&&{__value:g[4]},v&256&&g[8],(!r||v&198&&i!==(i=inputClass(g[2],g[1],!1,g[5],g[7].default||g[6].class)))&&{class:i}])),v&1&&(n.checked=n.__value===g[0]),p&&p.p&&(!r||v&8388608)&&update_slot_base(p,d,g,g[23],r?get_slot_changes(d,g[23],v,null):get_all_dirty_from_scope(g[23]),null)},i(g){r||(transition_in(p,g),r=!0)},o(g){transition_out(p,g),r=!1},d(g){g&&detach(n),e[22][0].splice(e[22][0].indexOf(n),1),p&&p.d(g),s=!1,run_all(o)}}}function create_fragment$K(e){let n,i;return n=new Label$2({props:{class:labelClass(e[3],e[6].class),show:e[7].default,$$slots:{default:[create_default_slot$a]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,[s]){const o={};s&72&&(o.class=labelClass(r[3],r[6].class)),s&128&&(o.show=r[7].default),s&8389079&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}const colorClasses={red:"text-red-600 focus:ring-red-500 dark:focus:ring-red-600",green:"text-green-600 focus:ring-green-500 dark:focus:ring-green-600",purple:"text-purple-600 focus:ring-purple-500 dark:focus:ring-purple-600",teal:"text-teal-600 focus:ring-teal-500 dark:focus:ring-teal-600",yellow:"text-yellow-400 focus:ring-yellow-500 dark:focus:ring-yellow-600",orange:"text-orange-500 focus:ring-orange-500 dark:focus:ring-orange-600",blue:"text-blue-600 focus:ring-blue-500 dark:focus:ring-blue-600"},labelClass=(e,n)=>classNames(e?"inline-flex":"flex","items-center",n),inputClass=(e,n,i,r,s)=>classNames("w-4 h-4 bg-gray-100 border-gray-300 dark:ring-offset-gray-800 focus:ring-2",s===!0&&"mr-2",r?"dark:bg-gray-600 dark:border-gray-500":"dark:bg-gray-700 dark:border-gray-600",e&&"sr-only peer",i&&"rounded",colorClasses[n],s);function instance$K(e,n,i){const r=["color","custom","inline","group","value"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;const f=compute_slots(o);let{color:d="blue"}=n,{custom:p=!1}=n,{inline:g=!1}=n,{group:v=""}=n,{value:S=""}=n,T=getContext$1("background");const k=[[]];function O(U){bubble.call(this,e,U)}function R(U){bubble.call(this,e,U)}function P(U){bubble.call(this,e,U)}function F(U){bubble.call(this,e,U)}function I(U){bubble.call(this,e,U)}function L(U){bubble.call(this,e,U)}function N(U){bubble.call(this,e,U)}function j(U){bubble.call(this,e,U)}function z(U){bubble.call(this,e,U)}function q(U){bubble.call(this,e,U)}function H(U){bubble.call(this,e,U)}function W(){v=this.__value,i(0,v)}return e.$$set=U=>{i(6,n=assign(assign({},n),exclude_internal_props(U))),i(8,s=compute_rest_props(n,r)),"color"in U&&i(1,d=U.color),"custom"in U&&i(2,p=U.custom),"inline"in U&&i(3,g=U.inline),"group"in U&&i(0,v=U.group),"value"in U&&i(4,S=U.value),"$$scope"in U&&i(23,l=U.$$scope)},n=exclude_internal_props(n),[v,d,p,g,S,T,n,f,s,o,O,R,P,F,I,L,N,j,z,q,H,W,k,l]}class Radio extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$K,create_fragment$K,safe_not_equal,{color:1,custom:2,inline:3,group:0,value:4})}}function create_default_slot$9(e){let n,i,r,s,o,l,f=[{type:"checkbox"},{__value:e[5]},e[11],{class:i=inputClass(e[3],e[2],!0,e[6],e[10].default||e[9].class)}],d={};for(let v=0;v<f.length;v+=1)d=assign(d,f[v]);const p=e[12].default,g=create_slot(p,e,e[25],null);return{c(){n=element$2("input"),g&&g.c(),this.h()},l(v){n=claim_element(v,"INPUT",{type:!0,class:!0}),g&&g.l(v),this.h()},h(){set_attributes(n,d)},m(v,S){insert_hydration(v,n,S),n.autofocus&&n.focus(),n.checked=e[1],g&&g.m(v,S),s=!0,o||(l=[action_destroyer(r=e[7].call(null,n,e[0])),listen(n,"change",e[24]),listen(n,"keyup",e[13]),listen(n,"keydown",e[14]),listen(n,"keypress",e[15]),listen(n,"focus",e[16]),listen(n,"blur",e[17]),listen(n,"click",e[18]),listen(n,"mouseover",e[19]),listen(n,"mouseenter",e[20]),listen(n,"mouseleave",e[21]),listen(n,"paste",e[22]),listen(n,"change",e[8]),listen(n,"change",e[23])],o=!0)},p(v,S){set_attributes(n,d=get_spread_update(f,[{type:"checkbox"},(!s||S&32)&&{__value:v[5]},S&2048&&v[11],(!s||S&1548&&i!==(i=inputClass(v[3],v[2],!0,v[6],v[10].default||v[9].class)))&&{class:i}])),r&&is_function(r.update)&&S&1&&r.update.call(null,v[0]),S&2&&(n.checked=v[1]),g&&g.p&&(!s||S&33554432)&&update_slot_base(g,p,v,v[25],s?get_slot_changes(p,v[25],S,null):get_all_dirty_from_scope(v[25]),null)},i(v){s||(transition_in(g,v),s=!0)},o(v){transition_out(g,v),s=!1},d(v){v&&detach(n),g&&g.d(v),o=!1,run_all(l)}}}function create_fragment$J(e){let n,i;return n=new Label$2({props:{class:labelClass(e[4],e[9].class),show:!!e[10].default,$$slots:{default:[create_default_slot$9]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,[s]){const o={};s&528&&(o.class=labelClass(r[4],r[9].class)),s&1024&&(o.show=!!r[10].default),s&33558063&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function instance$J(e,n,i){const r=["color","custom","inline","group","value","checked"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;const f=compute_slots(o);let{color:d="blue"}=n,{custom:p=!1}=n,{inline:g=!1}=n,{group:v=[]}=n,{value:S=""}=n,{checked:T=void 0}=n,k=getContext$1("background");function O(J,ne){return T===void 0&&i(1,T=ne.includes(S)),R(),{update(G){i(1,T=G.includes(S))}}}function R(){const J=v.indexOf(S);T===void 0&&i(1,T=J>=0),T?J<0&&(v.push(S),i(0,v)):J>=0&&(v.splice(J,1),i(0,v))}function P(J){bubble.call(this,e,J)}function F(J){bubble.call(this,e,J)}function I(J){bubble.call(this,e,J)}function L(J){bubble.call(this,e,J)}function N(J){bubble.call(this,e,J)}function j(J){bubble.call(this,e,J)}function z(J){bubble.call(this,e,J)}function q(J){bubble.call(this,e,J)}function H(J){bubble.call(this,e,J)}function W(J){bubble.call(this,e,J)}function U(J){bubble.call(this,e,J)}function Q(){T=this.checked,i(1,T)}return e.$$set=J=>{i(9,n=assign(assign({},n),exclude_internal_props(J))),i(11,s=compute_rest_props(n,r)),"color"in J&&i(2,d=J.color),"custom"in J&&i(3,p=J.custom),"inline"in J&&i(4,g=J.inline),"group"in J&&i(0,v=J.group),"value"in J&&i(5,S=J.value),"checked"in J&&i(1,T=J.checked),"$$scope"in J&&i(25,l=J.$$scope)},n=exclude_internal_props(n),[v,T,d,p,g,S,k,O,R,n,f,s,o,P,F,I,L,N,j,z,q,H,W,U,Q,l]}class Checkbox extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$J,create_fragment$J,safe_not_equal,{color:2,custom:3,inline:4,group:0,value:5,checked:1})}}const get_right_slot_changes=e=>({props:e[0]&36}),get_right_slot_context=e=>({props:{...e[5],class:e[2]}}),get_default_slot_changes=e=>({props:e[0]&36}),get_default_slot_context=e=>({props:{...e[5],class:e[2]}}),get_left_slot_changes=e=>({props:e[0]&36}),get_left_slot_context=e=>({props:{...e[5],class:e[2]}});function create_if_block_1$5(e){let n,i;const r=e[10].left,s=create_slot(r,e,e[25],get_left_slot_context);return{c(){n=element$2("div"),s&&s.c(),this.h()},l(o){n=claim_element(o,"DIV",{class:!0});var l=children$2(n);s&&s.l(l),l.forEach(detach),this.h()},h(){attr$6(n,"class",floatClass+" left-0 pl-2.5 pointer-events-none")},m(o,l){insert_hydration(o,n,l),s&&s.m(n,null),i=!0},p(o,l){s&&s.p&&(!i||l[0]&33554468)&&update_slot_base(s,r,o,o[25],i?get_slot_changes(r,o[25],l,get_left_slot_changes):get_all_dirty_from_scope(o[25]),get_left_slot_context)},i(o){i||(transition_in(s,o),i=!0)},o(o){transition_out(s,o),i=!1},d(o){o&&detach(n),s&&s.d(o)}}}function fallback_block$1(e){let n,i,r,s,o=[e[5],{class:e[2]}],l={};for(let f=0;f<o.length;f+=1)l=assign(l,o[f]);return{c(){n=element$2("input"),this.h()},l(f){n=claim_element(f,"INPUT",{class:!0}),this.h()},h(){set_attributes(n,l)},m(f,d){insert_hydration(f,n,d),n.autofocus&&n.focus(),set_input_value(n,e[0]),r||(s=[listen(n,"input",e[24]),listen(n,"blur",e[11]),listen(n,"change",e[12]),listen(n,"click",e[13]),listen(n,"contextmenu",e[14]),listen(n,"focus",e[15]),listen(n,"keydown",e[16]),listen(n,"keypress",e[17]),listen(n,"keyup",e[18]),listen(n,"mouseover",e[19]),listen(n,"mouseenter",e[20]),listen(n,"mouseleave",e[21]),listen(n,"paste",e[22]),listen(n,"input",e[23]),action_destroyer(i=e[3].call(null,n,e[1]))],r=!0)},p(f,d){set_attributes(n,l=get_spread_update(o,[d[0]&32&&f[5],d[0]&4&&{class:f[2]}])),d[0]&1&&n.value!==f[0]&&set_input_value(n,f[0]),i&&is_function(i.update)&&d[0]&2&&i.update.call(null,f[1])},d(f){f&&detach(n),r=!1,run_all(s)}}}function create_if_block$9(e){let n,i;const r=e[10].right,s=create_slot(r,e,e[25],get_right_slot_context);return{c(){n=element$2("div"),s&&s.c(),this.h()},l(o){n=claim_element(o,"DIV",{class:!0});var l=children$2(n);s&&s.l(l),l.forEach(detach),this.h()},h(){attr$6(n,"class",floatClass+" right-0 pr-2.5")},m(o,l){insert_hydration(o,n,l),s&&s.m(n,null),i=!0},p(o,l){s&&s.p&&(!i||l[0]&33554468)&&update_slot_base(s,r,o,o[25],i?get_slot_changes(r,o[25],l,get_right_slot_changes):get_all_dirty_from_scope(o[25]),get_right_slot_context)},i(o){i||(transition_in(s,o),i=!0)},o(o){transition_out(s,o),i=!1},d(o){o&&detach(n),s&&s.d(o)}}}function create_default_slot$8(e){let n,i,r,s,o=e[4].left&&create_if_block_1$5(e);const l=e[10].default,f=create_slot(l,e,e[25],get_default_slot_context),d=f||fallback_block$1(e);let p=e[4].right&&create_if_block$9(e);return{c(){o&&o.c(),n=space(),d&&d.c(),i=space(),p&&p.c(),r=empty()},l(g){o&&o.l(g),n=claim_space(g),d&&d.l(g),i=claim_space(g),p&&p.l(g),r=empty()},m(g,v){o&&o.m(g,v),insert_hydration(g,n,v),d&&d.m(g,v),insert_hydration(g,i,v),p&&p.m(g,v),insert_hydration(g,r,v),s=!0},p(g,v){g[4].left?o?(o.p(g,v),v[0]&16&&transition_in(o,1)):(o=create_if_block_1$5(g),o.c(),transition_in(o,1),o.m(n.parentNode,n)):o&&(group_outros(),transition_out(o,1,1,()=>{o=null}),check_outros()),f?f.p&&(!s||v[0]&33554468)&&update_slot_base(f,l,g,g[25],s?get_slot_changes(l,g[25],v,get_default_slot_changes):get_all_dirty_from_scope(g[25]),get_default_slot_context):d&&d.p&&(!s||v[0]&39)&&d.p(g,s?v:[-1,-1]),g[4].right?p?(p.p(g,v),v[0]&16&&transition_in(p,1)):(p=create_if_block$9(g),p.c(),transition_in(p,1),p.m(r.parentNode,r)):p&&(group_outros(),transition_out(p,1,1,()=>{p=null}),check_outros())},i(g){s||(transition_in(o),transition_in(d,g),transition_in(p),s=!0)},o(g){transition_out(o),transition_out(d,g),transition_out(p),s=!1},d(g){o&&o.d(g),g&&detach(n),d&&d.d(g),g&&detach(i),p&&p.d(g),g&&detach(r)}}}function create_fragment$I(e){let n,i;return n=new Wrapper({props:{class:"relative w-full",show:e[4].left||e[4].right,$$slots:{default:[create_default_slot$8]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s[0]&16&&(o.show=r[4].left||r[4].right),s[0]&33554487&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function clampSize(e){return e&&e==="xs"?"sm":e==="xl"?"lg":e}let floatClass="flex absolute inset-y-0 items-center text-gray-500 dark:text-gray-400";function instance$I(e,n,i){let r;const s=["type","value","size","defaultClass","color"];let o=compute_rest_props(n,s),{$$slots:l={},$$scope:f}=n;const d=compute_slots(l);let{type:p="text"}=n,{value:g=""}=n,{size:v=void 0}=n,{defaultClass:S="block w-full disabled:cursor-not-allowed disabled:opacity-50"}=n,{color:T="base"}=n;const k={base:"border-gray-300 dark:border-gray-600",tinted:"border-gray-300 dark:border-gray-500",green:"border-green-500 dark:border-green-400",red:"border-red-500 dark:border-red-400"},O={base:"focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-500 dark:focus:ring-blue-500",green:"focus:ring-green-500 focus:border-green-500 dark:focus:border-green-500 dark:focus:ring-green-500",red:"focus:ring-red-500 focus:border-red-500 dark:focus:ring-red-500 dark:focus:border-red-500"},R={base:"bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400",tinted:"bg-gray-50 text-gray-900 dark:bg-gray-600 dark:text-white dark:placeholder-gray-400",green:"bg-green-50 text-green-900 placeholder-green-700 dark:text-green-400 dark:placeholder-green-500 dark:bg-gray-700",red:"bg-red-50 text-red-900 placeholder-red-700 dark:text-red-500 dark:placeholder-red-500 dark:bg-gray-700"};let P=getContext$1("background"),F=getContext$1("group");const I=(V,se)=>(V.type=se,{update(fe){V.type=fe}}),L={sm:"sm:text-xs",md:"text-sm",lg:"sm:text-base"},N={sm:"pl-9",md:"pl-10",lg:"pl-11"},j={sm:"pr-9",md:"pr-10",lg:"pr-11"},z={sm:"p-2",md:"p-2.5",lg:"p-4"};let q;function H(V){bubble.call(this,e,V)}function W(V){bubble.call(this,e,V)}function U(V){bubble.call(this,e,V)}function Q(V){bubble.call(this,e,V)}function J(V){bubble.call(this,e,V)}function ne(V){bubble.call(this,e,V)}function G(V){bubble.call(this,e,V)}function Z(V){bubble.call(this,e,V)}function ae(V){bubble.call(this,e,V)}function oe(V){bubble.call(this,e,V)}function pe(V){bubble.call(this,e,V)}function Se(V){bubble.call(this,e,V)}function ue(V){bubble.call(this,e,V)}function ee(){g=this.value,i(0,g)}return e.$$set=V=>{i(35,n=assign(assign({},n),exclude_internal_props(V))),i(5,o=compute_rest_props(n,s)),"type"in V&&i(1,p=V.type),"value"in V&&i(0,g=V.value),"size"in V&&i(6,v=V.size),"defaultClass"in V&&i(7,S=V.defaultClass),"color"in V&&i(8,T=V.color),"$$scope"in V&&i(25,f=V.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&64&&i(9,r=v||clampSize(F==null?void 0:F.size)||"md");{const V=T==="base"&&P?"tinted":T;i(2,q=classNames(S,d.left&&N[r],d.right&&j[r],O[T],R[V],k[V],z[r],L[r],F||"rounded-lg",F&&"first:rounded-l-lg last:rounded-r-lg",F&&"border-l-0 first:border-l last:border-r",n.class))}},n=exclude_internal_props(n),[g,p,q,I,d,o,v,S,T,r,l,H,W,U,Q,J,ne,G,Z,ae,oe,pe,Se,ue,ee,f]}let Input$5=class extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$I,create_fragment$I,safe_not_equal,{type:1,value:0,size:6,defaultClass:7,color:8},null,[-1,-1])}};function create_default_slot$7(e){let n,i,r,s=[{type:"file"},e[17]],o={};for(let l=0;l<s.length;l+=1)o=assign(o,s[l]);return{c(){n=element$2("input"),this.h()},l(l){n=claim_element(l,"INPUT",{type:!0}),this.h()},h(){set_attributes(n,o)},m(l,f){insert_hydration(l,n,f),n.autofocus&&n.focus(),i||(r=[listen(n,"change",e[5]),listen(n,"keyup",e[6]),listen(n,"keydown",e[7]),listen(n,"keypress",e[8]),listen(n,"focus",e[9]),listen(n,"blur",e[10]),listen(n,"click",e[11]),listen(n,"mouseover",e[12]),listen(n,"mouseenter",e[13]),listen(n,"mouseleave",e[14]),listen(n,"paste",e[15]),listen(n,"change",e[16])],i=!0)},p(l,f){set_attributes(n,o=get_spread_update(s,[{type:"file"},f&131072&&l[17]]))},d(l){l&&detach(n),i=!1,run_all(r)}}}function create_fragment$H(e){let n,i;const r=[e[3],{class:classNames(e[2],e[4].class)}];let s={$$slots:{default:[create_default_slot$7,({props:o})=>({17:o}),({props:o})=>o?131072:0]},$$scope:{ctx:e}};for(let o=0;o<r.length;o+=1)s=assign(s,r[o]);return n=new Input$5({props:s}),{c(){create_component(n.$$.fragment)},l(o){claim_component(n.$$.fragment,o)},m(o,l){mount_component(n,o,l),i=!0},p(o,[l]){const f=l&28?get_spread_update(r,[l&8&&get_spread_object(o[3]),l&20&&{class:classNames(o[2],o[4].class)}]):{};l&393219&&(f.$$scope={dirty:l,ctx:o}),n.$set(f)},i(o){i||(transition_in(n.$$.fragment,o),i=!0)},o(o){transition_out(n.$$.fragment,o),i=!1},d(o){destroy_component(n,o)}}}function instance$H(e,n,i){const r=["value","files","inputClass"];let s=compute_rest_props(n,r),{value:o=""}=n,{files:l=void 0}=n,{inputClass:f="border !p-0 dark:text-gray-400"}=n;function d(L){bubble.call(this,e,L)}function p(L){bubble.call(this,e,L)}function g(L){bubble.call(this,e,L)}function v(L){bubble.call(this,e,L)}function S(L){bubble.call(this,e,L)}function T(L){bubble.call(this,e,L)}function k(L){bubble.call(this,e,L)}function O(L){bubble.call(this,e,L)}function R(L){bubble.call(this,e,L)}function P(L){bubble.call(this,e,L)}function F(L){bubble.call(this,e,L)}function I(){o=this.value,l=this.files,i(0,o),i(1,l)}return e.$$set=L=>{i(4,n=assign(assign({},n),exclude_internal_props(L))),i(3,s=compute_rest_props(n,r)),"value"in L&&i(0,o=L.value),"files"in L&&i(1,l=L.files),"inputClass"in L&&i(2,f=L.inputClass)},n=exclude_internal_props(n),[o,l,f,s,n,d,p,g,v,S,T,k,O,R,P,F,I]}class Fileupload extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$H,create_fragment$H,safe_not_equal,{value:0,files:1,inputClass:2})}}const get_footer_slot_changes=e=>({}),get_footer_slot_context=e=>({}),get_header_slot_changes=e=>({}),get_header_slot_context=e=>({});function create_if_block_1$4(e){let n,i;const r=e[8].header,s=create_slot(r,e,e[23],get_header_slot_context);return{c(){n=element$2("div"),s&&s.c(),this.h()},l(o){n=claim_element(o,"DIV",{class:!0});var l=children$2(n);s&&s.l(l),l.forEach(detach),this.h()},h(){attr$6(n,"class",e[5](!0))},m(o,l){insert_hydration(o,n,l),s&&s.m(n,null),i=!0},p(o,l){s&&s.p&&(!i||l&8388608)&&update_slot_base(s,r,o,o[23],i?get_slot_changes(r,o[23],l,get_header_slot_changes):get_all_dirty_from_scope(o[23]),get_header_slot_context)},i(o){i||(transition_in(s,o),i=!0)},o(o){transition_out(s,o),i=!1},d(o){o&&detach(n),s&&s.d(o)}}}function create_default_slot_1$1(e){let n,i,r,s=[e[7],{class:e[3]}],o={};for(let l=0;l<s.length;l+=1)o=assign(o,s[l]);return{c(){n=element$2("textarea"),this.h()},l(l){n=claim_element(l,"TEXTAREA",{class:!0}),children$2(n).forEach(detach),this.h()},h(){set_attributes(n,o)},m(l,f){insert_hydration(l,n,f),n.autofocus&&n.focus(),set_input_value(n,e[0]),i||(r=[listen(n,"input",e[22]),listen(n,"blur",e[9]),listen(n,"change",e[10]),listen(n,"click",e[11]),listen(n,"contextmenu",e[12]),listen(n,"focus",e[13]),listen(n,"input",e[14]),listen(n,"keydown",e[15]),listen(n,"keypress",e[16]),listen(n,"keyup",e[17]),listen(n,"mouseenter",e[18]),listen(n,"mouseleave",e[19]),listen(n,"mouseover",e[20]),listen(n,"paste",e[21])],i=!0)},p(l,f){set_attributes(n,o=get_spread_update(s,[f&128&&l[7],f&8&&{class:l[3]}])),f&1&&set_input_value(n,l[0])},d(l){l&&detach(n),i=!1,run_all(r)}}}function create_if_block$8(e){let n,i;const r=e[8].footer,s=create_slot(r,e,e[23],get_footer_slot_context);return{c(){n=element$2("div"),s&&s.c(),this.h()},l(o){n=claim_element(o,"DIV",{class:!0});var l=children$2(n);s&&s.l(l),l.forEach(detach),this.h()},h(){attr$6(n,"class",e[5](!1))},m(o,l){insert_hydration(o,n,l),s&&s.m(n,null),i=!0},p(o,l){s&&s.p&&(!i||l&8388608)&&update_slot_base(s,r,o,o[23],i?get_slot_changes(r,o[23],l,get_footer_slot_changes):get_all_dirty_from_scope(o[23]),get_footer_slot_context)},i(o){i||(transition_in(s,o),i=!0)},o(o){transition_out(s,o),i=!1},d(o){o&&detach(n),s&&s.d(o)}}}function create_default_slot$6(e){let n,i,r,s,o,l=e[6].header&&create_if_block_1$4(e);i=new Wrapper({props:{show:e[1],class:e[4],$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx:e}}});let f=e[6].footer&&create_if_block$8(e);return{c(){l&&l.c(),n=space(),create_component(i.$$.fragment),r=space(),f&&f.c(),s=empty()},l(d){l&&l.l(d),n=claim_space(d),claim_component(i.$$.fragment,d),r=claim_space(d),f&&f.l(d),s=empty()},m(d,p){l&&l.m(d,p),insert_hydration(d,n,p),mount_component(i,d,p),insert_hydration(d,r,p),f&&f.m(d,p),insert_hydration(d,s,p),o=!0},p(d,p){d[6].header?l?(l.p(d,p),p&64&&transition_in(l,1)):(l=create_if_block_1$4(d),l.c(),transition_in(l,1),l.m(n.parentNode,n)):l&&(group_outros(),transition_out(l,1,1,()=>{l=null}),check_outros());const g={};p&2&&(g.show=d[1]),p&16&&(g.class=d[4]),p&8388745&&(g.$$scope={dirty:p,ctx:d}),i.$set(g),d[6].footer?f?(f.p(d,p),p&64&&transition_in(f,1)):(f=create_if_block$8(d),f.c(),transition_in(f,1),f.m(s.parentNode,s)):f&&(group_outros(),transition_out(f,1,1,()=>{f=null}),check_outros())},i(d){o||(transition_in(l),transition_in(i.$$.fragment,d),transition_in(f),o=!0)},o(d){transition_out(l),transition_out(i.$$.fragment,d),transition_out(f),o=!1},d(d){l&&l.d(d),d&&detach(n),destroy_component(i,d),d&&detach(r),f&&f.d(d),d&&detach(s)}}}function create_fragment$G(e){let n,i;return n=new Wrapper({props:{show:e[1],class:e[2],$$slots:{default:[create_default_slot$6]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,[s]){const o={};s&2&&(o.show=r[1]),s&4&&(o.class=r[2]),s&8388827&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function instance$G(e,n,i){const r=["value"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;const f=compute_slots(o),d=getContext$1("background");let{value:p=""}=n,g,v,S;const T=J=>classNames(J?"border-b":"border-t","py-2 px-3 border-gray-200 dark:border-gray-600");let k;function O(J){bubble.call(this,e,J)}function R(J){bubble.call(this,e,J)}function P(J){bubble.call(this,e,J)}function F(J){bubble.call(this,e,J)}function I(J){bubble.call(this,e,J)}function L(J){bubble.call(this,e,J)}function N(J){bubble.call(this,e,J)}function j(J){bubble.call(this,e,J)}function z(J){bubble.call(this,e,J)}function q(J){bubble.call(this,e,J)}function H(J){bubble.call(this,e,J)}function W(J){bubble.call(this,e,J)}function U(J){bubble.call(this,e,J)}function Q(){p=this.value,i(0,p)}return e.$$set=J=>{i(25,n=assign(assign({},n),exclude_internal_props(J))),i(7,s=compute_rest_props(n,r)),"value"in J&&i(0,p=J.value),"$$scope"in J&&i(23,l=J.$$scope)},e.$$.update=()=>{i(2,v=classNames("w-full rounded-lg",d?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700","text-gray-900 dark:placeholder-gray-400 dark:text-white ","border border-gray-200 dark:border-gray-600",n.class)),e.$$.dirty&6&&i(3,S=g?classNames("block w-full","text-sm","border-0 px-0","bg-inherit dark:bg-inherit","focus:outline-none focus:ring-0"):classNames(v,"p-2.5 text-sm","focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-500 dark:focus:border-blue-500"))},i(1,g=f.header||f.footer),i(4,k=classNames("py-2 px-4 bg-white dark:bg-gray-800",f.footer||"rounded-b-lg",f.header||"rounded-t-lg")),n=exclude_internal_props(n),[p,g,v,S,k,T,f,s,o,O,R,P,F,I,L,N,j,z,q,H,W,U,Q,l]}class Textarea extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$G,create_fragment$G,safe_not_equal,{value:0})}}function create_fragment$F(e){let n,i,r;const s=e[4].default,o=create_slot(s,e,e[3],null);let l=[e[1],{class:i=classNames(e[0],e[2].class)},{"aria-label":"Sidebar"}],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=element$2("aside"),o&&o.c(),this.h()},l(d){n=claim_element(d,"ASIDE",{class:!0,"aria-label":!0});var p=children$2(n);o&&o.l(p),p.forEach(detach),this.h()},h(){set_attributes(n,f)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),r=!0},p(d,[p]){o&&o.p&&(!r||p&8)&&update_slot_base(o,s,d,d[3],r?get_slot_changes(s,d[3],p,null):get_all_dirty_from_scope(d[3]),null),set_attributes(n,f=get_spread_update(l,[p&2&&d[1],(!r||p&5&&i!==(i=classNames(d[0],d[2].class)))&&{class:i},{"aria-label":"Sidebar"}]))},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$F(e,n,i){const r=["asideClass"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n,{asideClass:f="w-64"}=n;return e.$$set=d=>{i(2,n=assign(assign({},n),exclude_internal_props(d))),i(1,s=compute_rest_props(n,r)),"asideClass"in d&&i(0,f=d.asideClass),"$$scope"in d&&i(3,l=d.$$scope)},n=exclude_internal_props(n),[f,s,n,l,o]}class Sidebar extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$F,create_fragment$F,safe_not_equal,{asideClass:0})}}const get_subtext_slot_changes=e=>({}),get_subtext_slot_context=e=>({}),get_icon_slot_changes$1=e=>({}),get_icon_slot_context$1=e=>({});function create_if_block$7(e){let n;const i=e[10].subtext,r=create_slot(i,e,e[9],get_subtext_slot_context);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&512)&&update_slot_base(r,i,s,s[9],n?get_slot_changes(i,s[9],o,get_subtext_slot_changes):get_all_dirty_from_scope(s[9]),get_subtext_slot_context)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_fragment$E(e){let n,i,r,s,o,l,f,d,p,g;const v=e[10].icon,S=create_slot(v,e,e[9],get_icon_slot_context$1);let T=e[8].subtext&&create_if_block$7(e),k=[e[6],{href:e[1]},{class:f=classNames(e[5]?e[4]:e[0],e[7].class)}],O={};for(let R=0;R<k.length;R+=1)O=assign(O,k[R]);return{c(){n=element$2("li"),i=element$2("a"),S&&S.c(),r=space(),s=element$2("span"),o=text$3(e[2]),l=space(),T&&T.c(),this.h()},l(R){n=claim_element(R,"LI",{});var P=children$2(n);i=claim_element(P,"A",{href:!0,class:!0});var F=children$2(i);S&&S.l(F),r=claim_space(F),s=claim_element(F,"SPAN",{class:!0});var I=children$2(s);o=claim_text(I,e[2]),I.forEach(detach),l=claim_space(F),T&&T.l(F),F.forEach(detach),P.forEach(detach),this.h()},h(){attr$6(s,"class",e[3]),set_attributes(i,O)},m(R,P){insert_hydration(R,n,P),append_hydration(n,i),S&&S.m(i,null),append_hydration(i,r),append_hydration(i,s),append_hydration(s,o),append_hydration(i,l),T&&T.m(i,null),d=!0,p||(g=[listen(i,"blur",e[11]),listen(i,"click",e[12]),listen(i,"focus",e[13]),listen(i,"keydown",e[14]),listen(i,"keypress",e[15]),listen(i,"keyup",e[16]),listen(i,"mouseenter",e[17]),listen(i,"mouseleave",e[18]),listen(i,"mouseover",e[19])],p=!0)},p(R,[P]){S&&S.p&&(!d||P&512)&&update_slot_base(S,v,R,R[9],d?get_slot_changes(v,R[9],P,get_icon_slot_changes$1):get_all_dirty_from_scope(R[9]),get_icon_slot_context$1),(!d||P&4)&&set_data(o,R[2]),(!d||P&8)&&attr$6(s,"class",R[3]),R[8].subtext?T?(T.p(R,P),P&256&&transition_in(T,1)):(T=create_if_block$7(R),T.c(),transition_in(T,1),T.m(i,null)):T&&(group_outros(),transition_out(T,1,1,()=>{T=null}),check_outros()),set_attributes(i,O=get_spread_update(k,[P&64&&R[6],(!d||P&2)&&{href:R[1]},(!d||P&177&&f!==(f=classNames(R[5]?R[4]:R[0],R[7].class)))&&{class:f}]))},i(R){d||(transition_in(S,R),transition_in(T),d=!0)},o(R){transition_out(S,R),transition_out(T),d=!1},d(R){R&&detach(n),S&&S.d(R),T&&T.d(),p=!1,run_all(g)}}}function instance$E(e,n,i){const r=["aClass","href","label","spanClass","activeClass","active"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;const f=compute_slots(o);let{aClass:d="flex items-center p-2 text-base font-normal text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}=n,{href:p=""}=n,{label:g=""}=n,{spanClass:v="ml-3"}=n,{activeClass:S="flex items-center p-2 text-base font-normal text-gray-900 bg-gray-200 dark:bg-gray-700 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}=n,{active:T=!1}=n;function k(z){bubble.call(this,e,z)}function O(z){bubble.call(this,e,z)}function R(z){bubble.call(this,e,z)}function P(z){bubble.call(this,e,z)}function F(z){bubble.call(this,e,z)}function I(z){bubble.call(this,e,z)}function L(z){bubble.call(this,e,z)}function N(z){bubble.call(this,e,z)}function j(z){bubble.call(this,e,z)}return e.$$set=z=>{i(7,n=assign(assign({},n),exclude_internal_props(z))),i(6,s=compute_rest_props(n,r)),"aClass"in z&&i(0,d=z.aClass),"href"in z&&i(1,p=z.href),"label"in z&&i(2,g=z.label),"spanClass"in z&&i(3,v=z.spanClass),"activeClass"in z&&i(4,S=z.activeClass),"active"in z&&i(5,T=z.active),"$$scope"in z&&i(9,l=z.$$scope)},n=exclude_internal_props(n),[d,p,g,v,S,T,s,n,f,l,o,k,O,R,P,F,I,L,N,j]}class SidebarItem extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$E,create_fragment$E,safe_not_equal,{aClass:0,href:1,label:2,spanClass:3,activeClass:4,active:5})}}function create_fragment$D(e){let n,i,r,s,o,l,f=[e[5],{href:e[1]},{class:s=classNames(e[4]?e[3]:e[0],e[6].class)}],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=element$2("li"),i=element$2("a"),r=text$3(e[2]),this.h()},l(p){n=claim_element(p,"LI",{});var g=children$2(n);i=claim_element(g,"A",{href:!0,class:!0});var v=children$2(i);r=claim_text(v,e[2]),v.forEach(detach),g.forEach(detach),this.h()},h(){set_attributes(i,d)},m(p,g){insert_hydration(p,n,g),append_hydration(n,i),append_hydration(i,r),o||(l=[listen(i,"blur",e[7]),listen(i,"click",e[8]),listen(i,"focus",e[9]),listen(i,"keydown",e[10]),listen(i,"keypress",e[11]),listen(i,"keyup",e[12]),listen(i,"mouseenter",e[13]),listen(i,"mouseleave",e[14]),listen(i,"mouseover",e[15])],o=!0)},p(p,[g]){g&4&&set_data(r,p[2]),set_attributes(i,d=get_spread_update(f,[g&32&&p[5],g&2&&{href:p[1]},g&89&&s!==(s=classNames(p[4]?p[3]:p[0],p[6].class))&&{class:s}]))},i:noop$6,o:noop$6,d(p){p&&detach(n),o=!1,run_all(l)}}}function instance$D(e,n,i){const r=["aClass","href","label","activeClass","active"];let s=compute_rest_props(n,r),{aClass:o="flex items-center p-2 pl-11 w-full text-base font-normal text-gray-900 rounded-lg transition duration-75 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"}=n,{href:l=""}=n,{label:f=""}=n,{activeClass:d="flex items-center p-2 pl-11 text-base font-normal text-gray-900 bg-gray-200 dark:bg-gray-700 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}=n,{active:p=!1}=n;function g(I){bubble.call(this,e,I)}function v(I){bubble.call(this,e,I)}function S(I){bubble.call(this,e,I)}function T(I){bubble.call(this,e,I)}function k(I){bubble.call(this,e,I)}function O(I){bubble.call(this,e,I)}function R(I){bubble.call(this,e,I)}function P(I){bubble.call(this,e,I)}function F(I){bubble.call(this,e,I)}return e.$$set=I=>{i(6,n=assign(assign({},n),exclude_internal_props(I))),i(5,s=compute_rest_props(n,r)),"aClass"in I&&i(0,o=I.aClass),"href"in I&&i(1,l=I.href),"label"in I&&i(2,f=I.label),"activeClass"in I&&i(3,d=I.activeClass),"active"in I&&i(4,p=I.active)},n=exclude_internal_props(n),[o,l,f,d,p,s,n,g,v,S,T,k,O,R,P,F]}class SidebarDropdownItem extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$D,create_fragment$D,safe_not_equal,{aClass:0,href:1,label:2,activeClass:3,active:4})}}const get_arrowdown_slot_changes=e=>({}),get_arrowdown_slot_context=e=>({}),get_arrowup_slot_changes=e=>({}),get_arrowup_slot_context=e=>({}),get_icon_slot_changes=e=>({}),get_icon_slot_context=e=>({});function create_else_block_1$1(e){let n,i;return n=new ChevronDown({}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p:noop$6,i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_if_block_3$2(e){let n;const i=e[10].arrowdown,r=create_slot(i,e,e[9],get_arrowdown_slot_context);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&512)&&update_slot_base(r,i,s,s[9],n?get_slot_changes(i,s[9],o,get_arrowdown_slot_changes):get_all_dirty_from_scope(s[9]),get_arrowdown_slot_context)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_if_block_1$3(e){let n,i,r,s;const o=[create_if_block_2$2,create_else_block$3],l=[];function f(d,p){return d[8].arrowup?0:1}return n=f(e),i=l[n]=o[n](e),{c(){i.c(),r=empty()},l(d){i.l(d),r=empty()},m(d,p){l[n].m(d,p),insert_hydration(d,r,p),s=!0},p(d,p){let g=n;n=f(d),n===g?l[n].p(d,p):(group_outros(),transition_out(l[g],1,1,()=>{l[g]=null}),check_outros(),i=l[n],i?i.p(d,p):(i=l[n]=o[n](d),i.c()),transition_in(i,1),i.m(r.parentNode,r))},i(d){s||(transition_in(i),s=!0)},o(d){transition_out(i),s=!1},d(d){l[n].d(d),d&&detach(r)}}}function create_else_block$3(e){let n,i;return n=new ChevronUp({}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p:noop$6,i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_if_block_2$2(e){let n;const i=e[10].arrowup,r=create_slot(i,e,e[9],get_arrowup_slot_context);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&512)&&update_slot_base(r,i,s,s[9],n?get_slot_changes(i,s[9],o,get_arrowup_slot_changes):get_all_dirty_from_scope(s[9]),get_arrowup_slot_context)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_if_block$6(e){let n,i,r;const s=e[10].default,o=create_slot(s,e,e[9],null);return{c(){n=element$2("ul"),o&&o.c(),this.h()},l(l){n=claim_element(l,"UL",{id:!0,class:!0});var f=children$2(n);o&&o.l(f),f.forEach(detach),this.h()},h(){attr$6(n,"id","dropdown"),attr$6(n,"class",e[4])},m(l,f){insert_hydration(l,n,f),o&&o.m(n,null),r=!0},p(l,f){e=l,o&&o.p&&(!r||f&512)&&update_slot_base(o,s,e,e[9],r?get_slot_changes(s,e[9],f,null):get_all_dirty_from_scope(e[9]),null),(!r||f&16)&&attr$6(n,"class",e[4])},i(l){r||(transition_in(o,l),add_render_callback(()=>{i||(i=create_bidirectional_transition(n,slide,{delay:250,duration:300,easing:quintOut},!0)),i.run(1)}),r=!0)},o(l){transition_out(o,l),i||(i=create_bidirectional_transition(n,slide,{delay:250,duration:300,easing:quintOut},!1)),i.run(0),r=!1},d(l){l&&detach(n),o&&o.d(l),l&&i&&i.end()}}}function create_fragment$C(e){let n,i,r,s,o,l,f,d,p,g,v,S,T;const k=e[10].icon,O=create_slot(k,e,e[9],get_icon_slot_context),R=[create_if_block_1$3,create_if_block_3$2,create_else_block_1$1],P=[];function F(j,z){return j[0]?0:j[8].arrowdown?1:2}f=F(e),d=P[f]=R[f](e);let I=[e[6],{type:"button"},{class:p=classNames(e[1],e[7].class)},{"aria-controls":"sidebar-dropdown"}],L={};for(let j=0;j<I.length;j+=1)L=assign(L,I[j]);let N=e[0]&&create_if_block$6(e);return{c(){n=element$2("li"),i=element$2("button"),O&&O.c(),r=space(),s=element$2("span"),o=text$3(e[2]),l=space(),d.c(),g=space(),N&&N.c(),this.h()},l(j){n=claim_element(j,"LI",{});var z=children$2(n);i=claim_element(z,"BUTTON",{type:!0,class:!0,"aria-controls":!0});var q=children$2(i);O&&O.l(q),r=claim_space(q),s=claim_element(q,"SPAN",{class:!0,"sidebar-toggle-item":!0});var H=children$2(s);o=claim_text(H,e[2]),H.forEach(detach),l=claim_space(q),d.l(q),q.forEach(detach),g=claim_space(z),N&&N.l(z),z.forEach(detach),this.h()},h(){attr$6(s,"class",e[3]),attr$6(s,"sidebar-toggle-item",""),set_attributes(i,L)},m(j,z){insert_hydration(j,n,z),append_hydration(n,i),O&&O.m(i,null),append_hydration(i,r),append_hydration(i,s),append_hydration(s,o),append_hydration(i,l),P[f].m(i,null),i.autofocus&&i.focus(),append_hydration(n,g),N&&N.m(n,null),v=!0,S||(T=listen(i,"click",e[11]),S=!0)},p(j,[z]){O&&O.p&&(!v||z&512)&&update_slot_base(O,k,j,j[9],v?get_slot_changes(k,j[9],z,get_icon_slot_changes):get_all_dirty_from_scope(j[9]),get_icon_slot_context),(!v||z&4)&&set_data(o,j[2]),(!v||z&8)&&attr$6(s,"class",j[3]);let q=f;f=F(j),f===q?P[f].p(j,z):(group_outros(),transition_out(P[q],1,1,()=>{P[q]=null}),check_outros(),d=P[f],d?d.p(j,z):(d=P[f]=R[f](j),d.c()),transition_in(d,1),d.m(i,null)),set_attributes(i,L=get_spread_update(I,[z&64&&j[6],{type:"button"},(!v||z&130&&p!==(p=classNames(j[1],j[7].class)))&&{class:p},{"aria-controls":"sidebar-dropdown"}])),j[0]?N?(N.p(j,z),z&1&&transition_in(N,1)):(N=create_if_block$6(j),N.c(),transition_in(N,1),N.m(n,null)):N&&(group_outros(),transition_out(N,1,1,()=>{N=null}),check_outros())},i(j){v||(transition_in(O,j),transition_in(d),transition_in(N),v=!0)},o(j){transition_out(O,j),transition_out(d),transition_out(N),v=!1},d(j){j&&detach(n),O&&O.d(j),P[f].d(),N&&N.d(),S=!1,T()}}}function instance$C(e,n,i){const r=["btnClass","label","spanClass","ulClass","isOpen"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;const f=compute_slots(o);let{btnClass:d="flex items-center p-2 w-full text-base font-normal text-gray-900 rounded-lg transition duration-75 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"}=n,{label:p=""}=n,{spanClass:g="flex-1 ml-3 text-left whitespace-nowrap"}=n,{ulClass:v="py-2 space-y-2"}=n,{isOpen:S=!1}=n;const T=()=>{i(0,S=!S)},k=()=>T();return e.$$set=O=>{i(7,n=assign(assign({},n),exclude_internal_props(O))),i(6,s=compute_rest_props(n,r)),"btnClass"in O&&i(1,d=O.btnClass),"label"in O&&i(2,p=O.label),"spanClass"in O&&i(3,g=O.spanClass),"ulClass"in O&&i(4,v=O.ulClass),"isOpen"in O&&i(0,S=O.isOpen),"$$scope"in O&&i(9,l=O.$$scope)},n=exclude_internal_props(n),[S,d,p,g,v,T,s,n,f,l,o,k]}class SidebarDropdownWrapper extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$C,create_fragment$C,safe_not_equal,{btnClass:1,label:2,spanClass:3,ulClass:4,isOpen:0})}}function create_fragment$B(e){let n,i,r;const s=e[6].default,o=create_slot(s,e,e[5],null);let l=[e[1],{class:i=classNames(e[0],e[2].class)}],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=element$2("ul"),o&&o.c(),this.h()},l(d){n=claim_element(d,"UL",{class:!0});var p=children$2(n);o&&o.l(p),p.forEach(detach),this.h()},h(){set_attributes(n,f)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),r=!0},p(d,[p]){o&&o.p&&(!r||p&32)&&update_slot_base(o,s,d,d[5],r?get_slot_changes(s,d[5],p,null):get_all_dirty_from_scope(d[5]),null),set_attributes(n,f=get_spread_update(l,[p&2&&d[1],(!r||p&5&&i!==(i=classNames(d[0],d[2].class)))&&{class:i}]))},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$B(e,n,i){const r=["ulClass","borderClass","border"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n,{ulClass:f="space-y-2"}=n,{borderClass:d="pt-4 mt-4 border-t border-gray-200 dark:border-gray-700"}=n,{border:p=!1}=n;return p&&(f+=" "+d),e.$$set=g=>{i(2,n=assign(assign({},n),exclude_internal_props(g))),i(1,s=compute_rest_props(n,r)),"ulClass"in g&&i(0,f=g.ulClass),"borderClass"in g&&i(3,d=g.borderClass),"border"in g&&i(4,p=g.border),"$$scope"in g&&i(5,l=g.$$scope)},n=exclude_internal_props(n),[f,s,n,d,p,l,o]}class SidebarGroup extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$B,create_fragment$B,safe_not_equal,{ulClass:0,borderClass:3,border:4})}}function create_fragment$A(e){let n,i,r;const s=e[4].default,o=create_slot(s,e,e[3],null);let l=[e[1],{class:i=classNames(e[0],e[2].class)}],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=element$2("div"),o&&o.c(),this.h()},l(d){n=claim_element(d,"DIV",{class:!0});var p=children$2(n);o&&o.l(p),p.forEach(detach),this.h()},h(){set_attributes(n,f)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),r=!0},p(d,[p]){o&&o.p&&(!r||p&8)&&update_slot_base(o,s,d,d[3],r?get_slot_changes(s,d[3],p,null):get_all_dirty_from_scope(d[3]),null),set_attributes(n,f=get_spread_update(l,[p&2&&d[1],(!r||p&5&&i!==(i=classNames(d[0],d[2].class)))&&{class:i}]))},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$A(e,n,i){const r=["divClass"];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n,{divClass:f="overflow-y-auto py-4 px-3 bg-gray-50 rounded dark:bg-gray-800"}=n;return e.$$set=d=>{i(2,n=assign(assign({},n),exclude_internal_props(d))),i(1,s=compute_rest_props(n,r)),"divClass"in d&&i(0,f=d.divClass),"$$scope"in d&&i(3,l=d.$$scope)},n=exclude_internal_props(n),[f,s,n,l,o]}class SidebarWrapper extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$A,create_fragment$A,safe_not_equal,{divClass:0})}}const app="",API_URL=writable({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_API_URL||{BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_API_URL_PLACEHOLDER);function get_each_context$6(e,n,i){const r=e.slice();return r[6]=n[i],r}function create_if_block$5(e){let n,i,r;const s=[e[0]];var o=e[2];function l(f){let d={$$slots:{default:[create_default_slot$5]},$$scope:{ctx:f}};for(let p=0;p<s.length;p+=1)d=assign(d,s[p]);return{props:d}}return o&&(n=construct_svelte_component(o,l(e)),n.$on("edit",e[4])),{c(){n&&create_component(n.$$.fragment),i=empty()},l(f){n&&claim_component(n.$$.fragment,f),i=empty()},m(f,d){n&&mount_component(n,f,d),insert_hydration(f,i,d),r=!0},p(f,d){const p=d&1?get_spread_update(s,[get_spread_object(f[0])]):{};if(d&514&&(p.$$scope={dirty:d,ctx:f}),o!==(o=f[2])){if(n){group_outros();const g=n;transition_out(g.$$.fragment,1,0,()=>{destroy_component(g,1)}),check_outros()}o?(n=construct_svelte_component(o,l(f)),n.$on("edit",f[4]),create_component(n.$$.fragment),transition_in(n.$$.fragment,1),mount_component(n,i.parentNode,i)):n=null}else o&&n.$set(p)},i(f){r||(n&&transition_in(n.$$.fragment,f),r=!0)},o(f){n&&transition_out(n.$$.fragment,f),r=!1},d(f){f&&detach(i),n&&destroy_component(n,f)}}}function create_each_block$6(e){let n,i;const r=[e[6]];let s={};for(let o=0;o<r.length;o+=1)s=assign(s,r[o]);return n=new DynamicComponent({props:s}),{c(){create_component(n.$$.fragment)},l(o){claim_component(n.$$.fragment,o)},m(o,l){mount_component(n,o,l),i=!0},p(o,l){const f=l&2?get_spread_update(r,[get_spread_object(o[6])]):{};n.$set(f)},i(o){i||(transition_in(n.$$.fragment,o),i=!0)},o(o){transition_out(n.$$.fragment,o),i=!1},d(o){destroy_component(n,o)}}}function create_default_slot$5(e){let n,i,r=e[1],s=[];for(let l=0;l<r.length;l+=1)s[l]=create_each_block$6(get_each_context$6(e,r,l));const o=l=>transition_out(s[l],1,1,()=>{s[l]=null});return{c(){for(let l=0;l<s.length;l+=1)s[l].c();n=empty()},l(l){for(let f=0;f<s.length;f+=1)s[f].l(l);n=empty()},m(l,f){for(let d=0;d<s.length;d+=1)s[d].m(l,f);insert_hydration(l,n,f),i=!0},p(l,f){if(f&2){r=l[1];let d;for(d=0;d<r.length;d+=1){const p=get_each_context$6(l,r,d);s[d]?(s[d].p(p,f),transition_in(s[d],1)):(s[d]=create_each_block$6(p),s[d].c(),transition_in(s[d],1),s[d].m(n.parentNode,n))}for(group_outros(),d=r.length;d<s.length;d+=1)o(d);check_outros()}},i(l){if(!i){for(let f=0;f<r.length;f+=1)transition_in(s[f]);i=!0}},o(l){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)transition_out(s[f]);i=!1},d(l){destroy_each(s,l),l&&detach(n)}}}function create_fragment$z(e){let n,i,r=e[2]&&create_if_block$5(e);return{c(){r&&r.c(),n=empty()},l(s){r&&r.l(s),n=empty()},m(s,o){r&&r.m(s,o),insert_hydration(s,n,o),i=!0},p(s,[o]){s[2]?r?(r.p(s,o),o&4&&transition_in(r,1)):(r=create_if_block$5(s),r.c(),transition_in(r,1),r.m(n.parentNode,n)):r&&(group_outros(),transition_out(r,1,1,()=>{r=null}),check_outros())},i(s){i||(transition_in(r),i=!0)},o(s){transition_out(r),i=!1},d(s){r&&r.d(s),s&&detach(n)}}}function instance$z(e,n,i){const r=getContext$1("Components");let{name:s}=n,{props:o}=n,{slots:l=[]}=n,f;onMount(async()=>{if(s in r){i(2,f=r[s]);return}else console.log(`Component ${s} was not imported and added to the Components context.`)});function d(p){bubble.call(this,e,p)}return e.$$set=p=>{"name"in p&&i(3,s=p.name),"props"in p&&i(0,o=p.props),"slots"in p&&i(1,l=p.slots)},e.$$.update=()=>{e.$$.dirty&8&&i(2,f=r[s])},[o,l,f,s,d]}class DynamicComponent extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$z,create_fragment$z,safe_not_equal,{name:3,props:0,slots:1})}}const globalStores=new Map;async function post(e,n){const i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),r=await i.json();if(!i.ok)throw console.log("HTTP status "+i.status+": "+i.statusText+`
 url: `+e+`
 data: `+JSON.stringify(n)),new Error("HTTP status "+i.status+": "+r.detail);return r}function applyModifications(e){for(const n of e)if(n.type==="ref"){if(!globalStores.has(n.id))continue;globalStores.get(n.id).update(r=>(r.scope=n.scope,r))}else if(n.type==="store"){const i=globalStores.get(n.id);if(i===void 0){console.log("Store is not maintained on the frontend. Only stores passed as props to a component are maintained in `globalStores`.",n.id);continue}if(!("triggerStore"in i))throw"Must use `meerkatWritable` for backend stores.";n.value!==get_store_value(i)&&i.set(n.value,!1)}}const TOAST_LIMIT=20,toasts=writable([]),toastTimeouts=new Map,addToRemoveQueue=e=>{if(toastTimeouts.has(e))return;const n=setTimeout(()=>{toastTimeouts.delete(e),remove$1(e)},1e3);toastTimeouts.set(e,n)},clearFromRemoveQueue=e=>{const n=toastTimeouts.get(e);n&&clearTimeout(n)};function update$7(e){e.id&&clearFromRemoveQueue(e.id),toasts.update(n=>n.map(i=>i.id===e.id?{...i,...e}:i))}function add$5(e){toasts.update(n=>[e,...n].slice(0,TOAST_LIMIT))}function upsert(e){get_store_value(toasts).find(n=>n.id===e.id)?update$7(e):add$5(e)}function dismiss(e){toasts.update(n=>(e?addToRemoveQueue(e):n.forEach(i=>{addToRemoveQueue(i.id)}),n.map(i=>i.id===e||e===void 0?{...i,visible:!1}:i)))}function remove$1(e){toasts.update(n=>e===void 0?[]:n.filter(i=>i.id!==e))}const isFunction$3=e=>typeof e=="function",resolveValue=(e,n)=>isFunction$3(e)?e(n):e,genId=(()=>{let e=0;return()=>(e+=1,e.toString())})(),createToast=(e,n="blank",i)=>({createdAt:Date.now(),visible:!0,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...i,id:(i==null?void 0:i.id)||genId()}),createHandler=e=>(n,i)=>{const r=createToast(n,e,i);return upsert(r),r.id},toast=(e,n)=>createHandler("blank")(e,n);toast.error=createHandler("error");toast.success=createHandler("success");toast.loading=createHandler("loading");toast.custom=createHandler("custom");toast.dismiss=e=>{dismiss(e)};toast.remove=e=>remove$1(e);toast.promise=(e,n,i)=>{const r=toast.loading(n.loading,{...i,...i==null?void 0:i.loading});return e.then(s=>(toast.success(resolveValue(n.success,s),{id:r,...i,...i==null?void 0:i.success}),s)).catch(s=>{toast.error(resolveValue(n.error,s),{id:r,...i,...i==null?void 0:i.error})}),e};const toast$1=toast;class DataFrameChunk{constructor(n,i,r,s,o){at(this,"columnInfos");at(this,"columns");at(this,"posidxs");at(this,"keyidxs");at(this,"rows");at(this,"fullLength");at(this,"primaryKey");this.columnInfos=n,this.columns=this.columnInfos.map(f=>f.name),this.posidxs=i,this.rows=r,this.fullLength=s,this.primaryKey=o;let l=this.columns.findIndex(f=>f===o);this.keyidxs=this.rows.map(f=>f[l])}getCell(n,i){let r=this.columns.indexOf(i);if(r===-1)throw new Error(`Column ${i} does not exist in this DataFrame`);let s=this.columnInfos[r];return{data:this.rows[n][this.columns.indexOf(i)],cellComponent:s.cellComponent,cellProps:s.cellProps,cellDataProp:s.cellDataProp,column:i}}getColumn(n){let i=this.columns.indexOf(n),r=this.columnInfos[i];return console.log(n),{data:this.rows.map(s=>s[i]),cellComponent:r.cellComponent,cellProps:r.cellProps,cellDataProp:r.cellDataProp,column:n}}getRow(n){let i={};for(let r=0;r<this.columns.length;r++)i[this.columns[r]]=this.rows[n][r];return i}getRows(){let n=[];for(let i=0;i<this.rows.length;i++)n.push(this.getRow(i));return n}length(){return this.rows.length}}const dispatch$1=async(e,n={})=>{if(e===null)return;const i=post(`${get_store_value(API_URL)}/endpoint/${e}/dispatch/`,n).catch(l=>{throw console.log(l),toast$1.error(l.message),l}),{result:r,modifications:s,error:o}=await i;return applyModifications(s),r},fetchChunk=async({df:e,columns:n=null,start:i=null,end:r=null,posidxs:s=null,keyidxs:o=null,keyColumn:l=null,formatter:f=null,shuffle:d=null})=>{const g=await post(`${get_store_value(API_URL)}/df/${e.refId}/rows/`,{start:i,end:r,posidxs:s,key_column:l,keyidxs:o,columns:n,formatter:f,shuffle:d}).catch(v=>{throw console.log(v),toast$1.error(v.message),v});return new DataFrameChunk(g.columnInfos,g.posidxs,g.rows,g.fullLength,g.primaryKey)},ChevronIcon_svelte_svelte_type_style_lang="",ClearIcon_svelte_svelte_type_style_lang="",LoadingIcon_svelte_svelte_type_style_lang="",Select_svelte_svelte_type_style_lang="";function create_fragment$y(e){let n,i,r;const s=e[2].default,o=create_slot(s,e,e[1],null);let l=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=svg_element("svg"),o&&o.c(),i=svg_element("path"),this.h()},l(d){n=claim_svg_element(d,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var p=children$2(n);o&&o.l(p),i=claim_svg_element(p,"path",{"fill-rule":!0,d:!0}),children$2(i).forEach(detach),p.forEach(detach),this.h()},h(){attr$6(i,"fill-rule","evenodd"),attr$6(i,"d","M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.004-.001.274-.11a.75.75 0 0 1 .558 0l.274.11.004.001 6.971 2.789Zm-1.374.527L8 5.962 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339Z"),set_svg_attributes(n,f),toggle_class(n,"bi",!0),toggle_class(n,"bi-box-fill",!0)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),append_hydration(n,i),r=!0},p(d,[p]){o&&o.p&&(!r||p&2)&&update_slot_base(o,s,d,d[1],r?get_slot_changes(s,d[1],p,null):get_all_dirty_from_scope(d[1]),null),set_svg_attributes(n,f=get_spread_update(l,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},p&1&&d[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-box-fill",!0)},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$y(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class BoxFill extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$y,create_fragment$y,safe_not_equal,{})}}function create_fragment$x(e){let n,i,r,s;const o=e[2].default,l=create_slot(o,e,e[1],null);let f=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=svg_element("svg"),l&&l.c(),i=svg_element("path"),r=svg_element("path"),this.h()},l(p){n=claim_svg_element(p,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var g=children$2(n);l&&l.l(g),i=claim_svg_element(g,"path",{d:!0}),children$2(i).forEach(detach),r=claim_svg_element(g,"path",{d:!0}),children$2(r).forEach(detach),g.forEach(detach),this.h()},h(){attr$6(i,"d","M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"),attr$6(r,"d","M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z"),set_svg_attributes(n,d),toggle_class(n,"bi",!0),toggle_class(n,"bi-check-square",!0)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),append_hydration(n,i),append_hydration(n,r),s=!0},p(p,[g]){l&&l.p&&(!s||g&2)&&update_slot_base(l,o,p,p[1],s?get_slot_changes(o,p[1],g,null):get_all_dirty_from_scope(p[1]),null),set_svg_attributes(n,d=get_spread_update(f,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},g&1&&p[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-check-square",!0)},i(p){s||(transition_in(l,p),s=!0)},o(p){transition_out(l,p),s=!1},d(p){p&&detach(n),l&&l.d(p)}}}function instance$x(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class CheckSquare extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$x,create_fragment$x,safe_not_equal,{})}}function create_fragment$w(e){let n,i,r;const s=e[2].default,o=create_slot(s,e,e[1],null);let l=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=svg_element("svg"),o&&o.c(),i=svg_element("path"),this.h()},l(d){n=claim_svg_element(d,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var p=children$2(n);o&&o.l(p),i=claim_svg_element(p,"path",{d:!0}),children$2(i).forEach(detach),p.forEach(detach),this.h()},h(){attr$6(i,"d","M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"),set_svg_attributes(n,f),toggle_class(n,"bi",!0),toggle_class(n,"bi-code-slash",!0)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),append_hydration(n,i),r=!0},p(d,[p]){o&&o.p&&(!r||p&2)&&update_slot_base(o,s,d,d[1],r?get_slot_changes(s,d[1],p,null):get_all_dirty_from_scope(d[1]),null),set_svg_attributes(n,f=get_spread_update(l,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},p&1&&d[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-code-slash",!0)},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$w(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class CodeSlash extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$w,create_fragment$w,safe_not_equal,{})}}function create_fragment$v(e){let n,i,r,s;const o=e[2].default,l=create_slot(o,e,e[1],null);let f=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=svg_element("svg"),l&&l.c(),i=svg_element("path"),r=svg_element("path"),this.h()},l(p){n=claim_svg_element(p,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var g=children$2(n);l&&l.l(g),i=claim_svg_element(g,"path",{d:!0}),children$2(i).forEach(detach),r=claim_svg_element(g,"path",{d:!0}),children$2(r).forEach(detach),g.forEach(detach),this.h()},h(){attr$6(i,"d","M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"),attr$6(r,"d","M6.854 4.646a.5.5 0 0 1 0 .708L4.207 8l2.647 2.646a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 0 1 .708 0zm2.292 0a.5.5 0 0 0 0 .708L11.793 8l-2.647 2.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708 0z"),set_svg_attributes(n,d),toggle_class(n,"bi",!0),toggle_class(n,"bi-code-square",!0)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),append_hydration(n,i),append_hydration(n,r),s=!0},p(p,[g]){l&&l.p&&(!s||g&2)&&update_slot_base(l,o,p,p[1],s?get_slot_changes(o,p[1],g,null):get_all_dirty_from_scope(p[1]),null),set_svg_attributes(n,d=get_spread_update(f,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},g&1&&p[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-code-square",!0)},i(p){s||(transition_in(l,p),s=!0)},o(p){transition_out(l,p),s=!1},d(p){p&&detach(n),l&&l.d(p)}}}function instance$v(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class CodeSquare extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$v,create_fragment$v,safe_not_equal,{})}}function create_fragment$u(e){let n,i,r;const s=e[2].default,o=create_slot(s,e,e[1],null);let l=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=svg_element("svg"),o&&o.c(),i=svg_element("path"),this.h()},l(d){n=claim_svg_element(d,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var p=children$2(n);o&&o.l(p),i=claim_svg_element(p,"path",{d:!0}),children$2(i).forEach(detach),p.forEach(detach),this.h()},h(){attr$6(i,"d","M5.854 4.854a.5.5 0 1 0-.708-.708l-3.5 3.5a.5.5 0 0 0 0 .708l3.5 3.5a.5.5 0 0 0 .708-.708L2.707 8l3.147-3.146zm4.292 0a.5.5 0 0 1 .708-.708l3.5 3.5a.5.5 0 0 1 0 .708l-3.5 3.5a.5.5 0 0 1-.708-.708L13.293 8l-3.147-3.146z"),set_svg_attributes(n,f),toggle_class(n,"bi",!0),toggle_class(n,"bi-code",!0)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),append_hydration(n,i),r=!0},p(d,[p]){o&&o.p&&(!r||p&2)&&update_slot_base(o,s,d,d[1],r?get_slot_changes(s,d[1],p,null):get_all_dirty_from_scope(d[1]),null),set_svg_attributes(n,f=get_spread_update(l,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},p&1&&d[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-code",!0)},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$u(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}let Code$1=class extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$u,create_fragment$u,safe_not_equal,{})}};function create_fragment$t(e){let n,i,r,s;const o=e[2].default,l=create_slot(o,e,e[1],null);let f=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=svg_element("svg"),l&&l.c(),i=svg_element("path"),r=svg_element("path"),this.h()},l(p){n=claim_svg_element(p,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var g=children$2(n);l&&l.l(g),i=claim_svg_element(g,"path",{d:!0}),children$2(i).forEach(detach),r=claim_svg_element(g,"path",{d:!0}),children$2(r).forEach(detach),g.forEach(detach),this.h()},h(){attr$6(i,"d","M10.943 6H5.057L5 8h.5c.18-1.096.356-1.192 1.694-1.235l.293-.01v5.09c0 .47-.1.582-.898.655v.5H9.41v-.5c-.803-.073-.903-.184-.903-.654V6.755l.298.01c1.338.043 1.514.14 1.694 1.235h.5l-.057-2z"),attr$6(r,"d","M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"),set_svg_attributes(n,d),toggle_class(n,"bi",!0),toggle_class(n,"bi-file-earmark-font",!0)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),append_hydration(n,i),append_hydration(n,r),s=!0},p(p,[g]){l&&l.p&&(!s||g&2)&&update_slot_base(l,o,p,p[1],s?get_slot_changes(o,p[1],g,null):get_all_dirty_from_scope(p[1]),null),set_svg_attributes(n,d=get_spread_update(f,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},g&1&&p[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-file-earmark-font",!0)},i(p){s||(transition_in(l,p),s=!0)},o(p){transition_out(l,p),s=!1},d(p){p&&detach(n),l&&l.d(p)}}}function instance$t(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class FileEarmarkFont extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$t,create_fragment$t,safe_not_equal,{})}}function create_fragment$s(e){let n,i,r,s;const o=e[2].default,l=create_slot(o,e,e[1],null);let f=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=svg_element("svg"),l&&l.c(),i=svg_element("path"),r=svg_element("path"),this.h()},l(p){n=claim_svg_element(p,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var g=children$2(n);l&&l.l(g),i=claim_svg_element(g,"path",{d:!0}),children$2(i).forEach(detach),r=claim_svg_element(g,"path",{d:!0}),children$2(r).forEach(detach),g.forEach(detach),this.h()},h(){attr$6(i,"d","M6.502 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"),attr$6(r,"d","M14 14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5V14zM4 1a1 1 0 0 0-1 1v10l2.224-2.224a.5.5 0 0 1 .61-.075L8 11l2.157-3.02a.5.5 0 0 1 .76-.063L13 10V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4z"),set_svg_attributes(n,d),toggle_class(n,"bi",!0),toggle_class(n,"bi-file-earmark-image",!0)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),append_hydration(n,i),append_hydration(n,r),s=!0},p(p,[g]){l&&l.p&&(!s||g&2)&&update_slot_base(l,o,p,p[1],s?get_slot_changes(o,p[1],g,null):get_all_dirty_from_scope(p[1]),null),set_svg_attributes(n,d=get_spread_update(f,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},g&1&&p[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-file-earmark-image",!0)},i(p){s||(transition_in(l,p),s=!0)},o(p){transition_out(l,p),s=!1},d(p){p&&detach(n),l&&l.d(p)}}}function instance$s(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class FileEarmarkImage extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$s,create_fragment$s,safe_not_equal,{})}}function create_fragment$r(e){let n,i,r,s;const o=e[2].default,l=create_slot(o,e,e[1],null);let f=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=svg_element("svg"),l&&l.c(),i=svg_element("path"),r=svg_element("path"),this.h()},l(p){n=claim_svg_element(p,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var g=children$2(n);l&&l.l(g),i=claim_svg_element(g,"path",{d:!0}),children$2(i).forEach(detach),r=claim_svg_element(g,"path",{d:!0}),children$2(r).forEach(detach),g.forEach(detach),this.h()},h(){attr$6(i,"d","M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"),attr$6(r,"d","M4.603 14.087a.81.81 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.68 7.68 0 0 1 1.482-.645 19.697 19.697 0 0 0 1.062-2.227 7.269 7.269 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a10.954 10.954 0 0 0 .98 1.686 5.753 5.753 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.856.856 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.712 5.712 0 0 1-.911-.95 11.651 11.651 0 0 0-1.997.406 11.307 11.307 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.793.793 0 0 1-.58.029zm1.379-1.901c-.166.076-.32.156-.459.238-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361.01.022.02.036.026.044a.266.266 0 0 0 .035-.012c.137-.056.355-.235.635-.572a8.18 8.18 0 0 0 .45-.606zm1.64-1.33a12.71 12.71 0 0 1 1.01-.193 11.744 11.744 0 0 1-.51-.858 20.801 20.801 0 0 1-.5 1.05zm2.446.45c.15.163.296.3.435.41.24.19.407.253.498.256a.107.107 0 0 0 .07-.015.307.307 0 0 0 .094-.125.436.436 0 0 0 .059-.2.095.095 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a3.876 3.876 0 0 0-.612-.053zM8.078 7.8a6.7 6.7 0 0 0 .2-.828c.031-.188.043-.343.038-.465a.613.613 0 0 0-.032-.198.517.517 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822.024.111.054.227.09.346z"),set_svg_attributes(n,d),toggle_class(n,"bi",!0),toggle_class(n,"bi-file-earmark-pdf",!0)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),append_hydration(n,i),append_hydration(n,r),s=!0},p(p,[g]){l&&l.p&&(!s||g&2)&&update_slot_base(l,o,p,p[1],s?get_slot_changes(o,p[1],g,null):get_all_dirty_from_scope(p[1]),null),set_svg_attributes(n,d=get_spread_update(f,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},g&1&&p[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-file-earmark-pdf",!0)},i(p){s||(transition_in(l,p),s=!0)},o(p){transition_out(l,p),s=!1},d(p){p&&detach(n),l&&l.d(p)}}}function instance$r(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class FileEarmarkPdf extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$r,create_fragment$r,safe_not_equal,{})}}function create_fragment$q(e){let n,i,r;const s=e[2].default,o=create_slot(s,e,e[1],null);let l=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=svg_element("svg"),o&&o.c(),i=svg_element("path"),this.h()},l(d){n=claim_svg_element(d,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var p=children$2(n);o&&o.l(p),i=claim_svg_element(p,"path",{d:!0}),children$2(i).forEach(detach),p.forEach(detach),this.h()},h(){attr$6(i,"d","M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855-.143.268-.276.56-.395.872.705.157 1.472.257 2.282.287V1.077zM4.249 3.539c.142-.384.304-.744.481-1.078a6.7 6.7 0 0 1 .597-.933A7.01 7.01 0 0 0 3.051 3.05c.362.184.763.349 1.198.49zM3.509 7.5c.036-1.07.188-2.087.436-3.008a9.124 9.124 0 0 1-1.565-.667A6.964 6.964 0 0 0 1.018 7.5h2.49zm1.4-2.741a12.344 12.344 0 0 0-.4 2.741H7.5V5.091c-.91-.03-1.783-.145-2.591-.332zM8.5 5.09V7.5h2.99a12.342 12.342 0 0 0-.399-2.741c-.808.187-1.681.301-2.591.332zM4.51 8.5c.035.987.176 1.914.399 2.741A13.612 13.612 0 0 1 7.5 10.91V8.5H4.51zm3.99 0v2.409c.91.03 1.783.145 2.591.332.223-.827.364-1.754.4-2.741H8.5zm-3.282 3.696c.12.312.252.604.395.872.552 1.035 1.218 1.65 1.887 1.855V11.91c-.81.03-1.577.13-2.282.287zm.11 2.276a6.696 6.696 0 0 1-.598-.933 8.853 8.853 0 0 1-.481-1.079 8.38 8.38 0 0 0-1.198.49 7.01 7.01 0 0 0 2.276 1.522zm-1.383-2.964A13.36 13.36 0 0 1 3.508 8.5h-2.49a6.963 6.963 0 0 0 1.362 3.675c.47-.258.995-.482 1.565-.667zm6.728 2.964a7.009 7.009 0 0 0 2.275-1.521 8.376 8.376 0 0 0-1.197-.49 8.853 8.853 0 0 1-.481 1.078 6.688 6.688 0 0 1-.597.933zM8.5 11.909v3.014c.67-.204 1.335-.82 1.887-1.855.143-.268.276-.56.395-.872A12.63 12.63 0 0 0 8.5 11.91zm3.555-.401c.57.185 1.095.409 1.565.667A6.963 6.963 0 0 0 14.982 8.5h-2.49a13.36 13.36 0 0 1-.437 3.008zM14.982 7.5a6.963 6.963 0 0 0-1.362-3.675c-.47.258-.995.482-1.565.667.248.92.4 1.938.437 3.008h2.49zM11.27 2.461c.177.334.339.694.482 1.078a8.368 8.368 0 0 0 1.196-.49 7.01 7.01 0 0 0-2.275-1.52c.218.283.418.597.597.932zm-.488 1.343a7.765 7.765 0 0 0-.395-.872C9.835 1.897 9.17 1.282 8.5 1.077V4.09c.81-.03 1.577-.13 2.282-.287z"),set_svg_attributes(n,f),toggle_class(n,"bi",!0),toggle_class(n,"bi-globe2",!0)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),append_hydration(n,i),r=!0},p(d,[p]){o&&o.p&&(!r||p&2)&&update_slot_base(o,s,d,d[1],r?get_slot_changes(s,d[1],p,null):get_all_dirty_from_scope(d[1]),null),set_svg_attributes(n,f=get_spread_update(l,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},p&1&&d[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-globe2",!0)},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$q(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class Globe2 extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$q,create_fragment$q,safe_not_equal,{})}}function create_fragment$p(e){let n,i,r;const s=e[2].default,o=create_slot(s,e,e[1],null);let l=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=svg_element("svg"),o&&o.c(),i=svg_element("path"),this.h()},l(d){n=claim_svg_element(d,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var p=children$2(n);o&&o.l(p),i=claim_svg_element(p,"path",{d:!0}),children$2(i).forEach(detach),p.forEach(detach),this.h()},h(){attr$6(i,"d","M8.39 12.648a1.32 1.32 0 0 0-.015.18c0 .305.21.508.5.508.266 0 .492-.172.555-.477l.554-2.703h1.204c.421 0 .617-.234.617-.547 0-.312-.188-.53-.617-.53h-.985l.516-2.524h1.265c.43 0 .618-.227.618-.547 0-.313-.188-.524-.618-.524h-1.046l.476-2.304a1.06 1.06 0 0 0 .016-.164.51.51 0 0 0-.516-.516.54.54 0 0 0-.539.43l-.523 2.554H7.617l.477-2.304c.008-.04.015-.118.015-.164a.512.512 0 0 0-.523-.516.539.539 0 0 0-.531.43L6.53 5.484H5.414c-.43 0-.617.22-.617.532 0 .312.187.539.617.539h.906l-.515 2.523H4.609c-.421 0-.609.219-.609.531 0 .313.188.547.61.547h.976l-.516 2.492c-.008.04-.015.125-.015.18 0 .305.21.508.5.508.265 0 .492-.172.554-.477l.555-2.703h2.242l-.515 2.492zm-1-6.109h2.266l-.515 2.563H6.859l.532-2.563z"),set_svg_attributes(n,f),toggle_class(n,"bi",!0),toggle_class(n,"bi-hash",!0)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),append_hydration(n,i),r=!0},p(d,[p]){o&&o.p&&(!r||p&2)&&update_slot_base(o,s,d,d[1],r?get_slot_changes(s,d[1],p,null):get_all_dirty_from_scope(d[1]),null),set_svg_attributes(n,f=get_spread_update(l,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},p&1&&d[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-hash",!0)},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$p(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class Hash extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$p,create_fragment$p,safe_not_equal,{})}}function create_fragment$o(e){let n,i,r,s;const o=e[2].default,l=create_slot(o,e,e[1],null);let f=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],d={};for(let p=0;p<f.length;p+=1)d=assign(d,f[p]);return{c(){n=svg_element("svg"),l&&l.c(),i=svg_element("path"),r=svg_element("path"),this.h()},l(p){n=claim_svg_element(p,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var g=children$2(n);l&&l.l(g),i=claim_svg_element(g,"path",{d:!0}),children$2(i).forEach(detach),r=claim_svg_element(g,"path",{d:!0}),children$2(r).forEach(detach),g.forEach(detach),this.h()},h(){attr$6(i,"d","M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"),attr$6(r,"d","M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"),set_svg_attributes(n,d),toggle_class(n,"bi",!0),toggle_class(n,"bi-image",!0)},m(p,g){insert_hydration(p,n,g),l&&l.m(n,null),append_hydration(n,i),append_hydration(n,r),s=!0},p(p,[g]){l&&l.p&&(!s||g&2)&&update_slot_base(l,o,p,p[1],s?get_slot_changes(o,p[1],g,null):get_all_dirty_from_scope(p[1]),null),set_svg_attributes(n,d=get_spread_update(f,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},g&1&&p[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-image",!0)},i(p){s||(transition_in(l,p),s=!0)},o(p){transition_out(l,p),s=!1},d(p){p&&detach(n),l&&l.d(p)}}}function instance$o(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}let Image$2=class extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$o,create_fragment$o,safe_not_equal,{})}};function create_fragment$n(e){let n,i,r;const s=e[2].default,o=create_slot(s,e,e[1],null);let l=[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},e[0]],f={};for(let d=0;d<l.length;d+=1)f=assign(f,l[d]);return{c(){n=svg_element("svg"),o&&o.c(),i=svg_element("path"),this.h()},l(d){n=claim_svg_element(d,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var p=children$2(n);o&&o.l(p),i=claim_svg_element(p,"path",{d:!0}),children$2(i).forEach(detach),p.forEach(detach),this.h()},h(){attr$6(i,"d","M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0v1.829Zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707L14 2.707ZM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707L7.293 4Zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1h1.829Zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1h1.829ZM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707L13.293 10ZM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0v1.829Zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0L8.354 9.06Z"),set_svg_attributes(n,f),toggle_class(n,"bi",!0),toggle_class(n,"bi-magic",!0)},m(d,p){insert_hydration(d,n,p),o&&o.m(n,null),append_hydration(n,i),r=!0},p(d,[p]){o&&o.p&&(!r||p&2)&&update_slot_base(o,s,d,d[1],r?get_slot_changes(s,d[1],p,null):get_all_dirty_from_scope(d[1]),null),set_svg_attributes(n,f=get_spread_update(l,[{xmlns:"http://www.w3.org/2000/svg"},{width:"16"},{height:"16"},{fill:"currentColor"},{viewBox:"0 0 16 16"},p&1&&d[0]])),toggle_class(n,"bi",!0),toggle_class(n,"bi-magic",!0)},i(d){r||(transition_in(o,d),r=!0)},o(d){transition_out(o,d),r=!1},d(d){d&&detach(n),o&&o.d(d)}}}function instance$n(e,n,i){const r=[];let s=compute_rest_props(n,r),{$$slots:o={},$$scope:l}=n;return e.$$set=f=>{n=assign(assign({},n),exclude_internal_props(f)),i(0,s=compute_rest_props(n,r)),"$$scope"in f&&i(1,l=f.$$scope)},[s,l,o]}class Magic extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$n,create_fragment$n,safe_not_equal,{})}}function get_each_context$5(e,n,i){const r=e.slice();return r[2]=n[i][0],r[3]=n[i][1],r}function create_each_block$5(e){let n,i,r=e[2]+"",s,o,l,f=e[1](e[3])+"",d,p;return{c(){n=element$2("div"),i=element$2("div"),s=text$3(r),o=space(),l=element$2("div"),d=text$3(f),p=space(),this.h()},l(g){n=claim_element(g,"DIV",{class:!0});var v=children$2(n);i=claim_element(v,"DIV",{class:!0});var S=children$2(i);s=claim_text(S,r),S.forEach(detach),o=claim_space(v),l=claim_element(v,"DIV",{class:!0});var T=children$2(l);d=claim_text(T,f),T.forEach(detach),p=claim_space(v),v.forEach(detach),this.h()},h(){attr$6(i,"class","text-slate-400 text-md px-2 self-center"),attr$6(l,"class","font-bold text-xl self-center"),attr$6(n,"class","bg-slate-100 rounded-md flex flex-col shadow-sm py-0.5")},m(g,v){insert_hydration(g,n,v),append_hydration(n,i),append_hydration(i,s),append_hydration(n,o),append_hydration(n,l),append_hydration(l,d),append_hydration(n,p)},p(g,v){v&1&&r!==(r=g[2]+"")&&set_data(s,r),v&1&&f!==(f=g[1](g[3])+"")&&set_data(d,f)},d(g){g&&detach(n)}}}function create_fragment$m(e){let n,i=Object.entries(e[0]),r=[];for(let s=0;s<i.length;s+=1)r[s]=create_each_block$5(get_each_context$5(e,i,s));return{c(){n=element$2("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){n=claim_element(s,"DIV",{class:!0});var o=children$2(n);for(let l=0;l<r.length;l+=1)r[l].l(o);o.forEach(detach),this.h()},h(){attr$6(n,"class","m-2 flex flex-wrap justify-center gap-x-2 gap-y-2")},m(s,o){insert_hydration(s,n,o);for(let l=0;l<r.length;l+=1)r[l].m(n,null)},p(s,[o]){if(o&3){i=Object.entries(s[0]);let l;for(l=0;l<i.length;l+=1){const f=get_each_context$5(s,i,l);r[l]?r[l].p(f,o):(r[l]=create_each_block$5(f),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=i.length}},i:noop$6,o:noop$6,d(s){s&&detach(n),destroy_each(r,s)}}}function instance$m(e,n,i){let{data:r={}}=n;const s=o=>{if(Number.isInteger(o)&&o<1e3)return o.toString();const l=[["B",9],["M",6],["K",3]];let f=o.toFixed(2);for(let d=0;d<l.length;d++){const p=l[d][0],g=Math.pow(10,l[d][1]);if(o>=g){f=`${(o/g).toFixed(2)}${p}`;break}}return f};return e.$$set=o=>{"data"in o&&i(0,r=o.data)},[r,s]}class Stats extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$m,create_fragment$m,safe_not_equal,{data:0})}}function create_fragment$l(e){let n,i,r;var s=e[1][e[0]];function o(l){return{}}return s&&(n=construct_svelte_component(s,o())),{c(){n&&create_component(n.$$.fragment),i=empty()},l(l){n&&claim_component(n.$$.fragment,l),i=empty()},m(l,f){n&&mount_component(n,l,f),insert_hydration(l,i,f),r=!0},p(l,[f]){if(s!==(s=l[1][l[0]])){if(n){group_outros();const d=n;transition_out(d.$$.fragment,1,0,()=>{destroy_component(d,1)}),check_outros()}s?(n=construct_svelte_component(s,o()),create_component(n.$$.fragment),transition_in(n.$$.fragment,1),mount_component(n,i.parentNode,i)):n=null}},i(l){r||(n&&transition_in(n.$$.fragment,l),r=!0)},o(l){n&&transition_out(n.$$.fragment,l),r=!1},d(l){l&&detach(i),n&&destroy_component(n,l)}}}function instance$l(e,n,i){let{name:r="Globe2"}=n;const s={Globe2,CodeSlash,CodeSquare,Code:Code$1,Image:Image$2,FileEarmarkImage,FileEarmarkFont,Hash,Magic,FileEarmarkPdf,BoxFill,CheckSquare};return e.$$set=o=>{"name"in o&&i(0,r=o.name)},[r,s]}class Icon extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$l,create_fragment$l,safe_not_equal,{name:0})}}function create_if_block_3$1(e){let n,i,r,s,o;return{c(){n=svg_element("svg"),i=svg_element("path"),r=space(),s=element$2("span"),o=text$3("Error icon"),this.h()},l(l){n=claim_svg_element(l,"svg",{"aria-hidden":!0,class:!0,fill:!0,viewBox:!0,xmlns:!0});var f=children$2(n);i=claim_svg_element(f,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),children$2(i).forEach(detach),f.forEach(detach),r=claim_space(l),s=claim_element(l,"SPAN",{class:!0});var d=children$2(s);o=claim_text(d,"Error icon"),d.forEach(detach),this.h()},h(){attr$6(i,"fill-rule","evenodd"),attr$6(i,"d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"),attr$6(i,"clip-rule","evenodd"),attr$6(n,"aria-hidden","true"),attr$6(n,"class","w-5 h-5"),attr$6(n,"fill","currentColor"),attr$6(n,"viewBox","0 0 20 20"),attr$6(n,"xmlns","http://www.w3.org/2000/svg"),attr$6(s,"class","sr-only")},m(l,f){insert_hydration(l,n,f),append_hydration(n,i),insert_hydration(l,r,f),insert_hydration(l,s,f),append_hydration(s,o)},p:noop$6,i:noop$6,o:noop$6,d(l){l&&detach(n),l&&detach(r),l&&detach(s)}}}function create_if_block_2$1(e){let n,i,r;return{c(){n=svg_element("svg"),i=svg_element("path"),r=svg_element("path"),this.h()},l(s){n=claim_svg_element(s,"svg",{"aria-hidden":!0,class:!0,viewBox:!0,fill:!0,xmlns:!0});var o=children$2(n);i=claim_svg_element(o,"path",{d:!0,fill:!0}),children$2(i).forEach(detach),r=claim_svg_element(o,"path",{d:!0,fill:!0}),children$2(r).forEach(detach),o.forEach(detach),this.h()},h(){attr$6(i,"d","M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"),attr$6(i,"fill","currentColor"),attr$6(r,"d","M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"),attr$6(r,"fill","currentFill"),attr$6(n,"aria-hidden","true"),attr$6(n,"class","w-6 h-6 text-gray-300 animate-spin fill-violet-600"),attr$6(n,"viewBox","0 0 100 101"),attr$6(n,"fill","none"),attr$6(n,"xmlns","http://www.w3.org/2000/svg")},m(s,o){insert_hydration(s,n,o),append_hydration(n,i),append_hydration(n,r)},p:noop$6,i:noop$6,o:noop$6,d(s){s&&detach(n)}}}function create_if_block_1$2(e){let n,i,r,s,o;return{c(){n=svg_element("svg"),i=svg_element("path"),r=space(),s=element$2("span"),o=text$3("Check icon"),this.h()},l(l){n=claim_svg_element(l,"svg",{"aria-hidden":!0,class:!0,fill:!0,viewBox:!0,xmlns:!0});var f=children$2(n);i=claim_svg_element(f,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),children$2(i).forEach(detach),f.forEach(detach),r=claim_space(l),s=claim_element(l,"SPAN",{class:!0});var d=children$2(s);o=claim_text(d,"Check icon"),d.forEach(detach),this.h()},h(){attr$6(i,"fill-rule","evenodd"),attr$6(i,"d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"),attr$6(i,"clip-rule","evenodd"),attr$6(n,"aria-hidden","true"),attr$6(n,"class","w-5 h-5"),attr$6(n,"fill","currentColor"),attr$6(n,"viewBox","0 0 20 20"),attr$6(n,"xmlns","http://www.w3.org/2000/svg"),attr$6(s,"class","sr-only")},m(l,f){insert_hydration(l,n,f),append_hydration(n,i),insert_hydration(l,r,f),insert_hydration(l,s,f),append_hydration(s,o)},p:noop$6,i:noop$6,o:noop$6,d(l){l&&detach(n),l&&detach(r),l&&detach(s)}}}function create_if_block$4(e){let n,i;return n=new Icon({props:{name:e[1]}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s&2&&(o.name=r[1]),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_fragment$k(e){let n,i,r,s,o,l,f,d,p,g,v;const S=[create_if_block$4,create_if_block_1$2,create_if_block_2$1,create_if_block_3$1],T=[];function k(O,R){return O[3]==="waiting"?0:O[3]==="success"?1:O[3]==="working"?2:O[3]==="error"?3:-1}return~(s=k(e))&&(o=T[s]=S[s](e)),{c(){n=element$2("div"),i=element$2("button"),r=element$2("div"),o&&o.c(),l=space(),f=text$3(e[0]),this.h()},l(O){n=claim_element(O,"DIV",{class:!0});var R=children$2(n);i=claim_element(R,"BUTTON",{});var P=children$2(i);r=claim_element(P,"DIV",{class:!0});var F=children$2(r);o&&o.l(F),l=claim_space(F),f=claim_text(F,e[0]),F.forEach(detach),P.forEach(detach),R.forEach(detach),this.h()},h(){attr$6(r,"class","flex flex-row gap-1 items-center"),attr$6(n,"class",d="w-fit bg-slate-100 py-1 px-2 rounded-md flex items-center text-slate-600 hover:bg-slate-200"+e[2])},m(O,R){insert_hydration(O,n,R),append_hydration(n,i),append_hydration(i,r),~s&&T[s].m(r,null),append_hydration(r,l),append_hydration(r,f),p=!0,g||(v=listen(i,"click",e[4]),g=!0)},p(O,[R]){let P=s;s=k(O),s===P?~s&&T[s].p(O,R):(o&&(group_outros(),transition_out(T[P],1,1,()=>{T[P]=null}),check_outros()),~s?(o=T[s],o?o.p(O,R):(o=T[s]=S[s](O),o.c()),transition_in(o,1),o.m(r,l)):o=null),(!p||R&1)&&set_data(f,O[0]),(!p||R&4&&d!==(d="w-fit bg-slate-100 py-1 px-2 rounded-md flex items-center text-slate-600 hover:bg-slate-200"+O[2]))&&attr$6(n,"class",d)},i(O){p||(transition_in(o),p=!0)},o(O){transition_out(o),p=!1},d(O){O&&detach(n),~s&&T[s].d(),g=!1,v()}}}const DELAY=3e3;function instance$k(e,n,i){let{title:r=""}=n,{icon:s=null}=n,{onClick:o=()=>{}}=n,{classes:l=""}=n;console.log("here"),console.log(o);let f="waiting";const d=p=>{i(3,f="working"),dispatch$1(o.endpointId,{detail:{}}).then(async()=>{i(3,f="success"),await new Promise(v=>setTimeout(v,DELAY)),i(3,f="waiting")}).catch(async v=>{i(3,f="error"),await new Promise(S=>setTimeout(S,DELAY)),i(3,f="waiting")})};return e.$$set=p=>{"title"in p&&i(0,r=p.title),"icon"in p&&i(1,s=p.icon),"onClick"in p&&i(5,o=p.onClick),"classes"in p&&i(2,l=p.classes)},[r,s,l,f,d,o]}class Button extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$k,create_fragment$k,safe_not_equal,{title:0,icon:1,onClick:5,classes:2})}}const get_time_slot_changes=e=>({}),get_time_slot_context=e=>({}),get_name_slot_changes=e=>({}),get_name_slot_context=e=>({}),get_avatar_slot_changes=e=>({}),get_avatar_slot_context=e=>({});function fallback_block_1(e){let n,i;return{c(){n=element$2("span"),i=text$3(e[1]),this.h()},l(r){n=claim_element(r,"SPAN",{class:!0});var s=children$2(n);i=claim_text(s,e[1]),s.forEach(detach),this.h()},h(){attr$6(n,"class","font-bold")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},p(r,s){s&2&&set_data(i,r[1])},d(r){r&&detach(n)}}}function fallback_block(e){let n,i;return{c(){n=element$2("span"),i=text$3(e[2]),this.h()},l(r){n=claim_element(r,"SPAN",{class:!0});var s=children$2(n);i=claim_text(s,e[2]),s.forEach(detach),this.h()},h(){attr$6(n,"class","text-gray-500")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},p(r,s){s&4&&set_data(i,r[2])},d(r){r&&detach(n)}}}function create_fragment$j(e){let n,i,r,s,o,l,f,d,p;const g=e[4].avatar,v=create_slot(g,e,e[3],get_avatar_slot_context),S=e[4].name,T=create_slot(S,e,e[3],get_name_slot_context),k=T||fallback_block_1(e),O=e[4].time,R=create_slot(O,e,e[3],get_time_slot_context),P=R||fallback_block(e);return{c(){n=element$2("div"),v&&v.c(),i=space(),r=element$2("div"),s=element$2("p"),k&&k.c(),o=space(),P&&P.c(),l=space(),f=element$2("p"),d=text$3(e[0]),this.h()},l(F){n=claim_element(F,"DIV",{class:!0});var I=children$2(n);v&&v.l(I),i=claim_space(I),r=claim_element(I,"DIV",{class:!0});var L=children$2(r);s=claim_element(L,"P",{class:!0});var N=children$2(s);k&&k.l(N),o=claim_space(N),P&&P.l(N),N.forEach(detach),l=claim_space(L),f=claim_element(L,"P",{class:!0});var j=children$2(f);d=claim_text(j,e[0]),j.forEach(detach),L.forEach(detach),I.forEach(detach),this.h()},h(){attr$6(s,"class","flex justify-between"),attr$6(f,"class","text-gray-800 whitespace-pre-line"),attr$6(r,"class","ml-2 w-full"),attr$6(n,"class","flex ml-2 pl-4 pr-4 mb-4")},m(F,I){insert_hydration(F,n,I),v&&v.m(n,null),append_hydration(n,i),append_hydration(n,r),append_hydration(r,s),k&&k.m(s,null),append_hydration(s,o),P&&P.m(s,null),append_hydration(r,l),append_hydration(r,f),append_hydration(f,d),p=!0},p(F,[I]){v&&v.p&&(!p||I&8)&&update_slot_base(v,g,F,F[3],p?get_slot_changes(g,F[3],I,get_avatar_slot_changes):get_all_dirty_from_scope(F[3]),get_avatar_slot_context),T?T.p&&(!p||I&8)&&update_slot_base(T,S,F,F[3],p?get_slot_changes(S,F[3],I,get_name_slot_changes):get_all_dirty_from_scope(F[3]),get_name_slot_context):k&&k.p&&(!p||I&2)&&k.p(F,p?I:-1),R?R.p&&(!p||I&8)&&update_slot_base(R,O,F,F[3],p?get_slot_changes(O,F[3],I,get_time_slot_changes):get_all_dirty_from_scope(F[3]),get_time_slot_context):P&&P.p&&(!p||I&4)&&P.p(F,p?I:-1),(!p||I&1)&&set_data(d,F[0])},i(F){p||(transition_in(v,F),transition_in(k,F),transition_in(P,F),p=!0)},o(F){transition_out(v,F),transition_out(k,F),transition_out(P,F),p=!1},d(F){F&&detach(n),v&&v.d(F),k&&k.d(F),P&&P.d(F)}}}function instance$j(e,n,i){let{$$slots:r={},$$scope:s}=n,{message:o}=n,{name:l}=n,{time:f}=n;return e.$$set=d=>{"message"in d&&i(0,o=d.message),"name"in d&&i(1,l=d.name),"time"in d&&i(2,f=d.time),"$$scope"in d&&i(3,s=d.$$scope)},[o,l,f,s,r]}class Message extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$j,create_fragment$j,safe_not_equal,{message:0,name:1,time:2})}}function get_each_context$4(e,n,i){const r=e.slice();return r[10]=n[i],r[12]=i,r}function create_catch_block(e){return{c:noop$6,l:noop$6,m:noop$6,p:noop$6,i:noop$6,o:noop$6,d:noop$6}}function create_then_block(e){let n,i,r=e[9].rows,s=[];for(let l=0;l<r.length;l+=1)s[l]=create_each_block$4(get_each_context$4(e,r,l));const o=l=>transition_out(s[l],1,1,()=>{s[l]=null});return{c(){for(let l=0;l<s.length;l+=1)s[l].c();n=empty()},l(l){for(let f=0;f<s.length;f+=1)s[f].l(l);n=empty()},m(l,f){for(let d=0;d<s.length;d+=1)s[d].m(l,f);insert_hydration(l,n,f),i=!0},p(l,f){if(f&11){r=l[9].rows;let d;for(d=0;d<r.length;d+=1){const p=get_each_context$4(l,r,d);s[d]?(s[d].p(p,f),transition_in(s[d],1)):(s[d]=create_each_block$4(p),s[d].c(),transition_in(s[d],1),s[d].m(n.parentNode,n))}for(group_outros(),d=r.length;d<s.length;d+=1)o(d);check_outros()}},i(l){if(!i){for(let f=0;f<r.length;f+=1)transition_in(s[f]);i=!0}},o(l){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)transition_out(s[f]);i=!1},d(l){destroy_each(s,l),l&&detach(n)}}}function create_avatar_slot(e){let n,i,r;return n=new Avatar({props:{src:e[9].getCell(e[9].fullLength-e[12]-1,"sender").data==="chatbot"?e[0]:e[1],stacked:!0,class:"mr-2"}}),{c(){create_component(n.$$.fragment),i=space()},l(s){claim_component(n.$$.fragment,s),i=claim_space(s)},m(s,o){mount_component(n,s,o),insert_hydration(s,i,o),r=!0},p(s,o){const l={};o&11&&(l.src=s[9].getCell(s[9].fullLength-s[12]-1,"sender").data==="chatbot"?s[0]:s[1]),n.$set(l)},i(s){r||(transition_in(n.$$.fragment,s),r=!0)},o(s){transition_out(n.$$.fragment,s),r=!1},d(s){destroy_component(n,s),s&&detach(i)}}}function create_each_block$4(e){let n,i;return n=new Message({props:{message:e[9].getCell(e[9].fullLength-e[12]-1,"message").data,name:e[9].getCell(e[9].fullLength-e[12]-1,"name").data,time:e[9].getCell(e[9].fullLength-e[12]-1,"time").data,$$slots:{avatar:[create_avatar_slot]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s&8&&(o.message=r[9].getCell(r[9].fullLength-r[12]-1,"message").data),s&8&&(o.name=r[9].getCell(r[9].fullLength-r[12]-1,"name").data),s&8&&(o.time=r[9].getCell(r[9].fullLength-r[12]-1,"time").data),s&8203&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_pending_block(e){return{c:noop$6,l:noop$6,m:noop$6,p:noop$6,i:noop$6,o:noop$6,d:noop$6}}function create_default_slot$4(e){let n,i;return{c(){n=svg_element("svg"),i=svg_element("path"),this.h()},l(r){n=claim_svg_element(r,"svg",{fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=children$2(n);i=claim_svg_element(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),children$2(i).forEach(detach),s.forEach(detach),this.h()},h(){attr$6(i,"stroke-linecap","round"),attr$6(i,"stroke-linejoin","round"),attr$6(i,"d","M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"),attr$6(n,"fill","none"),attr$6(n,"viewBox","0 0 24 24"),attr$6(n,"stroke-width","1.5"),attr$6(n,"stroke","currentColor"),attr$6(n,"class","w-6 h-6")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},p:noop$6,d(r){r&&detach(n)}}}function create_fragment$i(e){let n,i,r,s,o,l,f,d,p,g,v={ctx:e,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,value:9,blocks:[,,,]};handle_promise(r=e[3],v);function S(k){e[6](k)}let T={rows:"5",placeholder:"Your message...",class:"mx-4 resize-none"};return e[2]!==void 0&&(T.value=e[2]),l=new Textarea({props:T}),binding_callbacks.push(()=>bind$3(l,"value",S)),l.$on("keyup",e[7]),p=new Button$1({props:{class:"text-violet-600 dark:text-violet-500",color:"light",$$slots:{default:[create_default_slot$4]},$$scope:{ctx:e}}}),p.$on("click",e[4]),{c(){n=element$2("div"),i=element$2("div"),v.block.c(),s=space(),o=element$2("div"),create_component(l.$$.fragment),d=space(),create_component(p.$$.fragment),this.h()},l(k){n=claim_element(k,"DIV",{class:!0});var O=children$2(n);i=claim_element(O,"DIV",{class:!0});var R=children$2(i);v.block.l(R),R.forEach(detach),s=claim_space(O),o=claim_element(O,"DIV",{class:!0});var P=children$2(o);claim_component(l.$$.fragment,P),d=claim_space(P),claim_component(p.$$.fragment,P),P.forEach(detach),O.forEach(detach),this.h()},h(){attr$6(i,"class","flex flex-col-reverse overflow-y-scroll"),attr$6(o,"class","flex mt-4"),attr$6(n,"class","h-full bg-violet-100 p-4 rounded-lg flex flex-col justify-between shadow-md")},m(k,O){insert_hydration(k,n,O),append_hydration(n,i),v.block.m(i,v.anchor=null),v.mount=()=>i,v.anchor=null,append_hydration(n,s),append_hydration(n,o),mount_component(l,o,null),append_hydration(o,d),mount_component(p,o,null),g=!0},p(k,[O]){e=k,v.ctx=e,O&8&&r!==(r=e[3])&&handle_promise(r,v)||update_await_block_branch(v,e,O);const R={};!f&&O&4&&(f=!0,R.value=e[2],add_flush_callback(()=>f=!1)),l.$set(R);const P={};O&8192&&(P.$$scope={dirty:O,ctx:e}),p.$set(P)},i(k){g||(transition_in(v.block),transition_in(l.$$.fragment,k),transition_in(p.$$.fragment,k),g=!0)},o(k){for(let O=0;O<3;O+=1){const R=v.blocks[O];transition_out(R)}transition_out(l.$$.fragment,k),transition_out(p.$$.fragment,k),g=!1},d(k){k&&detach(n),v.block.d(),v.token=null,v=null,destroy_component(l),destroy_component(p)}}}function instance$i(e,n,i){let r;const s=createEventDispatcher();let{df:o}=n,{imgChatbot:l}=n,{imgUser:f}=n,d="",p=()=>{s("send",{message:d}),i(2,d="")};function g(S){d=S,i(2,d)}const v=S=>{S.key==="Enter"&&!S.shiftKey&&p()};return e.$$set=S=>{"df"in S&&i(5,o=S.df),"imgChatbot"in S&&i(0,l=S.imgChatbot),"imgUser"in S&&i(1,f=S.imgUser)},e.$$.update=()=>{e.$$.dirty&32&&i(3,r=fetchChunk({df:o,start:0,end:1e5}))},[l,f,d,r,p,o,g,v]}class Chat extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$i,create_fragment$i,safe_not_equal,{df:5,imgChatbot:0,imgUser:1})}}function create_default_slot$3(e){let n;const i=e[6].default,r=create_slot(i,e,e[11],null);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&2048)&&update_slot_base(r,i,s,s[11],n?get_slot_changes(i,s[11],o,null):get_all_dirty_from_scope(s[11]),null)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_fragment$h(e){let n,i,r,s,o,l;function f(v){e[7](v)}function d(v){e[8](v)}function p(v){e[9](v)}let g={$$slots:{default:[create_default_slot$3]},$$scope:{ctx:e}};return e[0]!==void 0&&(g.checked=e[0]),e[1]!==void 0&&(g.disabled=e[1]),e[2]!==void 0&&(g.color=e[2]),i=new Checkbox({props:g}),binding_callbacks.push(()=>bind$3(i,"checked",f)),binding_callbacks.push(()=>bind$3(i,"disabled",d)),binding_callbacks.push(()=>bind$3(i,"color",p)),i.$on("change",e[10]),{c(){n=element$2("div"),create_component(i.$$.fragment),this.h()},l(v){n=claim_element(v,"DIV",{class:!0});var S=children$2(n);claim_component(i.$$.fragment,S),S.forEach(detach),this.h()},h(){attr$6(n,"class",e[3])},m(v,S){insert_hydration(v,n,S),mount_component(i,n,null),l=!0},p(v,[S]){const T={};S&2048&&(T.$$scope={dirty:S,ctx:v}),!r&&S&1&&(r=!0,T.checked=v[0],add_flush_callback(()=>r=!1)),!s&&S&2&&(s=!0,T.disabled=v[1],add_flush_callback(()=>s=!1)),!o&&S&4&&(o=!0,T.color=v[2],add_flush_callback(()=>o=!1)),i.$set(T),(!l||S&8)&&attr$6(n,"class",v[3])},i(v){l||(transition_in(i.$$.fragment,v),l=!0)},o(v){transition_out(i.$$.fragment,v),l=!1},d(v){v&&detach(n),destroy_component(i)}}}function instance$h(e,n,i){let{$$slots:r={},$$scope:s}=n,{checked:o=!1}=n,{disabled:l=!1}=n,{color:f="purple"}=n,{classes:d=""}=n;const p=getContext$1("cellEdit"),g=createEventDispatcher();function v(O){o=O,i(0,o)}function S(O){l=O,i(1,l)}function T(O){f=O,i(2,f)}const k=O=>{p(o),g("change")};return e.$$set=O=>{"checked"in O&&i(0,o=O.checked),"disabled"in O&&i(1,l=O.disabled),"color"in O&&i(2,f=O.color),"classes"in O&&i(3,d=O.classes),"$$scope"in O&&i(11,s=O.$$scope)},[o,l,f,d,p,g,r,v,S,T,k,s]}class Checkbox_1 extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$h,create_fragment$h,safe_not_equal,{checked:0,disabled:1,color:2,classes:3})}}var prismExports={},prism={get exports(){return prismExports},set exports(e){prismExports=e}};(function(e){var n=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var i=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,o=0,l={},f={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function F(I){return I instanceof d?new d(I.type,F(I.content),I.alias):Array.isArray(I)?I.map(F):I.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(F){return Object.prototype.toString.call(F).slice(8,-1)},objId:function(F){return F.__id||Object.defineProperty(F,"__id",{value:++o}),F.__id},clone:function F(I,L){L=L||{};var N,j;switch(f.util.type(I)){case"Object":if(j=f.util.objId(I),L[j])return L[j];N={},L[j]=N;for(var z in I)I.hasOwnProperty(z)&&(N[z]=F(I[z],L));return N;case"Array":return j=f.util.objId(I),L[j]?L[j]:(N=[],L[j]=N,I.forEach(function(q,H){N[H]=F(q,L)}),N);default:return I}},getLanguage:function(F){for(;F;){var I=s.exec(F.className);if(I)return I[1].toLowerCase();F=F.parentElement}return"none"},setLanguage:function(F,I){F.className=F.className.replace(RegExp(s,"gi"),""),F.classList.add("language-"+I)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(N){var F=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(N.stack)||[])[1];if(F){var I=document.getElementsByTagName("script");for(var L in I)if(I[L].src==F)return I[L]}return null}},isActive:function(F,I,L){for(var N="no-"+I;F;){var j=F.classList;if(j.contains(I))return!0;if(j.contains(N))return!1;F=F.parentElement}return!!L}},languages:{plain:l,plaintext:l,text:l,txt:l,extend:function(F,I){var L=f.util.clone(f.languages[F]);for(var N in I)L[N]=I[N];return L},insertBefore:function(F,I,L,N){N=N||f.languages;var j=N[F],z={};for(var q in j)if(j.hasOwnProperty(q)){if(q==I)for(var H in L)L.hasOwnProperty(H)&&(z[H]=L[H]);L.hasOwnProperty(q)||(z[q]=j[q])}var W=N[F];return N[F]=z,f.languages.DFS(f.languages,function(U,Q){Q===W&&U!=F&&(this[U]=z)}),z},DFS:function F(I,L,N,j){j=j||{};var z=f.util.objId;for(var q in I)if(I.hasOwnProperty(q)){L.call(I,q,I[q],N||q);var H=I[q],W=f.util.type(H);W==="Object"&&!j[z(H)]?(j[z(H)]=!0,F(H,L,null,j)):W==="Array"&&!j[z(H)]&&(j[z(H)]=!0,F(H,L,q,j))}}},plugins:{},highlightAll:function(F,I){f.highlightAllUnder(document,F,I)},highlightAllUnder:function(F,I,L){var N={callback:L,container:F,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};f.hooks.run("before-highlightall",N),N.elements=Array.prototype.slice.apply(N.container.querySelectorAll(N.selector)),f.hooks.run("before-all-elements-highlight",N);for(var j=0,z;z=N.elements[j++];)f.highlightElement(z,I===!0,N.callback)},highlightElement:function(F,I,L){var N=f.util.getLanguage(F),j=f.languages[N];f.util.setLanguage(F,N);var z=F.parentElement;z&&z.nodeName.toLowerCase()==="pre"&&f.util.setLanguage(z,N);var q=F.textContent,H={element:F,language:N,grammar:j,code:q};function W(Q){H.highlightedCode=Q,f.hooks.run("before-insert",H),H.element.innerHTML=H.highlightedCode,f.hooks.run("after-highlight",H),f.hooks.run("complete",H),L&&L.call(H.element)}if(f.hooks.run("before-sanity-check",H),z=H.element.parentElement,z&&z.nodeName.toLowerCase()==="pre"&&!z.hasAttribute("tabindex")&&z.setAttribute("tabindex","0"),!H.code){f.hooks.run("complete",H),L&&L.call(H.element);return}if(f.hooks.run("before-highlight",H),!H.grammar){W(f.util.encode(H.code));return}if(I&&r.Worker){var U=new Worker(f.filename);U.onmessage=function(Q){W(Q.data)},U.postMessage(JSON.stringify({language:H.language,code:H.code,immediateClose:!0}))}else W(f.highlight(H.code,H.grammar,H.language))},highlight:function(F,I,L){var N={code:F,grammar:I,language:L};if(f.hooks.run("before-tokenize",N),!N.grammar)throw new Error('The language "'+N.language+'" has no grammar.');return N.tokens=f.tokenize(N.code,N.grammar),f.hooks.run("after-tokenize",N),d.stringify(f.util.encode(N.tokens),N.language)},tokenize:function(F,I){var L=I.rest;if(L){for(var N in L)I[N]=L[N];delete I.rest}var j=new v;return S(j,j.head,F),g(F,j,I,j.head,0),k(j)},hooks:{all:{},add:function(F,I){var L=f.hooks.all;L[F]=L[F]||[],L[F].push(I)},run:function(F,I){var L=f.hooks.all[F];if(!(!L||!L.length))for(var N=0,j;j=L[N++];)j(I)}},Token:d};r.Prism=f;function d(F,I,L,N){this.type=F,this.content=I,this.alias=L,this.length=(N||"").length|0}d.stringify=function F(I,L){if(typeof I=="string")return I;if(Array.isArray(I)){var N="";return I.forEach(function(W){N+=F(W,L)}),N}var j={type:I.type,content:F(I.content,L),tag:"span",classes:["token",I.type],attributes:{},language:L},z=I.alias;z&&(Array.isArray(z)?Array.prototype.push.apply(j.classes,z):j.classes.push(z)),f.hooks.run("wrap",j);var q="";for(var H in j.attributes)q+=" "+H+'="'+(j.attributes[H]||"").replace(/"/g,"&quot;")+'"';return"<"+j.tag+' class="'+j.classes.join(" ")+'"'+q+">"+j.content+"</"+j.tag+">"};function p(F,I,L,N){F.lastIndex=I;var j=F.exec(L);if(j&&N&&j[1]){var z=j[1].length;j.index+=z,j[0]=j[0].slice(z)}return j}function g(F,I,L,N,j,z){for(var q in L)if(!(!L.hasOwnProperty(q)||!L[q])){var H=L[q];H=Array.isArray(H)?H:[H];for(var W=0;W<H.length;++W){if(z&&z.cause==q+","+W)return;var U=H[W],Q=U.inside,J=!!U.lookbehind,ne=!!U.greedy,G=U.alias;if(ne&&!U.pattern.global){var Z=U.pattern.toString().match(/[imsuy]*$/)[0];U.pattern=RegExp(U.pattern.source,Z+"g")}for(var ae=U.pattern||U,oe=N.next,pe=j;oe!==I.tail&&!(z&&pe>=z.reach);pe+=oe.value.length,oe=oe.next){var Se=oe.value;if(I.length>F.length)return;if(!(Se instanceof d)){var ue=1,ee;if(ne){if(ee=p(ae,pe,F,J),!ee||ee.index>=F.length)break;var he=ee.index,V=ee.index+ee[0].length,se=pe;for(se+=oe.value.length;he>=se;)oe=oe.next,se+=oe.value.length;if(se-=oe.value.length,pe=se,oe.value instanceof d)continue;for(var fe=oe;fe!==I.tail&&(se<V||typeof fe.value=="string");fe=fe.next)ue++,se+=fe.value.length;ue--,Se=F.slice(pe,se),ee.index-=pe}else if(ee=p(ae,0,Se,J),!ee)continue;var he=ee.index,be=ee[0],xe=Se.slice(0,he),ye=Se.slice(he+be.length),we=pe+Se.length;z&&we>z.reach&&(z.reach=we);var $e=oe.prev;xe&&($e=S(I,$e,xe),pe+=xe.length),T(I,$e,ue);var ve=new d(q,Q?f.tokenize(be,Q):be,G,be);if(oe=S(I,$e,ve),ye&&S(I,oe,ye),ue>1){var Te={cause:q+","+W,reach:we};g(F,I,L,oe.prev,pe,Te),z&&Te.reach>z.reach&&(z.reach=Te.reach)}}}}}}function v(){var F={value:null,prev:null,next:null},I={value:null,prev:F,next:null};F.next=I,this.head=F,this.tail=I,this.length=0}function S(F,I,L){var N=I.next,j={value:L,prev:I,next:N};return I.next=j,N.prev=j,F.length++,j}function T(F,I,L){for(var N=I.next,j=0;j<L&&N!==F.tail;j++)N=N.next;I.next=N,N.prev=I,F.length-=j}function k(F){for(var I=[],L=F.head.next;L!==F.tail;)I.push(L.value),L=L.next;return I}if(!r.document)return r.addEventListener&&(f.disableWorkerMessageHandler||r.addEventListener("message",function(F){var I=JSON.parse(F.data),L=I.language,N=I.code,j=I.immediateClose;r.postMessage(f.highlight(N,f.languages[L],L)),j&&r.close()},!1)),f;var O=f.util.currentScript();O&&(f.filename=O.src,O.hasAttribute("data-manual")&&(f.manual=!0));function R(){f.manual||f.highlightAll()}if(!f.manual){var P=document.readyState;P==="loading"||P==="interactive"&&O&&O.defer?document.addEventListener("DOMContentLoaded",R):window.requestAnimationFrame?window.requestAnimationFrame(R):window.setTimeout(R,16)}return f}(n);e.exports&&(e.exports=i),typeof commonjsGlobal<"u"&&(commonjsGlobal.Prism=i),i.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},i.languages.markup.tag.inside["attr-value"].inside.entity=i.languages.markup.entity,i.languages.markup.doctype.inside["internal-subset"].inside=i.languages.markup,i.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(i.languages.markup.tag,"addInlined",{value:function(s,o){var l={};l["language-"+o]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:i.languages[o]},l.cdata=/^<!\[CDATA\[|\]\]>$/i;var f={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:l}};f["language-"+o]={pattern:/[\s\S]+/,inside:i.languages[o]};var d={};d[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:f},i.languages.insertBefore("markup","cdata",d)}}),Object.defineProperty(i.languages.markup.tag,"addAttribute",{value:function(r,s){i.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:i.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),i.languages.html=i.languages.markup,i.languages.mathml=i.languages.markup,i.languages.svg=i.languages.markup,i.languages.xml=i.languages.extend("markup",{}),i.languages.ssml=i.languages.xml,i.languages.atom=i.languages.xml,i.languages.rss=i.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var o=r.languages.markup;o&&(o.tag.addInlined("style","css"),o.tag.addAttribute("style","css"))}(i),i.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},i.languages.javascript=i.languages.extend("clike",{"class-name":[i.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),i.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,i.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:i.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:i.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:i.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:i.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:i.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),i.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:i.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),i.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),i.languages.markup&&(i.languages.markup.tag.addInlined("script","javascript"),i.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),i.languages.js=i.languages.javascript,function(){if(typeof i>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(O,R){return" Error "+O+" while fetching file: "+R},o=" Error: File does not exist or is empty",l={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},f="data-src-status",d="loading",p="loaded",g="failed",v="pre[data-src]:not(["+f+'="'+p+'"]):not(['+f+'="'+d+'"])';function S(O,R,P){var F=new XMLHttpRequest;F.open("GET",O,!0),F.onreadystatechange=function(){F.readyState==4&&(F.status<400&&F.responseText?R(F.responseText):F.status>=400?P(s(F.status,F.statusText)):P(o))},F.send(null)}function T(O){var R=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(O||"");if(R){var P=Number(R[1]),F=R[2],I=R[3];return F?I?[P,Number(I)]:[P,void 0]:[P,P]}}i.hooks.add("before-highlightall",function(O){O.selector+=", "+v}),i.hooks.add("before-sanity-check",function(O){var R=O.element;if(R.matches(v)){O.code="",R.setAttribute(f,d);var P=R.appendChild(document.createElement("CODE"));P.textContent=r;var F=R.getAttribute("data-src"),I=O.language;if(I==="none"){var L=(/\.(\w+)$/.exec(F)||[,"none"])[1];I=l[L]||L}i.util.setLanguage(P,I),i.util.setLanguage(R,I);var N=i.plugins.autoloader;N&&N.loadLanguages(I),S(F,function(j){R.setAttribute(f,p);var z=T(R.getAttribute("data-range"));if(z){var q=j.split(/\r\n?|\n/g),H=z[0],W=z[1]==null?q.length:z[1];H<0&&(H+=q.length),H=Math.max(0,Math.min(H-1,q.length)),W<0&&(W+=q.length),W=Math.max(0,Math.min(W,q.length)),j=q.slice(H,W).join(`
`),R.hasAttribute("data-start")||R.setAttribute("data-start",String(H+1))}P.textContent=j,i.highlightElement(P)},function(j){R.setAttribute(f,g),P.textContent=j})}}),i.plugins.fileHighlight={highlight:function(R){for(var P=(R||document).querySelectorAll(v),F=0,I;I=P[F++];)i.highlightElement(I)}};var k=!1;i.fileHighlight=function(){k||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),k=!0),i.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(prism);const Prism=prismExports;function create_fragment$g(e){let n,i,r,s,o,l,f,d;return{c(){n=element$2("link"),r=space(),s=element$2("div"),o=element$2("pre"),l=element$2("code"),this.h()},l(p){const g=head_selector("svelte-1dsodst",document.head);n=claim_element(g,"LINK",{href:!0,rel:!0}),g.forEach(detach),r=claim_space(p),s=claim_element(p,"DIV",{class:!0});var v=children$2(s);o=claim_element(v,"PRE",{});var S=children$2(o);l=claim_element(S,"CODE",{class:!0});var T=children$2(l);T.forEach(detach),S.forEach(detach),v.forEach(detach),this.h()},h(){attr$6(n,"href",i="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-"+e[1]+".min.css"),attr$6(n,"rel","stylesheet"),attr$6(l,"class",f="language-"+e[0]),attr$6(s,"class",d="text-left whitespace-pre overflow-auto py-2 px-4 h-full aspect-video "+e[3]+" "+e[2])},m(p,g){append_hydration(document.head,n),insert_hydration(p,r,g),insert_hydration(p,s,g),append_hydration(s,o),append_hydration(o,l),l.innerHTML=e[4]},p(p,[g]){g&2&&i!==(i="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-"+p[1]+".min.css")&&attr$6(n,"href",i),g&16&&(l.innerHTML=p[4]),g&1&&f!==(f="language-"+p[0])&&attr$6(l,"class",f),g&12&&d!==(d="text-left whitespace-pre overflow-auto py-2 px-4 h-full aspect-video "+p[3]+" "+p[2])&&attr$6(s,"class",d)},i:noop$6,o:noop$6,d(p){detach(n),p&&detach(r),p&&detach(s)}}}function instance$g(e,n,i){let r,{body:s}=n,{language:o="python"}=n,{theme:l="okaidia"}=n,{classes:f=""}=n,{background:d="bg-slate-800"}=n;return e.$$set=p=>{"body"in p&&i(5,s=p.body),"language"in p&&i(0,o=p.language),"theme"in p&&i(1,l=p.theme),"classes"in p&&i(2,f=p.classes),"background"in p&&i(3,d=p.background)},e.$$.update=()=>{e.$$.dirty&33&&i(4,r=Prism.highlight(s,Prism.languages.js,o))},[o,l,f,d,r,s]}class Code extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$g,create_fragment$g,safe_not_equal,{body:5,language:0,theme:1,classes:2,background:3})}}const CopyButton_svelte_svelte_type_style_lang="",Document_svelte_svelte_type_style_lang="";function create_fragment$f(e){let n,i,r;function s(l){e[7](l)}let o={inputClass:e[1],webkitdirectory:e[2],directory:e[3],multiple:e[4]};return e[0]!==void 0&&(o.files=e[0]),n=new Fileupload({props:o}),binding_callbacks.push(()=>bind$3(n,"files",s)),n.$on("change",e[8]),n.$on("keyup",e[9]),n.$on("keydown",e[10]),n.$on("keypress",e[11]),n.$on("focus",e[12]),n.$on("blur",e[13]),n.$on("click",e[14]),n.$on("mouseover",e[15]),n.$on("mouseenter",e[16]),n.$on("mouseleave",e[17]),n.$on("paste",e[18]),{c(){create_component(n.$$.fragment)},l(l){claim_component(n.$$.fragment,l)},m(l,f){mount_component(n,l,f),r=!0},p(l,[f]){const d={};f&2&&(d.inputClass=l[1]),f&4&&(d.webkitdirectory=l[2]),f&8&&(d.directory=l[3]),f&16&&(d.multiple=l[4]),!i&&f&1&&(i=!0,d.files=l[0],add_flush_callback(()=>i=!1)),n.$set(d)},i(l){r||(transition_in(n.$$.fragment,l),r=!0)},o(l){transition_out(n.$$.fragment,l),r=!1},d(l){destroy_component(n,l)}}}function instance$f(e,n,i){const r=createEventDispatcher();let{files:s}=n,{filenames:o}=n,{contents:l}=n,{classes:f}=n,{webkitdirectory:d=!1}=n,{directory:p=!1}=n,{multiple:g=!1}=n,v=async H=>await Promise.all(Array.from(H).map(W=>W.text())),S=async()=>{i(6,l=await v(s)),r("upload",{filenames:Array.from(s).map(H=>H.name),contents:l})};function T(H){s=H,i(0,s)}function k(H){bubble.call(this,e,H)}function O(H){bubble.call(this,e,H)}function R(H){bubble.call(this,e,H)}function P(H){bubble.call(this,e,H)}function F(H){bubble.call(this,e,H)}function I(H){bubble.call(this,e,H)}function L(H){bubble.call(this,e,H)}function N(H){bubble.call(this,e,H)}function j(H){bubble.call(this,e,H)}function z(H){bubble.call(this,e,H)}function q(H){bubble.call(this,e,H)}return e.$$set=H=>{"files"in H&&i(0,s=H.files),"filenames"in H&&i(5,o=H.filenames),"contents"in H&&i(6,l=H.contents),"classes"in H&&i(1,f=H.classes),"webkitdirectory"in H&&i(2,d=H.webkitdirectory),"directory"in H&&i(3,p=H.directory),"multiple"in H&&i(4,g=H.multiple)},e.$$.update=()=>{e.$$.dirty&1&&i(5,o=Array.from(s).map(H=>H.name)),e.$$.dirty&1&&S()},[s,f,d,p,g,o,l,T,k,O,R,P,F,I,L,N,j,z,q]}class FileUpload extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$f,create_fragment$f,safe_not_equal,{files:0,filenames:5,contents:6,classes:1,webkitdirectory:2,directory:3,multiple:4})}}const Circle_svelte_svelte_type_style_lang="",Circle2_svelte_svelte_type_style_lang="",Circle3_svelte_svelte_type_style_lang="",DoubleBounce_svelte_svelte_type_style_lang="",GoogleSpin_svelte_svelte_type_style_lang="",ScaleOut_svelte_svelte_type_style_lang="",SpinLine_svelte_svelte_type_style_lang="",Stretch_svelte_svelte_type_style_lang="",BarLoader_svelte_svelte_type_style_lang="",Jumper_svelte_svelte_type_style_lang="",RingLoader_svelte_svelte_type_style_lang="",SyncLoader_svelte_svelte_type_style_lang="",Rainbow_svelte_svelte_type_style_lang="",Wave_svelte_svelte_type_style_lang="",Firework_svelte_svelte_type_style_lang="",Pulse_svelte_svelte_type_style_lang="",Jellyfish_svelte_svelte_type_style_lang="",Chasing_svelte_svelte_type_style_lang="",Shadow_svelte_svelte_type_style_lang="",Square_svelte_svelte_type_style_lang="",Moon_svelte_svelte_type_style_lang="",Plane_svelte_svelte_type_style_lang="",Diamonds_svelte_svelte_type_style_lang="",Clock_svelte_svelte_type_style_lang="";var VERSION="1.13.6",root$1=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},ArrayProto=Array.prototype,ObjProto=Object.prototype,SymbolProto=typeof Symbol<"u"?Symbol.prototype:null,push$1=ArrayProto.push,slice$2=ArrayProto.slice,toString$1=ObjProto.toString,hasOwnProperty$1=ObjProto.hasOwnProperty,supportsArrayBuffer=typeof ArrayBuffer<"u",supportsDataView=typeof DataView<"u",nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeCreate=Object.create,nativeIsView=supportsArrayBuffer&&ArrayBuffer.isView,_isNaN=isNaN,_isFinite=isFinite,hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],MAX_ARRAY_INDEX=Math.pow(2,53)-1;function restArguments(e,n){return n=n==null?e.length-1:+n,function(){for(var i=Math.max(arguments.length-n,0),r=Array(i),s=0;s<i;s++)r[s]=arguments[s+n];switch(n){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var o=Array(n+1);for(s=0;s<n;s++)o[s]=arguments[s];return o[n]=r,e.apply(this,o)}}function isObject$2(e){var n=typeof e;return n==="function"||n==="object"&&!!e}function isNull(e){return e===null}function isUndefined(e){return e===void 0}function isBoolean$3(e){return e===!0||e===!1||toString$1.call(e)==="[object Boolean]"}function isElement(e){return!!(e&&e.nodeType===1)}function tagTester(e){var n="[object "+e+"]";return function(i){return toString$1.call(i)===n}}const isString$1=tagTester("String"),isNumber$2=tagTester("Number"),isDate$2=tagTester("Date"),isRegExp$1=tagTester("RegExp"),isError=tagTester("Error"),isSymbol=tagTester("Symbol"),isArrayBuffer=tagTester("ArrayBuffer");var isFunction$1=tagTester("Function"),nodelist=root$1.document&&root$1.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof nodelist!="function"&&(isFunction$1=function(e){return typeof e=="function"||!1});const isFunction$2=isFunction$1,hasObjectTag=tagTester("Object");var hasStringTagBug=supportsDataView&&hasObjectTag(new DataView(new ArrayBuffer(8))),isIE11=typeof Map<"u"&&hasObjectTag(new Map),isDataView=tagTester("DataView");function ie10IsDataView(e){return e!=null&&isFunction$2(e.getInt8)&&isArrayBuffer(e.buffer)}const isDataView$1=hasStringTagBug?ie10IsDataView:isDataView,isArray$1=nativeIsArray||tagTester("Array");function has$4(e,n){return e!=null&&hasOwnProperty$1.call(e,n)}var isArguments=tagTester("Arguments");(function(){isArguments(arguments)||(isArguments=function(e){return has$4(e,"callee")})})();const isArguments$1=isArguments;function isFinite$1(e){return!isSymbol(e)&&_isFinite(e)&&!isNaN(parseFloat(e))}function isNaN$1(e){return isNumber$2(e)&&_isNaN(e)}function constant$5(e){return function(){return e}}function createSizePropertyCheck(e){return function(n){var i=e(n);return typeof i=="number"&&i>=0&&i<=MAX_ARRAY_INDEX}}function shallowProperty(e){return function(n){return n==null?void 0:n[e]}}const getByteLength=shallowProperty("byteLength"),isBufferLike=createSizePropertyCheck(getByteLength);var typedArrayPattern=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function isTypedArray(e){return nativeIsView?nativeIsView(e)&&!isDataView$1(e):isBufferLike(e)&&typedArrayPattern.test(toString$1.call(e))}const isTypedArray$1=supportsArrayBuffer?isTypedArray:constant$5(!1),getLength=shallowProperty("length");function emulatedSet(e){for(var n={},i=e.length,r=0;r<i;++r)n[e[r]]=!0;return{contains:function(s){return n[s]===!0},push:function(s){return n[s]=!0,e.push(s)}}}function collectNonEnumProps(e,n){n=emulatedSet(n);var i=nonEnumerableProps.length,r=e.constructor,s=isFunction$2(r)&&r.prototype||ObjProto,o="constructor";for(has$4(e,o)&&!n.contains(o)&&n.push(o);i--;)o=nonEnumerableProps[i],o in e&&e[o]!==s[o]&&!n.contains(o)&&n.push(o)}function keys$4(e){if(!isObject$2(e))return[];if(nativeKeys)return nativeKeys(e);var n=[];for(var i in e)has$4(e,i)&&n.push(i);return hasEnumBug&&collectNonEnumProps(e,n),n}function isEmpty$1(e){if(e==null)return!0;var n=getLength(e);return typeof n=="number"&&(isArray$1(e)||isString$1(e)||isArguments$1(e))?n===0:getLength(keys$4(e))===0}function isMatch(e,n){var i=keys$4(n),r=i.length;if(e==null)return!r;for(var s=Object(e),o=0;o<r;o++){var l=i[o];if(n[l]!==s[l]||!(l in s))return!1}return!0}function _$1(e){if(e instanceof _$1)return e;if(!(this instanceof _$1))return new _$1(e);this._wrapped=e}_$1.VERSION=VERSION;_$1.prototype.value=function(){return this._wrapped};_$1.prototype.valueOf=_$1.prototype.toJSON=_$1.prototype.value;_$1.prototype.toString=function(){return String(this._wrapped)};function toBufferView(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,getByteLength(e))}var tagDataView="[object DataView]";function eq$2(e,n,i,r){if(e===n)return e!==0||1/e===1/n;if(e==null||n==null)return!1;if(e!==e)return n!==n;var s=typeof e;return s!=="function"&&s!=="object"&&typeof n!="object"?!1:deepEq(e,n,i,r)}function deepEq(e,n,i,r){e instanceof _$1&&(e=e._wrapped),n instanceof _$1&&(n=n._wrapped);var s=toString$1.call(e);if(s!==toString$1.call(n))return!1;if(hasStringTagBug&&s=="[object Object]"&&isDataView$1(e)){if(!isDataView$1(n))return!1;s=tagDataView}switch(s){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:+e==0?1/+e===1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return SymbolProto.valueOf.call(e)===SymbolProto.valueOf.call(n);case"[object ArrayBuffer]":case tagDataView:return deepEq(toBufferView(e),toBufferView(n),i,r)}var o=s==="[object Array]";if(!o&&isTypedArray$1(e)){var l=getByteLength(e);if(l!==getByteLength(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;o=!0}if(!o){if(typeof e!="object"||typeof n!="object")return!1;var f=e.constructor,d=n.constructor;if(f!==d&&!(isFunction$2(f)&&f instanceof f&&isFunction$2(d)&&d instanceof d)&&"constructor"in e&&"constructor"in n)return!1}i=i||[],r=r||[];for(var p=i.length;p--;)if(i[p]===e)return r[p]===n;if(i.push(e),r.push(n),o){if(p=e.length,p!==n.length)return!1;for(;p--;)if(!eq$2(e[p],n[p],i,r))return!1}else{var g=keys$4(e),v;if(p=g.length,keys$4(n).length!==p)return!1;for(;p--;)if(v=g[p],!(has$4(n,v)&&eq$2(e[v],n[v],i,r)))return!1}return i.pop(),r.pop(),!0}function isEqual$1(e,n){return eq$2(e,n)}function allKeys(e){if(!isObject$2(e))return[];var n=[];for(var i in e)n.push(i);return hasEnumBug&&collectNonEnumProps(e,n),n}function ie11fingerprint(e){var n=getLength(e);return function(i){if(i==null)return!1;var r=allKeys(i);if(getLength(r))return!1;for(var s=0;s<n;s++)if(!isFunction$2(i[e[s]]))return!1;return e!==weakMapMethods||!isFunction$2(i[forEachName])}}var forEachName="forEach",hasName="has",commonInit=["clear","delete"],mapTail=["get",hasName,"set"],mapMethods=commonInit.concat(forEachName,mapTail),weakMapMethods=commonInit.concat(mapTail),setMethods=["add"].concat(commonInit,forEachName,hasName);const isMap=isIE11?ie11fingerprint(mapMethods):tagTester("Map"),isWeakMap=isIE11?ie11fingerprint(weakMapMethods):tagTester("WeakMap"),isSet=isIE11?ie11fingerprint(setMethods):tagTester("Set"),isWeakSet=tagTester("WeakSet");function values$4(e){for(var n=keys$4(e),i=n.length,r=Array(i),s=0;s<i;s++)r[s]=e[n[s]];return r}function pairs(e){for(var n=keys$4(e),i=n.length,r=Array(i),s=0;s<i;s++)r[s]=[n[s],e[n[s]]];return r}function invert$1(e){for(var n={},i=keys$4(e),r=0,s=i.length;r<s;r++)n[e[i[r]]]=i[r];return n}function functions(e){var n=[];for(var i in e)isFunction$2(e[i])&&n.push(i);return n.sort()}function createAssigner(e,n){return function(i){var r=arguments.length;if(n&&(i=Object(i)),r<2||i==null)return i;for(var s=1;s<r;s++)for(var o=arguments[s],l=e(o),f=l.length,d=0;d<f;d++){var p=l[d];(!n||i[p]===void 0)&&(i[p]=o[p])}return i}}const extend$2=createAssigner(allKeys),extendOwn=createAssigner(keys$4),defaults$2=createAssigner(allKeys,!0);function ctor(){return function(){}}function baseCreate(e){if(!isObject$2(e))return{};if(nativeCreate)return nativeCreate(e);var n=ctor();n.prototype=e;var i=new n;return n.prototype=null,i}function create$4(e,n){var i=baseCreate(e);return n&&extendOwn(i,n),i}function clone$1(e){return isObject$2(e)?isArray$1(e)?e.slice():extend$2({},e):e}function tap(e,n){return n(e),e}function toPath$1(e){return isArray$1(e)?e:[e]}_$1.toPath=toPath$1;function toPath(e){return _$1.toPath(e)}function deepGet(e,n){for(var i=n.length,r=0;r<i;r++){if(e==null)return;e=e[n[r]]}return i?e:void 0}function get$6(e,n,i){var r=deepGet(e,toPath(n));return isUndefined(r)?i:r}function has$3(e,n){n=toPath(n);for(var i=n.length,r=0;r<i;r++){var s=n[r];if(!has$4(e,s))return!1;e=e[s]}return!!i}function identity$7(e){return e}function matcher(e){return e=extendOwn({},e),function(n){return isMatch(n,e)}}function property$1(e){return e=toPath(e),function(n){return deepGet(n,e)}}function optimizeCb(e,n,i){if(n===void 0)return e;switch(i??3){case 1:return function(r){return e.call(n,r)};case 3:return function(r,s,o){return e.call(n,r,s,o)};case 4:return function(r,s,o,l){return e.call(n,r,s,o,l)}}return function(){return e.apply(n,arguments)}}function baseIteratee(e,n,i){return e==null?identity$7:isFunction$2(e)?optimizeCb(e,n,i):isObject$2(e)&&!isArray$1(e)?matcher(e):property$1(e)}function iteratee(e,n){return baseIteratee(e,n,1/0)}_$1.iteratee=iteratee;function cb(e,n,i){return _$1.iteratee!==iteratee?_$1.iteratee(e,n):baseIteratee(e,n,i)}function mapObject(e,n,i){n=cb(n,i);for(var r=keys$4(e),s=r.length,o={},l=0;l<s;l++){var f=r[l];o[f]=n(e[f],f,e)}return o}function noop$5(){}function propertyOf(e){return e==null?noop$5:function(n){return get$6(e,n)}}function times(e,n,i){var r=Array(Math.max(0,e));n=optimizeCb(n,i,1);for(var s=0;s<e;s++)r[s]=n(s);return r}function random$1(e,n){return n==null&&(n=e,e=0),e+Math.floor(Math.random()*(n-e+1))}const now$1=Date.now||function(){return new Date().getTime()};function createEscaper(e){var n=function(o){return e[o]},i="(?:"+keys$4(e).join("|")+")",r=RegExp(i),s=RegExp(i,"g");return function(o){return o=o==null?"":""+o,r.test(o)?o.replace(s,n):o}}const escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},escape$2=createEscaper(escapeMap),unescapeMap=invert$1(escapeMap),unescape$2=createEscaper(unescapeMap),templateSettings=_$1.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escapeRegExp=/\\|'|\r|\n|\u2028|\u2029/g;function escapeChar(e){return"\\"+escapes[e]}var bareIdentifier=/^\s*(\w|\$)+\s*$/;function template(e,n,i){!n&&i&&(n=i),n=defaults$2({},n,_$1.templateSettings);var r=RegExp([(n.escape||noMatch).source,(n.interpolate||noMatch).source,(n.evaluate||noMatch).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(r,function(p,g,v,S,T){return o+=e.slice(s,T).replace(escapeRegExp,escapeChar),s=T+p.length,g?o+=`'+
((__t=(`+g+`))==null?'':_.escape(__t))+
'`:v?o+=`'+
((__t=(`+v+`))==null?'':__t)+
'`:S&&(o+=`';
`+S+`
__p+='`),p}),o+=`';
`;var l=n.variable;if(l){if(!bareIdentifier.test(l))throw new Error("variable is not a bare identifier: "+l)}else o=`with(obj||{}){
`+o+`}
`,l="obj";o=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+o+`return __p;
`;var f;try{f=new Function(l,"_",o)}catch(p){throw p.source=o,p}var d=function(p){return f.call(this,p,_$1)};return d.source="function("+l+`){
`+o+"}",d}function result$1(e,n,i){n=toPath(n);var r=n.length;if(!r)return isFunction$2(i)?i.call(e):i;for(var s=0;s<r;s++){var o=e==null?void 0:e[n[s]];o===void 0&&(o=i,s=r),e=isFunction$2(o)?o.call(e):o}return e}var idCounter$1=0;function uniqueId$1(e){var n=++idCounter$1+"";return e?e+n:n}function chain(e){var n=_$1(e);return n._chain=!0,n}function executeBound(e,n,i,r,s){if(!(r instanceof n))return e.apply(i,s);var o=baseCreate(e.prototype),l=e.apply(o,s);return isObject$2(l)?l:o}var partial=restArguments(function(e,n){var i=partial.placeholder,r=function(){for(var s=0,o=n.length,l=Array(o),f=0;f<o;f++)l[f]=n[f]===i?arguments[s++]:n[f];for(;s<arguments.length;)l.push(arguments[s++]);return executeBound(e,r,this,this,l)};return r});partial.placeholder=_$1;const bind$2=restArguments(function(e,n,i){if(!isFunction$2(e))throw new TypeError("Bind must be called on a function");var r=restArguments(function(s){return executeBound(e,r,n,this,i.concat(s))});return r}),isArrayLike=createSizePropertyCheck(getLength);function flatten$2(e,n,i,r){if(r=r||[],!n&&n!==0)n=1/0;else if(n<=0)return r.concat(e);for(var s=r.length,o=0,l=getLength(e);o<l;o++){var f=e[o];if(isArrayLike(f)&&(isArray$1(f)||isArguments$1(f)))if(n>1)flatten$2(f,n-1,i,r),s=r.length;else for(var d=0,p=f.length;d<p;)r[s++]=f[d++];else i||(r[s++]=f)}return r}const bindAll=restArguments(function(e,n){n=flatten$2(n,!1,!1);var i=n.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var r=n[i];e[r]=bind$2(e[r],e)}return e});function memoize$1(e,n){var i=function(r){var s=i.cache,o=""+(n?n.apply(this,arguments):r);return has$4(s,o)||(s[o]=e.apply(this,arguments)),s[o]};return i.cache={},i}const delay=restArguments(function(e,n,i){return setTimeout(function(){return e.apply(null,i)},n)}),defer=partial(delay,_$1,1);function throttle(e,n,i){var r,s,o,l,f=0;i||(i={});var d=function(){f=i.leading===!1?0:now$1(),r=null,l=e.apply(s,o),r||(s=o=null)},p=function(){var g=now$1();!f&&i.leading===!1&&(f=g);var v=n-(g-f);return s=this,o=arguments,v<=0||v>n?(r&&(clearTimeout(r),r=null),f=g,l=e.apply(s,o),r||(s=o=null)):!r&&i.trailing!==!1&&(r=setTimeout(d,v)),l};return p.cancel=function(){clearTimeout(r),f=0,r=s=o=null},p}function debounce$1(e,n,i){var r,s,o,l,f,d=function(){var g=now$1()-s;n>g?r=setTimeout(d,n-g):(r=null,i||(l=e.apply(f,o)),r||(o=f=null))},p=restArguments(function(g){return f=this,o=g,s=now$1(),r||(r=setTimeout(d,n),i&&(l=e.apply(f,o))),l});return p.cancel=function(){clearTimeout(r),r=o=f=null},p}function wrap$2(e,n){return partial(n,e)}function negate(e){return function(){return!e.apply(this,arguments)}}function compose$1(){var e=arguments,n=e.length-1;return function(){for(var i=n,r=e[n].apply(this,arguments);i--;)r=e[i].call(this,r);return r}}function after(e,n){return function(){if(--e<1)return n.apply(this,arguments)}}function before(e,n){var i;return function(){return--e>0&&(i=n.apply(this,arguments)),e<=1&&(n=null),i}}const once=partial(before,2);function findKey(e,n,i){n=cb(n,i);for(var r=keys$4(e),s,o=0,l=r.length;o<l;o++)if(s=r[o],n(e[s],s,e))return s}function createPredicateIndexFinder(e){return function(n,i,r){i=cb(i,r);for(var s=getLength(n),o=e>0?0:s-1;o>=0&&o<s;o+=e)if(i(n[o],o,n))return o;return-1}}const findIndex=createPredicateIndexFinder(1),findLastIndex=createPredicateIndexFinder(-1);function sortedIndex(e,n,i,r){i=cb(i,r,1);for(var s=i(n),o=0,l=getLength(e);o<l;){var f=Math.floor((o+l)/2);i(e[f])<s?o=f+1:l=f}return o}function createIndexFinder(e,n,i){return function(r,s,o){var l=0,f=getLength(r);if(typeof o=="number")e>0?l=o>=0?o:Math.max(o+f,l):f=o>=0?Math.min(o+1,f):o+f+1;else if(i&&o&&f)return o=i(r,s),r[o]===s?o:-1;if(s!==s)return o=n(slice$2.call(r,l,f),isNaN$1),o>=0?o+l:-1;for(o=e>0?l:f-1;o>=0&&o<f;o+=e)if(r[o]===s)return o;return-1}}const indexOf=createIndexFinder(1,findIndex,sortedIndex),lastIndexOf=createIndexFinder(-1,findLastIndex);function find$4(e,n,i){var r=isArrayLike(e)?findIndex:findKey,s=r(e,n,i);if(s!==void 0&&s!==-1)return e[s]}function findWhere(e,n){return find$4(e,matcher(n))}function each$1(e,n,i){n=optimizeCb(n,i);var r,s;if(isArrayLike(e))for(r=0,s=e.length;r<s;r++)n(e[r],r,e);else{var o=keys$4(e);for(r=0,s=o.length;r<s;r++)n(e[o[r]],o[r],e)}return e}function map$2(e,n,i){n=cb(n,i);for(var r=!isArrayLike(e)&&keys$4(e),s=(r||e).length,o=Array(s),l=0;l<s;l++){var f=r?r[l]:l;o[l]=n(e[f],f,e)}return o}function createReduce(e){var n=function(i,r,s,o){var l=!isArrayLike(i)&&keys$4(i),f=(l||i).length,d=e>0?0:f-1;for(o||(s=i[l?l[d]:d],d+=e);d>=0&&d<f;d+=e){var p=l?l[d]:d;s=r(s,i[p],p,i)}return s};return function(i,r,s,o){var l=arguments.length>=3;return n(i,optimizeCb(r,o,4),s,l)}}const reduce$1=createReduce(1),reduceRight=createReduce(-1);function filter$4(e,n,i){var r=[];return n=cb(n,i),each$1(e,function(s,o,l){n(s,o,l)&&r.push(s)}),r}function reject(e,n,i){return filter$4(e,negate(cb(n)),i)}function every$1(e,n,i){n=cb(n,i);for(var r=!isArrayLike(e)&&keys$4(e),s=(r||e).length,o=0;o<s;o++){var l=r?r[o]:o;if(!n(e[l],l,e))return!1}return!0}function some$1(e,n,i){n=cb(n,i);for(var r=!isArrayLike(e)&&keys$4(e),s=(r||e).length,o=0;o<s;o++){var l=r?r[o]:o;if(n(e[l],l,e))return!0}return!1}function contains$2(e,n,i,r){return isArrayLike(e)||(e=values$4(e)),(typeof i!="number"||r)&&(i=0),indexOf(e,n,i)>=0}const invoke$1=restArguments(function(e,n,i){var r,s;return isFunction$2(n)?s=n:(n=toPath(n),r=n.slice(0,-1),n=n[n.length-1]),map$2(e,function(o){var l=s;if(!l){if(r&&r.length&&(o=deepGet(o,r)),o==null)return;l=o[n]}return l==null?l:l.apply(o,i)})});function pluck$1(e,n){return map$2(e,property$1(n))}function where(e,n){return filter$4(e,matcher(n))}function max$3(e,n,i){var r=-1/0,s=-1/0,o,l;if(n==null||typeof n=="number"&&typeof e[0]!="object"&&e!=null){e=isArrayLike(e)?e:values$4(e);for(var f=0,d=e.length;f<d;f++)o=e[f],o!=null&&o>r&&(r=o)}else n=cb(n,i),each$1(e,function(p,g,v){l=n(p,g,v),(l>s||l===-1/0&&r===-1/0)&&(r=p,s=l)});return r}function min$3(e,n,i){var r=1/0,s=1/0,o,l;if(n==null||typeof n=="number"&&typeof e[0]!="object"&&e!=null){e=isArrayLike(e)?e:values$4(e);for(var f=0,d=e.length;f<d;f++)o=e[f],o!=null&&o<r&&(r=o)}else n=cb(n,i),each$1(e,function(p,g,v){l=n(p,g,v),(l<s||l===1/0&&r===1/0)&&(r=p,s=l)});return r}var reStrSymbol=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function toArray(e){return e?isArray$1(e)?slice$2.call(e):isString$1(e)?e.match(reStrSymbol):isArrayLike(e)?map$2(e,identity$7):values$4(e):[]}function sample(e,n,i){if(n==null||i)return isArrayLike(e)||(e=values$4(e)),e[random$1(e.length-1)];var r=toArray(e),s=getLength(r);n=Math.max(Math.min(n,s),0);for(var o=s-1,l=0;l<n;l++){var f=random$1(l,o),d=r[l];r[l]=r[f],r[f]=d}return r.slice(0,n)}function shuffle$1(e){return sample(e,1/0)}function sortBy(e,n,i){var r=0;return n=cb(n,i),pluck$1(map$2(e,function(s,o,l){return{value:s,index:r++,criteria:n(s,o,l)}}).sort(function(s,o){var l=s.criteria,f=o.criteria;if(l!==f){if(l>f||l===void 0)return 1;if(l<f||f===void 0)return-1}return s.index-o.index}),"value")}function group$1(e,n){return function(i,r,s){var o=n?[[],[]]:{};return r=cb(r,s),each$1(i,function(l,f){var d=r(l,f,i);e(o,l,d)}),o}}const groupBy=group$1(function(e,n,i){has$4(e,i)?e[i].push(n):e[i]=[n]}),indexBy=group$1(function(e,n,i){e[i]=n}),countBy=group$1(function(e,n,i){has$4(e,i)?e[i]++:e[i]=1}),partition$5=group$1(function(e,n,i){e[i?0:1].push(n)},!0);function size(e){return e==null?0:isArrayLike(e)?e.length:keys$4(e).length}function keyInObj(e,n,i){return n in i}const pick$3=restArguments(function(e,n){var i={},r=n[0];if(e==null)return i;isFunction$2(r)?(n.length>1&&(r=optimizeCb(r,n[1])),n=allKeys(e)):(r=keyInObj,n=flatten$2(n,!1,!1),e=Object(e));for(var s=0,o=n.length;s<o;s++){var l=n[s],f=e[l];r(f,l,e)&&(i[l]=f)}return i}),omit$1=restArguments(function(e,n){var i=n[0],r;return isFunction$2(i)?(i=negate(i),n.length>1&&(r=n[1])):(n=map$2(flatten$2(n,!1,!1),String),i=function(s,o){return!contains$2(n,o)}),pick$3(e,i,r)});function initial(e,n,i){return slice$2.call(e,0,Math.max(0,e.length-(n==null||i?1:n)))}function first(e,n,i){return e==null||e.length<1?n==null||i?void 0:[]:n==null||i?e[0]:initial(e,e.length-n)}function rest(e,n,i){return slice$2.call(e,n==null||i?1:n)}function last(e,n,i){return e==null||e.length<1?n==null||i?void 0:[]:n==null||i?e[e.length-1]:rest(e,Math.max(0,e.length-n))}function compact(e){return filter$4(e,Boolean)}function flatten$1(e,n){return flatten$2(e,n,!1)}const difference=restArguments(function(e,n){return n=flatten$2(n,!0,!0),filter$4(e,function(i){return!contains$2(n,i)})}),without=restArguments(function(e,n){return difference(e,n)});function uniq(e,n,i,r){isBoolean$3(n)||(r=i,i=n,n=!1),i!=null&&(i=cb(i,r));for(var s=[],o=[],l=0,f=getLength(e);l<f;l++){var d=e[l],p=i?i(d,l,e):d;n&&!i?((!l||o!==p)&&s.push(d),o=p):i?contains$2(o,p)||(o.push(p),s.push(d)):contains$2(s,d)||s.push(d)}return s}const union$1=restArguments(function(e){return uniq(flatten$2(e,!0,!0))});function intersection$1(e){for(var n=[],i=arguments.length,r=0,s=getLength(e);r<s;r++){var o=e[r];if(!contains$2(n,o)){var l;for(l=1;l<i&&contains$2(arguments[l],o);l++);l===i&&n.push(o)}}return n}function unzip(e){for(var n=e&&max$3(e,getLength).length||0,i=Array(n),r=0;r<n;r++)i[r]=pluck$1(e,r);return i}const zip=restArguments(unzip);function object$2(e,n){for(var i={},r=0,s=getLength(e);r<s;r++)n?i[e[r]]=n[r]:i[e[r][0]]=e[r][1];return i}function range$5(e,n,i){n==null&&(n=e||0,e=0),i||(i=n<e?-1:1);for(var r=Math.max(Math.ceil((n-e)/i),0),s=Array(r),o=0;o<r;o++,e+=i)s[o]=e;return s}function chunk(e,n){if(n==null||n<1)return[];for(var i=[],r=0,s=e.length;r<s;)i.push(slice$2.call(e,r,r+=n));return i}function chainResult(e,n){return e._chain?_$1(n).chain():n}function mixin(e){return each$1(functions(e),function(n){var i=_$1[n]=e[n];_$1.prototype[n]=function(){var r=[this._wrapped];return push$1.apply(r,arguments),chainResult(this,i.apply(_$1,r))}}),_$1}each$1(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=ArrayProto[e];_$1.prototype[e]=function(){var i=this._wrapped;return i!=null&&(n.apply(i,arguments),(e==="shift"||e==="splice")&&i.length===0&&delete i[0]),chainResult(this,i)}});each$1(["concat","join","slice"],function(e){var n=ArrayProto[e];_$1.prototype[e]=function(){var i=this._wrapped;return i!=null&&(i=n.apply(i,arguments)),chainResult(this,i)}});const allExports=Object.freeze(Object.defineProperty({__proto__:null,VERSION,after,all:every$1,allKeys,any:some$1,assign:extendOwn,before,bind:bind$2,bindAll,chain,chunk,clone:clone$1,collect:map$2,compact,compose:compose$1,constant:constant$5,contains:contains$2,countBy,create:create$4,debounce:debounce$1,default:_$1,defaults:defaults$2,defer,delay,detect:find$4,difference,drop:rest,each:each$1,escape:escape$2,every:every$1,extend:extend$2,extendOwn,filter:filter$4,find:find$4,findIndex,findKey,findLastIndex,findWhere,first,flatten:flatten$1,foldl:reduce$1,foldr:reduceRight,forEach:each$1,functions,get:get$6,groupBy,has:has$3,head:first,identity:identity$7,include:contains$2,includes:contains$2,indexBy,indexOf,initial,inject:reduce$1,intersection:intersection$1,invert:invert$1,invoke:invoke$1,isArguments:isArguments$1,isArray:isArray$1,isArrayBuffer,isBoolean:isBoolean$3,isDataView:isDataView$1,isDate:isDate$2,isElement,isEmpty:isEmpty$1,isEqual:isEqual$1,isError,isFinite:isFinite$1,isFunction:isFunction$2,isMap,isMatch,isNaN:isNaN$1,isNull,isNumber:isNumber$2,isObject:isObject$2,isRegExp:isRegExp$1,isSet,isString:isString$1,isSymbol,isTypedArray:isTypedArray$1,isUndefined,isWeakMap,isWeakSet,iteratee,keys:keys$4,last,lastIndexOf,map:map$2,mapObject,matcher,matches:matcher,max:max$3,memoize:memoize$1,methods:functions,min:min$3,mixin,negate,noop:noop$5,now:now$1,object:object$2,omit:omit$1,once,pairs,partial,partition:partition$5,pick:pick$3,pluck:pluck$1,property:property$1,propertyOf,random:random$1,range:range$5,reduce:reduce$1,reduceRight,reject,rest,restArguments,result:result$1,sample,select:filter$4,shuffle:shuffle$1,size,some:some$1,sortBy,sortedIndex,tail:rest,take:first,tap,template,templateSettings,throttle,times,toArray,toPath:toPath$1,transpose:unzip,unescape:unescape$2,union:union$1,uniq,unique:uniq,uniqueId:uniqueId$1,unzip,values:values$4,where,without,wrap:wrap$2,zip},Symbol.toStringTag,{value:"Module"}));var _=mixin(allExports);_._=_;const Card_svelte_svelte_type_style_lang="",Cards_svelte_svelte_type_style_lang="";function create_fragment$e(e){let n,i;return{c(){n=element$2("img"),this.h()},l(r){n=claim_element(r,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){attr$6(n,"class",e[1]),src_url_equal(n.src,i=e[0])||attr$6(n,"src",i),attr$6(n,"alt","A Meerkat cell.")},m(r,s){insert_hydration(r,n,s)},p(r,[s]){s&2&&attr$6(n,"class",r[1]),s&1&&!src_url_equal(n.src,i=r[0])&&attr$6(n,"src",i)},i:noop$6,o:noop$6,d(r){r&&detach(n)}}}function instance$e(e,n,i){let{data:r}=n,{classes:s=""}=n;return e.$$set=o=>{"data"in o&&i(0,r=o.data),"classes"in o&&i(1,s=o.classes)},[r,s]}let Image$1=class extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$e,create_fragment$e,safe_not_equal,{data:0,classes:1})}};const JsonView_svelte_svelte_type_style_lang="";function get_each_context$3(e,n,i){const r=e.slice();return r[10]=n[i],r[12]=i,r}function create_else_block$2(e){let n,i=e[6][0]+"",r,s,o,l,f,d=e[6][1]+"",p,g,v,S,T,k=e[5],O=[];for(let F=0;F<k.length;F+=1)O[F]=create_each_block$3(get_each_context$3(e,k,F));const R=F=>transition_out(O[F],1,1,()=>{O[F]=null});let P=!e[3]&&create_if_block_4();return{c(){n=element$2("span"),r=text$3(i),s=space(),o=element$2("ul");for(let F=0;F<O.length;F+=1)O[F].c();l=space(),f=element$2("span"),p=text$3(d),P&&P.c(),g=empty(),this.h()},l(F){n=claim_element(F,"SPAN",{class:!0,role:!0,tabindex:!0});var I=children$2(n);r=claim_text(I,i),I.forEach(detach),s=claim_space(F),o=claim_element(F,"UL",{class:!0});var L=children$2(o);for(let j=0;j<O.length;j+=1)O[j].l(L);L.forEach(detach),l=claim_space(F),f=claim_element(F,"SPAN",{class:!0,role:!0,tabindex:!0});var N=children$2(f);p=claim_text(N,d),N.forEach(detach),P&&P.l(F),g=empty(),this.h()},h(){attr$6(n,"class","_jsonBkt svelte-d5rr90"),attr$6(n,"role","button"),attr$6(n,"tabindex","0"),attr$6(o,"class","_jsonList svelte-d5rr90"),attr$6(f,"class","_jsonBkt svelte-d5rr90"),attr$6(f,"role","button"),attr$6(f,"tabindex","0")},m(F,I){insert_hydration(F,n,I),append_hydration(n,r),insert_hydration(F,s,I),insert_hydration(F,o,I);for(let L=0;L<O.length;L+=1)O[L].m(o,null);insert_hydration(F,l,I),insert_hydration(F,f,I),append_hydration(f,p),P&&P.m(F,I),insert_hydration(F,g,I),v=!0,S||(T=[listen(n,"click",e[8]),listen(n,"keydown",e[9]),listen(f,"click",e[8]),listen(f,"keydown",e[9])],S=!0)},p(F,I){if((!v||I&64)&&i!==(i=F[6][0]+"")&&set_data(r,i),I&55){k=F[5];let L;for(L=0;L<k.length;L+=1){const N=get_each_context$3(F,k,L);O[L]?(O[L].p(N,I),transition_in(O[L],1)):(O[L]=create_each_block$3(N),O[L].c(),transition_in(O[L],1),O[L].m(o,null))}for(group_outros(),L=k.length;L<O.length;L+=1)R(L);check_outros()}(!v||I&64)&&d!==(d=F[6][1]+"")&&set_data(p,d),F[3]?P&&(P.d(1),P=null):P||(P=create_if_block_4(),P.c(),P.m(g.parentNode,g))},i(F){if(!v){for(let I=0;I<k.length;I+=1)transition_in(O[I]);v=!0}},o(F){O=O.filter(Boolean);for(let I=0;I<O.length;I+=1)transition_out(O[I]);v=!1},d(F){F&&detach(n),F&&detach(s),F&&detach(o),destroy_each(O,F),F&&detach(l),F&&detach(f),P&&P.d(F),F&&detach(g),S=!1,run_all(T)}}}function create_if_block_2(e){let n,i=e[6][0]+"",r,s,o=e[6][1]+"",l,f,d,p,g=!e[3]&&e[7]&&create_if_block_3();return{c(){n=element$2("span"),r=text$3(i),s=text$3("..."),l=text$3(o),g&&g.c(),f=empty(),this.h()},l(v){n=claim_element(v,"SPAN",{class:!0,role:!0,tabindex:!0});var S=children$2(n);r=claim_text(S,i),s=claim_text(S,"..."),l=claim_text(S,o),S.forEach(detach),g&&g.l(v),f=empty(),this.h()},h(){attr$6(n,"class","_jsonBkt svelte-d5rr90"),attr$6(n,"role","button"),attr$6(n,"tabindex","0")},m(v,S){insert_hydration(v,n,S),append_hydration(n,r),append_hydration(n,s),append_hydration(n,l),g&&g.m(v,S),insert_hydration(v,f,S),d||(p=[listen(n,"click",e[8]),listen(n,"keydown",e[9])],d=!0)},p(v,S){S&64&&i!==(i=v[6][0]+"")&&set_data(r,i),S&64&&o!==(o=v[6][1]+"")&&set_data(l,o),!v[3]&&v[7]?g||(g=create_if_block_3(),g.c(),g.m(f.parentNode,f)):g&&(g.d(1),g=null)},i:noop$6,o:noop$6,d(v){v&&detach(n),g&&g.d(v),v&&detach(f),d=!1,run_all(p)}}}function create_if_block$3(e){let n,i=e[6][0]+"",r,s=e[6][1]+"",o,l,f=!e[3]&&create_if_block_1$1();return{c(){n=element$2("span"),r=text$3(i),o=text$3(s),f&&f.c(),l=empty(),this.h()},l(d){n=claim_element(d,"SPAN",{class:!0});var p=children$2(n);r=claim_text(p,i),o=claim_text(p,s),p.forEach(detach),f&&f.l(d),l=empty(),this.h()},h(){attr$6(n,"class","_jsonBkt empty svelte-d5rr90")},m(d,p){insert_hydration(d,n,p),append_hydration(n,r),append_hydration(n,o),f&&f.m(d,p),insert_hydration(d,l,p)},p(d,p){p&64&&i!==(i=d[6][0]+"")&&set_data(r,i),p&64&&s!==(s=d[6][1]+"")&&set_data(o,s),d[3]?f&&(f.d(1),f=null):f||(f=create_if_block_1$1(),f.c(),f.m(l.parentNode,l))},i:noop$6,o:noop$6,d(d){d&&detach(n),f&&f.d(d),d&&detach(l)}}}function create_if_block_7(e){let n,i,r=e[10]+"",s,o,l,f;return{c(){n=element$2("span"),i=text$3('"'),s=text$3(r),o=text$3('"'),l=element$2("span"),f=text$3(":"),this.h()},l(d){n=claim_element(d,"SPAN",{class:!0});var p=children$2(n);i=claim_text(p,'"'),s=claim_text(p,r),o=claim_text(p,'"'),p.forEach(detach),l=claim_element(d,"SPAN",{class:!0});var g=children$2(l);f=claim_text(g,":"),g.forEach(detach),this.h()},h(){attr$6(n,"class","_jsonKey svelte-d5rr90"),attr$6(l,"class","_jsonSep svelte-d5rr90")},m(d,p){insert_hydration(d,n,p),append_hydration(n,i),append_hydration(n,s),append_hydration(n,o),insert_hydration(d,l,p),append_hydration(l,f)},p(d,p){p&32&&r!==(r=d[10]+"")&&set_data(s,r)},d(d){d&&detach(n),d&&detach(l)}}}function create_else_block_1(e){let n,i=format$4(e[0][e[10]])+"",r,s,o,l=e[12]<e[5].length-1&&create_if_block_6();return{c(){n=element$2("span"),r=text$3(i),l&&l.c(),o=empty(),this.h()},l(f){n=claim_element(f,"SPAN",{class:!0});var d=children$2(n);r=claim_text(d,i),d.forEach(detach),l&&l.l(f),o=empty(),this.h()},h(){attr$6(n,"class",s="_jsonVal "+getType(e[0][e[10]])+" svelte-d5rr90")},m(f,d){insert_hydration(f,n,d),append_hydration(n,r),l&&l.m(f,d),insert_hydration(f,o,d)},p(f,d){d&33&&i!==(i=format$4(f[0][f[10]])+"")&&set_data(r,i),d&33&&s!==(s="_jsonVal "+getType(f[0][f[10]])+" svelte-d5rr90")&&attr$6(n,"class",s),f[12]<f[5].length-1?l||(l=create_if_block_6(),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null)},i:noop$6,o:noop$6,d(f){f&&detach(n),l&&l.d(f),f&&detach(o)}}}function create_if_block_5(e){let n,i;return n=new JsonView({props:{json:e[0][e[10]],depth:e[1],_cur:e[2]+1,_last:e[12]===e[5].length-1}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s&33&&(o.json=r[0][r[10]]),s&2&&(o.depth=r[1]),s&4&&(o._cur=r[2]+1),s&32&&(o._last=r[12]===r[5].length-1),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_if_block_6(e){let n,i;return{c(){n=element$2("span"),i=text$3(","),this.h()},l(r){n=claim_element(r,"SPAN",{class:!0});var s=children$2(n);i=claim_text(s,","),s.forEach(detach),this.h()},h(){attr$6(n,"class","_jsonSep svelte-d5rr90")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},d(r){r&&detach(n)}}}function create_each_block$3(e){let n,i,r,s,o,l,f,d=!e[4]&&create_if_block_7(e);const p=[create_if_block_5,create_else_block_1],g=[];function v(S,T){return T&33&&(r=null),r==null&&(r=getType(S[0][S[10]])==="object"),r?0:1}return s=v(e,-1),o=g[s]=p[s](e),{c(){n=element$2("li"),d&&d.c(),i=space(),o.c(),l=space()},l(S){n=claim_element(S,"LI",{});var T=children$2(n);d&&d.l(T),i=claim_space(T),o.l(T),l=claim_space(T),T.forEach(detach)},m(S,T){insert_hydration(S,n,T),d&&d.m(n,null),append_hydration(n,i),g[s].m(n,null),append_hydration(n,l),f=!0},p(S,T){S[4]?d&&(d.d(1),d=null):d?d.p(S,T):(d=create_if_block_7(S),d.c(),d.m(n,i));let k=s;s=v(S,T),s===k?g[s].p(S,T):(group_outros(),transition_out(g[k],1,1,()=>{g[k]=null}),check_outros(),o=g[s],o?o.p(S,T):(o=g[s]=p[s](S),o.c()),transition_in(o,1),o.m(n,l))},i(S){f||(transition_in(o),f=!0)},o(S){transition_out(o),f=!1},d(S){S&&detach(n),d&&d.d(),g[s].d()}}}function create_if_block_4(e){let n,i;return{c(){n=element$2("span"),i=text$3(","),this.h()},l(r){n=claim_element(r,"SPAN",{class:!0});var s=children$2(n);i=claim_text(s,","),s.forEach(detach),this.h()},h(){attr$6(n,"class","_jsonSep svelte-d5rr90")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},d(r){r&&detach(n)}}}function create_if_block_3(e){let n,i;return{c(){n=element$2("span"),i=text$3(","),this.h()},l(r){n=claim_element(r,"SPAN",{class:!0});var s=children$2(n);i=claim_text(s,","),s.forEach(detach),this.h()},h(){attr$6(n,"class","_jsonSep svelte-d5rr90")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},d(r){r&&detach(n)}}}function create_if_block_1$1(e){let n,i;return{c(){n=element$2("span"),i=text$3(","),this.h()},l(r){n=claim_element(r,"SPAN",{class:!0});var s=children$2(n);i=claim_text(s,","),s.forEach(detach),this.h()},h(){attr$6(n,"class","_jsonSep svelte-d5rr90")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},d(r){r&&detach(n)}}}function create_fragment$d(e){let n,i,r,s;const o=[create_if_block$3,create_if_block_2,create_else_block$2],l=[];function f(d,p){return d[5].length?d[7]?1:2:0}return n=f(e),i=l[n]=o[n](e),{c(){i.c(),r=empty()},l(d){i.l(d),r=empty()},m(d,p){l[n].m(d,p),insert_hydration(d,r,p),s=!0},p(d,[p]){let g=n;n=f(d),n===g?l[n].p(d,p):(group_outros(),transition_out(l[g],1,1,()=>{l[g]=null}),check_outros(),i=l[n],i?i.p(d,p):(i=l[n]=o[n](d),i.c()),transition_in(i,1),i.m(r.parentNode,r))},i(d){s||(transition_in(i),s=!0)},o(d){transition_out(i),s=!1},d(d){l[n].d(d),d&&detach(r)}}}function getType(e){return e===null?"null":typeof e}function format$4(e){const n=getType(e);return n==="string"?`"${e}"`:n==="function"?"f () {...}":n==="symbol"?e.toString():e}function instance$d(e,n,i){let{json:r}=n,{depth:s=1/0}=n,{_cur:o=0}=n,{_last:l=!0}=n,f,d=!1,p=["",""],g=!1;function v(){i(7,g=!g)}function S(T){T instanceof KeyboardEvent&&["Enter"," "].includes(T.key)&&v()}return e.$$set=T=>{"json"in T&&i(0,r=T.json),"depth"in T&&i(1,s=T.depth),"_cur"in T&&i(2,o=T._cur),"_last"in T&&i(3,l=T._last)},e.$$.update=()=>{e.$$.dirty&17&&(i(5,f=getType(r)==="object"?Object.keys(r):[]),i(4,d=Array.isArray(r)),i(6,p=d?["[","]"]:["{","}"])),e.$$.dirty&6&&i(7,g=s<o)},[r,s,o,l,d,f,p,g,v,S]}class JsonView extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$d,create_fragment$d,safe_not_equal,{json:0,depth:1,_cur:2,_last:3})}}function create_fragment$c(e){let n,i,r,s;return i=new JsonView({props:{json:e[0]}}),{c(){n=element$2("div"),create_component(i.$$.fragment),this.h()},l(o){n=claim_element(o,"DIV",{class:!0,style:!0});var l=children$2(n);claim_component(i.$$.fragment,l),l.forEach(detach),this.h()},h(){attr$6(n,"class",r="font-mono text-sm text-gray-800 bg-purple-50 rounded-lg p-2 "+e[2]),set_style(n,"--jsonPaddingLeft",e[1]+"rem")},m(o,l){insert_hydration(o,n,l),mount_component(i,n,null),s=!0},p(o,[l]){const f={};l&1&&(f.json=o[0]),i.$set(f),(!s||l&4&&r!==(r="font-mono text-sm text-gray-800 bg-purple-50 rounded-lg p-2 "+o[2]))&&attr$6(n,"class",r),(!s||l&2)&&set_style(n,"--jsonPaddingLeft",o[1]+"rem")},i(o){s||(transition_in(i.$$.fragment,o),s=!0)},o(o){transition_out(i.$$.fragment,o),s=!1},d(o){o&&detach(n),destroy_component(i)}}}function instance$c(e,n,i){let{body:r}=n,{padding:s=2}=n,{classes:o=""}=n;return e.$$set=l=>{"body"in l&&i(0,r=l.body),"padding"in l&&i(1,s=l.padding),"classes"in l&&i(2,o=l.classes)},[r,s,o]}class Json extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$c,create_fragment$c,safe_not_equal,{body:0,padding:1,classes:2})}}function getDefaults(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let defaults$1=getDefaults();function changeDefaults(e){defaults$1=e}const escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=e=>escapeReplacements[e];function escape$1(e,n){if(n){if(escapeTest.test(e))return e.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(e))return e.replace(escapeReplaceNoEncode,getEscapeReplacement);return e}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape$1(e){return e.replace(unescapeTest,(n,i)=>(i=i.toLowerCase(),i==="colon"?":":i.charAt(0)==="#"?i.charAt(1)==="x"?String.fromCharCode(parseInt(i.substring(2),16)):String.fromCharCode(+i.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(e,n){e=typeof e=="string"?e:e.source,n=n||"";const i={replace:(r,s)=>(s=s.source||s,s=s.replace(caret,"$1"),e=e.replace(r,s),i),getRegex:()=>new RegExp(e,n)};return i}const nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(e,n,i){if(e){let r;try{r=decodeURIComponent(unescape$1(i)).replace(nonWordAndColonTest,"").toLowerCase()}catch{return null}if(r.indexOf("javascript:")===0||r.indexOf("vbscript:")===0||r.indexOf("data:")===0)return null}n&&!originIndependentUrl.test(i)&&(i=resolveUrl(n,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}const baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain$2=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(e,n){baseUrls[" "+e]||(justDomain.test(e)?baseUrls[" "+e]=e+"/":baseUrls[" "+e]=rtrim(e,"/",!0)),e=baseUrls[" "+e];const i=e.indexOf(":")===-1;return n.substring(0,2)==="//"?i?n:e.replace(protocol,"$1")+n:n.charAt(0)==="/"?i?n:e.replace(domain$2,"$1")+n:e+n}const noopTest={exec:function(){}};function merge$4(e){let n=1,i,r;for(;n<arguments.length;n++){i=arguments[n];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}function splitCells(e,n){const i=e.replace(/\|/g,(o,l,f)=>{let d=!1,p=l;for(;--p>=0&&f[p]==="\\";)d=!d;return d?"|":" |"}),r=i.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),r.length>n)r.splice(n);else for(;r.length<n;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function rtrim(e,n,i){const r=e.length;if(r===0)return"";let s=0;for(;s<r;){const o=e.charAt(r-s-1);if(o===n&&!i)s++;else if(o!==n&&i)s++;else break}return e.slice(0,r-s)}function findClosingBracket(e,n){if(e.indexOf(n[1])===-1)return-1;const i=e.length;let r=0,s=0;for(;s<i;s++)if(e[s]==="\\")s++;else if(e[s]===n[0])r++;else if(e[s]===n[1]&&(r--,r<0))return s;return-1}function checkSanitizeDeprecation(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(e,n){if(n<1)return"";let i="";for(;n>1;)n&1&&(i+=e),n>>=1,e+=e;return i+e}function outputLink(e,n,i,r){const s=n.href,o=n.title?escape$1(n.title):null,l=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){r.state.inLink=!0;const f={type:"link",raw:i,href:s,title:o,text:l,tokens:r.inlineTokens(l)};return r.state.inLink=!1,f}return{type:"image",raw:i,href:s,title:o,text:escape$1(l)}}function indentCodeCompensation(e,n){const i=e.match(/^(\s+)(?:```)/);if(i===null)return n;const r=i[1];return n.split(`
`).map(s=>{const o=s.match(/^\s+/);if(o===null)return s;const[l]=o;return l.length>=r.length?s.slice(r.length):s}).join(`
`)}let Tokenizer$1=class{constructor(n){this.options=n||defaults$1}space(n){const i=this.rules.block.newline.exec(n);if(i&&i[0].length>0)return{type:"space",raw:i[0]}}code(n){const i=this.rules.block.code.exec(n);if(i){const r=i[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:this.options.pedantic?r:rtrim(r,`
`)}}}fences(n){const i=this.rules.block.fences.exec(n);if(i){const r=i[0],s=indentCodeCompensation(r,i[3]||"");return{type:"code",raw:r,lang:i[2]?i[2].trim().replace(this.rules.inline._escapes,"$1"):i[2],text:s}}}heading(n){const i=this.rules.block.heading.exec(n);if(i){let r=i[2].trim();if(/#$/.test(r)){const s=rtrim(r,"#");(this.options.pedantic||!s||/ $/.test(s))&&(r=s.trim())}return{type:"heading",raw:i[0],depth:i[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(n){const i=this.rules.block.hr.exec(n);if(i)return{type:"hr",raw:i[0]}}blockquote(n){const i=this.rules.block.blockquote.exec(n);if(i){const r=i[0].replace(/^ *>[ \t]?/gm,""),s=this.lexer.state.top;this.lexer.state.top=!0;const o=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:i[0],tokens:o,text:r}}}list(n){let i=this.rules.block.list.exec(n);if(i){let r,s,o,l,f,d,p,g,v,S,T,k,O=i[1].trim();const R=O.length>1,P={type:"list",raw:"",ordered:R,start:R?+O.slice(0,-1):"",loose:!1,items:[]};O=R?`\\d{1,9}\\${O.slice(-1)}`:`\\${O}`,this.options.pedantic&&(O=R?O:"[*+-]");const F=new RegExp(`^( {0,3}${O})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;n&&(k=!1,!(!(i=F.exec(n))||this.rules.block.hr.test(n)));){if(r=i[0],n=n.substring(r.length),g=i[2].split(`
`,1)[0].replace(/^\t+/,L=>" ".repeat(3*L.length)),v=n.split(`
`,1)[0],this.options.pedantic?(l=2,T=g.trimLeft()):(l=i[2].search(/[^ ]/),l=l>4?1:l,T=g.slice(l),l+=i[1].length),d=!1,!g&&/^ *$/.test(v)&&(r+=v+`
`,n=n.substring(v.length+1),k=!0),!k){const L=new RegExp(`^ {0,${Math.min(3,l-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),N=new RegExp(`^ {0,${Math.min(3,l-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),j=new RegExp(`^ {0,${Math.min(3,l-1)}}(?:\`\`\`|~~~)`),z=new RegExp(`^ {0,${Math.min(3,l-1)}}#`);for(;n&&(S=n.split(`
`,1)[0],v=S,this.options.pedantic&&(v=v.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(j.test(v)||z.test(v)||L.test(v)||N.test(n)));){if(v.search(/[^ ]/)>=l||!v.trim())T+=`
`+v.slice(l);else{if(d||g.search(/[^ ]/)>=4||j.test(g)||z.test(g)||N.test(g))break;T+=`
`+v}!d&&!v.trim()&&(d=!0),r+=S+`
`,n=n.substring(S.length+1),g=v.slice(l)}}P.loose||(p?P.loose=!0:/\n *\n *$/.test(r)&&(p=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(T),s&&(o=s[0]!=="[ ] ",T=T.replace(/^\[[ xX]\] +/,""))),P.items.push({type:"list_item",raw:r,task:!!s,checked:o,loose:!1,text:T}),P.raw+=r}P.items[P.items.length-1].raw=r.trimRight(),P.items[P.items.length-1].text=T.trimRight(),P.raw=P.raw.trimRight();const I=P.items.length;for(f=0;f<I;f++)if(this.lexer.state.top=!1,P.items[f].tokens=this.lexer.blockTokens(P.items[f].text,[]),!P.loose){const L=P.items[f].tokens.filter(j=>j.type==="space"),N=L.length>0&&L.some(j=>/\n.*\n/.test(j.raw));P.loose=N}if(P.loose)for(f=0;f<I;f++)P.items[f].loose=!0;return P}}html(n){const i=this.rules.block.html.exec(n);if(i){const r={type:"html",raw:i[0],pre:!this.options.sanitizer&&(i[1]==="pre"||i[1]==="script"||i[1]==="style"),text:i[0]};if(this.options.sanitize){const s=this.options.sanitizer?this.options.sanitizer(i[0]):escape$1(i[0]);r.type="paragraph",r.text=s,r.tokens=this.lexer.inline(s)}return r}}def(n){const i=this.rules.block.def.exec(n);if(i){const r=i[1].toLowerCase().replace(/\s+/g," "),s=i[2]?i[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",o=i[3]?i[3].substring(1,i[3].length-1).replace(this.rules.inline._escapes,"$1"):i[3];return{type:"def",tag:r,raw:i[0],href:s,title:o}}}table(n){const i=this.rules.block.table.exec(n);if(i){const r={type:"table",header:splitCells(i[1]).map(s=>({text:s})),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:i[3]&&i[3].trim()?i[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){r.raw=i[0];let s=r.align.length,o,l,f,d;for(o=0;o<s;o++)/^ *-+: *$/.test(r.align[o])?r.align[o]="right":/^ *:-+: *$/.test(r.align[o])?r.align[o]="center":/^ *:-+ *$/.test(r.align[o])?r.align[o]="left":r.align[o]=null;for(s=r.rows.length,o=0;o<s;o++)r.rows[o]=splitCells(r.rows[o],r.header.length).map(p=>({text:p}));for(s=r.header.length,l=0;l<s;l++)r.header[l].tokens=this.lexer.inline(r.header[l].text);for(s=r.rows.length,l=0;l<s;l++)for(d=r.rows[l],f=0;f<d.length;f++)d[f].tokens=this.lexer.inline(d[f].text);return r}}}lheading(n){const i=this.rules.block.lheading.exec(n);if(i)return{type:"heading",raw:i[0],depth:i[2].charAt(0)==="="?1:2,text:i[1],tokens:this.lexer.inline(i[1])}}paragraph(n){const i=this.rules.block.paragraph.exec(n);if(i){const r=i[1].charAt(i[1].length-1)===`
`?i[1].slice(0,-1):i[1];return{type:"paragraph",raw:i[0],text:r,tokens:this.lexer.inline(r)}}}text(n){const i=this.rules.block.text.exec(n);if(i)return{type:"text",raw:i[0],text:i[0],tokens:this.lexer.inline(i[0])}}escape(n){const i=this.rules.inline.escape.exec(n);if(i)return{type:"escape",raw:i[0],text:escape$1(i[1])}}tag(n){const i=this.rules.inline.tag.exec(n);if(i)return!this.lexer.state.inLink&&/^<a /i.test(i[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(i[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:i[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):escape$1(i[0]):i[0]}}link(n){const i=this.rules.inline.link.exec(n);if(i){const r=i[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const l=rtrim(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{const l=findClosingBracket(i[2],"()");if(l>-1){const d=(i[0].indexOf("!")===0?5:4)+i[1].length+l;i[2]=i[2].substring(0,l),i[0]=i[0].substring(0,d).trim(),i[3]=""}}let s=i[2],o="";if(this.options.pedantic){const l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);l&&(s=l[1],o=l[3])}else o=i[3]?i[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(r)?s=s.slice(1):s=s.slice(1,-1)),outputLink(i,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},i[0],this.lexer)}}reflink(n,i){let r;if((r=this.rules.inline.reflink.exec(n))||(r=this.rules.inline.nolink.exec(n))){let s=(r[2]||r[1]).replace(/\s+/g," ");if(s=i[s.toLowerCase()],!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return outputLink(r,s,r[0],this.lexer)}}emStrong(n,i,r=""){let s=this.rules.inline.emStrong.lDelim.exec(n);if(!s||s[3]&&r.match(/[\p{L}\p{N}]/u))return;const o=s[1]||s[2]||"";if(!o||o&&(r===""||this.rules.inline.punctuation.exec(r))){const l=s[0].length-1;let f,d,p=l,g=0;const v=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(v.lastIndex=0,i=i.slice(-1*n.length+l);(s=v.exec(i))!=null;){if(f=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!f)continue;if(d=f.length,s[3]||s[4]){p+=d;continue}else if((s[5]||s[6])&&l%3&&!((l+d)%3)){g+=d;continue}if(p-=d,p>0)continue;d=Math.min(d,d+p+g);const S=n.slice(0,l+s.index+(s[0].length-f.length)+d);if(Math.min(l,d)%2){const k=S.slice(1,-1);return{type:"em",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}const T=S.slice(2,-2);return{type:"strong",raw:S,text:T,tokens:this.lexer.inlineTokens(T)}}}}codespan(n){const i=this.rules.inline.code.exec(n);if(i){let r=i[2].replace(/\n/g," ");const s=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return s&&o&&(r=r.substring(1,r.length-1)),r=escape$1(r,!0),{type:"codespan",raw:i[0],text:r}}}br(n){const i=this.rules.inline.br.exec(n);if(i)return{type:"br",raw:i[0]}}del(n){const i=this.rules.inline.del.exec(n);if(i)return{type:"del",raw:i[0],text:i[2],tokens:this.lexer.inlineTokens(i[2])}}autolink(n,i){const r=this.rules.inline.autolink.exec(n);if(r){let s,o;return r[2]==="@"?(s=escape$1(this.options.mangle?i(r[1]):r[1]),o="mailto:"+s):(s=escape$1(r[1]),o=s),{type:"link",raw:r[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}url(n,i){let r;if(r=this.rules.inline.url.exec(n)){let s,o;if(r[2]==="@")s=escape$1(this.options.mangle?i(r[0]):r[0]),o="mailto:"+s;else{let l;do l=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0];while(l!==r[0]);s=escape$1(r[0]),r[1]==="www."?o="http://"+r[0]:o=r[0]}return{type:"link",raw:r[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(n,i){const r=this.rules.inline.text.exec(n);if(r){let s;return this.lexer.state.inRawBlock?s=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):escape$1(r[0]):r[0]:s=escape$1(this.options.smartypants?i(r[0]):r[0]),{type:"text",raw:r[0],text:s}}}};const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex();block.bullet=/(?:[*+-]|\d{1,9}[.)])/;block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex();block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex();block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex();block.normal=merge$4({},block);block.gfm=merge$4({},block.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.pedantic=merge$4({},block.normal,{html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex();inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;inline.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex();inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex();inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex();inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex();inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex();inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex();inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex();inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex();inline.normal=merge$4({},inline);inline.pedantic=merge$4({},inline.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()});inline.gfm=merge$4({},inline.normal,{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex();inline.breaks=merge$4({},inline.gfm,{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function smartypants(e){return e.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function mangle(e){let n="",i,r;const s=e.length;for(i=0;i<s;i++)r=e.charCodeAt(i),Math.random()>.5&&(r="x"+r.toString(16)),n+="&#"+r+";";return n}class Lexer{constructor(n){this.tokens=[],this.tokens.links=Object.create(null),this.options=n||defaults$1,this.options.tokenizer=this.options.tokenizer||new Tokenizer$1,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const i={block:block.normal,inline:inline.normal};this.options.pedantic?(i.block=block.pedantic,i.inline=inline.pedantic):this.options.gfm&&(i.block=block.gfm,this.options.breaks?i.inline=inline.breaks:i.inline=inline.gfm),this.tokenizer.rules=i}static get rules(){return{block,inline}}static lex(n,i){return new Lexer(i).lex(n)}static lexInline(n,i){return new Lexer(i).inlineTokens(n)}lex(n){n=n.replace(/\r\n|\r/g,`
`),this.blockTokens(n,this.tokens);let i;for(;i=this.inlineQueue.shift();)this.inlineTokens(i.src,i.tokens);return this.tokens}blockTokens(n,i=[]){this.options.pedantic?n=n.replace(/\t/g,"    ").replace(/^ +$/gm,""):n=n.replace(/^( *)(\t+)/gm,(f,d,p)=>d+"    ".repeat(p.length));let r,s,o,l;for(;n;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(f=>(r=f.call({lexer:this},n,i))?(n=n.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.space(n)){n=n.substring(r.raw.length),r.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(r);continue}if(r=this.tokenizer.code(n)){n=n.substring(r.raw.length),s=i[i.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(r);continue}if(r=this.tokenizer.fences(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.heading(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.hr(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.blockquote(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.list(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.html(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.def(n)){n=n.substring(r.raw.length),s=i[i.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.lheading(n)){n=n.substring(r.raw.length),i.push(r);continue}if(o=n,this.options.extensions&&this.options.extensions.startBlock){let f=1/0;const d=n.slice(1);let p;this.options.extensions.startBlock.forEach(function(g){p=g.call({lexer:this},d),typeof p=="number"&&p>=0&&(f=Math.min(f,p))}),f<1/0&&f>=0&&(o=n.substring(0,f+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){s=i[i.length-1],l&&s.type==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(r),l=o.length!==n.length,n=n.substring(r.raw.length);continue}if(r=this.tokenizer.text(n)){n=n.substring(r.raw.length),s=i[i.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(r);continue}if(n){const f="Infinite loop on byte: "+n.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return this.state.top=!0,i}inline(n,i=[]){return this.inlineQueue.push({src:n,tokens:i}),i}inlineTokens(n,i=[]){let r,s,o,l=n,f,d,p;if(this.tokens.links){const g=Object.keys(this.tokens.links);if(g.length>0)for(;(f=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)g.includes(f[0].slice(f[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,f.index)+"["+repeatString("a",f[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(f=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,f.index)+"["+repeatString("a",f[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(f=this.tokenizer.rules.inline.escapedEmSt.exec(l))!=null;)l=l.slice(0,f.index+f[0].length-2)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;n;)if(d||(p=""),d=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(g=>(r=g.call({lexer:this},n,i))?(n=n.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.escape(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.tag(n)){n=n.substring(r.raw.length),s=i[i.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):i.push(r);continue}if(r=this.tokenizer.link(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.reflink(n,this.tokens.links)){n=n.substring(r.raw.length),s=i[i.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):i.push(r);continue}if(r=this.tokenizer.emStrong(n,l,p)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.codespan(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.br(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.del(n)){n=n.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.autolink(n,mangle)){n=n.substring(r.raw.length),i.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(n,mangle))){n=n.substring(r.raw.length),i.push(r);continue}if(o=n,this.options.extensions&&this.options.extensions.startInline){let g=1/0;const v=n.slice(1);let S;this.options.extensions.startInline.forEach(function(T){S=T.call({lexer:this},v),typeof S=="number"&&S>=0&&(g=Math.min(g,S))}),g<1/0&&g>=0&&(o=n.substring(0,g+1))}if(r=this.tokenizer.inlineText(o,smartypants)){n=n.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(p=r.raw.slice(-1)),d=!0,s=i[i.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):i.push(r);continue}if(n){const g="Infinite loop on byte: "+n.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return i}}let Renderer$1=class{constructor(n){this.options=n||defaults$1}code(n,i,r){const s=(i||"").match(/\S*/)[0];if(this.options.highlight){const o=this.options.highlight(n,s);o!=null&&o!==n&&(r=!0,n=o)}return n=n.replace(/\n$/,"")+`
`,s?'<pre><code class="'+this.options.langPrefix+escape$1(s)+'">'+(r?n:escape$1(n,!0))+`</code></pre>
`:"<pre><code>"+(r?n:escape$1(n,!0))+`</code></pre>
`}blockquote(n){return`<blockquote>
${n}</blockquote>
`}html(n){return n}heading(n,i,r,s){if(this.options.headerIds){const o=this.options.headerPrefix+s.slug(r);return`<h${i} id="${o}">${n}</h${i}>
`}return`<h${i}>${n}</h${i}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(n,i,r){const s=i?"ol":"ul",o=i&&r!==1?' start="'+r+'"':"";return"<"+s+o+`>
`+n+"</"+s+`>
`}listitem(n){return`<li>${n}</li>
`}checkbox(n){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(n){return`<p>${n}</p>
`}table(n,i){return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+i+`</table>
`}tablerow(n){return`<tr>
${n}</tr>
`}tablecell(n,i){const r=i.header?"th":"td";return(i.align?`<${r} align="${i.align}">`:`<${r}>`)+n+`</${r}>
`}strong(n){return`<strong>${n}</strong>`}em(n){return`<em>${n}</em>`}codespan(n){return`<code>${n}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(n){return`<del>${n}</del>`}link(n,i,r){if(n=cleanUrl(this.options.sanitize,this.options.baseUrl,n),n===null)return r;let s='<a href="'+n+'"';return i&&(s+=' title="'+i+'"'),s+=">"+r+"</a>",s}image(n,i,r){if(n=cleanUrl(this.options.sanitize,this.options.baseUrl,n),n===null)return r;let s=`<img src="${n}" alt="${r}"`;return i&&(s+=` title="${i}"`),s+=this.options.xhtml?"/>":">",s}text(n){return n}};class TextRenderer{strong(n){return n}em(n){return n}codespan(n){return n}del(n){return n}html(n){return n}text(n){return n}link(n,i,r){return""+r}image(n,i,r){return""+r}br(){return""}}class Slugger{constructor(){this.seen={}}serialize(n){return n.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(n,i){let r=n,s=0;if(this.seen.hasOwnProperty(r)){s=this.seen[n];do s++,r=n+"-"+s;while(this.seen.hasOwnProperty(r))}return i||(this.seen[n]=s,this.seen[r]=0),r}slug(n,i={}){const r=this.serialize(n);return this.getNextSafeSlug(r,i.dryrun)}}let Parser$4=class{constructor(n){this.options=n||defaults$1,this.options.renderer=this.options.renderer||new Renderer$1,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(n,i){return new Parser$4(i).parse(n)}static parseInline(n,i){return new Parser$4(i).parseInline(n)}parse(n,i=!0){let r="",s,o,l,f,d,p,g,v,S,T,k,O,R,P,F,I,L,N,j;const z=n.length;for(s=0;s<z;s++){if(T=n[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[T.type]&&(j=this.options.extensions.renderers[T.type].call({parser:this},T),j!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(T.type))){r+=j||"";continue}switch(T.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{r+=this.renderer.heading(this.parseInline(T.tokens),T.depth,unescape$1(this.parseInline(T.tokens,this.textRenderer)),this.slugger);continue}case"code":{r+=this.renderer.code(T.text,T.lang,T.escaped);continue}case"table":{for(v="",g="",f=T.header.length,o=0;o<f;o++)g+=this.renderer.tablecell(this.parseInline(T.header[o].tokens),{header:!0,align:T.align[o]});for(v+=this.renderer.tablerow(g),S="",f=T.rows.length,o=0;o<f;o++){for(p=T.rows[o],g="",d=p.length,l=0;l<d;l++)g+=this.renderer.tablecell(this.parseInline(p[l].tokens),{header:!1,align:T.align[l]});S+=this.renderer.tablerow(g)}r+=this.renderer.table(v,S);continue}case"blockquote":{S=this.parse(T.tokens),r+=this.renderer.blockquote(S);continue}case"list":{for(k=T.ordered,O=T.start,R=T.loose,f=T.items.length,S="",o=0;o<f;o++)F=T.items[o],I=F.checked,L=F.task,P="",F.task&&(N=this.renderer.checkbox(I),R?F.tokens.length>0&&F.tokens[0].type==="paragraph"?(F.tokens[0].text=N+" "+F.tokens[0].text,F.tokens[0].tokens&&F.tokens[0].tokens.length>0&&F.tokens[0].tokens[0].type==="text"&&(F.tokens[0].tokens[0].text=N+" "+F.tokens[0].tokens[0].text)):F.tokens.unshift({type:"text",text:N}):P+=N),P+=this.parse(F.tokens,R),S+=this.renderer.listitem(P,L,I);r+=this.renderer.list(S,k,O);continue}case"html":{r+=this.renderer.html(T.text);continue}case"paragraph":{r+=this.renderer.paragraph(this.parseInline(T.tokens));continue}case"text":{for(S=T.tokens?this.parseInline(T.tokens):T.text;s+1<z&&n[s+1].type==="text";)T=n[++s],S+=`
`+(T.tokens?this.parseInline(T.tokens):T.text);r+=i?this.renderer.paragraph(S):S;continue}default:{const q='Token with "'+T.type+'" type was not found.';if(this.options.silent){console.error(q);return}else throw new Error(q)}}}return r}parseInline(n,i){i=i||this.renderer;let r="",s,o,l;const f=n.length;for(s=0;s<f;s++){if(o=n[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]&&(l=this.options.extensions.renderers[o.type].call({parser:this},o),l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type))){r+=l||"";continue}switch(o.type){case"escape":{r+=i.text(o.text);break}case"html":{r+=i.html(o.text);break}case"link":{r+=i.link(o.href,o.title,this.parseInline(o.tokens,i));break}case"image":{r+=i.image(o.href,o.title,o.text);break}case"strong":{r+=i.strong(this.parseInline(o.tokens,i));break}case"em":{r+=i.em(this.parseInline(o.tokens,i));break}case"codespan":{r+=i.codespan(o.text);break}case"br":{r+=i.br();break}case"del":{r+=i.del(this.parseInline(o.tokens,i));break}case"text":{r+=i.text(o.text);break}default:{const d='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(d);return}else throw new Error(d)}}}return r}};function marked(e,n,i){if(typeof e>"u"||e===null)throw new Error("marked(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(typeof n=="function"&&(i=n,n=null),n=merge$4({},marked.defaults,n||{}),checkSanitizeDeprecation(n),i){const s=n.highlight;let o;try{o=Lexer.lex(e,n)}catch(d){return i(d)}const l=function(d){let p;if(!d)try{n.walkTokens&&marked.walkTokens(o,n.walkTokens),p=Parser$4.parse(o,n)}catch(g){d=g}return n.highlight=s,d?i(d):i(null,p)};if(!s||s.length<3||(delete n.highlight,!o.length))return l();let f=0;marked.walkTokens(o,function(d){d.type==="code"&&(f++,setTimeout(()=>{s(d.text,d.lang,function(p,g){if(p)return l(p);g!=null&&g!==d.text&&(d.text=g,d.escaped=!0),f--,f===0&&l()})},0))}),f===0&&l();return}function r(s){if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,n.silent)return"<p>An error occurred:</p><pre>"+escape$1(s.message+"",!0)+"</pre>";throw s}try{const s=Lexer.lex(e,n);if(n.walkTokens){if(n.async)return Promise.all(marked.walkTokens(s,n.walkTokens)).then(()=>Parser$4.parse(s,n)).catch(r);marked.walkTokens(s,n.walkTokens)}return Parser$4.parse(s,n)}catch(s){r(s)}}marked.options=marked.setOptions=function(e){return merge$4(marked.defaults,e),changeDefaults(marked.defaults),marked};marked.getDefaults=getDefaults;marked.defaults=defaults$1;marked.use=function(...e){const n=marked.defaults.extensions||{renderers:{},childTokens:{}};e.forEach(i=>{const r=merge$4({},i);if(r.async=marked.defaults.async||r.async,i.extensions&&(i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const o=n.renderers[s.name];o?n.renderers[s.name]=function(...l){let f=s.renderer.apply(this,l);return f===!1&&(f=o.apply(this,l)),f}:n.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");n[s.level]?n[s.level].unshift(s.tokenizer):n[s.level]=[s.tokenizer],s.start&&(s.level==="block"?n.startBlock?n.startBlock.push(s.start):n.startBlock=[s.start]:s.level==="inline"&&(n.startInline?n.startInline.push(s.start):n.startInline=[s.start]))}s.childTokens&&(n.childTokens[s.name]=s.childTokens)}),r.extensions=n),i.renderer){const s=marked.defaults.renderer||new Renderer$1;for(const o in i.renderer){const l=s[o];s[o]=(...f)=>{let d=i.renderer[o].apply(s,f);return d===!1&&(d=l.apply(s,f)),d}}r.renderer=s}if(i.tokenizer){const s=marked.defaults.tokenizer||new Tokenizer$1;for(const o in i.tokenizer){const l=s[o];s[o]=(...f)=>{let d=i.tokenizer[o].apply(s,f);return d===!1&&(d=l.apply(s,f)),d}}r.tokenizer=s}if(i.walkTokens){const s=marked.defaults.walkTokens;r.walkTokens=function(o){let l=[];return l.push(i.walkTokens.call(this,o)),s&&(l=l.concat(s.call(this,o))),l}}marked.setOptions(r)})};marked.walkTokens=function(e,n){let i=[];for(const r of e)switch(i=i.concat(n.call(marked,r)),r.type){case"table":{for(const s of r.header)i=i.concat(marked.walkTokens(s.tokens,n));for(const s of r.rows)for(const o of s)i=i.concat(marked.walkTokens(o.tokens,n));break}case"list":{i=i.concat(marked.walkTokens(r.items,n));break}default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[r.type]?marked.defaults.extensions.childTokens[r.type].forEach(function(s){i=i.concat(marked.walkTokens(r[s],n))}):r.tokens&&(i=i.concat(marked.walkTokens(r.tokens,n)))}return i};marked.parseInline=function(e,n){if(typeof e>"u"||e===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");n=merge$4({},marked.defaults,n||{}),checkSanitizeDeprecation(n);try{const i=Lexer.lexInline(e,n);return n.walkTokens&&marked.walkTokens(i,n.walkTokens),Parser$4.parseInline(i,n)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,n.silent)return"<p>An error occurred:</p><pre>"+escape$1(i.message+"",!0)+"</pre>";throw i}};marked.Parser=Parser$4;marked.parser=Parser$4.parse;marked.Renderer=Renderer$1;marked.TextRenderer=TextRenderer;marked.Lexer=Lexer;marked.lexer=Lexer.lex;marked.Tokenizer=Tokenizer$1;marked.Slugger=Slugger;marked.parse=marked;marked.options;marked.setOptions;marked.use;marked.walkTokens;marked.parseInline;Parser$4.parse;Lexer.lex;function create_fragment$b(e){let n,i=marked.parse(e[0])+"",r;return{c(){n=element$2("div"),this.h()},l(s){n=claim_element(s,"DIV",{class:!0});var o=children$2(n);o.forEach(detach),this.h()},h(){attr$6(n,"class",r="prose "+e[1])},m(s,o){insert_hydration(s,n,o),n.innerHTML=i},p(s,[o]){o&1&&i!==(i=marked.parse(s[0])+"")&&(n.innerHTML=i),o&2&&r!==(r="prose "+s[1])&&attr$6(n,"class",r)},i:noop$6,o:noop$6,d(s){s&&detach(n)}}}function instance$b(e,n,i){let{body:r}=n,{classes:s=""}=n,{baseUrl:o=null}=n,{breaks:l=!1}=n,{gfm:f=!0}=n,{headerIds:d=!0}=n,{headerPrefix:p=""}=n,{langPrefix:g="language-"}=n,{mangle:v=!0}=n,{pedantic:S=!1}=n,{sanitize:T=!1}=n,{silent:k=!1}=n,{smartypants:O=!1}=n,{xhtml:R=!1}=n;return marked.setOptions({baseUrl:o,breaks:l,gfm:f,headerIds:d,headerPrefix:p,langPrefix:g,mangle:v,pedantic:S,sanitize:T,silent:k,smartypants:O,xhtml:R}),e.$$set=P=>{"body"in P&&i(0,r=P.body),"classes"in P&&i(1,s=P.classes),"baseUrl"in P&&i(2,o=P.baseUrl),"breaks"in P&&i(3,l=P.breaks),"gfm"in P&&i(4,f=P.gfm),"headerIds"in P&&i(5,d=P.headerIds),"headerPrefix"in P&&i(6,p=P.headerPrefix),"langPrefix"in P&&i(7,g=P.langPrefix),"mangle"in P&&i(8,v=P.mangle),"pedantic"in P&&i(9,S=P.pedantic),"sanitize"in P&&i(10,T=P.sanitize),"silent"in P&&i(11,k=P.silent),"smartypants"in P&&i(12,O=P.smartypants),"xhtml"in P&&i(13,R=P.xhtml)},[r,s,o,l,f,d,p,g,v,S,T,k,O,R]}class Markdown extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$b,create_fragment$b,safe_not_equal,{body:0,classes:1,baseUrl:2,breaks:3,gfm:4,headerIds:5,headerPrefix:6,langPrefix:7,mangle:8,pedantic:9,sanitize:10,silent:11,smartypants:12,xhtml:13})}}function create_fragment$a(e){let n,i,r;return{c(){n=element$2("input"),this.h()},l(s){n=claim_element(s,"INPUT",{type:!0,placeholder:!0,class:!0}),this.h()},h(){attr$6(n,"type","text"),attr$6(n,"placeholder",e[1]),n.value=e[3],attr$6(n,"class",e[2])},m(s,o){insert_hydration(s,n,o),i||(r=[listen(n,"keyup",e[8]),listen(n,"keypress",e[7]),listen(n,"blur",e[9])],i=!0)},p(s,[o]){o&2&&attr$6(n,"placeholder",s[1]),o&8&&n.value!==s[3]&&(n.value=s[3]),o&4&&attr$6(n,"class",s[2])},i:noop$6,o:noop$6,d(s){s&&detach(n),i=!1,run_all(r)}}}function instance$a(e,n,i){let{text:r}=n,{placeholder:s="Write some text..."}=n,{debounceTimer:o=150}=n,{classes:l="grow h-10 px-3 rounded-md shadow-md my-1 border-gray-400"}=n,f;const d=k=>{clearTimeout(f),f=setTimeout(()=>{console.log("debounding"),i(0,r=k.target.value),setTimeout(()=>{k.code=="Enter"&&g("keyenter",{text:r}),g("keyup",k)},3)},o)};let p;const g=createEventDispatcher();function v(k){bubble.call(this,e,k)}const S=k=>d(k),T=k=>{g("blur",{text:r})};return e.$$set=k=>{"text"in k&&i(0,r=k.text),"placeholder"in k&&i(1,s=k.placeholder),"debounceTimer"in k&&i(6,o=k.debounceTimer),"classes"in k&&i(2,l=k.classes)},e.$$.update=()=>{e.$$.dirty&1&&i(3,p=r)},[r,s,l,p,d,g,o,v,S,T]}class Textbox extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$a,create_fragment$a,safe_not_equal,{text:0,placeholder:1,debounceTimer:6,classes:2})}}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdfExports={},pdf={get exports(){return pdfExports},set exports(e){pdfExports=e}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,i){module.exports=i()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.UNSUPPORTED_FEATURES=n.TextRenderingMode=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=ue,n.bytesToString=Te,n.createPromiseCapability=Ge,n.createValidAbsoluteUrl=V,n.getModificationDate=Qe,n.getVerbosityLevel=ae,n.info=oe,n.isArrayBuffer=ze,n.isArrayEqual=Ve,n.objectFromMap=ge,n.objectSize=ce,n.setVerbosityLevel=Z,n.shadow=se,n.string32=ie,n.stringToBytes=te,n.stringToPDFString=je,n.stringToUTF8String=Me,n.unreachable=Se,n.utf8StringToString=Be,n.warn=pe;const i=[1,0,0,1,0,0];n.IDENTITY_MATRIX=i;const r=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=r;const s=1.35;n.LINE_FACTOR=s;const o=.35;n.LINE_DESCENT_FACTOR=o;const l=o/s;n.BASELINE_FACTOR=l;const f={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=f;const d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=d;const p="pdfjs_internal_editor_";n.AnnotationEditorPrefix=p;const g={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};n.AnnotationEditorType=g;const v={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};n.AnnotationEditorParamsType=v;const S={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=S;const T={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=T;const k={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=k;const O={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=O;const R={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=R;const P={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=P;const F={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=F;const I={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=I;const L={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=L;const N={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=N;const j={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=j;const z={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=z;const q={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=q;const H={O:"PageOpen",C:"PageClose"};n.PageActionEventType=H;const W={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=W;const U={NONE:0,BINARY:1};n.CMapCompressionType=U;const Q={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=Q;const J={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};n.UNSUPPORTED_FEATURES=J;const ne={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=ne;let G=W.WARNINGS;function Z(me){Number.isInteger(me)&&(G=me)}function ae(){return G}function oe(me){G>=W.INFOS&&console.log(`Info: ${me}`)}function pe(me){G>=W.WARNINGS&&console.log(`Warning: ${me}`)}function Se(me){throw new Error(me)}function ue(me,_e){me||Se(_e)}function ee(me){if(!me)return!1;switch(me.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function V(me,_e=null,Ee=null){if(!me)return null;try{if(Ee&&typeof me=="string"){if(Ee.addDefaultProtocol&&me.startsWith("www.")){const We=me.match(/\./g);We&&We.length>=2&&(me=`http://${me}`)}if(Ee.tryConvertEncoding)try{me=Me(me)}catch{}}const Ne=_e?new URL(me,_e):new URL(me);if(ee(Ne))return Ne}catch{}return null}function se(me,_e,Ee,Ne=!1){return Object.defineProperty(me,_e,{value:Ee,enumerable:!Ne,configurable:!0,writable:!1}),Ee}const fe=function(){function _e(Ee,Ne){this.constructor===_e&&Se("Cannot initialize BaseException."),this.message=Ee,this.name=Ne}return _e.prototype=new Error,_e.constructor=_e,_e}();n.BaseException=fe;class he extends fe{constructor(_e,Ee){super(_e,"PasswordException"),this.code=Ee}}n.PasswordException=he;class be extends fe{constructor(_e,Ee){super(_e,"UnknownErrorException"),this.details=Ee}}n.UnknownErrorException=be;class xe extends fe{constructor(_e){super(_e,"InvalidPDFException")}}n.InvalidPDFException=xe;class ye extends fe{constructor(_e){super(_e,"MissingPDFException")}}n.MissingPDFException=ye;class we extends fe{constructor(_e,Ee){super(_e,"UnexpectedResponseException"),this.status=Ee}}n.UnexpectedResponseException=we;class $e extends fe{constructor(_e){super(_e,"FormatError")}}n.FormatError=$e;class ve extends fe{constructor(_e){super(_e,"AbortException")}}n.AbortException=ve;function Te(me){(typeof me!="object"||me===null||me.length===void 0)&&Se("Invalid argument for bytesToString");const _e=me.length,Ee=8192;if(_e<Ee)return String.fromCharCode.apply(null,me);const Ne=[];for(let We=0;We<_e;We+=Ee){const st=Math.min(We+Ee,_e),Ce=me.subarray(We,st);Ne.push(String.fromCharCode.apply(null,Ce))}return Ne.join("")}function te(me){typeof me!="string"&&Se("Invalid argument for stringToBytes");const _e=me.length,Ee=new Uint8Array(_e);for(let Ne=0;Ne<_e;++Ne)Ee[Ne]=me.charCodeAt(Ne)&255;return Ee}function ie(me){return String.fromCharCode(me>>24&255,me>>16&255,me>>8&255,me&255)}function ce(me){return Object.keys(me).length}function ge(me){const _e=Object.create(null);for(const[Ee,Ne]of me)_e[Ee]=Ne;return _e}function de(){const me=new Uint8Array(4);return me[0]=1,new Uint32Array(me.buffer,0,1)[0]===1}function Ae(){try{return new Function(""),!0}catch{return!1}}class Oe{static get isLittleEndian(){return se(this,"isLittleEndian",de())}static get isEvalSupported(){return se(this,"isEvalSupported",Ae())}static get isOffscreenCanvasSupported(){return se(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?se(this,"platform",{isWin:!1,isMac:!1}):se(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}n.FeatureTest=Oe;const Re=[...Array(256).keys()].map(me=>me.toString(16).padStart(2,"0"));class Ie{static makeHexColor(_e,Ee,Ne){return`#${Re[_e]}${Re[Ee]}${Re[Ne]}`}static scaleMinMax(_e,Ee){let Ne;_e[0]?(_e[0]<0&&(Ne=Ee[0],Ee[0]=Ee[1],Ee[1]=Ne),Ee[0]*=_e[0],Ee[1]*=_e[0],_e[3]<0&&(Ne=Ee[2],Ee[2]=Ee[3],Ee[3]=Ne),Ee[2]*=_e[3],Ee[3]*=_e[3]):(Ne=Ee[0],Ee[0]=Ee[2],Ee[2]=Ne,Ne=Ee[1],Ee[1]=Ee[3],Ee[3]=Ne,_e[1]<0&&(Ne=Ee[2],Ee[2]=Ee[3],Ee[3]=Ne),Ee[2]*=_e[1],Ee[3]*=_e[1],_e[2]<0&&(Ne=Ee[0],Ee[0]=Ee[1],Ee[1]=Ne),Ee[0]*=_e[2],Ee[1]*=_e[2]),Ee[0]+=_e[4],Ee[1]+=_e[4],Ee[2]+=_e[5],Ee[3]+=_e[5]}static transform(_e,Ee){return[_e[0]*Ee[0]+_e[2]*Ee[1],_e[1]*Ee[0]+_e[3]*Ee[1],_e[0]*Ee[2]+_e[2]*Ee[3],_e[1]*Ee[2]+_e[3]*Ee[3],_e[0]*Ee[4]+_e[2]*Ee[5]+_e[4],_e[1]*Ee[4]+_e[3]*Ee[5]+_e[5]]}static applyTransform(_e,Ee){const Ne=_e[0]*Ee[0]+_e[1]*Ee[2]+Ee[4],We=_e[0]*Ee[1]+_e[1]*Ee[3]+Ee[5];return[Ne,We]}static applyInverseTransform(_e,Ee){const Ne=Ee[0]*Ee[3]-Ee[1]*Ee[2],We=(_e[0]*Ee[3]-_e[1]*Ee[2]+Ee[2]*Ee[5]-Ee[4]*Ee[3])/Ne,st=(-_e[0]*Ee[1]+_e[1]*Ee[0]+Ee[4]*Ee[1]-Ee[5]*Ee[0])/Ne;return[We,st]}static getAxialAlignedBoundingBox(_e,Ee){const Ne=Ie.applyTransform(_e,Ee),We=Ie.applyTransform(_e.slice(2,4),Ee),st=Ie.applyTransform([_e[0],_e[3]],Ee),Ce=Ie.applyTransform([_e[2],_e[1]],Ee);return[Math.min(Ne[0],We[0],st[0],Ce[0]),Math.min(Ne[1],We[1],st[1],Ce[1]),Math.max(Ne[0],We[0],st[0],Ce[0]),Math.max(Ne[1],We[1],st[1],Ce[1])]}static inverseTransform(_e){const Ee=_e[0]*_e[3]-_e[1]*_e[2];return[_e[3]/Ee,-_e[1]/Ee,-_e[2]/Ee,_e[0]/Ee,(_e[2]*_e[5]-_e[4]*_e[3])/Ee,(_e[4]*_e[1]-_e[5]*_e[0])/Ee]}static singularValueDecompose2dScale(_e){const Ee=[_e[0],_e[2],_e[1],_e[3]],Ne=_e[0]*Ee[0]+_e[1]*Ee[2],We=_e[0]*Ee[1]+_e[1]*Ee[3],st=_e[2]*Ee[0]+_e[3]*Ee[2],Ce=_e[2]*Ee[1]+_e[3]*Ee[3],Fe=(Ne+Ce)/2,qe=Math.sqrt((Ne+Ce)**2-4*(Ne*Ce-st*We))/2,He=Fe+qe||1,Xe=Fe-qe||1;return[Math.sqrt(He),Math.sqrt(Xe)]}static normalizeRect(_e){const Ee=_e.slice(0);return _e[0]>_e[2]&&(Ee[0]=_e[2],Ee[2]=_e[0]),_e[1]>_e[3]&&(Ee[1]=_e[3],Ee[3]=_e[1]),Ee}static intersect(_e,Ee){const Ne=Math.max(Math.min(_e[0],_e[2]),Math.min(Ee[0],Ee[2])),We=Math.min(Math.max(_e[0],_e[2]),Math.max(Ee[0],Ee[2]));if(Ne>We)return null;const st=Math.max(Math.min(_e[1],_e[3]),Math.min(Ee[1],Ee[3])),Ce=Math.min(Math.max(_e[1],_e[3]),Math.max(Ee[1],Ee[3]));return st>Ce?null:[Ne,st,We,Ce]}static bezierBoundingBox(_e,Ee,Ne,We,st,Ce,Fe,qe){const He=[],Xe=[[],[]];let tt,Je,Ye,Ke,et,ct,ot,rt;for(let ft=0;ft<2;++ft){if(ft===0?(Je=6*_e-12*Ne+6*st,tt=-3*_e+9*Ne-9*st+3*Fe,Ye=3*Ne-3*_e):(Je=6*Ee-12*We+6*Ce,tt=-3*Ee+9*We-9*Ce+3*qe,Ye=3*We-3*Ee),Math.abs(tt)<1e-12){if(Math.abs(Je)<1e-12)continue;Ke=-Ye/Je,0<Ke&&Ke<1&&He.push(Ke);continue}ot=Je*Je-4*Ye*tt,rt=Math.sqrt(ot),!(ot<0)&&(et=(-Je+rt)/(2*tt),0<et&&et<1&&He.push(et),ct=(-Je-rt)/(2*tt),0<ct&&ct<1&&He.push(ct))}let ut=He.length,it;const dt=ut;for(;ut--;)Ke=He[ut],it=1-Ke,Xe[0][ut]=it*it*it*_e+3*it*it*Ke*Ne+3*it*Ke*Ke*st+Ke*Ke*Ke*Fe,Xe[1][ut]=it*it*it*Ee+3*it*it*Ke*We+3*it*Ke*Ke*Ce+Ke*Ke*Ke*qe;return Xe[0][dt]=_e,Xe[1][dt]=Ee,Xe[0][dt+1]=Fe,Xe[1][dt+1]=qe,Xe[0].length=Xe[1].length=dt+2,[Math.min(...Xe[0]),Math.min(...Xe[1]),Math.max(...Xe[0]),Math.max(...Xe[1])]}}n.Util=Ie;const ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function je(me){if(me[0]>=""){let Ee;if(me[0]===""&&me[1]===""?Ee="utf-16be":me[0]===""&&me[1]===""?Ee="utf-16le":me[0]===""&&me[1]===""&&me[2]===""&&(Ee="utf-8"),Ee)try{const Ne=new TextDecoder(Ee,{fatal:!0}),We=te(me);return Ne.decode(We)}catch(Ne){pe(`stringToPDFString: "${Ne}".`)}}const _e=[];for(let Ee=0,Ne=me.length;Ee<Ne;Ee++){const We=ke[me.charCodeAt(Ee)];_e.push(We?String.fromCharCode(We):me.charAt(Ee))}return _e.join("")}function Me(me){return decodeURIComponent(escape(me))}function Be(me){return unescape(encodeURIComponent(me))}function ze(me){return typeof me=="object"&&me!==null&&me.byteLength!==void 0}function Ve(me,_e){if(me.length!==_e.length)return!1;for(let Ee=0,Ne=me.length;Ee<Ne;Ee++)if(me[Ee]!==_e[Ee])return!1;return!0}function Qe(me=new Date){return[me.getUTCFullYear().toString(),(me.getUTCMonth()+1).toString().padStart(2,"0"),me.getUTCDate().toString().padStart(2,"0"),me.getUTCHours().toString().padStart(2,"0"),me.getUTCMinutes().toString().padStart(2,"0"),me.getUTCSeconds().toString().padStart(2,"0")].join("")}function Ge(){const me=Object.create(null);let _e=!1;return Object.defineProperty(me,"settled",{get(){return _e}}),me.promise=new Promise(function(Ee,Ne){me.resolve=function(We){_e=!0,Ee(We)},me.reject=function(We){_e=!0,Ne(We)}}),me}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var e,n,r,s,o,l,f,d,p,g,ti,S,T,ni,O,R;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:F,NodeCMapReaderFactory:I,NodeStandardFontDataFactory:L}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=F,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=I,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=L}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:F}=__w_pdfjs_require__(21);createPDFNetworkStream=I=>new F(I)}else{const{PDFNetworkStream:F}=__w_pdfjs_require__(24),{PDFFetchStream:I}=__w_pdfjs_require__(25);createPDFNetworkStream=L=>(0,_display_utils.isValidFetchUrl)(L.url)?new I(L):new F(L)}function getDocument(F){if(typeof F=="string"||F instanceof URL)F={url:F};else if((0,_util.isArrayBuffer)(F))F={data:F};else if(F instanceof PDFDataRangeTransport)(0,_display_utils.deprecated)("`PDFDataRangeTransport`-instance, please use a parameter object with `range`-property instead."),F={range:F};else if(typeof F!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!F.url&&!F.data&&!F.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const I=new PDFDocumentLoadingTask,L=F.url?getUrlProp(F.url):null,N=F.data?getDataProp(F.data):null,j=F.httpHeaders||null,z=F.withCredentials===!0,q=F.password??null,H=F.range instanceof PDFDataRangeTransport?F.range:null,W=Number.isInteger(F.rangeChunkSize)&&F.rangeChunkSize>0?F.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let U=F.worker instanceof PDFWorker?F.worker:null;const Q=F.verbosity,J=typeof F.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(F.docBaseUrl)?F.docBaseUrl:null,ne=typeof F.cMapUrl=="string"?F.cMapUrl:null,G=F.cMapPacked!==!1,Z=F.CMapReaderFactory||DefaultCMapReaderFactory,ae=typeof F.standardFontDataUrl=="string"?F.standardFontDataUrl:null,oe=F.StandardFontDataFactory||DefaultStandardFontDataFactory,pe=F.stopAtErrors!==!0,Se=Number.isInteger(F.maxImageSize)&&F.maxImageSize>-1?F.maxImageSize:-1,ue=F.isEvalSupported!==!1,ee=typeof F.isOffscreenCanvasSupported=="boolean"?F.isOffscreenCanvasSupported:!_is_node.isNodeJS,V=typeof F.disableFontFace=="boolean"?F.disableFontFace:_is_node.isNodeJS,se=F.fontExtraProperties===!0,fe=F.enableXfa===!0,he=F.ownerDocument||globalThis.document,be=F.disableRange===!0,xe=F.disableStream===!0,ye=F.disableAutoFetch===!0,we=F.pdfBug===!0,$e=H?H.length:F.length??NaN,ve=typeof F.useSystemFonts=="boolean"?F.useSystemFonts:!_is_node.isNodeJS&&!V,Te=typeof F.useWorkerFetch=="boolean"?F.useWorkerFetch:Z===_display_utils.DOMCMapReaderFactory&&oe===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(ne,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ae,document.baseURI),te=null;(0,_util.setVerbosityLevel)(Q);const ie=Te?null:{cMapReaderFactory:new Z({baseUrl:ne,isCompressed:G}),standardFontDataFactory:new oe({baseUrl:ae})};if(!U){const Ae={verbosity:Q,port:_worker_options.GlobalWorkerOptions.workerPort};U=Ae.port?PDFWorker.fromPort(Ae):new PDFWorker(Ae),I._worker=U}const ce=I.docId,ge={docId:ce,apiVersion:"3.4.120",data:N,password:q,disableAutoFetch:ye,rangeChunkSize:W,length:$e,docBaseUrl:J,enableXfa:fe,evaluatorOptions:{maxImageSize:Se,disableFontFace:V,ignoreErrors:pe,isEvalSupported:ue,isOffscreenCanvasSupported:ee,fontExtraProperties:se,useSystemFonts:ve,cMapUrl:Te?ne:null,standardFontDataUrl:Te?ae:null}},de={ignoreErrors:pe,isEvalSupported:ue,disableFontFace:V,fontExtraProperties:se,enableXfa:fe,ownerDocument:he,disableAutoFetch:ye,pdfBug:we,styleElement:te};return U.promise.then(function(){if(I.destroyed)throw new Error("Loading aborted");const Ae=_fetchDocument(U,ge),Oe=new Promise(function(Re){let Ie;H?Ie=new _transport_stream.PDFDataTransportStream({length:$e,initialData:H.initialData,progressiveDone:H.progressiveDone,contentDispositionFilename:H.contentDispositionFilename,disableRange:be,disableStream:xe},H):N||(Ie=createPDFNetworkStream({url:L,length:$e,httpHeaders:j,withCredentials:z,rangeChunkSize:W,disableRange:be,disableStream:xe})),Re(Ie)});return Promise.all([Ae,Oe]).then(function([Re,Ie]){if(I.destroyed)throw new Error("Loading aborted");const ke=new _message_handler.MessageHandler(ce,Re,U.port),je=new WorkerTransport(ke,I,Ie,de,ie);I._transport=je,ke.send("Ready",null)})}).catch(I._capability.reject),I}async function _fetchDocument(F,I){if(F.destroyed)throw new Error("Worker was destroyed");const L=await F.messageHandler.sendWithPromise("GetDocRequest",I,I.data?[I.data.buffer]:null);if(F.destroyed)throw new Error("Worker was destroyed");return L}function getUrlProp(F){if(F instanceof URL)return F.href;try{return new URL(F,window.location).href}catch{if(_is_node.isNodeJS&&typeof F=="string")return F}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(F){if(_is_node.isNodeJS&&typeof Buffer<"u"&&F instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(F);if(F instanceof Uint8Array&&F.byteLength===F.buffer.byteLength)return F;if(typeof F=="string")return(0,_util.stringToBytes)(F);if(typeof F=="object"&&!isNaN(F==null?void 0:F.length)||(0,_util.isArrayBuffer)(F))return new Uint8Array(F);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class{constructor(){De(this,n,null);this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ei(i,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get onUnsupportedFeature(){return le(this,n)}set onUnsupportedFeature(I){(0,_display_utils.deprecated)("The PDFDocumentLoadingTask onUnsupportedFeature property will be removed in the future."),Ue(this,n,I)}get promise(){return this._capability.promise}async destroy(){var I;this.destroyed=!0,await((I=this._transport)==null?void 0:I.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=i;e=new WeakMap,n=new WeakMap,De(PDFDocumentLoadingTask,e,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(I,L,N=!1,j=null){this.length=I,this.initialData=L,this.progressiveDone=N,this.contentDispositionFilename=j,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(I){this._rangeListeners.push(I)}addProgressListener(I){this._progressListeners.push(I)}addProgressiveReadListener(I){this._progressiveReadListeners.push(I)}addProgressiveDoneListener(I){this._progressiveDoneListeners.push(I)}onDataRange(I,L){for(const N of this._rangeListeners)N(I,L)}onDataProgress(I,L){this._readyCapability.promise.then(()=>{for(const N of this._progressListeners)N(I,L)})}onDataProgressiveRead(I){this._readyCapability.promise.then(()=>{for(const L of this._progressiveReadListeners)L(I)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const I of this._progressiveDoneListeners)I()})}transportReady(){this._readyCapability.resolve()}requestDataRange(I,L){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(I,L){this._pdfInfo=I,this._transport=L}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(I){return this._transport.getPage(I)}getPageIndex(I){return this._transport.getPageIndex(I)}getDestinations(){return this._transport.getDestinations()}getDestination(I){return this._transport.getDestination(I)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(I=!1){return this._transport.startCleanup(I||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(I,L,N,j,z=!1){this._pageIndex=I,this._pageInfo=L,this._ownerDocument=j,this._transport=N,this._stats=z?new _display_utils.StatTimer:null,this._pdfBug=z,this.commonObjs=N.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:I,rotation:L=this.rotate,offsetX:N=0,offsetY:j=0,dontFlip:z=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:I,rotation:L,offsetX:N,offsetY:j,dontFlip:z})}getAnnotations({intent:I="display"}={}){const L=this._transport.getRenderingIntent(I);return this._transport.getAnnotations(this._pageIndex,L.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var I;return((I=this._transport._htmlForXfa)==null?void 0:I.children[this._pageIndex])||null}render({canvasContext:I,viewport:L,intent:N="display",annotationMode:j=_util.AnnotationMode.ENABLE,transform:z=null,canvasFactory:q=null,background:H=null,optionalContentConfigPromise:W=null,annotationCanvasMap:U=null,pageColors:Q=null,printAnnotationStorage:J=null}){var ue,ee;(ue=this._stats)==null||ue.time("Overall");const ne=this._transport.getRenderingIntent(N,j,J);this.pendingCleanup=!1,W||(W=this._transport.getOptionalContentConfig());let G=this._intentStates.get(ne.cacheKey);G||(G=Object.create(null),this._intentStates.set(ne.cacheKey,G)),G.streamReaderCancelTimeout&&(clearTimeout(G.streamReaderCancelTimeout),G.streamReaderCancelTimeout=null);const Z=q||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),ae=!!(ne.renderingIntent&_util.RenderingIntentFlag.PRINT);G.displayReadyCapability||(G.displayReadyCapability=(0,_util.createPromiseCapability)(),G.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ee=this._stats)==null||ee.time("Page Request"),this._pumpOperatorList(ne));const oe=V=>{var se,fe;G.renderTasks.delete(pe),(this.cleanupAfterRender||ae)&&(this.pendingCleanup=!0),this._tryCleanup(),V?(pe.capability.reject(V),this._abortOperatorList({intentState:G,reason:V instanceof Error?V:new Error(V)})):pe.capability.resolve(),(se=this._stats)==null||se.timeEnd("Rendering"),(fe=this._stats)==null||fe.timeEnd("Overall")},pe=new InternalRenderTask({callback:oe,params:{canvasContext:I,viewport:L,transform:z,background:H},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:U,operatorList:G.operatorList,pageIndex:this._pageIndex,canvasFactory:Z,useRequestAnimationFrame:!ae,pdfBug:this._pdfBug,pageColors:Q});(G.renderTasks||(G.renderTasks=new Set)).add(pe);const Se=pe.task;return Promise.all([G.displayReadyCapability.promise,W]).then(([V,se])=>{var fe;if(this.pendingCleanup){oe();return}(fe=this._stats)==null||fe.time("Rendering"),pe.initializeGraphics({transparency:V,optionalContentConfig:se}),pe.operatorListChanged()}).catch(oe),Se}getOperatorList({intent:I="display",annotationMode:L=_util.AnnotationMode.ENABLE,printAnnotationStorage:N=null}={}){var W;function j(){q.operatorList.lastChunk&&(q.opListReadCapability.resolve(q.operatorList),q.renderTasks.delete(H))}const z=this._transport.getRenderingIntent(I,L,N,!0);let q=this._intentStates.get(z.cacheKey);q||(q=Object.create(null),this._intentStates.set(z.cacheKey,q));let H;return q.opListReadCapability||(H=Object.create(null),H.operatorListChanged=j,q.opListReadCapability=(0,_util.createPromiseCapability)(),(q.renderTasks||(q.renderTasks=new Set)).add(H),q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(W=this._stats)==null||W.time("Page Request"),this._pumpOperatorList(z)),q.opListReadCapability.promise}streamTextContent({disableCombineTextItems:I=!1,includeMarkedContent:L=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:I!==!0,includeMarkedContent:L===!0},{highWaterMark:100,size(j){return j.items.length}})}getTextContent(I={}){if(this._transport._htmlForXfa)return this.getXfa().then(N=>_xfa_text.XfaText.textContent(N));const L=this.streamTextContent(I);return new Promise(function(N,j){function z(){q.read().then(function({value:W,done:U}){if(U){N(H);return}Object.assign(H.styles,W.styles),H.items.push(...W.items),z()},j)}const q=L.getReader(),H={items:[],styles:Object.create(null)};z()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const I=[];for(const L of this._intentStates.values())if(this._abortOperatorList({intentState:L,reason:new Error("Page was destroyed."),force:!0}),!L.opListReadCapability)for(const N of L.renderTasks)I.push(N.completed),N.cancel();return this.objs.clear(),this.pendingCleanup=!1,Promise.all(I)}cleanup(I=!1){return this.pendingCleanup=!0,this._tryCleanup(I)}_tryCleanup(I=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:L,operatorList:N}of this._intentStates.values())if(L.size>0||!N.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),I&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(I,L){var j,z;const N=this._intentStates.get(L);N&&((j=this._stats)==null||j.timeEnd("Page Request"),(z=N.displayReadyCapability)==null||z.resolve(I))}_renderPageChunk(I,L){for(let N=0,j=I.length;N<j;N++)L.operatorList.fnArray.push(I.fnArray[N]),L.operatorList.argsArray.push(I.argsArray[N]);L.operatorList.lastChunk=I.lastChunk,L.operatorList.separateAnnots=I.separateAnnots;for(const N of L.renderTasks)N.operatorListChanged();I.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:I,cacheKey:L,annotationStorageMap:N}){const z=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:I,cacheKey:L,annotationStorage:N}).getReader(),q=this._intentStates.get(L);q.streamReader=z;const H=()=>{z.read().then(({value:W,done:U})=>{if(U){q.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(W,q),H())},W=>{if(q.streamReader=null,!this._transport.destroyed){if(q.operatorList){q.operatorList.lastChunk=!0;for(const U of q.renderTasks)U.operatorListChanged();this._tryCleanup()}if(q.displayReadyCapability)q.displayReadyCapability.reject(W);else if(q.opListReadCapability)q.opListReadCapability.reject(W);else throw W}})};H()}_abortOperatorList({intentState:I,reason:L,force:N=!1}){if(I.streamReader){if(I.streamReaderCancelTimeout&&(clearTimeout(I.streamReaderCancelTimeout),I.streamReaderCancelTimeout=null),!N){if(I.renderTasks.size>0)return;if(L instanceof _display_utils.RenderingCancelledException){let j=RENDERING_CANCELLED_TIMEOUT;L.extraDelay>0&&L.extraDelay<1e3&&(j+=L.extraDelay),I.streamReaderCancelTimeout=setTimeout(()=>{I.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:I,reason:L,force:!0})},j);return}}if(I.streamReader.cancel(new _util.AbortException(L.message)).catch(()=>{}),I.streamReader=null,!this._transport.destroyed){for(const[j,z]of this._intentStates)if(z===I){this._intentStates.delete(j);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){De(this,r,new Set);De(this,s,Promise.resolve())}postMessage(I,L){const N={data:structuredClone(I,L)};le(this,s).then(()=>{for(const j of le(this,r))j.call(this,N)})}addEventListener(I,L){le(this,r).add(L)}removeEventListener(I,L){le(this,r).delete(L)}terminate(){le(this,r).clear()}}r=new WeakMap,s=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const F=(o=document==null?void 0:document.currentScript)==null?void 0:o.src;F&&(PDFWorkerUtil.fallbackWorkerSrc=F.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(F,I){let L;try{if(L=new URL(F),!L.origin||L.origin==="null")return!1}catch{return!1}const N=new URL(I,L);return L.origin===N.origin},PDFWorkerUtil.createCDNWrapper=function(F){const I=`importScripts("${F}");`;return URL.createObjectURL(new Blob([I]))}}const _PDFWorker=class{constructor({name:F=null,port:I=null,verbosity:L=(0,_util.getVerbosityLevel)()}={}){if(I&&le(_PDFWorker,l).has(I))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=F,this.destroyed=!1,this.verbosity=L,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,I){le(_PDFWorker,l).set(I,this),this._initializeFromPort(I);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(F){this._port=F,this._messageHandler=new _message_handler.MessageHandler("main","worker",F),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:F}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,F)||(F=PDFWorkerUtil.createCDNWrapper(new URL(F,window.location).href));const I=new Worker(F),L=new _message_handler.MessageHandler("main","worker",I),N=()=>{I.removeEventListener("error",j),L.destroy(),I.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},j=()=>{this._webWorker||N()};I.addEventListener("error",j),L.on("test",q=>{if(I.removeEventListener("error",j),this.destroyed){N();return}q?(this._messageHandler=L,this._port=I,this._webWorker=I,this._readyCapability.resolve(),L.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),L.destroy(),I.terminate())}),L.on("ready",q=>{if(I.removeEventListener("error",j),this.destroyed){N();return}try{z()}catch{this._setupFakeWorker()}});const z=()=>{const q=new Uint8Array;L.send("test",q,[q.buffer])};z();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(F=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const I=new LoopbackPort;this._port=I;const L=`fake${PDFWorkerUtil.fakeWorkerId++}`,N=new _message_handler.MessageHandler(L+"_worker",L,I);F.setup(N,I);const j=new _message_handler.MessageHandler(L,L+"_worker",I);this._messageHandler=j,this._readyCapability.resolve(),j.send("configure",{verbosity:this.verbosity})}).catch(F=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${F.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),le(_PDFWorker,l).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(F){if(!(F!=null&&F.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return le(this,l).has(F.port)?le(this,l).get(F.port):new _PDFWorker(F)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var F;try{return((F=globalThis.pdfjsWorker)==null?void 0:F.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;l=new WeakMap,De(PDFWorker,l,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(I,L,N,j,z){De(this,g);De(this,f,new Map);De(this,d,new Map);De(this,p,new Map);this.messageHandler=I,this.loadingTask=L,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:j.ownerDocument,styleElement:j.styleElement}),this._params=j,this.cMapReaderFactory=z==null?void 0:z.cMapReaderFactory,this.standardFontDataFactory=z==null?void 0:z.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=N,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(I,L=_util.AnnotationMode.ENABLE,N=null,j=!1){let z=_util.RenderingIntentFlag.DISPLAY,q=null;switch(I){case"any":z=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":z=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${I}`)}switch(L){case _util.AnnotationMode.DISABLE:z+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:z+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:z+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,q=(z&_util.RenderingIntentFlag.PRINT&&N instanceof _annotation_storage.PrintAnnotationStorage?N:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${L}`)}return j&&(z+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:z,cacheKey:`${z}_${_annotation_storage.AnnotationStorage.getHash(q)}`,annotationStorageMap:q}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const I=[];for(const N of le(this,d).values())I.push(N._destroy());le(this,d).clear(),le(this,p).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const L=this.messageHandler.sendWithPromise("Terminate",null);return I.push(L),Promise.all(I).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),le(this,f).clear(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:I,loadingTask:L}=this;I.on("GetReader",(N,j)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=z=>{this._lastProgress={loaded:z.loaded,total:z.total}},j.onPull=()=>{this._fullReader.read().then(function({value:z,done:q}){if(q){j.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),j.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{j.error(z)})},j.onCancel=z=>{this._fullReader.cancel(z),j.ready.catch(q=>{if(!this.destroyed)throw q})}}),I.on("ReaderHeadersReady",N=>{const j=(0,_util.createPromiseCapability)(),z=this._fullReader;return z.headersReady.then(()=>{var q;(!z.isStreamingSupported||!z.isRangeSupported)&&(this._lastProgress&&((q=L.onProgress)==null||q.call(L,this._lastProgress)),z.onProgress=H=>{var W;(W=L.onProgress)==null||W.call(L,{loaded:H.loaded,total:H.total})}),j.resolve({isStreamingSupported:z.isStreamingSupported,isRangeSupported:z.isRangeSupported,contentLength:z.contentLength})},j.reject),j.promise}),I.on("GetRangeReader",(N,j)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const z=this._networkStream.getRangeReader(N.begin,N.end);if(!z){j.close();return}j.onPull=()=>{z.read().then(function({value:q,done:H}){if(H){j.close();return}(0,_util.assert)(q instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),j.enqueue(new Uint8Array(q),1,[q])}).catch(q=>{j.error(q)})},j.onCancel=q=>{z.cancel(q),j.ready.catch(H=>{if(!this.destroyed)throw H})}}),I.on("GetDoc",({pdfInfo:N})=>{this._numPages=N.numPages,this._htmlForXfa=N.htmlForXfa,delete N.htmlForXfa,L._capability.resolve(new PDFDocumentProxy(N,this))}),I.on("DocException",function(N){let j;switch(N.name){case"PasswordException":j=new _util.PasswordException(N.message,N.code);break;case"InvalidPDFException":j=new _util.InvalidPDFException(N.message);break;case"MissingPDFException":j=new _util.MissingPDFException(N.message);break;case"UnexpectedResponseException":j=new _util.UnexpectedResponseException(N.message,N.status);break;case"UnknownErrorException":j=new _util.UnknownErrorException(N.message,N.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}L._capability.reject(j)}),I.on("PasswordRequest",N=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),L.onPassword){const j=z=>{z instanceof Error?this._passwordCapability.reject(z):this._passwordCapability.resolve({password:z})};try{L.onPassword(j,N.code)}catch(z){this._passwordCapability.reject(z)}}else this._passwordCapability.reject(new _util.PasswordException(N.message,N.code));return this._passwordCapability.promise}),I.on("DataLoaded",N=>{var j;(j=L.onProgress)==null||j.call(L,{loaded:N.length,total:N.length}),this.downloadInfoCapability.resolve(N)}),I.on("StartRenderPage",N=>{if(this.destroyed)return;le(this,d).get(N.pageIndex)._startRenderPage(N.transparency,N.cacheKey)}),I.on("commonobj",([N,j,z])=>{var q;if(!this.destroyed&&!this.commonObjs.has(N))switch(j){case"Font":const H=this._params;if("error"in z){const Q=z.error;(0,_util.warn)(`Error during font loading: ${Q}`),this.commonObjs.resolve(N,Q);break}let W=null;H.pdfBug&&((q=globalThis.FontInspector)!=null&&q.enabled)&&(W={registerFont(Q,J){globalThis.FontInspector.fontAdded(Q,J)}});const U=new _font_loader.FontFaceObject(z,{isEvalSupported:H.isEvalSupported,disableFontFace:H.disableFontFace,ignoreErrors:H.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:W});this.fontLoader.bind(U).catch(Q=>I.sendWithPromise("FontFallback",{id:N})).finally(()=>{!H.fontExtraProperties&&U.data&&(U.data=null),this.commonObjs.resolve(N,U)});break;case"FontPath":case"Image":this.commonObjs.resolve(N,z);break;default:throw new Error(`Got unknown common object type ${j}`)}}),I.on("obj",([N,j,z,q])=>{var W;if(this.destroyed)return;const H=le(this,d).get(j);if(!H.objs.has(N))switch(z){case"Image":H.objs.resolve(N,q);const U=8e6;if(q){let Q;if(q.bitmap){const{width:J,height:ne}=q;Q=J*ne*4}else Q=((W=q.data)==null?void 0:W.length)||0;Q>U&&(H.cleanupAfterRender=!0)}break;case"Pattern":H.objs.resolve(N,q);break;default:throw new Error(`Got unknown object type ${z}`)}}),I.on("DocProgress",N=>{var j;this.destroyed||(j=L.onProgress)==null||j.call(L,{loaded:N.loaded,total:N.total})}),I.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),I.on("FetchBuiltInCMap",N=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(N):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),I.on("FetchStandardFontData",N=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(N):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:I}){var L,N;this.destroyed||(N=(L=this.loadingTask).onUnsupportedFeature)==null||N.call(L,I)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var I;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((I=this._fullReader)==null?void 0:I.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(I){if(!Number.isInteger(I)||I<=0||I>this._numPages)return Promise.reject(new Error("Invalid page request."));const L=I-1,N=le(this,p).get(L);if(N)return N;const j=this.messageHandler.sendWithPromise("GetPage",{pageIndex:L}).then(z=>{if(this.destroyed)throw new Error("Transport destroyed");const q=new PDFPageProxy(L,z,this,this._params.ownerDocument,this._params.pdfBug);return le(this,d).set(L,q),q});return le(this,p).set(L,j),j}getPageIndex(I){return typeof I!="object"||I===null||!Number.isInteger(I.num)||I.num<0||!Number.isInteger(I.gen)||I.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:I.num,gen:I.gen})}getAnnotations(I,L){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:I,intent:L})}getFieldObjects(){return Pe(this,g,ti).call(this,"GetFieldObjects")}hasJSActions(){return Pe(this,g,ti).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(I){return typeof I!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:I})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(I){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:I})}getStructTree(I){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:I})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(I=>new _optional_content_config.OptionalContentConfig(I))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const I="GetMetadata",L=le(this,f).get(I);if(L)return L;const N=this.messageHandler.sendWithPromise(I,null).then(j=>{var z,q;return{info:j[0],metadata:j[1]?new _metadata.Metadata(j[1]):null,contentDispositionFilename:((z=this._fullReader)==null?void 0:z.filename)??null,contentLength:((q=this._fullReader)==null?void 0:q.contentLength)??null}});return le(this,f).set(I,N),N}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(I=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const L of le(this,d).values())if(!L.cleanup())throw new Error(`startCleanup: Page ${L.pageNumber} is currently rendering.`);this.commonObjs.clear(),I||this.fontLoader.clear(),le(this,f).clear()}}get loadingParams(){const{disableAutoFetch:I,enableXfa:L}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:I,enableXfa:L})}}f=new WeakMap,d=new WeakMap,p=new WeakMap,g=new WeakSet,ti=function(I,L=null){const N=le(this,f).get(I);if(N)return N;const j=this.messageHandler.sendWithPromise(I,L);return le(this,f).set(I,j),j};class PDFObjects{constructor(){De(this,T);De(this,S,Object.create(null))}get(I,L=null){if(L){const j=Pe(this,T,ni).call(this,I);return j.capability.promise.then(()=>L(j.data)),null}const N=le(this,S)[I];if(!(N!=null&&N.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${I}.`);return N.data}has(I){const L=le(this,S)[I];return(L==null?void 0:L.capability.settled)||!1}resolve(I,L=null){const N=Pe(this,T,ni).call(this,I);N.data=L,N.capability.resolve()}clear(){var I;for(const L in le(this,S)){const{data:N}=le(this,S)[L];(I=N==null?void 0:N.bitmap)==null||I.close()}Ue(this,S,Object.create(null))}}S=new WeakMap,T=new WeakSet,ni=function(I){const L=le(this,S)[I];return L||(le(this,S)[I]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(I){De(this,O,null);Ue(this,O,I),this.onContinue=null}get promise(){return le(this,O).capability.promise}cancel(I=0){le(this,O).cancel(null,I)}get separateAnnots(){const{separateAnnots:I}=le(this,O).operatorList;if(!I)return!1;const{annotationCanvasMap:L}=le(this,O);return I.form||I.canvas&&(L==null?void 0:L.size)>0}}O=new WeakMap,exports.RenderTask=RenderTask;const P=class{constructor({callback:I,params:L,objs:N,commonObjs:j,annotationCanvasMap:z,operatorList:q,pageIndex:H,canvasFactory:W,useRequestAnimationFrame:U=!1,pdfBug:Q=!1,pageColors:J=null}){this.callback=I,this.params=L,this.objs=N,this.commonObjs=j,this.annotationCanvasMap=z,this.operatorListIdx=null,this.operatorList=q,this._pageIndex=H,this.canvasFactory=W,this._pdfBug=Q,this.pageColors=J,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=U===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=L.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:I=!1,optionalContentConfig:L}){var H,W;if(this.cancelled)return;if(this._canvas){if(le(P,R).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");le(P,R).add(this._canvas)}this._pdfBug&&((H=globalThis.StepperManager)!=null&&H.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:N,viewport:j,transform:z,background:q}=this.params;this.gfx=new _canvas.CanvasGraphics(N,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:L},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:z,viewport:j,transparency:I,background:q}),this.operatorListIdx=0,this.graphicsReady=!0,(W=this.graphicsReadyCallback)==null||W.call(this)}cancel(I=null,L=0){var N;this.running=!1,this.cancelled=!0,(N=this.gfx)==null||N.endDrawing(),this._canvas&&le(P,R).delete(this._canvas),this.callback(I||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",L))}operatorListChanged(){var I;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(I=this.stepper)==null||I.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&le(P,R).delete(this._canvas),this.callback())))}};let InternalRenderTask=P;R=new WeakMap,De(InternalRenderTask,R,new WeakSet);const version="3.4.120";exports.version=version;const build="af6414988";exports.build=build},(e,n,i)=>{var d,p,g,Gi,S;Object.defineProperty(n,"__esModule",{value:!0}),n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var r=i(1),s=i(4),o=i(8);class l{constructor(){De(this,g);De(this,d,!1);De(this,p,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(k,O){const R=le(this,p).get(k);return R===void 0?O:Object.assign(O,R)}getRawValue(k){return le(this,p).get(k)}remove(k){if(le(this,p).delete(k),le(this,p).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const O of le(this,p).values())if(O instanceof s.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(k,O){const R=le(this,p).get(k);let P=!1;if(R!==void 0)for(const[F,I]of Object.entries(O))R[F]!==I&&(P=!0,R[F]=I);else P=!0,le(this,p).set(k,O);P&&Pe(this,g,Gi).call(this),O instanceof s.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(O.constructor._type)}has(k){return le(this,p).has(k)}getAll(){return le(this,p).size>0?(0,r.objectFromMap)(le(this,p)):null}setAll(k){for(const[O,R]of Object.entries(k))this.setValue(O,R)}get size(){return le(this,p).size}resetModified(){le(this,d)&&(Ue(this,d,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new f(this)}get serializable(){if(le(this,p).size===0)return null;const k=new Map;for(const[O,R]of le(this,p)){const P=R instanceof s.AnnotationEditor?R.serialize():R;P&&k.set(O,P)}return k}static getHash(k){if(!k)return"";const O=new o.MurmurHash3_64;for(const[R,P]of k)O.update(`${R}:${JSON.stringify(P)}`);return O.hexdigest()}}d=new WeakMap,p=new WeakMap,g=new WeakSet,Gi=function(){le(this,d)||(Ue(this,d,!0),typeof this.onSetModified=="function"&&this.onSetModified())},n.AnnotationStorage=l;class f extends l{constructor(O){super();De(this,S,null);Ue(this,S,structuredClone(O.serializable))}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return le(this,S)}}S=new WeakMap,n.PrintAnnotationStorage=f},(e,n,i)=>{var l,f,d,p,g,v;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var r=i(5),s=i(1);const S=class{constructor(k){De(this,l,this.focusin.bind(this));De(this,f,this.focusout.bind(this));De(this,d,!1);De(this,p,!1);De(this,g,!1);at(this,"_uiManager",null);De(this,v,S._zIndex++);this.constructor===S&&(0,s.unreachable)("Cannot initialize AnnotationEditor."),this.parent=k.parent,this.id=k.id,this.width=this.height=null,this.pageIndex=k.parent.pageIndex,this.name=k.name,this.div=null,this._uiManager=k.uiManager;const{rotation:O,rawDims:{pageWidth:R,pageHeight:P,pageX:F,pageY:I}}=this.parent.viewport;this.rotation=O,this.pageDimensions=[R,P],this.pageTranslation=[F,I];const[L,N]=this.parentDimensions;this.x=k.x/L,this.y=k.y/N,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,s.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(k){this._uiManager.addCommands(k)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=le(this,v)}setParent(k){k!==null&&(this.pageIndex=k.pageIndex,this.pageDimensions=k.pageDimensions),this.parent=k}focusin(k){le(this,d)?Ue(this,d,!1):this.parent.setSelected(this)}focusout(k){var R;if(!this.isAttachedToDOM)return;const O=k.relatedTarget;O!=null&&O.closest(`#${this.id}`)||(k.preventDefault(),(R=this.parent)!=null&&R.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(k){const O=this.parent.div.getBoundingClientRect();this.startX=k.clientX-O.x,this.startY=k.clientY-O.y,k.dataTransfer.setData("text/plain",this.id),k.dataTransfer.effectAllowed="move"}setAt(k,O,R,P){const[F,I]=this.parentDimensions;[R,P]=this.screenToPageTranslation(R,P),this.x=(k+R)/F,this.y=(O+P)/I,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(k,O){const[R,P]=this.parentDimensions;[k,O]=this.screenToPageTranslation(k,O),this.x+=k/R,this.y+=O/P,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(k,O){switch(this.parentRotation){case 90:return[O,-k];case 180:return[-k,-O];case 270:return[-O,k];default:return[k,O]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:k}=this._uiManager.viewParameters,[O,R]=this.pageDimensions;return[O*k,R*k]}setDims(k,O){const[R,P]=this.parentDimensions;this.div.style.width=`${100*k/R}%`,this.div.style.height=`${100*O/P}%`}fixDims(){const{style:k}=this.div,{height:O,width:R}=k,P=R.endsWith("%"),F=O.endsWith("%");if(P&&F)return;const[I,L]=this.parentDimensions;P||(k.width=`${100*parseFloat(R)/I}%`),F||(k.height=`${100*parseFloat(O)/L}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",le(this,l)),this.div.addEventListener("focusout",le(this,f));const[k,O]=this.getInitialTranslation();return this.translate(k,O),(0,r.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(k){const{isMac:O}=s.FeatureTest.platform;if(k.button!==0||k.ctrlKey&&O){k.preventDefault();return}k.ctrlKey&&!O||k.shiftKey||k.metaKey&&O?this.parent.toggleSelected(this):this.parent.setSelected(this),Ue(this,d,!0)}getRect(k,O){const R=this.parentScale,[P,F]=this.pageDimensions,[I,L]=this.pageTranslation,N=k/R,j=O/R,z=this.x*P,q=this.y*F,H=this.width*P,W=this.height*F;switch(this.rotation){case 0:return[z+N+I,F-q-j-W+L,z+N+H+I,F-q-j+L];case 90:return[z+j+I,F-q+N+L,z+j+W+I,F-q+N+H+L];case 180:return[z-N-H+I,F-q+j+L,z-N+I,F-q+j+W+L];case 270:return[z-j-W+I,F-q-N-H+L,z-j+I,F-q-N+L];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(k,O){const[R,P,F,I]=k,L=F-R,N=I-P;switch(this.rotation){case 0:return[R,O-I,L,N];case 90:return[R,O-P,N,L];case 180:return[F,O-P,L,N];case 270:return[F,O-I,N,L];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Ue(this,g,!0)}disableEditMode(){Ue(this,g,!1)}isInEditMode(){return le(this,g)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var k;(k=this.div)==null||k.addEventListener("focusin",le(this,l))}serialize(){(0,s.unreachable)("An editor must be serializable")}static deserialize(k,O,R){const P=new this.prototype.constructor({parent:O,id:O.getNextId(),uiManager:R});P.rotation=k.rotation;const[F,I]=P.pageDimensions,[L,N,j,z]=P.getRectInCurrentCoords(k.rect,I);return P.x=L/F,P.y=N/I,P.width=j/F,P.height=z/I,P}remove(){this.div.removeEventListener("focusin",le(this,l)),this.div.removeEventListener("focusout",le(this,f)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var k;(k=this.div)==null||k.classList.add("selectedEditor")}unselect(){var k;(k=this.div)==null||k.classList.remove("selectedEditor")}updateParams(k,O){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return le(this,p)}set isEditing(k){Ue(this,p,k),k?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let o=S;l=new WeakMap,f=new WeakMap,d=new WeakMap,p=new WeakMap,g=new WeakMap,v=new WeakMap,at(o,"_colorManager",new r.ColorManager),at(o,"_zIndex",1),n.AnnotationEditor=o},(e,n,i)=>{var S,T,k,O,R,P,Vi,L,N,j,z,q,H,W,U,Q,J,ne,G,Z,ae,oe,pe,Se,ue,ee,V,se,fe,he,be,Wi,ye,ii,$e,Xi,Te,Yi,ie,bt,ge,yn,Ae,Ki,Re,Qi,ke,ri,Me,vn,ze,ai;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=o,n.opacityToHex=l;var r=i(1),s=i(6);function o(Ge,me,_e){for(const Ee of _e)me.addEventListener(Ee,Ge[Ee].bind(Ge))}function l(Ge){return Math.round(Math.min(255,Math.max(1,255*Ge))).toString(16).padStart(2,"0")}class f{constructor(){De(this,S,0)}getId(){return`${r.AnnotationEditorPrefix}${ei(this,S)._++}`}}S=new WeakMap;class d{constructor(me=128){De(this,T,[]);De(this,k,!1);De(this,O,void 0);De(this,R,-1);Ue(this,O,me)}add({cmd:me,undo:_e,mustExec:Ee,type:Ne=NaN,overwriteIfSameType:We=!1,keepUndo:st=!1}){if(Ee&&me(),le(this,k))return;const Ce={cmd:me,undo:_e,type:Ne};if(le(this,R)===-1){le(this,T).length>0&&(le(this,T).length=0),Ue(this,R,0),le(this,T).push(Ce);return}if(We&&le(this,T)[le(this,R)].type===Ne){st&&(Ce.undo=le(this,T)[le(this,R)].undo),le(this,T)[le(this,R)]=Ce;return}const Fe=le(this,R)+1;Fe===le(this,O)?le(this,T).splice(0,1):(Ue(this,R,Fe),Fe<le(this,T).length&&le(this,T).splice(Fe)),le(this,T).push(Ce)}undo(){le(this,R)!==-1&&(Ue(this,k,!0),le(this,T)[le(this,R)].undo(),Ue(this,k,!1),Ue(this,R,le(this,R)-1))}redo(){le(this,R)<le(this,T).length-1&&(Ue(this,R,le(this,R)+1),Ue(this,k,!0),le(this,T)[le(this,R)].cmd(),Ue(this,k,!1))}hasSomethingToUndo(){return le(this,R)!==-1}hasSomethingToRedo(){return le(this,R)<le(this,T).length-1}destroy(){Ue(this,T,null)}}T=new WeakMap,k=new WeakMap,O=new WeakMap,R=new WeakMap,n.CommandManager=d;class p{constructor(me){De(this,P);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:_e}=r.FeatureTest.platform;for(const[Ee,Ne]of me)for(const We of Ee){const st=We.startsWith("mac+");_e&&st?(this.callbacks.set(We.slice(4),Ne),this.allKeys.add(We.split("+").at(-1))):!_e&&!st&&(this.callbacks.set(We,Ne),this.allKeys.add(We.split("+").at(-1)))}}exec(me,_e){if(!this.allKeys.has(_e.key))return;const Ee=this.callbacks.get(Pe(this,P,Vi).call(this,_e));Ee&&(Ee.bind(me)(),_e.stopPropagation(),_e.preventDefault())}}P=new WeakSet,Vi=function(me){me.altKey&&this.buffer.push("alt"),me.ctrlKey&&this.buffer.push("ctrl"),me.metaKey&&this.buffer.push("meta"),me.shiftKey&&this.buffer.push("shift"),this.buffer.push(me.key);const _e=this.buffer.join("+");return this.buffer.length=0,_e},n.KeyboardManager=p;const I=class{get _colors(){const me=new Map([["CanvasText",null],["Canvas",null]]);return(0,s.getColorValues)(me),(0,r.shadow)(this,"_colors",me)}convert(me){const _e=(0,s.getRGB)(me);if(!window.matchMedia("(forced-colors: active)").matches)return _e;for(const[Ee,Ne]of this._colors)if(Ne.every((We,st)=>We===_e[st]))return I._colorsMapping.get(Ee);return _e}getHexCode(me){const _e=this._colors.get(me);return _e?r.Util.makeHexColor(..._e):me}};let g=I;at(g,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),n.ColorManager=g;const Qe=class{constructor(me,_e,Ee){De(this,be);De(this,ye);De(this,$e);De(this,Te);De(this,ie);De(this,ge);De(this,Ae);De(this,Re);De(this,ke);De(this,Me);De(this,ze);De(this,L,null);De(this,N,new Map);De(this,j,new Map);De(this,z,null);De(this,q,new d);De(this,H,0);De(this,W,null);De(this,U,new Set);De(this,Q,null);De(this,J,new f);De(this,ne,!1);De(this,G,r.AnnotationEditorType.NONE);De(this,Z,new Set);De(this,ae,this.copy.bind(this));De(this,oe,this.cut.bind(this));De(this,pe,this.paste.bind(this));De(this,Se,this.keydown.bind(this));De(this,ue,this.onEditingAction.bind(this));De(this,ee,this.onPageChanging.bind(this));De(this,V,this.onScaleChanging.bind(this));De(this,se,this.onRotationChanging.bind(this));De(this,fe,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});De(this,he,null);Ue(this,he,me),Ue(this,Q,_e),le(this,Q)._on("editingaction",le(this,ue)),le(this,Q)._on("pagechanging",le(this,ee)),le(this,Q)._on("scalechanging",le(this,V)),le(this,Q)._on("rotationchanging",le(this,se)),Ue(this,z,Ee),this.viewParameters={realScale:s.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){Pe(this,ye,ii).call(this),le(this,Q)._off("editingaction",le(this,ue)),le(this,Q)._off("pagechanging",le(this,ee)),le(this,Q)._off("scalechanging",le(this,V)),le(this,Q)._off("rotationchanging",le(this,se));for(const me of le(this,j).values())me.destroy();le(this,j).clear(),le(this,N).clear(),le(this,U).clear(),Ue(this,L,null),le(this,Z).clear(),le(this,q).destroy()}onPageChanging({pageNumber:me}){Ue(this,H,me-1)}focusMainContainer(){le(this,he).focus()}addShouldRescale(me){le(this,U).add(me)}removeShouldRescale(me){le(this,U).delete(me)}onScaleChanging({scale:me}){this.commitOrRemove(),this.viewParameters.realScale=me*s.PixelsPerInch.PDF_TO_CSS_UNITS;for(const _e of le(this,U))_e.onScaleChanging()}onRotationChanging({pagesRotation:me}){this.commitOrRemove(),this.viewParameters.rotation=me}addToAnnotationStorage(me){!me.isEmpty()&&le(this,z)&&!le(this,z).has(me.id)&&le(this,z).setValue(me.id,me)}copy(me){if(me.preventDefault(),le(this,L)&&le(this,L).commitOrRemove(),!this.hasSelection)return;const _e=[];for(const Ee of le(this,Z))Ee.isEmpty()||_e.push(Ee.serialize());_e.length!==0&&me.clipboardData.setData("application/pdfjs",JSON.stringify(_e))}cut(me){this.copy(me),this.delete()}paste(me){me.preventDefault();let _e=me.clipboardData.getData("application/pdfjs");if(!_e)return;try{_e=JSON.parse(_e)}catch(Ne){(0,r.warn)(`paste: "${Ne.message}".`);return}if(!Array.isArray(_e))return;this.unselectAll();const Ee=le(this,j).get(le(this,H));try{const Ne=[];for(const Ce of _e){const Fe=Ee.deserialize(Ce);if(!Fe)return;Ne.push(Fe)}const We=()=>{for(const Ce of Ne)Pe(this,ke,ri).call(this,Ce);Pe(this,ze,ai).call(this,Ne)},st=()=>{for(const Ce of Ne)Ce.remove()};this.addCommands({cmd:We,undo:st,mustExec:!0})}catch(Ne){(0,r.warn)(`paste: "${Ne.message}".`)}}keydown(me){var _e;(_e=this.getActive())!=null&&_e.shouldGetKeyboardEvents()||Qe._keyboardManager.exec(this,me)}onEditingAction(me){["undo","redo","delete","selectAll"].includes(me.name)&&this[me.name]()}setEditingState(me){me?(Pe(this,be,Wi).call(this),Pe(this,$e,Xi).call(this),Pe(this,ie,bt).call(this,{isEditing:le(this,G)!==r.AnnotationEditorType.NONE,isEmpty:Pe(this,Me,vn).call(this),hasSomethingToUndo:le(this,q).hasSomethingToUndo(),hasSomethingToRedo:le(this,q).hasSomethingToRedo(),hasSelectedEditor:!1})):(Pe(this,ye,ii).call(this),Pe(this,Te,Yi).call(this),Pe(this,ie,bt).call(this,{isEditing:!1}))}registerEditorTypes(me){if(!le(this,W)){Ue(this,W,me);for(const _e of le(this,W))Pe(this,ge,yn).call(this,_e.defaultPropertiesToUpdate)}}getId(){return le(this,J).getId()}get currentLayer(){return le(this,j).get(le(this,H))}get currentPageIndex(){return le(this,H)}addLayer(me){le(this,j).set(me.pageIndex,me),le(this,ne)?me.enable():me.disable()}removeLayer(me){le(this,j).delete(me.pageIndex)}updateMode(me){if(Ue(this,G,me),me===r.AnnotationEditorType.NONE)this.setEditingState(!1),Pe(this,Re,Qi).call(this);else{this.setEditingState(!0),Pe(this,Ae,Ki).call(this);for(const _e of le(this,j).values())_e.updateMode(me)}}updateToolbar(me){me!==le(this,G)&&le(this,Q).dispatch("switchannotationeditormode",{source:this,mode:me})}updateParams(me,_e){if(le(this,W)){for(const Ee of le(this,Z))Ee.updateParams(me,_e);for(const Ee of le(this,W))Ee.updateDefaultParams(me,_e)}}getEditors(me){const _e=[];for(const Ee of le(this,N).values())Ee.pageIndex===me&&_e.push(Ee);return _e}getEditor(me){return le(this,N).get(me)}addEditor(me){le(this,N).set(me.id,me)}removeEditor(me){var _e;le(this,N).delete(me.id),this.unselect(me),(_e=le(this,z))==null||_e.remove(me.id)}setActiveEditor(me){le(this,L)!==me&&(Ue(this,L,me),me&&Pe(this,ge,yn).call(this,me.propertiesToUpdate))}toggleSelected(me){if(le(this,Z).has(me)){le(this,Z).delete(me),me.unselect(),Pe(this,ie,bt).call(this,{hasSelectedEditor:this.hasSelection});return}le(this,Z).add(me),me.select(),Pe(this,ge,yn).call(this,me.propertiesToUpdate),Pe(this,ie,bt).call(this,{hasSelectedEditor:!0})}setSelected(me){for(const _e of le(this,Z))_e!==me&&_e.unselect();le(this,Z).clear(),le(this,Z).add(me),me.select(),Pe(this,ge,yn).call(this,me.propertiesToUpdate),Pe(this,ie,bt).call(this,{hasSelectedEditor:!0})}isSelected(me){return le(this,Z).has(me)}unselect(me){me.unselect(),le(this,Z).delete(me),Pe(this,ie,bt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return le(this,Z).size!==0}undo(){le(this,q).undo(),Pe(this,ie,bt).call(this,{hasSomethingToUndo:le(this,q).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Pe(this,Me,vn).call(this)})}redo(){le(this,q).redo(),Pe(this,ie,bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:le(this,q).hasSomethingToRedo(),isEmpty:Pe(this,Me,vn).call(this)})}addCommands(me){le(this,q).add(me),Pe(this,ie,bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Pe(this,Me,vn).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const me=[...le(this,Z)],_e=()=>{for(const Ne of me)Ne.remove()},Ee=()=>{for(const Ne of me)Pe(this,ke,ri).call(this,Ne)};this.addCommands({cmd:_e,undo:Ee,mustExec:!0})}commitOrRemove(){var me;(me=le(this,L))==null||me.commitOrRemove()}selectAll(){for(const me of le(this,Z))me.commit();Pe(this,ze,ai).call(this,le(this,N).values())}unselectAll(){if(le(this,L)){le(this,L).commitOrRemove();return}if(le(this,Z).size!==0){for(const me of le(this,Z))me.unselect();le(this,Z).clear(),Pe(this,ie,bt).call(this,{hasSelectedEditor:!1})}}isActive(me){return le(this,L)===me}getActive(){return le(this,L)}getMode(){return le(this,G)}};let v=Qe;L=new WeakMap,N=new WeakMap,j=new WeakMap,z=new WeakMap,q=new WeakMap,H=new WeakMap,W=new WeakMap,U=new WeakMap,Q=new WeakMap,J=new WeakMap,ne=new WeakMap,G=new WeakMap,Z=new WeakMap,ae=new WeakMap,oe=new WeakMap,pe=new WeakMap,Se=new WeakMap,ue=new WeakMap,ee=new WeakMap,V=new WeakMap,se=new WeakMap,fe=new WeakMap,he=new WeakMap,be=new WeakSet,Wi=function(){le(this,he).addEventListener("keydown",le(this,Se))},ye=new WeakSet,ii=function(){le(this,he).removeEventListener("keydown",le(this,Se))},$e=new WeakSet,Xi=function(){document.addEventListener("copy",le(this,ae)),document.addEventListener("cut",le(this,oe)),document.addEventListener("paste",le(this,pe))},Te=new WeakSet,Yi=function(){document.removeEventListener("copy",le(this,ae)),document.removeEventListener("cut",le(this,oe)),document.removeEventListener("paste",le(this,pe))},ie=new WeakSet,bt=function(me){Object.entries(me).some(([Ee,Ne])=>le(this,fe)[Ee]!==Ne)&&le(this,Q).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(le(this,fe),me)})},ge=new WeakSet,yn=function(me){le(this,Q).dispatch("annotationeditorparamschanged",{source:this,details:me})},Ae=new WeakSet,Ki=function(){if(!le(this,ne)){Ue(this,ne,!0);for(const me of le(this,j).values())me.enable()}},Re=new WeakSet,Qi=function(){if(this.unselectAll(),le(this,ne)){Ue(this,ne,!1);for(const me of le(this,j).values())me.disable()}},ke=new WeakSet,ri=function(me){const _e=le(this,j).get(me.pageIndex);_e?_e.addOrRebuild(me):this.addEditor(me)},Me=new WeakSet,vn=function(){if(le(this,N).size===0)return!0;if(le(this,N).size===1)for(const me of le(this,N).values())return me.isEmpty();return!1},ze=new WeakSet,ai=function(me){le(this,Z).clear();for(const _e of me)_e.isEmpty()||(le(this,Z).add(_e),_e.select());Pe(this,ie,bt).call(this,{hasSelectedEditor:!0})},at(v,"_keyboardManager",new p([[["ctrl+a","mac+meta+a"],Qe.prototype.selectAll],[["ctrl+z","mac+meta+z"],Qe.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],Qe.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],Qe.prototype.delete],[["Escape","mac+Escape"],Qe.prototype.unselectAll]])),n.AnnotationEditorUIManager=v},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=j,n.getColorValues=U,n.getCurrentTransform=Q,n.getCurrentTransformInverse=J,n.getFilenameFromUrl=P,n.getPdfFilenameFromUrl=F,n.getRGB=W,n.getXfaPageViewport=H,n.isDataScheme=O,n.isPdfFile=R,n.isValidFetchUrl=L,n.loadScript=N,n.setLayerDimensions=ne;var r=i(7),s=i(1);const o="http://www.w3.org/2000/svg",l="pdfjs_internal_id_";n.AnnotationPrefix=l;const G=class{};let f=G;at(f,"CSS",96),at(f,"PDF",72),at(f,"PDF_TO_CSS_UNITS",G.CSS/G.PDF),n.PixelsPerInch=f;class d extends r.BaseCanvasFactory{constructor({ownerDocument:ae=globalThis.document}={}){super(),this._document=ae}_createCanvas(ae,oe){const pe=this._document.createElement("canvas");return pe.width=ae,pe.height=oe,pe}}n.DOMCanvasFactory=d;async function p(Z,ae=!1){if(L(Z,document.baseURI)){const oe=await fetch(Z);if(!oe.ok)throw new Error(oe.statusText);return ae?new Uint8Array(await oe.arrayBuffer()):(0,s.stringToBytes)(await oe.text())}return new Promise((oe,pe)=>{const Se=new XMLHttpRequest;Se.open("GET",Z,!0),ae&&(Se.responseType="arraybuffer"),Se.onreadystatechange=()=>{if(Se.readyState===XMLHttpRequest.DONE){if(Se.status===200||Se.status===0){let ue;if(ae&&Se.response?ue=new Uint8Array(Se.response):!ae&&Se.responseText&&(ue=(0,s.stringToBytes)(Se.responseText)),ue){oe(ue);return}}pe(new Error(Se.statusText))}},Se.send(null)})}class g extends r.BaseCMapReaderFactory{_fetchData(ae,oe){return p(ae,this.isCompressed).then(pe=>({cMapData:pe,compressionType:oe}))}}n.DOMCMapReaderFactory=g;class v extends r.BaseStandardFontDataFactory{_fetchData(ae){return p(ae,!0)}}n.DOMStandardFontDataFactory=v;class S extends r.BaseSVGFactory{_createSVG(ae){return document.createElementNS(o,ae)}}n.DOMSVGFactory=S;class T{constructor({viewBox:ae,scale:oe,rotation:pe,offsetX:Se=0,offsetY:ue=0,dontFlip:ee=!1}){this.viewBox=ae,this.scale=oe,this.rotation=pe,this.offsetX=Se,this.offsetY=ue;const V=(ae[2]+ae[0])/2,se=(ae[3]+ae[1])/2;let fe,he,be,xe;switch(pe%=360,pe<0&&(pe+=360),pe){case 180:fe=-1,he=0,be=0,xe=1;break;case 90:fe=0,he=1,be=1,xe=0;break;case 270:fe=0,he=-1,be=-1,xe=0;break;case 0:fe=1,he=0,be=0,xe=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}ee&&(be=-be,xe=-xe);let ye,we,$e,ve;fe===0?(ye=Math.abs(se-ae[1])*oe+Se,we=Math.abs(V-ae[0])*oe+ue,$e=(ae[3]-ae[1])*oe,ve=(ae[2]-ae[0])*oe):(ye=Math.abs(V-ae[0])*oe+Se,we=Math.abs(se-ae[1])*oe+ue,$e=(ae[2]-ae[0])*oe,ve=(ae[3]-ae[1])*oe),this.transform=[fe*oe,he*oe,be*oe,xe*oe,ye-fe*oe*V-be*oe*se,we-he*oe*V-xe*oe*se],this.width=$e,this.height=ve}get rawDims(){const{viewBox:ae}=this;return(0,s.shadow)(this,"rawDims",{pageWidth:ae[2]-ae[0],pageHeight:ae[3]-ae[1],pageX:ae[0],pageY:ae[1]})}clone({scale:ae=this.scale,rotation:oe=this.rotation,offsetX:pe=this.offsetX,offsetY:Se=this.offsetY,dontFlip:ue=!1}={}){return new T({viewBox:this.viewBox.slice(),scale:ae,rotation:oe,offsetX:pe,offsetY:Se,dontFlip:ue})}convertToViewportPoint(ae,oe){return s.Util.applyTransform([ae,oe],this.transform)}convertToViewportRectangle(ae){const oe=s.Util.applyTransform([ae[0],ae[1]],this.transform),pe=s.Util.applyTransform([ae[2],ae[3]],this.transform);return[oe[0],oe[1],pe[0],pe[1]]}convertToPdfPoint(ae,oe){return s.Util.applyInverseTransform([ae,oe],this.transform)}}n.PageViewport=T;class k extends s.BaseException{constructor(ae,oe,pe=0){super(ae,"RenderingCancelledException"),this.type=oe,this.extraDelay=pe}}n.RenderingCancelledException=k;function O(Z){const ae=Z.length;let oe=0;for(;oe<ae&&Z[oe].trim()==="";)oe++;return Z.substring(oe,oe+5).toLowerCase()==="data:"}function R(Z){return typeof Z=="string"&&/\.pdf$/i.test(Z)}function P(Z,ae=!1){return ae||([Z]=Z.split(/[#?]/,1)),Z.substring(Z.lastIndexOf("/")+1)}function F(Z,ae="document.pdf"){if(typeof Z!="string")return ae;if(O(Z))return(0,s.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),ae;const oe=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,pe=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Se=oe.exec(Z);let ue=pe.exec(Se[1])||pe.exec(Se[2])||pe.exec(Se[3]);if(ue&&(ue=ue[0],ue.includes("%")))try{ue=pe.exec(decodeURIComponent(ue))[0]}catch{}return ue||ae}class I{constructor(){at(this,"started",Object.create(null));at(this,"times",[])}time(ae){ae in this.started&&(0,s.warn)(`Timer is already running for ${ae}`),this.started[ae]=Date.now()}timeEnd(ae){ae in this.started||(0,s.warn)(`Timer has not been started for ${ae}`),this.times.push({name:ae,start:this.started[ae],end:Date.now()}),delete this.started[ae]}toString(){const ae=[];let oe=0;for(const{name:pe}of this.times)oe=Math.max(pe.length,oe);for(const{name:pe,start:Se,end:ue}of this.times)ae.push(`${pe.padEnd(oe)} ${ue-Se}ms
`);return ae.join("")}}n.StatTimer=I;function L(Z,ae){try{const{protocol:oe}=ae?new URL(Z,ae):new URL(Z);return oe==="http:"||oe==="https:"}catch{return!1}}function N(Z,ae=!1){return new Promise((oe,pe)=>{const Se=document.createElement("script");Se.src=Z,Se.onload=function(ue){ae&&Se.remove(),oe(ue)},Se.onerror=function(){pe(new Error(`Cannot load script at: ${Se.src}`))},(document.head||document.documentElement).append(Se)})}function j(Z){console.log("Deprecated API usage: "+Z)}let z;class q{static toDateObject(ae){if(!ae||typeof ae!="string")return null;z||(z=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const oe=z.exec(ae);if(!oe)return null;const pe=parseInt(oe[1],10);let Se=parseInt(oe[2],10);Se=Se>=1&&Se<=12?Se-1:0;let ue=parseInt(oe[3],10);ue=ue>=1&&ue<=31?ue:1;let ee=parseInt(oe[4],10);ee=ee>=0&&ee<=23?ee:0;let V=parseInt(oe[5],10);V=V>=0&&V<=59?V:0;let se=parseInt(oe[6],10);se=se>=0&&se<=59?se:0;const fe=oe[7]||"Z";let he=parseInt(oe[8],10);he=he>=0&&he<=23?he:0;let be=parseInt(oe[9],10)||0;return be=be>=0&&be<=59?be:0,fe==="-"?(ee+=he,V+=be):fe==="+"&&(ee-=he,V-=be),new Date(Date.UTC(pe,Se,ue,ee,V,se))}}n.PDFDateString=q;function H(Z,{scale:ae=1,rotation:oe=0}){const{width:pe,height:Se}=Z.attributes.style,ue=[0,0,parseInt(pe),parseInt(Se)];return new T({viewBox:ue,scale:ae,rotation:oe})}function W(Z){if(Z.startsWith("#")){const ae=parseInt(Z.slice(1),16);return[(ae&16711680)>>16,(ae&65280)>>8,ae&255]}return Z.startsWith("rgb(")?Z.slice(4,-1).split(",").map(ae=>parseInt(ae)):Z.startsWith("rgba(")?Z.slice(5,-1).split(",").map(ae=>parseInt(ae)).slice(0,3):((0,s.warn)(`Not a valid color format: "${Z}"`),[0,0,0])}function U(Z){const ae=document.createElement("span");ae.style.visibility="hidden",document.body.append(ae);for(const oe of Z.keys()){ae.style.color=oe;const pe=window.getComputedStyle(ae).color;Z.set(oe,W(pe))}ae.remove()}function Q(Z){const{a:ae,b:oe,c:pe,d:Se,e:ue,f:ee}=Z.getTransform();return[ae,oe,pe,Se,ue,ee]}function J(Z){const{a:ae,b:oe,c:pe,d:Se,e:ue,f:ee}=Z.getTransform().invertSelf();return[ae,oe,pe,Se,ue,ee]}function ne(Z,ae,oe=!1,pe=!0){if(ae instanceof T){const{pageWidth:Se,pageHeight:ue}=ae.rawDims,{style:ee}=Z,V=`calc(var(--scale-factor) * ${Se}px)`,se=`calc(var(--scale-factor) * ${ue}px)`;!oe||ae.rotation%180===0?(ee.width=V,ee.height=se):(ee.width=se,ee.height=V)}pe&&Z.setAttribute("data-main-rotation",ae.rotation)}},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var r=i(1);class s{constructor(){this.constructor===s&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(p,g){if(p<=0||g<=0)throw new Error("Invalid canvas size");const v=this._createCanvas(p,g);return{canvas:v,context:v.getContext("2d")}}reset(p,g,v){if(!p.canvas)throw new Error("Canvas is not specified");if(g<=0||v<=0)throw new Error("Invalid canvas size");p.canvas.width=g,p.canvas.height=v}destroy(p){if(!p.canvas)throw new Error("Canvas is not specified");p.canvas.width=0,p.canvas.height=0,p.canvas=null,p.context=null}_createCanvas(p,g){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=s;class o{constructor({baseUrl:p=null,isCompressed:g=!0}){this.constructor===o&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=p,this.isCompressed=g}async fetch({name:p}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!p)throw new Error("CMap name must be specified.");const g=this.baseUrl+p+(this.isCompressed?".bcmap":""),v=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(g,v).catch(S=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${g}`)})}_fetchData(p,g){(0,r.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=o;class l{constructor({baseUrl:p=null}){this.constructor===l&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=p}async fetch({filename:p}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!p)throw new Error("Font filename must be specified.");const g=`${this.baseUrl}${p}`;return this._fetchData(g).catch(v=>{throw new Error(`Unable to load font data at: ${g}`)})}_fetchData(p){(0,r.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=l;class f{constructor(){this.constructor===f&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(p,g,v=!1){if(p<=0||g<=0)throw new Error("Invalid SVG dimensions");const S=this._createSVG("svg:svg");return S.setAttribute("version","1.1"),v||(S.setAttribute("width",`${p}px`),S.setAttribute("height",`${g}px`)),S.setAttribute("preserveAspectRatio","none"),S.setAttribute("viewBox",`0 0 ${p} ${g}`),S}createElement(p){if(typeof p!="string")throw new Error("Invalid SVG element type");return this._createSVG(p)}_createSVG(p){(0,r.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=f},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var r=i(1);const s=3285377520,o=4294901760,l=65535;class f{constructor(p){this.h1=p?p&4294967295:s,this.h2=p?p&4294967295:s}update(p){let g,v;if(typeof p=="string"){g=new Uint8Array(p.length*2),v=0;for(let z=0,q=p.length;z<q;z++){const H=p.charCodeAt(z);H<=255?g[v++]=H:(g[v++]=H>>>8,g[v++]=H&255)}}else if((0,r.isArrayBuffer)(p))g=p.slice(),v=g.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const S=v>>2,T=v-S*4,k=new Uint32Array(g.buffer,0,S);let O=0,R=0,P=this.h1,F=this.h2;const I=3432918353,L=461845907,N=I&l,j=L&l;for(let z=0;z<S;z++)z&1?(O=k[z],O=O*I&o|O*N&l,O=O<<15|O>>>17,O=O*L&o|O*j&l,P^=O,P=P<<13|P>>>19,P=P*5+3864292196):(R=k[z],R=R*I&o|R*N&l,R=R<<15|R>>>17,R=R*L&o|R*j&l,F^=R,F=F<<13|F>>>19,F=F*5+3864292196);switch(O=0,T){case 3:O^=g[S*4+2]<<16;case 2:O^=g[S*4+1]<<8;case 1:O^=g[S*4],O=O*I&o|O*N&l,O=O<<15|O>>>17,O=O*L&o|O*j&l,S&1?P^=O:F^=O}this.h1=P,this.h2=F}hexdigest(){let p=this.h1,g=this.h2;return p^=g>>>1,p=p*3981806797&o|p*36045&l,g=g*4283543511&o|((g<<16|p>>>16)*2950163797&o)>>>16,p^=g>>>1,p=p*444984403&o|p*60499&l,g=g*3301882366&o|((g<<16|p>>>16)*3120437893&o)>>>16,p^=g>>>1,(p>>>0).toString(16).padStart(8,"0")+(g>>>0).toString(16).padStart(8,"0")}}n.MurmurHash3_64=f},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var r=i(1),s=i(10);class o{constructor({onUnsupportedFeature:d,ownerDocument:p=globalThis.document,styleElement:g=null}){this._onUnsupportedFeature=d,this._document=p,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(d){this.nativeFontFaces.push(d),this._document.fonts.add(d)}insertRule(d){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const p=this.styleElement.sheet;p.insertRule(d,p.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(d){if(d.attached||d.missingFile)return;if(d.attached=!0,this.isFontLoadingAPISupported){const g=d.createNativeFontFace();if(g){this.addNativeFontFace(g);try{await g.loaded}catch(v){throw this._onUnsupportedFeature({featureId:r.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,r.warn)(`Failed to load font '${g.family}': '${v}'.`),d.disableFontFace=!0,v}}return}const p=d.createFontFaceRule();if(p){if(this.insertRule(p),this.isSyncFontLoadingSupported)return;await new Promise(g=>{const v=this._queueLoadingCallback(g);this._prepareFontLoadEvent(d,v)})}}get isFontLoadingAPISupported(){var p;const d=!!((p=this._document)!=null&&p.fonts);return(0,r.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){let d=!1;return(s.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(d=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function p(){for((0,r.assert)(!v.done,"completeRequest() cannot be called twice."),v.done=!0;g.length>0&&g[0].done;){const S=g.shift();setTimeout(S.callback,0)}}const{loadingRequests:g}=this,v={done:!1,complete:p,callback:d};return g.push(v),v}get _loadTestFont(){const d=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",d)}_prepareFontLoadEvent(d,p){function g(U,Q){return U.charCodeAt(Q)<<24|U.charCodeAt(Q+1)<<16|U.charCodeAt(Q+2)<<8|U.charCodeAt(Q+3)&255}function v(U,Q,J,ne){const G=U.substring(0,Q),Z=U.substring(Q+J);return G+ne+Z}let S,T;const k=this._document.createElement("canvas");k.width=1,k.height=1;const O=k.getContext("2d");let R=0;function P(U,Q){if(++R>30){(0,r.warn)("Load test font never loaded."),Q();return}if(O.font="30px "+U,O.fillText(".",0,20),O.getImageData(0,0,1,1).data[3]>0){Q();return}setTimeout(P.bind(null,U,Q))}const F=`lt${Date.now()}${this.loadTestFontId++}`;let I=this._loadTestFont;I=v(I,976,F.length,F);const N=16,j=1482184792;let z=g(I,N);for(S=0,T=F.length-3;S<T;S+=4)z=z-j+g(F,S)|0;S<F.length&&(z=z-j+g(F+"XXX",S)|0),I=v(I,N,4,(0,r.string32)(z));const q=`url(data:font/opentype;base64,${btoa(I)});`,H=`@font-face {font-family:"${F}";src:${q}}`;this.insertRule(H);const W=this._document.createElement("div");W.style.visibility="hidden",W.style.width=W.style.height="10px",W.style.position="absolute",W.style.top=W.style.left="0px";for(const U of[d.loadedName,F]){const Q=this._document.createElement("span");Q.textContent="Hi",Q.style.fontFamily=U,W.append(Q)}this._document.body.append(W),P(F,()=>{W.remove(),p.complete()})}}n.FontLoader=o;class l{constructor(d,{isEvalSupported:p=!0,disableFontFace:g=!1,ignoreErrors:v=!1,onUnsupportedFeature:S,fontRegistry:T=null}){this.compiledGlyphs=Object.create(null);for(const k in d)this[k]=d[k];this.isEvalSupported=p!==!1,this.disableFontFace=g===!0,this.ignoreErrors=v===!0,this._onUnsupportedFeature=S,this.fontRegistry=T}createNativeFontFace(){var p;if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const g={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(g.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,g)}return(p=this.fontRegistry)==null||p.registerFont(this),d}createFontFaceRule(){var v;if(!this.data||this.disableFontFace)return null;const d=(0,r.bytesToString)(this.data),p=`url(data:${this.mimetype};base64,${btoa(d)});`;let g;if(!this.cssFontInfo)g=`@font-face {font-family:"${this.loadedName}";src:${p}}`;else{let S=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(S+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),g=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${S}src:${p}}`}return(v=this.fontRegistry)==null||v.registerFont(this,p),g}getPathGenerator(d,p){if(this.compiledGlyphs[p]!==void 0)return this.compiledGlyphs[p];let g;try{g=d.get(this.loadedName+"_path_"+p)}catch(v){if(!this.ignoreErrors)throw v;return this._onUnsupportedFeature({featureId:r.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,r.warn)(`getPathGenerator - ignoring character: "${v}".`),this.compiledGlyphs[p]=function(S,T){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){const v=[];for(const S of g){const T=S.args!==void 0?S.args.join(","):"";v.push("c.",S.cmd,"(",T,`);
`)}return this.compiledGlyphs[p]=new Function("c","size",v.join(""))}return this.compiledGlyphs[p]=function(v,S){for(const T of g)T.cmd==="scale"&&(T.args=[S,-S]),v[T.cmd].apply(v,T.args)}}}n.FontFaceObject=l},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const i=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=i},(e,n,i)=>{var oe,si;Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var r=i(1),s=i(6),o=i(12),l=i(13);const f=16,d=100,p=4096,g=15,v=10,S=1e3,T=16;function k(ue,ee){if(ue._removeMirroring)throw new Error("Context is already forwarding operations.");ue.__originalSave=ue.save,ue.__originalRestore=ue.restore,ue.__originalRotate=ue.rotate,ue.__originalScale=ue.scale,ue.__originalTranslate=ue.translate,ue.__originalTransform=ue.transform,ue.__originalSetTransform=ue.setTransform,ue.__originalResetTransform=ue.resetTransform,ue.__originalClip=ue.clip,ue.__originalMoveTo=ue.moveTo,ue.__originalLineTo=ue.lineTo,ue.__originalBezierCurveTo=ue.bezierCurveTo,ue.__originalRect=ue.rect,ue.__originalClosePath=ue.closePath,ue.__originalBeginPath=ue.beginPath,ue._removeMirroring=()=>{ue.save=ue.__originalSave,ue.restore=ue.__originalRestore,ue.rotate=ue.__originalRotate,ue.scale=ue.__originalScale,ue.translate=ue.__originalTranslate,ue.transform=ue.__originalTransform,ue.setTransform=ue.__originalSetTransform,ue.resetTransform=ue.__originalResetTransform,ue.clip=ue.__originalClip,ue.moveTo=ue.__originalMoveTo,ue.lineTo=ue.__originalLineTo,ue.bezierCurveTo=ue.__originalBezierCurveTo,ue.rect=ue.__originalRect,ue.closePath=ue.__originalClosePath,ue.beginPath=ue.__originalBeginPath,delete ue._removeMirroring},ue.save=function(){ee.save(),this.__originalSave()},ue.restore=function(){ee.restore(),this.__originalRestore()},ue.translate=function(se,fe){ee.translate(se,fe),this.__originalTranslate(se,fe)},ue.scale=function(se,fe){ee.scale(se,fe),this.__originalScale(se,fe)},ue.transform=function(se,fe,he,be,xe,ye){ee.transform(se,fe,he,be,xe,ye),this.__originalTransform(se,fe,he,be,xe,ye)},ue.setTransform=function(se,fe,he,be,xe,ye){ee.setTransform(se,fe,he,be,xe,ye),this.__originalSetTransform(se,fe,he,be,xe,ye)},ue.resetTransform=function(){ee.resetTransform(),this.__originalResetTransform()},ue.rotate=function(se){ee.rotate(se),this.__originalRotate(se)},ue.clip=function(se){ee.clip(se),this.__originalClip(se)},ue.moveTo=function(V,se){ee.moveTo(V,se),this.__originalMoveTo(V,se)},ue.lineTo=function(V,se){ee.lineTo(V,se),this.__originalLineTo(V,se)},ue.bezierCurveTo=function(V,se,fe,he,be,xe){ee.bezierCurveTo(V,se,fe,he,be,xe),this.__originalBezierCurveTo(V,se,fe,he,be,xe)},ue.rect=function(V,se,fe,he){ee.rect(V,se,fe,he),this.__originalRect(V,se,fe,he)},ue.closePath=function(){ee.closePath(),this.__originalClosePath()},ue.beginPath=function(){ee.beginPath(),this.__originalBeginPath()}}class O{constructor(ee){this.canvasFactory=ee,this.cache=Object.create(null)}getCanvas(ee,V,se){let fe;return this.cache[ee]!==void 0?(fe=this.cache[ee],this.canvasFactory.reset(fe,V,se)):(fe=this.canvasFactory.create(V,se),this.cache[ee]=fe),fe}delete(ee){delete this.cache[ee]}clear(){for(const ee in this.cache){const V=this.cache[ee];this.canvasFactory.destroy(V),delete this.cache[ee]}}}function R(ue,ee,V,se,fe,he,be,xe,ye,we){const[$e,ve,Te,te,ie,ce]=(0,s.getCurrentTransform)(ue);if(ve===0&&Te===0){const Ae=be*$e+ie,Oe=Math.round(Ae),Re=xe*te+ce,Ie=Math.round(Re),ke=(be+ye)*$e+ie,je=Math.abs(Math.round(ke)-Oe)||1,Me=(xe+we)*te+ce,Be=Math.abs(Math.round(Me)-Ie)||1;return ue.setTransform(Math.sign($e),0,0,Math.sign(te),Oe,Ie),ue.drawImage(ee,V,se,fe,he,0,0,je,Be),ue.setTransform($e,ve,Te,te,ie,ce),[je,Be]}if($e===0&&te===0){const Ae=xe*Te+ie,Oe=Math.round(Ae),Re=be*ve+ce,Ie=Math.round(Re),ke=(xe+we)*Te+ie,je=Math.abs(Math.round(ke)-Oe)||1,Me=(be+ye)*ve+ce,Be=Math.abs(Math.round(Me)-Ie)||1;return ue.setTransform(0,Math.sign(ve),Math.sign(Te),0,Oe,Ie),ue.drawImage(ee,V,se,fe,he,0,0,Be,je),ue.setTransform($e,ve,Te,te,ie,ce),[Be,je]}ue.drawImage(ee,V,se,fe,he,be,xe,ye,we);const ge=Math.hypot($e,ve),de=Math.hypot(Te,te);return[ge*ye,de*we]}function P(ue){const{width:ee,height:V}=ue;if(ee>S||V>S)return null;const se=1e3,fe=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),he=ee+1;let be=new Uint8Array(he*(V+1)),xe,ye,we;const $e=ee+7&-8;let ve=new Uint8Array($e*V),Te=0;for(const de of ue.data){let Ae=128;for(;Ae>0;)ve[Te++]=de&Ae?0:255,Ae>>=1}let te=0;for(Te=0,ve[Te]!==0&&(be[0]=1,++te),ye=1;ye<ee;ye++)ve[Te]!==ve[Te+1]&&(be[ye]=ve[Te]?2:1,++te),Te++;for(ve[Te]!==0&&(be[ye]=2,++te),xe=1;xe<V;xe++){Te=xe*$e,we=xe*he,ve[Te-$e]!==ve[Te]&&(be[we]=ve[Te]?1:8,++te);let de=(ve[Te]?4:0)+(ve[Te-$e]?8:0);for(ye=1;ye<ee;ye++)de=(de>>2)+(ve[Te+1]?4:0)+(ve[Te-$e+1]?8:0),fe[de]&&(be[we+ye]=fe[de],++te),Te++;if(ve[Te-$e]!==ve[Te]&&(be[we+ye]=ve[Te]?2:4,++te),te>se)return null}for(Te=$e*(V-1),we=xe*he,ve[Te]!==0&&(be[we]=8,++te),ye=1;ye<ee;ye++)ve[Te]!==ve[Te+1]&&(be[we+ye]=ve[Te]?4:8,++te),Te++;if(ve[Te]!==0&&(be[we+ye]=4,++te),te>se)return null;const ie=new Int32Array([0,he,-1,0,-he,0,0,0,1]),ce=new Path2D;for(xe=0;te&&xe<=V;xe++){let de=xe*he;const Ae=de+ee;for(;de<Ae&&!be[de];)de++;if(de===Ae)continue;ce.moveTo(de%he,xe);const Oe=de;let Re=be[de];do{const Ie=ie[Re];do de+=Ie;while(!be[de]);const ke=be[de];ke!==5&&ke!==10?(Re=ke,be[de]=0):(Re=ke&51*Re>>4,be[de]&=Re>>2|Re<<2),ce.lineTo(de%he,de/he|0),be[de]||--te}while(Oe!==de);--xe}return ve=null,be=null,function(de){de.save(),de.scale(1/ee,-1/V),de.translate(0,-V),de.fill(ce),de.beginPath(),de.restore()}}class F{constructor(ee,V){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,ee,V])}clone(){const ee=Object.create(this);return ee.clipBox=this.clipBox.slice(),ee}setCurrentPoint(ee,V){this.x=ee,this.y=V}updatePathMinMax(ee,V,se){[V,se]=r.Util.applyTransform([V,se],ee),this.minX=Math.min(this.minX,V),this.minY=Math.min(this.minY,se),this.maxX=Math.max(this.maxX,V),this.maxY=Math.max(this.maxY,se)}updateRectMinMax(ee,V){const se=r.Util.applyTransform(V,ee),fe=r.Util.applyTransform(V.slice(2),ee);this.minX=Math.min(this.minX,se[0],fe[0]),this.minY=Math.min(this.minY,se[1],fe[1]),this.maxX=Math.max(this.maxX,se[0],fe[0]),this.maxY=Math.max(this.maxY,se[1],fe[1])}updateScalingPathMinMax(ee,V){r.Util.scaleMinMax(ee,V),this.minX=Math.min(this.minX,V[0]),this.maxX=Math.max(this.maxX,V[1]),this.minY=Math.min(this.minY,V[2]),this.maxY=Math.max(this.maxY,V[3])}updateCurvePathMinMax(ee,V,se,fe,he,be,xe,ye,we,$e){const ve=r.Util.bezierBoundingBox(V,se,fe,he,be,xe,ye,we);if($e){$e[0]=Math.min($e[0],ve[0],ve[2]),$e[1]=Math.max($e[1],ve[0],ve[2]),$e[2]=Math.min($e[2],ve[1],ve[3]),$e[3]=Math.max($e[3],ve[1],ve[3]);return}this.updateRectMinMax(ee,ve)}getPathBoundingBox(ee=o.PathType.FILL,V=null){const se=[this.minX,this.minY,this.maxX,this.maxY];if(ee===o.PathType.STROKE){V||(0,r.unreachable)("Stroke bounding box must include transform.");const fe=r.Util.singularValueDecompose2dScale(V),he=fe[0]*this.lineWidth/2,be=fe[1]*this.lineWidth/2;se[0]-=he,se[1]-=be,se[2]+=he,se[3]+=be}return se}updateClipFromPath(){const ee=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ee||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ee){this.clipBox=ee,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ee=o.PathType.FILL,V=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(ee,V))}}function I(ue,ee,V=null){if(typeof ImageData<"u"&&ee instanceof ImageData){ue.putImageData(ee,0,0);return}const se=ee.height,fe=ee.width,he=se%T,be=(se-he)/T,xe=he===0?be:be+1,ye=ue.createImageData(fe,T);let we=0,$e;const ve=ee.data,Te=ye.data;let te,ie,ce,ge,de,Ae,Oe,Re;if(V)switch(V.length){case 1:de=V[0],Ae=V[0],Oe=V[0],Re=V[0];break;case 4:de=V[0],Ae=V[1],Oe=V[2],Re=V[3];break}if(ee.kind===r.ImageKind.GRAYSCALE_1BPP){const Ie=ve.byteLength,ke=new Uint32Array(Te.buffer,0,Te.byteLength>>2),je=ke.length,Me=fe+7>>3;let Be=4294967295,ze=r.FeatureTest.isLittleEndian?4278190080:255;for(Re&&Re[0]===255&&Re[255]===0&&([Be,ze]=[ze,Be]),te=0;te<xe;te++){for(ce=te<be?T:he,$e=0,ie=0;ie<ce;ie++){const Ve=Ie-we;let Qe=0;const Ge=Ve>Me?fe:Ve*8-7,me=Ge&-8;let _e=0,Ee=0;for(;Qe<me;Qe+=8)Ee=ve[we++],ke[$e++]=Ee&128?Be:ze,ke[$e++]=Ee&64?Be:ze,ke[$e++]=Ee&32?Be:ze,ke[$e++]=Ee&16?Be:ze,ke[$e++]=Ee&8?Be:ze,ke[$e++]=Ee&4?Be:ze,ke[$e++]=Ee&2?Be:ze,ke[$e++]=Ee&1?Be:ze;for(;Qe<Ge;Qe++)_e===0&&(Ee=ve[we++],_e=128),ke[$e++]=Ee&_e?Be:ze,_e>>=1}for(;$e<je;)ke[$e++]=0;ue.putImageData(ye,0,te*T)}}else if(ee.kind===r.ImageKind.RGBA_32BPP){const Ie=!!(de||Ae||Oe);for(ie=0,ge=fe*T*4,te=0;te<be;te++){if(Te.set(ve.subarray(we,we+ge)),we+=ge,Ie)for(let ke=0;ke<ge;ke+=4)de&&(Te[ke+0]=de[Te[ke+0]]),Ae&&(Te[ke+1]=Ae[Te[ke+1]]),Oe&&(Te[ke+2]=Oe[Te[ke+2]]);ue.putImageData(ye,0,ie),ie+=T}if(te<xe){if(ge=fe*he*4,Te.set(ve.subarray(we,we+ge)),Ie)for(let ke=0;ke<ge;ke+=4)de&&(Te[ke+0]=de[Te[ke+0]]),Ae&&(Te[ke+1]=Ae[Te[ke+1]]),Oe&&(Te[ke+2]=Oe[Te[ke+2]]);ue.putImageData(ye,0,ie)}}else if(ee.kind===r.ImageKind.RGB_24BPP){const Ie=!!(de||Ae||Oe);for(ce=T,ge=fe*ce,te=0;te<xe;te++){for(te>=be&&(ce=he,ge=fe*ce),$e=0,ie=ge;ie--;)Te[$e++]=ve[we++],Te[$e++]=ve[we++],Te[$e++]=ve[we++],Te[$e++]=255;if(Ie)for(let ke=0;ke<$e;ke+=4)de&&(Te[ke+0]=de[Te[ke+0]]),Ae&&(Te[ke+1]=Ae[Te[ke+1]]),Oe&&(Te[ke+2]=Oe[Te[ke+2]]);ue.putImageData(ye,0,te*T)}}else throw new Error(`bad image kind: ${ee.kind}`)}function L(ue,ee){if(ee.bitmap){ue.drawImage(ee.bitmap,0,0);return}const V=ee.height,se=ee.width,fe=V%T,he=(V-fe)/T,be=fe===0?he:he+1,xe=ue.createImageData(se,T);let ye=0;const we=ee.data,$e=xe.data;for(let ve=0;ve<be;ve++){const Te=ve<he?T:fe;({srcPos:ye}=(0,l.applyMaskImageData)({src:we,srcPos:ye,dest:$e,width:se,height:Te})),ue.putImageData(xe,0,ve*T)}}function N(ue,ee){const V=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const se of V)ue[se]!==void 0&&(ee[se]=ue[se]);ue.setLineDash!==void 0&&(ee.setLineDash(ue.getLineDash()),ee.lineDashOffset=ue.lineDashOffset)}function j(ue,ee){ue.strokeStyle=ue.fillStyle=ee||"#000000",ue.fillRule="nonzero",ue.globalAlpha=1,ue.lineWidth=1,ue.lineCap="butt",ue.lineJoin="miter",ue.miterLimit=10,ue.globalCompositeOperation="source-over",ue.font="10px sans-serif",ue.setLineDash!==void 0&&(ue.setLineDash([]),ue.lineDashOffset=0)}function z(ue,ee,V,se){const fe=ue.length;for(let he=3;he<fe;he+=4){const be=ue[he];if(be===0)ue[he-3]=ee,ue[he-2]=V,ue[he-1]=se;else if(be<255){const xe=255-be;ue[he-3]=ue[he-3]*be+ee*xe>>8,ue[he-2]=ue[he-2]*be+V*xe>>8,ue[he-1]=ue[he-1]*be+se*xe>>8}}}function q(ue,ee,V){const se=ue.length,fe=1/255;for(let he=3;he<se;he+=4){const be=V?V[ue[he]]:ue[he];ee[he]=ee[he]*be*fe|0}}function H(ue,ee,V){const se=ue.length;for(let fe=3;fe<se;fe+=4){const he=ue[fe-3]*77+ue[fe-2]*152+ue[fe-1]*28;ee[fe]=V?ee[fe]*V[he>>8]>>8:ee[fe]*he>>16}}function W(ue,ee,V,se,fe,he,be,xe,ye,we,$e){const ve=!!he,Te=ve?he[0]:0,te=ve?he[1]:0,ie=ve?he[2]:0;let ce;fe==="Luminosity"?ce=H:ce=q;const de=Math.min(se,Math.ceil(1048576/V));for(let Ae=0;Ae<se;Ae+=de){const Oe=Math.min(de,se-Ae),Re=ue.getImageData(xe-we,Ae+(ye-$e),V,Oe),Ie=ee.getImageData(xe,Ae+ye,V,Oe);ve&&z(Re.data,Te,te,ie),ce(Re.data,Ie.data,be),ee.putImageData(Ie,xe,Ae+ye)}}function U(ue,ee,V,se){const fe=se[0],he=se[1],be=se[2]-fe,xe=se[3]-he;be===0||xe===0||(W(ee.context,V,be,xe,ee.subtype,ee.backdrop,ee.transferMap,fe,he,ee.offsetX,ee.offsetY),ue.save(),ue.globalAlpha=1,ue.globalCompositeOperation="source-over",ue.setTransform(1,0,0,1,0,0),ue.drawImage(V.canvas,0,0),ue.restore())}function Q(ue,ee){const V=r.Util.singularValueDecompose2dScale(ue);V[0]=Math.fround(V[0]),V[1]=Math.fround(V[1]);const se=Math.fround((globalThis.devicePixelRatio||1)*s.PixelsPerInch.PDF_TO_CSS_UNITS);return ee!==void 0?ee:V[0]<=se||V[1]<=se}const J=["butt","round","square"],ne=["miter","round","bevel"],G={},Z={},Se=class{constructor(ee,V,se,fe,{optionalContentConfig:he,markedContentStack:be=null},xe,ye){De(this,oe);this.ctx=ee,this.current=new F(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=V,this.objs=se,this.canvasFactory=fe,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=be||[],this.optionalContentConfig=he,this.cachedCanvases=new O(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=xe,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(ye==null?void 0:ye.background)||null,this.foregroundColor=(ye==null?void 0:ye.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ee,V=null){return typeof ee=="string"?ee.startsWith("g_")?this.commonObjs.get(ee):this.objs.get(ee):V}beginDrawing({transform:ee,viewport:V,transparency:se=!1,background:fe=null}){const he=this.ctx.canvas.width,be=this.ctx.canvas.height,xe=fe||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const ye=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const we=this.backgroundColor=this.ctx.fillStyle;let $e=!0,ve=xe;if(this.ctx.fillStyle=xe,ve=this.ctx.fillStyle,$e=typeof ve=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ve),ye==="#000000"&&we==="#ffffff"||ye===we||!$e)this.foregroundColor=this.backgroundColor=null;else{const[Te,te,ie]=(0,s.getRGB)(ve),ce=de=>(de/=255,de<=.03928?de/12.92:((de+.055)/1.055)**2.4),ge=Math.round(.2126*ce(Te)+.7152*ce(te)+.0722*ce(ie));this.selectColor=(de,Ae,Oe)=>{const Re=.2126*ce(de)+.7152*ce(Ae)+.0722*ce(Oe);return Math.round(Re)===ge?we:ye}}}if(this.ctx.fillStyle=this.backgroundColor||xe,this.ctx.fillRect(0,0,he,be),this.ctx.restore(),se){const ye=this.cachedCanvases.getCanvas("transparent",he,be);this.compositeCtx=this.ctx,this.transparentCanvas=ye.canvas,this.ctx=ye.context,this.ctx.save(),this.ctx.transform(...(0,s.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),j(this.ctx,this.foregroundColor),ee&&(this.ctx.transform(...ee),this.outputScaleX=ee[0],this.outputScaleY=ee[0]),this.ctx.transform(...V.transform),this.viewportScale=V.scale,this.baseTransform=(0,s.getCurrentTransform)(this.ctx)}executeOperatorList(ee,V,se,fe){const he=ee.argsArray,be=ee.fnArray;let xe=V||0;const ye=he.length;if(ye===xe)return xe;const we=ye-xe>v&&typeof se=="function",$e=we?Date.now()+g:0;let ve=0;const Te=this.commonObjs,te=this.objs;let ie;for(;;){if(fe!==void 0&&xe===fe.nextBreakPoint)return fe.breakIt(xe,se),xe;if(ie=be[xe],ie!==r.OPS.dependency)this[ie].apply(this,he[xe]);else for(const ce of he[xe]){const ge=ce.startsWith("g_")?Te:te;if(!ge.has(ce))return ge.get(ce,se),xe}if(xe++,xe===ye)return xe;if(we&&++ve>v){if(Date.now()>$e)return se(),xe;ve=0}}}endDrawing(){Pe(this,oe,si).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ee of this._cachedBitmapsMap.values()){for(const V of ee.values())typeof HTMLCanvasElement<"u"&&V instanceof HTMLCanvasElement&&(V.width=V.height=0);ee.clear()}this._cachedBitmapsMap.clear()}_scaleImage(ee,V){const se=ee.width,fe=ee.height;let he=Math.max(Math.hypot(V[0],V[1]),1),be=Math.max(Math.hypot(V[2],V[3]),1),xe=se,ye=fe,we="prescale1",$e,ve;for(;he>2&&xe>1||be>2&&ye>1;){let Te=xe,te=ye;he>2&&xe>1&&(Te=Math.ceil(xe/2),he/=xe/Te),be>2&&ye>1&&(te=Math.ceil(ye/2),be/=ye/te),$e=this.cachedCanvases.getCanvas(we,Te,te),ve=$e.context,ve.clearRect(0,0,Te,te),ve.drawImage(ee,0,0,xe,ye,0,0,Te,te),ee=$e.canvas,xe=Te,ye=te,we=we==="prescale1"?"prescale2":"prescale1"}return{img:ee,paintWidth:xe,paintHeight:ye}}_createMaskCanvas(ee){const V=this.ctx,{width:se,height:fe}=ee,he=this.current.fillColor,be=this.current.patternFill,xe=(0,s.getCurrentTransform)(V);let ye,we,$e,ve;if((ee.bitmap||ee.data)&&ee.count>1){const je=ee.bitmap||ee.data.buffer;we=JSON.stringify(be?xe:[xe.slice(0,4),he]),ye=this._cachedBitmapsMap.get(je),ye||(ye=new Map,this._cachedBitmapsMap.set(je,ye));const Me=ye.get(we);if(Me&&!be){const Be=Math.round(Math.min(xe[0],xe[2])+xe[4]),ze=Math.round(Math.min(xe[1],xe[3])+xe[5]);return{canvas:Me,offsetX:Be,offsetY:ze}}$e=Me}$e||(ve=this.cachedCanvases.getCanvas("maskCanvas",se,fe),L(ve.context,ee));let Te=r.Util.transform(xe,[1/se,0,0,-1/fe,0,0]);Te=r.Util.transform(Te,[1,0,0,1,0,-fe]);const te=r.Util.applyTransform([0,0],Te),ie=r.Util.applyTransform([se,fe],Te),ce=r.Util.normalizeRect([te[0],te[1],ie[0],ie[1]]),ge=Math.round(ce[2]-ce[0])||1,de=Math.round(ce[3]-ce[1])||1,Ae=this.cachedCanvases.getCanvas("fillCanvas",ge,de),Oe=Ae.context,Re=Math.min(te[0],ie[0]),Ie=Math.min(te[1],ie[1]);Oe.translate(-Re,-Ie),Oe.transform(...Te),$e||($e=this._scaleImage(ve.canvas,(0,s.getCurrentTransformInverse)(Oe)),$e=$e.img,ye&&be&&ye.set(we,$e)),Oe.imageSmoothingEnabled=Q((0,s.getCurrentTransform)(Oe),ee.interpolate),R(Oe,$e,0,0,$e.width,$e.height,0,0,se,fe),Oe.globalCompositeOperation="source-in";const ke=r.Util.transform((0,s.getCurrentTransformInverse)(Oe),[1,0,0,1,-Re,-Ie]);return Oe.fillStyle=be?he.getPattern(V,this,ke,o.PathType.FILL):he,Oe.fillRect(0,0,se,fe),ye&&!be&&(this.cachedCanvases.delete("fillCanvas"),ye.set(we,Ae.canvas)),{canvas:Ae.canvas,offsetX:Math.round(Re),offsetY:Math.round(Ie)}}setLineWidth(ee){ee!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=ee,this.ctx.lineWidth=ee}setLineCap(ee){this.ctx.lineCap=J[ee]}setLineJoin(ee){this.ctx.lineJoin=ne[ee]}setMiterLimit(ee){this.ctx.miterLimit=ee}setDash(ee,V){const se=this.ctx;se.setLineDash!==void 0&&(se.setLineDash(ee),se.lineDashOffset=V)}setRenderingIntent(ee){}setFlatness(ee){}setGState(ee){for(const[V,se]of ee)switch(V){case"LW":this.setLineWidth(se);break;case"LC":this.setLineCap(se);break;case"LJ":this.setLineJoin(se);break;case"ML":this.setMiterLimit(se);break;case"D":this.setDash(se[0],se[1]);break;case"RI":this.setRenderingIntent(se);break;case"FL":this.setFlatness(se);break;case"Font":this.setFont(se[0],se[1]);break;case"CA":this.current.strokeAlpha=se;break;case"ca":this.current.fillAlpha=se,this.ctx.globalAlpha=se;break;case"BM":this.ctx.globalCompositeOperation=se;break;case"SMask":this.current.activeSMask=se?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=se}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ee=this.inSMaskMode;this.current.activeSMask&&!ee?this.beginSMaskMode():!this.current.activeSMask&&ee&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ee=this.ctx.canvas.width,V=this.ctx.canvas.height,se="smaskGroupAt"+this.groupLevel,fe=this.cachedCanvases.getCanvas(se,ee,V);this.suspendedCtx=this.ctx,this.ctx=fe.context;const he=this.ctx;he.setTransform(...(0,s.getCurrentTransform)(this.suspendedCtx)),N(this.suspendedCtx,he),k(he,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),N(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ee){if(!this.current.activeSMask)return;ee?(ee[0]=Math.floor(ee[0]),ee[1]=Math.floor(ee[1]),ee[2]=Math.ceil(ee[2]),ee[3]=Math.ceil(ee[3])):ee=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const V=this.current.activeSMask,se=this.suspendedCtx;U(se,V,this.ctx,ee),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(N(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ee=this.current;this.stateStack.push(ee),this.current=ee.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),N(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(ee,V,se,fe,he,be){this.ctx.transform(ee,V,se,fe,he,be),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(ee,V,se){const fe=this.ctx,he=this.current;let be=he.x,xe=he.y,ye,we;const $e=(0,s.getCurrentTransform)(fe),ve=$e[0]===0&&$e[3]===0||$e[1]===0&&$e[2]===0,Te=ve?se.slice(0):null;for(let te=0,ie=0,ce=ee.length;te<ce;te++)switch(ee[te]|0){case r.OPS.rectangle:be=V[ie++],xe=V[ie++];const ge=V[ie++],de=V[ie++],Ae=be+ge,Oe=xe+de;fe.moveTo(be,xe),ge===0||de===0?fe.lineTo(Ae,Oe):(fe.lineTo(Ae,xe),fe.lineTo(Ae,Oe),fe.lineTo(be,Oe)),ve||he.updateRectMinMax($e,[be,xe,Ae,Oe]),fe.closePath();break;case r.OPS.moveTo:be=V[ie++],xe=V[ie++],fe.moveTo(be,xe),ve||he.updatePathMinMax($e,be,xe);break;case r.OPS.lineTo:be=V[ie++],xe=V[ie++],fe.lineTo(be,xe),ve||he.updatePathMinMax($e,be,xe);break;case r.OPS.curveTo:ye=be,we=xe,be=V[ie+4],xe=V[ie+5],fe.bezierCurveTo(V[ie],V[ie+1],V[ie+2],V[ie+3],be,xe),he.updateCurvePathMinMax($e,ye,we,V[ie],V[ie+1],V[ie+2],V[ie+3],be,xe,Te),ie+=6;break;case r.OPS.curveTo2:ye=be,we=xe,fe.bezierCurveTo(be,xe,V[ie],V[ie+1],V[ie+2],V[ie+3]),he.updateCurvePathMinMax($e,ye,we,be,xe,V[ie],V[ie+1],V[ie+2],V[ie+3],Te),be=V[ie+2],xe=V[ie+3],ie+=4;break;case r.OPS.curveTo3:ye=be,we=xe,be=V[ie+2],xe=V[ie+3],fe.bezierCurveTo(V[ie],V[ie+1],be,xe,be,xe),he.updateCurvePathMinMax($e,ye,we,V[ie],V[ie+1],be,xe,be,xe,Te),ie+=4;break;case r.OPS.closePath:fe.closePath();break}ve&&he.updateScalingPathMinMax($e,Te),he.setCurrentPoint(be,xe)}closePath(){this.ctx.closePath()}stroke(ee=!0){const V=this.ctx,se=this.current.strokeColor;V.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof se=="object"&&(se!=null&&se.getPattern)?(V.save(),V.strokeStyle=se.getPattern(V,this,(0,s.getCurrentTransformInverse)(V),o.PathType.STROKE),this.rescaleAndStroke(!1),V.restore()):this.rescaleAndStroke(!0)),ee&&this.consumePath(this.current.getClippedPathBoundingBox()),V.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ee=!0){const V=this.ctx,se=this.current.fillColor,fe=this.current.patternFill;let he=!1;fe&&(V.save(),V.fillStyle=se.getPattern(V,this,(0,s.getCurrentTransformInverse)(V),o.PathType.FILL),he=!0);const be=this.current.getClippedPathBoundingBox();this.contentVisible&&be!==null&&(this.pendingEOFill?(V.fill("evenodd"),this.pendingEOFill=!1):V.fill()),he&&V.restore(),ee&&this.consumePath(be)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=G}eoClip(){this.pendingClip=Z}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ee=this.pendingTextPaths,V=this.ctx;if(ee===void 0){V.beginPath();return}V.save(),V.beginPath();for(const se of ee)V.setTransform(...se.transform),V.translate(se.x,se.y),se.addToPath(V,se.fontSize);V.restore(),V.clip(),V.beginPath(),delete this.pendingTextPaths}setCharSpacing(ee){this.current.charSpacing=ee}setWordSpacing(ee){this.current.wordSpacing=ee}setHScale(ee){this.current.textHScale=ee/100}setLeading(ee){this.current.leading=-ee}setFont(ee,V){const se=this.commonObjs.get(ee),fe=this.current;if(!se)throw new Error(`Can't find font for ${ee}`);if(fe.fontMatrix=se.fontMatrix||r.FONT_IDENTITY_MATRIX,(fe.fontMatrix[0]===0||fe.fontMatrix[3]===0)&&(0,r.warn)("Invalid font matrix for font "+ee),V<0?(V=-V,fe.fontDirection=-1):fe.fontDirection=1,this.current.font=se,this.current.fontSize=V,se.isType3Font)return;const he=se.loadedName||"sans-serif";let be="normal";se.black?be="900":se.bold&&(be="bold");const xe=se.italic?"italic":"normal",ye=`"${he}", ${se.fallbackName}`;let we=V;V<f?we=f:V>d&&(we=d),this.current.fontSizeScale=V/we,this.ctx.font=`${xe} ${be} ${we}px ${ye}`}setTextRenderingMode(ee){this.current.textRenderingMode=ee}setTextRise(ee){this.current.textRise=ee}moveText(ee,V){this.current.x=this.current.lineX+=ee,this.current.y=this.current.lineY+=V}setLeadingMoveText(ee,V){this.setLeading(-V),this.moveText(ee,V)}setTextMatrix(ee,V,se,fe,he,be){this.current.textMatrix=[ee,V,se,fe,he,be],this.current.textMatrixScale=Math.hypot(ee,V),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ee,V,se,fe){const he=this.ctx,be=this.current,xe=be.font,ye=be.textRenderingMode,we=be.fontSize/be.fontSizeScale,$e=ye&r.TextRenderingMode.FILL_STROKE_MASK,ve=!!(ye&r.TextRenderingMode.ADD_TO_PATH_FLAG),Te=be.patternFill&&!xe.missingFile;let te;(xe.disableFontFace||ve||Te)&&(te=xe.getPathGenerator(this.commonObjs,ee)),xe.disableFontFace||Te?(he.save(),he.translate(V,se),he.beginPath(),te(he,we),fe&&he.setTransform(...fe),($e===r.TextRenderingMode.FILL||$e===r.TextRenderingMode.FILL_STROKE)&&he.fill(),($e===r.TextRenderingMode.STROKE||$e===r.TextRenderingMode.FILL_STROKE)&&he.stroke(),he.restore()):(($e===r.TextRenderingMode.FILL||$e===r.TextRenderingMode.FILL_STROKE)&&he.fillText(ee,V,se),($e===r.TextRenderingMode.STROKE||$e===r.TextRenderingMode.FILL_STROKE)&&he.strokeText(ee,V,se)),ve&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,s.getCurrentTransform)(he),x:V,y:se,fontSize:we,addToPath:te})}get isFontSubpixelAAEnabled(){const{context:ee}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ee.scale(1.5,1),ee.fillText("I",0,10);const V=ee.getImageData(0,0,10,10).data;let se=!1;for(let fe=3;fe<V.length;fe+=4)if(V[fe]>0&&V[fe]<255){se=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",se)}showText(ee){const V=this.current,se=V.font;if(se.isType3Font)return this.showType3Text(ee);const fe=V.fontSize;if(fe===0)return;const he=this.ctx,be=V.fontSizeScale,xe=V.charSpacing,ye=V.wordSpacing,we=V.fontDirection,$e=V.textHScale*we,ve=ee.length,Te=se.vertical,te=Te?1:-1,ie=se.defaultVMetrics,ce=fe*V.fontMatrix[0],ge=V.textRenderingMode===r.TextRenderingMode.FILL&&!se.disableFontFace&&!V.patternFill;he.save(),he.transform(...V.textMatrix),he.translate(V.x,V.y+V.textRise),we>0?he.scale($e,-1):he.scale($e,1);let de;if(V.patternFill){he.save();const ke=V.fillColor.getPattern(he,this,(0,s.getCurrentTransformInverse)(he),o.PathType.FILL);de=(0,s.getCurrentTransform)(he),he.restore(),he.fillStyle=ke}let Ae=V.lineWidth;const Oe=V.textMatrixScale;if(Oe===0||Ae===0){const ke=V.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;(ke===r.TextRenderingMode.STROKE||ke===r.TextRenderingMode.FILL_STROKE)&&(Ae=this.getSinglePixelWidth())}else Ae/=Oe;if(be!==1&&(he.scale(be,be),Ae/=be),he.lineWidth=Ae,se.isInvalidPDFjsFont){const ke=[];let je=0;for(const Me of ee)ke.push(Me.unicode),je+=Me.width;he.fillText(ke.join(""),0,0),V.x+=je*ce*$e,he.restore(),this.compose();return}let Re=0,Ie;for(Ie=0;Ie<ve;++Ie){const ke=ee[Ie];if(typeof ke=="number"){Re+=te*ke*fe/1e3;continue}let je=!1;const Me=(ke.isSpace?ye:0)+xe,Be=ke.fontChar,ze=ke.accent;let Ve,Qe,Ge=ke.width;if(Te){const _e=ke.vmetric||ie,Ee=-(ke.vmetric?_e[1]:Ge*.5)*ce,Ne=_e[2]*ce;Ge=_e?-_e[0]:Ge,Ve=Ee/be,Qe=(Re+Ne)/be}else Ve=Re/be,Qe=0;if(se.remeasure&&Ge>0){const _e=he.measureText(Be).width*1e3/fe*be;if(Ge<_e&&this.isFontSubpixelAAEnabled){const Ee=Ge/_e;je=!0,he.save(),he.scale(Ee,1),Ve/=Ee}else Ge!==_e&&(Ve+=(Ge-_e)/2e3*fe/be)}if(this.contentVisible&&(ke.isInFont||se.missingFile)){if(ge&&!ze)he.fillText(Be,Ve,Qe);else if(this.paintChar(Be,Ve,Qe,de),ze){const _e=Ve+fe*ze.offset.x/be,Ee=Qe-fe*ze.offset.y/be;this.paintChar(ze.fontChar,_e,Ee,de)}}let me;Te?me=Ge*ce-Me*we:me=Ge*ce+Me*we,Re+=me,je&&he.restore()}Te?V.y-=Re:V.x+=Re*$e,he.restore(),this.compose()}showType3Text(ee){const V=this.ctx,se=this.current,fe=se.font,he=se.fontSize,be=se.fontDirection,xe=fe.vertical?1:-1,ye=se.charSpacing,we=se.wordSpacing,$e=se.textHScale*be,ve=se.fontMatrix||r.FONT_IDENTITY_MATRIX,Te=ee.length,te=se.textRenderingMode===r.TextRenderingMode.INVISIBLE;let ie,ce,ge,de;if(!(te||he===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,V.save(),V.transform(...se.textMatrix),V.translate(se.x,se.y),V.scale($e,be),ie=0;ie<Te;++ie){if(ce=ee[ie],typeof ce=="number"){de=xe*ce*he/1e3,this.ctx.translate(de,0),se.x+=de*$e;continue}const Ae=(ce.isSpace?we:0)+ye,Oe=fe.charProcOperatorList[ce.operatorListId];if(!Oe){(0,r.warn)(`Type3 character "${ce.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ce,this.save(),V.scale(he,he),V.transform(...ve),this.executeOperatorList(Oe),this.restore()),ge=r.Util.applyTransform([ce.width,0],ve)[0]*he+Ae,V.translate(ge,0),se.x+=ge*$e}V.restore(),this.processingType3=null}}setCharWidth(ee,V){}setCharWidthAndBounds(ee,V,se,fe,he,be){this.ctx.rect(se,fe,he-se,be-fe),this.ctx.clip(),this.endPath()}getColorN_Pattern(ee){let V;if(ee[0]==="TilingPattern"){const se=ee[1],fe=this.baseTransform||(0,s.getCurrentTransform)(this.ctx),he={createCanvasGraphics:be=>new Se(be,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};V=new o.TilingPattern(ee,se,this.ctx,he,fe)}else V=this._getPattern(ee[1],ee[2]);return V}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ee,V,se){var he;const fe=((he=this.selectColor)==null?void 0:he.call(this,ee,V,se))||r.Util.makeHexColor(ee,V,se);this.ctx.strokeStyle=fe,this.current.strokeColor=fe}setFillRGBColor(ee,V,se){var he;const fe=((he=this.selectColor)==null?void 0:he.call(this,ee,V,se))||r.Util.makeHexColor(ee,V,se);this.ctx.fillStyle=fe,this.current.fillColor=fe,this.current.patternFill=!1}_getPattern(ee,V=null){let se;return this.cachedPatterns.has(ee)?se=this.cachedPatterns.get(ee):(se=(0,o.getShadingPattern)(this.objs.get(ee)),this.cachedPatterns.set(ee,se)),V&&(se.matrix=V),se}shadingFill(ee){if(!this.contentVisible)return;const V=this.ctx;this.save();const se=this._getPattern(ee);V.fillStyle=se.getPattern(V,this,(0,s.getCurrentTransformInverse)(V),o.PathType.SHADING);const fe=(0,s.getCurrentTransformInverse)(V);if(fe){const he=V.canvas,be=he.width,xe=he.height,ye=r.Util.applyTransform([0,0],fe),we=r.Util.applyTransform([0,xe],fe),$e=r.Util.applyTransform([be,0],fe),ve=r.Util.applyTransform([be,xe],fe),Te=Math.min(ye[0],we[0],$e[0],ve[0]),te=Math.min(ye[1],we[1],$e[1],ve[1]),ie=Math.max(ye[0],we[0],$e[0],ve[0]),ce=Math.max(ye[1],we[1],$e[1],ve[1]);this.ctx.fillRect(Te,te,ie-Te,ce-te)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ee,V){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ee)&&ee.length===6&&this.transform(...ee),this.baseTransform=(0,s.getCurrentTransform)(this.ctx),V)){const se=V[2]-V[0],fe=V[3]-V[1];this.ctx.rect(V[0],V[1],se,fe),this.current.updateRectMinMax((0,s.getCurrentTransform)(this.ctx),V),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ee){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const V=this.ctx;ee.isolated||(0,r.info)("TODO: Support non-isolated groups."),ee.knockout&&(0,r.warn)("Knockout groups not supported.");const se=(0,s.getCurrentTransform)(V);if(ee.matrix&&V.transform(...ee.matrix),!ee.bbox)throw new Error("Bounding box is required.");let fe=r.Util.getAxialAlignedBoundingBox(ee.bbox,(0,s.getCurrentTransform)(V));const he=[0,0,V.canvas.width,V.canvas.height];fe=r.Util.intersect(fe,he)||[0,0,0,0];const be=Math.floor(fe[0]),xe=Math.floor(fe[1]);let ye=Math.max(Math.ceil(fe[2])-be,1),we=Math.max(Math.ceil(fe[3])-xe,1),$e=1,ve=1;ye>p&&($e=ye/p,ye=p),we>p&&(ve=we/p,we=p),this.current.startNewPathAndClipBox([0,0,ye,we]);let Te="groupAt"+this.groupLevel;ee.smask&&(Te+="_smask_"+this.smaskCounter++%2);const te=this.cachedCanvases.getCanvas(Te,ye,we),ie=te.context;ie.scale(1/$e,1/ve),ie.translate(-be,-xe),ie.transform(...se),ee.smask?this.smaskStack.push({canvas:te.canvas,context:ie,offsetX:be,offsetY:xe,scaleX:$e,scaleY:ve,subtype:ee.smask.subtype,backdrop:ee.smask.backdrop,transferMap:ee.smask.transferMap||null,startTransformInverse:null}):(V.setTransform(1,0,0,1,0,0),V.translate(be,xe),V.scale($e,ve),V.save()),N(V,ie),this.ctx=ie,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(V),this.groupLevel++}endGroup(ee){if(!this.contentVisible)return;this.groupLevel--;const V=this.ctx,se=this.groupStack.pop();if(this.ctx=se,this.ctx.imageSmoothingEnabled=!1,ee.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const fe=(0,s.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...fe);const he=r.Util.getAxialAlignedBoundingBox([0,0,V.canvas.width,V.canvas.height],fe);this.ctx.drawImage(V.canvas,0,0),this.ctx.restore(),this.compose(he)}}beginAnnotation(ee,V,se,fe,he){if(Pe(this,oe,si).call(this),j(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(V)&&V.length===4){const be=V[2]-V[0],xe=V[3]-V[1];if(he&&this.annotationCanvasMap){se=se.slice(),se[4]-=V[0],se[5]-=V[1],V=V.slice(),V[0]=V[1]=0,V[2]=be,V[3]=xe;const[ye,we]=r.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(this.ctx)),{viewportScale:$e}=this,ve=Math.ceil(be*this.outputScaleX*$e),Te=Math.ceil(xe*this.outputScaleY*$e);this.annotationCanvas=this.canvasFactory.create(ve,Te);const{canvas:te,context:ie}=this.annotationCanvas;this.annotationCanvasMap.set(ee,te),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ie,this.ctx.setTransform(ye,0,0,-we,0,xe*we),j(this.ctx,this.foregroundColor)}else j(this.ctx,this.foregroundColor),this.ctx.rect(V[0],V[1],be,xe),this.ctx.clip(),this.endPath()}this.current=new F(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...se),this.transform(...fe)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ee){if(!this.contentVisible)return;const V=ee.count;ee=this.getObject(ee.data,ee),ee.count=V;const se=this.ctx,fe=this.processingType3;if(fe&&(fe.compiled===void 0&&(fe.compiled=P(ee)),fe.compiled)){fe.compiled(se);return}const he=this._createMaskCanvas(ee),be=he.canvas;se.save(),se.setTransform(1,0,0,1,0,0),se.drawImage(be,he.offsetX,he.offsetY),se.restore(),this.compose()}paintImageMaskXObjectRepeat(ee,V,se=0,fe=0,he,be){if(!this.contentVisible)return;ee=this.getObject(ee.data,ee);const xe=this.ctx;xe.save();const ye=(0,s.getCurrentTransform)(xe);xe.transform(V,se,fe,he,0,0);const we=this._createMaskCanvas(ee);xe.setTransform(1,0,0,1,we.offsetX-ye[4],we.offsetY-ye[5]);for(let $e=0,ve=be.length;$e<ve;$e+=2){const Te=r.Util.transform(ye,[V,se,fe,he,be[$e],be[$e+1]]),[te,ie]=r.Util.applyTransform([0,0],Te);xe.drawImage(we.canvas,te,ie)}xe.restore(),this.compose()}paintImageMaskXObjectGroup(ee){if(!this.contentVisible)return;const V=this.ctx,se=this.current.fillColor,fe=this.current.patternFill;for(const he of ee){const{data:be,width:xe,height:ye,transform:we}=he,$e=this.cachedCanvases.getCanvas("maskCanvas",xe,ye),ve=$e.context;ve.save();const Te=this.getObject(be,he);L(ve,Te),ve.globalCompositeOperation="source-in",ve.fillStyle=fe?se.getPattern(ve,this,(0,s.getCurrentTransformInverse)(V),o.PathType.FILL):se,ve.fillRect(0,0,xe,ye),ve.restore(),V.save(),V.transform(...we),V.scale(1,-1),R(V,$e.canvas,0,0,xe,ye,0,-1,1,1),V.restore()}this.compose()}paintImageXObject(ee){if(!this.contentVisible)return;const V=this.getObject(ee);if(!V){(0,r.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(V)}paintImageXObjectRepeat(ee,V,se,fe){if(!this.contentVisible)return;const he=this.getObject(ee);if(!he){(0,r.warn)("Dependent image isn't ready yet");return}const be=he.width,xe=he.height,ye=[];for(let we=0,$e=fe.length;we<$e;we+=2)ye.push({transform:[V,0,0,se,fe[we],fe[we+1]],x:0,y:0,w:be,h:xe});this.paintInlineImageXObjectGroup(he,ye)}paintInlineImageXObject(ee){if(!this.contentVisible)return;const V=ee.width,se=ee.height,fe=this.ctx;this.save(),fe.scale(1/V,-1/se);let he;if(typeof HTMLElement=="function"&&ee instanceof HTMLElement||!ee.data)he=ee;else{const xe=this.cachedCanvases.getCanvas("inlineImage",V,se),ye=xe.context;I(ye,ee,this.current.transferMaps),he=xe.canvas}const be=this._scaleImage(he,(0,s.getCurrentTransformInverse)(fe));fe.imageSmoothingEnabled=Q((0,s.getCurrentTransform)(fe),ee.interpolate),R(fe,be.img,0,0,be.paintWidth,be.paintHeight,0,-se,V,se),this.compose(),this.restore()}paintInlineImageXObjectGroup(ee,V){if(!this.contentVisible)return;const se=this.ctx,fe=ee.width,he=ee.height,be=this.cachedCanvases.getCanvas("inlineImage",fe,he),xe=be.context;I(xe,ee,this.current.transferMaps);for(const ye of V)se.save(),se.transform(...ye.transform),se.scale(1,-1),R(se,be.canvas,ye.x,ye.y,ye.w,ye.h,0,-1,1,1),se.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ee){}markPointProps(ee,V){}beginMarkedContent(ee){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ee,V){ee==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(V)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ee){const V=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ee);const se=this.ctx;this.pendingClip&&(V||(this.pendingClip===Z?se.clip("evenodd"):se.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),se.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ee=(0,s.getCurrentTransform)(this.ctx);if(ee[1]===0&&ee[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ee[0]),Math.abs(ee[3]));else{const V=Math.abs(ee[0]*ee[3]-ee[2]*ee[1]),se=Math.hypot(ee[0],ee[2]),fe=Math.hypot(ee[1],ee[3]);this._cachedGetSinglePixelWidth=Math.max(se,fe)/V}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:ee}=this.current,V=(0,s.getCurrentTransform)(this.ctx);let se,fe;if(V[1]===0&&V[2]===0){const he=Math.abs(V[0]),be=Math.abs(V[3]);if(ee===0)se=1/he,fe=1/be;else{const xe=he*ee,ye=be*ee;se=xe<1?1/xe:1,fe=ye<1?1/ye:1}}else{const he=Math.abs(V[0]*V[3]-V[2]*V[1]),be=Math.hypot(V[0],V[1]),xe=Math.hypot(V[2],V[3]);if(ee===0)se=xe/he,fe=be/he;else{const ye=ee*he;se=xe>ye?xe/ye:1,fe=be>ye?be/ye:1}}this._cachedScaleForStroking=[se,fe]}return this._cachedScaleForStroking}rescaleAndStroke(ee){const{ctx:V}=this,{lineWidth:se}=this.current,[fe,he]=this.getScaleForStroking();if(V.lineWidth=se||1,fe===1&&he===1){V.stroke();return}let be,xe,ye;ee&&(be=(0,s.getCurrentTransform)(V),xe=V.getLineDash().slice(),ye=V.lineDashOffset),V.scale(fe,he);const we=Math.max(fe,he);V.setLineDash(V.getLineDash().map($e=>$e/we)),V.lineDashOffset/=we,V.stroke(),ee&&(V.setTransform(...be),V.setLineDash(xe),V.lineDashOffset=ye)}isContentVisible(){for(let ee=this.markedContentStack.length-1;ee>=0;ee--)if(!this.markedContentStack[ee].visible)return!1;return!0}};let ae=Se;oe=new WeakSet,si=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},n.CanvasGraphics=ae;for(const ue in r.OPS)ae.prototype[ue]!==void 0&&(ae.prototype[r.OPS[ue]]=ae.prototype[ue])},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=T;var r=i(1),s=i(6);const o={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=o;function l(R,P){if(!P)return;const F=P[2]-P[0],I=P[3]-P[1],L=new Path2D;L.rect(P[0],P[1],F,I),R.clip(L)}class f{constructor(){this.constructor===f&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class d extends f{constructor(P){super(),this._type=P[1],this._bbox=P[2],this._colorStops=P[3],this._p0=P[4],this._p1=P[5],this._r0=P[6],this._r1=P[7],this.matrix=null}_createGradient(P){let F;this._type==="axial"?F=P.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(F=P.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const I of this._colorStops)F.addColorStop(I[0],I[1]);return F}getPattern(P,F,I,L){let N;if(L===o.STROKE||L===o.FILL){const j=F.current.getClippedPathBoundingBox(L,(0,s.getCurrentTransform)(P))||[0,0,0,0],z=Math.ceil(j[2]-j[0])||1,q=Math.ceil(j[3]-j[1])||1,H=F.cachedCanvases.getCanvas("pattern",z,q,!0),W=H.context;W.clearRect(0,0,W.canvas.width,W.canvas.height),W.beginPath(),W.rect(0,0,W.canvas.width,W.canvas.height),W.translate(-j[0],-j[1]),I=r.Util.transform(I,[1,0,0,1,j[0],j[1]]),W.transform(...F.baseTransform),this.matrix&&W.transform(...this.matrix),l(W,this._bbox),W.fillStyle=this._createGradient(W),W.fill(),N=P.createPattern(H.canvas,"no-repeat");const U=new DOMMatrix(I);N.setTransform(U)}else l(P,this._bbox),N=this._createGradient(P);return N}}function p(R,P,F,I,L,N,j,z){const q=P.coords,H=P.colors,W=R.data,U=R.width*4;let Q;q[F+1]>q[I+1]&&(Q=F,F=I,I=Q,Q=N,N=j,j=Q),q[I+1]>q[L+1]&&(Q=I,I=L,L=Q,Q=j,j=z,z=Q),q[F+1]>q[I+1]&&(Q=F,F=I,I=Q,Q=N,N=j,j=Q);const J=(q[F]+P.offsetX)*P.scaleX,ne=(q[F+1]+P.offsetY)*P.scaleY,G=(q[I]+P.offsetX)*P.scaleX,Z=(q[I+1]+P.offsetY)*P.scaleY,ae=(q[L]+P.offsetX)*P.scaleX,oe=(q[L+1]+P.offsetY)*P.scaleY;if(ne>=oe)return;const pe=H[N],Se=H[N+1],ue=H[N+2],ee=H[j],V=H[j+1],se=H[j+2],fe=H[z],he=H[z+1],be=H[z+2],xe=Math.round(ne),ye=Math.round(oe);let we,$e,ve,Te,te,ie,ce,ge;for(let de=xe;de<=ye;de++){if(de<Z){let ke;de<ne?ke=0:ke=(ne-de)/(ne-Z),we=J-(J-G)*ke,$e=pe-(pe-ee)*ke,ve=Se-(Se-V)*ke,Te=ue-(ue-se)*ke}else{let ke;de>oe?ke=1:Z===oe?ke=0:ke=(Z-de)/(Z-oe),we=G-(G-ae)*ke,$e=ee-(ee-fe)*ke,ve=V-(V-he)*ke,Te=se-(se-be)*ke}let Ae;de<ne?Ae=0:de>oe?Ae=1:Ae=(ne-de)/(ne-oe),te=J-(J-ae)*Ae,ie=pe-(pe-fe)*Ae,ce=Se-(Se-he)*Ae,ge=ue-(ue-be)*Ae;const Oe=Math.round(Math.min(we,te)),Re=Math.round(Math.max(we,te));let Ie=U*de+Oe*4;for(let ke=Oe;ke<=Re;ke++)Ae=(we-ke)/(we-te),Ae<0?Ae=0:Ae>1&&(Ae=1),W[Ie++]=$e-($e-ie)*Ae|0,W[Ie++]=ve-(ve-ce)*Ae|0,W[Ie++]=Te-(Te-ge)*Ae|0,W[Ie++]=255}}function g(R,P,F){const I=P.coords,L=P.colors;let N,j;switch(P.type){case"lattice":const z=P.verticesPerRow,q=Math.floor(I.length/z)-1,H=z-1;for(N=0;N<q;N++){let W=N*z;for(let U=0;U<H;U++,W++)p(R,F,I[W],I[W+1],I[W+z],L[W],L[W+1],L[W+z]),p(R,F,I[W+z+1],I[W+1],I[W+z],L[W+z+1],L[W+1],L[W+z])}break;case"triangles":for(N=0,j=I.length;N<j;N+=3)p(R,F,I[N],I[N+1],I[N+2],L[N],L[N+1],L[N+2]);break;default:throw new Error("illegal figure")}}class v extends f{constructor(P){super(),this._coords=P[2],this._colors=P[3],this._figures=P[4],this._bounds=P[5],this._bbox=P[7],this._background=P[8],this.matrix=null}_createMeshCanvas(P,F,I){const z=Math.floor(this._bounds[0]),q=Math.floor(this._bounds[1]),H=Math.ceil(this._bounds[2])-z,W=Math.ceil(this._bounds[3])-q,U=Math.min(Math.ceil(Math.abs(H*P[0]*1.1)),3e3),Q=Math.min(Math.ceil(Math.abs(W*P[1]*1.1)),3e3),J=H/U,ne=W/Q,G={coords:this._coords,colors:this._colors,offsetX:-z,offsetY:-q,scaleX:1/J,scaleY:1/ne},Z=U+2*2,ae=Q+2*2,oe=I.getCanvas("mesh",Z,ae,!1),pe=oe.context,Se=pe.createImageData(U,Q);if(F){const ee=Se.data;for(let V=0,se=ee.length;V<se;V+=4)ee[V]=F[0],ee[V+1]=F[1],ee[V+2]=F[2],ee[V+3]=255}for(const ee of this._figures)g(Se,ee,G);return pe.putImageData(Se,2,2),{canvas:oe.canvas,offsetX:z-2*J,offsetY:q-2*ne,scaleX:J,scaleY:ne}}getPattern(P,F,I,L){l(P,this._bbox);let N;if(L===o.SHADING)N=r.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(P));else if(N=r.Util.singularValueDecompose2dScale(F.baseTransform),this.matrix){const z=r.Util.singularValueDecompose2dScale(this.matrix);N=[N[0]*z[0],N[1]*z[1]]}const j=this._createMeshCanvas(N,L===o.SHADING?null:this._background,F.cachedCanvases);return L!==o.SHADING&&(P.setTransform(...F.baseTransform),this.matrix&&P.transform(...this.matrix)),P.translate(j.offsetX,j.offsetY),P.scale(j.scaleX,j.scaleY),P.createPattern(j.canvas,"no-repeat")}}class S extends f{getPattern(){return"hotpink"}}function T(R){switch(R[0]){case"RadialAxial":return new d(R);case"Mesh":return new v(R);case"Dummy":return new S}throw new Error(`Unknown IR type: ${R[0]}`)}const k={COLORED:1,UNCOLORED:2};class O{static get MAX_PATTERN_SIZE(){return(0,r.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(P,F,I,L,N){this.operatorList=P[2],this.matrix=P[3]||[1,0,0,1,0,0],this.bbox=P[4],this.xstep=P[5],this.ystep=P[6],this.paintType=P[7],this.tilingType=P[8],this.color=F,this.ctx=I,this.canvasGraphicsFactory=L,this.baseTransform=N}createPatternCanvas(P){const F=this.operatorList,I=this.bbox,L=this.xstep,N=this.ystep,j=this.paintType,z=this.tilingType,q=this.color,H=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+z);const W=I[0],U=I[1],Q=I[2],J=I[3],ne=r.Util.singularValueDecompose2dScale(this.matrix),G=r.Util.singularValueDecompose2dScale(this.baseTransform),Z=[ne[0]*G[0],ne[1]*G[1]],ae=this.getSizeAndScale(L,this.ctx.canvas.width,Z[0]),oe=this.getSizeAndScale(N,this.ctx.canvas.height,Z[1]),pe=P.cachedCanvases.getCanvas("pattern",ae.size,oe.size,!0),Se=pe.context,ue=H.createCanvasGraphics(Se);ue.groupLevel=P.groupLevel,this.setFillAndStrokeStyleToContext(ue,j,q);let ee=W,V=U,se=Q,fe=J;return W<0&&(ee=0,se+=Math.abs(W)),U<0&&(V=0,fe+=Math.abs(U)),Se.translate(-(ae.scale*ee),-(oe.scale*V)),ue.transform(ae.scale,0,0,oe.scale,0,0),Se.save(),this.clipBbox(ue,ee,V,se,fe),ue.baseTransform=(0,s.getCurrentTransform)(ue.ctx),ue.executeOperatorList(F),ue.endDrawing(),{canvas:pe.canvas,scaleX:ae.scale,scaleY:oe.scale,offsetX:ee,offsetY:V}}getSizeAndScale(P,F,I){P=Math.abs(P);const L=Math.max(O.MAX_PATTERN_SIZE,F);let N=Math.ceil(P*I);return N>=L?N=L:I=N/P,{scale:I,size:N}}clipBbox(P,F,I,L,N){const j=L-F,z=N-I;P.ctx.rect(F,I,j,z),P.current.updateRectMinMax((0,s.getCurrentTransform)(P.ctx),[F,I,L,N]),P.clip(),P.endPath()}setFillAndStrokeStyleToContext(P,F,I){const L=P.ctx,N=P.current;switch(F){case k.COLORED:const j=this.ctx;L.fillStyle=j.fillStyle,L.strokeStyle=j.strokeStyle,N.fillColor=j.fillStyle,N.strokeColor=j.strokeStyle;break;case k.UNCOLORED:const z=r.Util.makeHexColor(I[0],I[1],I[2]);L.fillStyle=z,L.strokeStyle=z,N.fillColor=z,N.strokeColor=z;break;default:throw new r.FormatError(`Unsupported paint type: ${F}`)}}getPattern(P,F,I,L){let N=I;L!==o.SHADING&&(N=r.Util.transform(N,F.baseTransform),this.matrix&&(N=r.Util.transform(N,this.matrix)));const j=this.createPatternCanvas(F);let z=new DOMMatrix(N);z=z.translate(j.offsetX,j.offsetY),z=z.scale(1/j.scaleX,1/j.scaleY);const q=P.createPattern(j.canvas,"repeat");return q.setTransform(z),q}}n.TilingPattern=O},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.applyMaskImageData=s;var r=i(1);function s({src:o,srcPos:l=0,dest:f,destPos:d=0,width:p,height:g,inverseDecode:v=!1}){const S=r.FeatureTest.isLittleEndian?4278190080:255,[T,k]=v?[0,S]:[S,0],O=p>>3,R=p&7,P=o.length;f=new Uint32Array(f.buffer);for(let F=0;F<g;F++){for(const L=l+O;l<L;l++){const N=l<P?o[l]:255;f[d++]=N&128?k:T,f[d++]=N&64?k:T,f[d++]=N&32?k:T,f[d++]=N&16?k:T,f[d++]=N&8?k:T,f[d++]=N&4?k:T,f[d++]=N&2?k:T,f[d++]=N&1?k:T}if(R===0)continue;const I=l<P?o[l++]:255;for(let L=0;L<R;L++)f[d++]=I&1<<7-L?k:T}return{srcPos:l,destPos:d}}},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const i=Object.create(null);n.GlobalWorkerOptions=i,i.workerPort=null,i.workerSrc=""},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var r=i(1);const s={UNKNOWN:0,DATA:1,ERROR:2},o={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function l(d){switch(d instanceof Error||typeof d=="object"&&d!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new r.AbortException(d.message);case"MissingPDFException":return new r.MissingPDFException(d.message);case"PasswordException":return new r.PasswordException(d.message,d.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(d.message,d.status);case"UnknownErrorException":return new r.UnknownErrorException(d.message,d.details);default:return new r.UnknownErrorException(d.message,d.toString())}}class f{constructor(p,g,v){this.sourceName=p,this.targetName=g,this.comObj=v,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=S=>{const T=S.data;if(T.targetName!==this.sourceName)return;if(T.stream){this._processStreamMessage(T);return}if(T.callback){const O=T.callbackId,R=this.callbackCapabilities[O];if(!R)throw new Error(`Cannot resolve callback ${O}`);if(delete this.callbackCapabilities[O],T.callback===s.DATA)R.resolve(T.data);else if(T.callback===s.ERROR)R.reject(l(T.reason));else throw new Error("Unexpected callback case");return}const k=this.actionHandler[T.action];if(!k)throw new Error(`Unknown action from worker: ${T.action}`);if(T.callbackId){const O=this.sourceName,R=T.sourceName;new Promise(function(P){P(k(T.data))}).then(function(P){v.postMessage({sourceName:O,targetName:R,callback:s.DATA,callbackId:T.callbackId,data:P})},function(P){v.postMessage({sourceName:O,targetName:R,callback:s.ERROR,callbackId:T.callbackId,reason:l(P)})});return}if(T.streamId){this._createStreamSink(T);return}k(T.data)},v.addEventListener("message",this._onComObjOnMessage)}on(p,g){const v=this.actionHandler;if(v[p])throw new Error(`There is already an actionName called "${p}"`);v[p]=g}send(p,g,v){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,data:g},v)}sendWithPromise(p,g,v){const S=this.callbackId++,T=(0,r.createPromiseCapability)();this.callbackCapabilities[S]=T;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,callbackId:S,data:g},v)}catch(k){T.reject(k)}return T.promise}sendWithStream(p,g,v,S){const T=this.streamId++,k=this.sourceName,O=this.targetName,R=this.comObj;return new ReadableStream({start:P=>{const F=(0,r.createPromiseCapability)();return this.streamControllers[T]={controller:P,startCall:F,pullCall:null,cancelCall:null,isClosed:!1},R.postMessage({sourceName:k,targetName:O,action:p,streamId:T,data:g,desiredSize:P.desiredSize},S),F.promise},pull:P=>{const F=(0,r.createPromiseCapability)();return this.streamControllers[T].pullCall=F,R.postMessage({sourceName:k,targetName:O,stream:o.PULL,streamId:T,desiredSize:P.desiredSize}),F.promise},cancel:P=>{(0,r.assert)(P instanceof Error,"cancel must have a valid reason");const F=(0,r.createPromiseCapability)();return this.streamControllers[T].cancelCall=F,this.streamControllers[T].isClosed=!0,R.postMessage({sourceName:k,targetName:O,stream:o.CANCEL,streamId:T,reason:l(P)}),F.promise}},v)}_createStreamSink(p){const g=p.streamId,v=this.sourceName,S=p.sourceName,T=this.comObj,k=this,O=this.actionHandler[p.action],R={enqueue(P,F=1,I){if(this.isCancelled)return;const L=this.desiredSize;this.desiredSize-=F,L>0&&this.desiredSize<=0&&(this.sinkCapability=(0,r.createPromiseCapability)(),this.ready=this.sinkCapability.promise),T.postMessage({sourceName:v,targetName:S,stream:o.ENQUEUE,streamId:g,chunk:P},I)},close(){this.isCancelled||(this.isCancelled=!0,T.postMessage({sourceName:v,targetName:S,stream:o.CLOSE,streamId:g}),delete k.streamSinks[g])},error(P){(0,r.assert)(P instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,T.postMessage({sourceName:v,targetName:S,stream:o.ERROR,streamId:g,reason:l(P)}))},sinkCapability:(0,r.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:p.desiredSize,ready:null};R.sinkCapability.resolve(),R.ready=R.sinkCapability.promise,this.streamSinks[g]=R,new Promise(function(P){P(O(p.data,R))}).then(function(){T.postMessage({sourceName:v,targetName:S,stream:o.START_COMPLETE,streamId:g,success:!0})},function(P){T.postMessage({sourceName:v,targetName:S,stream:o.START_COMPLETE,streamId:g,reason:l(P)})})}_processStreamMessage(p){const g=p.streamId,v=this.sourceName,S=p.sourceName,T=this.comObj,k=this.streamControllers[g],O=this.streamSinks[g];switch(p.stream){case o.START_COMPLETE:p.success?k.startCall.resolve():k.startCall.reject(l(p.reason));break;case o.PULL_COMPLETE:p.success?k.pullCall.resolve():k.pullCall.reject(l(p.reason));break;case o.PULL:if(!O){T.postMessage({sourceName:v,targetName:S,stream:o.PULL_COMPLETE,streamId:g,success:!0});break}O.desiredSize<=0&&p.desiredSize>0&&O.sinkCapability.resolve(),O.desiredSize=p.desiredSize,new Promise(function(R){R(O.onPull&&O.onPull())}).then(function(){T.postMessage({sourceName:v,targetName:S,stream:o.PULL_COMPLETE,streamId:g,success:!0})},function(R){T.postMessage({sourceName:v,targetName:S,stream:o.PULL_COMPLETE,streamId:g,reason:l(R)})});break;case o.ENQUEUE:if((0,r.assert)(k,"enqueue should have stream controller"),k.isClosed)break;k.controller.enqueue(p.chunk);break;case o.CLOSE:if((0,r.assert)(k,"close should have stream controller"),k.isClosed)break;k.isClosed=!0,k.controller.close(),this._deleteStreamController(k,g);break;case o.ERROR:(0,r.assert)(k,"error should have stream controller"),k.controller.error(l(p.reason)),this._deleteStreamController(k,g);break;case o.CANCEL_COMPLETE:p.success?k.cancelCall.resolve():k.cancelCall.reject(l(p.reason)),this._deleteStreamController(k,g);break;case o.CANCEL:if(!O)break;new Promise(function(R){R(O.onCancel&&O.onCancel(l(p.reason)))}).then(function(){T.postMessage({sourceName:v,targetName:S,stream:o.CANCEL_COMPLETE,streamId:g,success:!0})},function(R){T.postMessage({sourceName:v,targetName:S,stream:o.CANCEL_COMPLETE,streamId:g,reason:l(R)})}),O.sinkCapability.reject(l(p.reason)),O.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(p,g){await Promise.allSettled([p.startCall&&p.startCall.promise,p.pullCall&&p.pullCall.promise,p.cancelCall&&p.cancelCall.promise]),delete this.streamControllers[g]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=f},(e,n,i)=>{var o,l;Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var r=i(1);class s{constructor({parsedData:d,rawData:p}){De(this,o,void 0);De(this,l,void 0);Ue(this,o,d),Ue(this,l,p)}getRaw(){return le(this,l)}get(d){return le(this,o).get(d)??null}getAll(){return(0,r.objectFromMap)(le(this,o))}has(d){return le(this,o).has(d)}}o=new WeakMap,l=new WeakMap,n.Metadata=s},(e,n,i)=>{var d,p,g,v,S,T,oi;Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var r=i(1),s=i(8);const o=Symbol("INTERNAL");class l{constructor(R,P){De(this,d,!0);this.name=R,this.intent=P}get visible(){return le(this,d)}_setVisible(R,P){R!==o&&(0,r.unreachable)("Internal method `_setVisible` called."),Ue(this,d,P)}}d=new WeakMap;class f{constructor(R){De(this,T);De(this,p,null);De(this,g,new Map);De(this,v,null);De(this,S,null);if(this.name=null,this.creator=null,R!==null){this.name=R.name,this.creator=R.creator,Ue(this,S,R.order);for(const P of R.groups)le(this,g).set(P.id,new l(P.name,P.intent));if(R.baseState==="OFF")for(const P of le(this,g).values())P._setVisible(o,!1);for(const P of R.on)le(this,g).get(P)._setVisible(o,!0);for(const P of R.off)le(this,g).get(P)._setVisible(o,!1);Ue(this,v,this.getHash())}}isVisible(R){if(le(this,g).size===0)return!0;if(!R)return(0,r.warn)("Optional content group not defined."),!0;if(R.type==="OCG")return le(this,g).has(R.id)?le(this,g).get(R.id).visible:((0,r.warn)(`Optional content group not found: ${R.id}`),!0);if(R.type==="OCMD"){if(R.expression)return Pe(this,T,oi).call(this,R.expression);if(!R.policy||R.policy==="AnyOn"){for(const P of R.ids){if(!le(this,g).has(P))return(0,r.warn)(`Optional content group not found: ${P}`),!0;if(le(this,g).get(P).visible)return!0}return!1}else if(R.policy==="AllOn"){for(const P of R.ids){if(!le(this,g).has(P))return(0,r.warn)(`Optional content group not found: ${P}`),!0;if(!le(this,g).get(P).visible)return!1}return!0}else if(R.policy==="AnyOff"){for(const P of R.ids){if(!le(this,g).has(P))return(0,r.warn)(`Optional content group not found: ${P}`),!0;if(!le(this,g).get(P).visible)return!0}return!1}else if(R.policy==="AllOff"){for(const P of R.ids){if(!le(this,g).has(P))return(0,r.warn)(`Optional content group not found: ${P}`),!0;if(le(this,g).get(P).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${R.policy}.`),!0}return(0,r.warn)(`Unknown group type ${R.type}.`),!0}setVisibility(R,P=!0){if(!le(this,g).has(R)){(0,r.warn)(`Optional content group not found: ${R}`);return}le(this,g).get(R)._setVisible(o,!!P),Ue(this,p,null)}get hasInitialVisibility(){return this.getHash()===le(this,v)}getOrder(){return le(this,g).size?le(this,S)?le(this,S).slice():[...le(this,g).keys()]:null}getGroups(){return le(this,g).size>0?(0,r.objectFromMap)(le(this,g)):null}getGroup(R){return le(this,g).get(R)||null}getHash(){if(le(this,p)!==null)return le(this,p);const R=new s.MurmurHash3_64;for(const[P,F]of le(this,g))R.update(`${P}:${F.visible}`);return Ue(this,p,R.hexdigest())}}p=new WeakMap,g=new WeakMap,v=new WeakMap,S=new WeakMap,T=new WeakSet,oi=function(R){const P=R.length;if(P<2)return!0;const F=R[0];for(let I=1;I<P;I++){const L=R[I];let N;if(Array.isArray(L))N=Pe(this,T,oi).call(this,L);else if(le(this,g).has(L))N=le(this,g).get(L).visible;else return(0,r.warn)(`Optional content group not found: ${L}`),!0;switch(F){case"And":if(!N)return!1;break;case"Or":if(N)return!0;break;case"Not":return!N;default:return!0}}return F==="And"},n.OptionalContentConfig=f},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var r=i(1),s=i(6);class o{constructor({length:p,initialData:g,progressiveDone:v=!1,contentDispositionFilename:S=null,disableRange:T=!1,disableStream:k=!1},O){if((0,r.assert)(O,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=v,this._contentDispositionFilename=S,(g==null?void 0:g.length)>0){const R=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;this._queuedChunks.push(R)}this._pdfDataRangeTransport=O,this._isStreamingSupported=!k,this._isRangeSupported=!T,this._contentLength=p,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((R,P)=>{this._onReceiveData({begin:R,chunk:P})}),this._pdfDataRangeTransport.addProgressListener((R,P)=>{this._onProgress({loaded:R,total:P})}),this._pdfDataRangeTransport.addProgressiveReadListener(R=>{this._onReceiveData({chunk:R})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:p,chunk:g}){const v=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;if(p===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(v):this._queuedChunks.push(v);else{const S=this._rangeReaders.some(function(T){return T._begin!==p?!1:(T._enqueue(v),!0)});(0,r.assert)(S,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}_onProgress(p){var g,v,S,T;p.total===void 0?(v=(g=this._rangeReaders[0])==null?void 0:g.onProgress)==null||v.call(g,{loaded:p.loaded}):(T=(S=this._fullRequestReader)==null?void 0:S.onProgress)==null||T.call(S,{loaded:p.loaded,total:p.total})}_onProgressiveDone(){var p;(p=this._fullRequestReader)==null||p.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(p){const g=this._rangeReaders.indexOf(p);g>=0&&this._rangeReaders.splice(g,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const p=this._queuedChunks;return this._queuedChunks=null,new l(this,p,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(p,g){if(g<=this._progressiveDataLength)return null;const v=new f(this,p,g);return this._pdfDataRangeTransport.requestDataRange(p,g),this._rangeReaders.push(v),v}cancelAllRequests(p){var g;(g=this._fullRequestReader)==null||g.cancel(p);for(const v of this._rangeReaders.slice(0))v.cancel(p);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=o;class l{constructor(p,g,v=!1,S=null){this._stream=p,this._done=v||!1,this._filename=(0,s.isPdfFile)(S)?S:null,this._queuedChunks=g||[],this._loaded=0;for(const T of this._queuedChunks)this._loaded+=T.byteLength;this._requests=[],this._headersReady=Promise.resolve(),p._fullRequestReader=this,this.onProgress=null}_enqueue(p){this._done||(this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunks.push(p),this._loaded+=p.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=(0,r.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class f{constructor(p,g,v){this._stream=p,this._begin=g,this._end=v,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(p){if(!this._done){if(this._requests.length===0)this._queuedChunk=p;else{this._requests.shift().resolve({value:p,done:!1});for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const p=(0,r.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class i{static textContent(s){const o=[],l={items:o,styles:Object.create(null)};function f(d){var v;if(!d)return;let p=null;const g=d.name;if(g==="#text")p=d.value;else if(i.shouldBuildText(g))(v=d==null?void 0:d.attributes)!=null&&v.textContent?p=d.attributes.textContent:d.value&&(p=d.value);else return;if(p!==null&&o.push({str:p}),!!d.children)for(const S of d.children)f(S)}return f(s),l}static shouldBuildText(s){return!(s==="textarea"||s==="input"||s==="option"||s==="select")}}n.XfaText=i},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var r=i(7);const s=function(d){return new Promise((p,g)=>{require$$2.readFile(d,(S,T)=>{if(S||!T){g(new Error(S));return}p(new Uint8Array(T))})})};class o extends r.BaseCanvasFactory{_createCanvas(p,g){return require$$2.createCanvas(p,g)}}n.NodeCanvasFactory=o;class l extends r.BaseCMapReaderFactory{_fetchData(p,g){return s(p).then(v=>({cMapData:v,compressionType:g}))}}n.NodeCMapReaderFactory=l;class f extends r.BaseStandardFontDataFactory{_fetchData(p){return s(p)}}n.NodeStandardFontDataFactory=f},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var r=i(1),s=i(22);const o=require$$2,l=require$$2,f=require$$2,d=require$$2,p=/^file:\/\/\/[a-zA-Z]:\//;function g(I){const L=d.parse(I);return L.protocol==="file:"||L.host?L:/^[a-z]:[/\\]/i.test(I)?d.parse(`file:///${I}`):(L.host||(L.protocol="file:"),L)}class v{constructor(L){this.source=L,this.url=g(L.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new P(this):new O(this),this._fullRequestReader}getRangeReader(L,N){if(N<=this._progressiveDataLength)return null;const j=this.isFsUrl?new F(this,L,N):new R(this,L,N);return this._rangeRequestReaders.push(j),j}cancelAllRequests(L){var N;(N=this._fullRequestReader)==null||N.cancel(L);for(const j of this._rangeRequestReaders.slice(0))j.cancel(L)}}n.PDFNodeStream=v;class S{constructor(L){this._url=L.url,this._done=!1,this._storedError=null,this.onProgress=null;const N=L.source;this._contentLength=N.length,this._loaded=0,this._filename=null,this._disableRange=N.disableRange||!1,this._rangeChunkSize=N.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!N.disableStream,this._isRangeSupported=!N.disableRange,this._readableStream=null,this._readCapability=(0,r.createPromiseCapability)(),this._headersCapability=(0,r.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var j;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const L=this._readableStream.read();return L===null?(this._readCapability=(0,r.createPromiseCapability)(),this.read()):(this._loaded+=L.length,(j=this.onProgress)==null||j.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){if(!this._readableStream){this._error(L);return}this._readableStream.destroy(L)}_error(L){this._storedError=L,this._readCapability.resolve()}_setReadableStream(L){this._readableStream=L,L.on("readable",()=>{this._readCapability.resolve()}),L.on("end",()=>{L.destroy(),this._done=!0,this._readCapability.resolve()}),L.on("error",N=>{this._error(N)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class T{constructor(L){this._url=L.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,r.createPromiseCapability)();const N=L.source;this._isStreamingSupported=!N.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var j;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const L=this._readableStream.read();return L===null?(this._readCapability=(0,r.createPromiseCapability)(),this.read()):(this._loaded+=L.length,(j=this.onProgress)==null||j.call(this,{loaded:this._loaded}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){if(!this._readableStream){this._error(L);return}this._readableStream.destroy(L)}_error(L){this._storedError=L,this._readCapability.resolve()}_setReadableStream(L){this._readableStream=L,L.on("readable",()=>{this._readCapability.resolve()}),L.on("end",()=>{L.destroy(),this._done=!0,this._readCapability.resolve()}),L.on("error",N=>{this._error(N)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function k(I,L){return{protocol:I.protocol,auth:I.auth,host:I.hostname,port:I.port,path:I.path,method:"GET",headers:L}}class O extends S{constructor(L){super(L);const N=j=>{if(j.statusCode===404){const W=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=W,this._headersCapability.reject(W);return}this._headersCapability.resolve(),this._setReadableStream(j);const z=W=>this._readableStream.headers[W.toLowerCase()],{allowRangeRequests:q,suggestedLength:H}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:z,isHttp:L.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=q,this._contentLength=H||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(z)};this._request=null,this._url.protocol==="http:"?this._request=l.request(k(this._url,L.httpHeaders),N):this._request=f.request(k(this._url,L.httpHeaders),N),this._request.on("error",j=>{this._storedError=j,this._headersCapability.reject(j)}),this._request.end()}}class R extends T{constructor(L,N,j){super(L),this._httpHeaders={};for(const q in L.httpHeaders){const H=L.httpHeaders[q];H!==void 0&&(this._httpHeaders[q]=H)}this._httpHeaders.Range=`bytes=${N}-${j-1}`;const z=q=>{if(q.statusCode===404){const H=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=H;return}this._setReadableStream(q)};this._request=null,this._url.protocol==="http:"?this._request=l.request(k(this._url,this._httpHeaders),z):this._request=f.request(k(this._url,this._httpHeaders),z),this._request.on("error",q=>{this._storedError=q}),this._request.end()}}class P extends S{constructor(L){super(L);let N=decodeURIComponent(this._url.path);p.test(this._url.href)&&(N=N.replace(/^\//,"")),o.lstat(N,(j,z)=>{if(j){j.code==="ENOENT"&&(j=new r.MissingPDFException(`Missing PDF "${N}".`)),this._storedError=j,this._headersCapability.reject(j);return}this._contentLength=z.size,this._setReadableStream(o.createReadStream(N)),this._headersCapability.resolve()})}}class F extends T{constructor(L,N,j){super(L);let z=decodeURIComponent(this._url.path);p.test(this._url.href)&&(z=z.replace(/^\//,"")),this._setReadableStream(o.createReadStream(z,{start:N,end:j-1}))}}},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=d,n.extractFilenameFromHeader=f,n.validateRangeRequestCapabilities=l,n.validateResponseStatus=p;var r=i(1),s=i(23),o=i(6);function l({getResponseHeader:g,isHttp:v,rangeChunkSize:S,disableRange:T}){const k={allowRangeRequests:!1,suggestedLength:void 0},O=parseInt(g("Content-Length"),10);return!Number.isInteger(O)||(k.suggestedLength=O,O<=2*S)||T||!v||g("Accept-Ranges")!=="bytes"||(g("Content-Encoding")||"identity")!=="identity"||(k.allowRangeRequests=!0),k}function f(g){const v=g("Content-Disposition");if(v){let S=(0,s.getFilenameFromContentDispositionHeader)(v);if(S.includes("%"))try{S=decodeURIComponent(S)}catch{}if((0,o.isPdfFile)(S))return S}return null}function d(g,v){return g===404||g===0&&v.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+v+'".'):new r.UnexpectedResponseException(`Unexpected server response (${g}) while retrieving PDF "${v}".`,g)}function p(g){return g===200||g===206}},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=s;var r=i(1);function s(o){let l=!0,f=d("filename\\*","i").exec(o);if(f){f=f[1];let O=S(f);return O=unescape(O),O=T(O),O=k(O),g(O)}if(f=v(o),f){const O=k(f);return g(O)}if(f=d("filename","i").exec(o),f){f=f[1];let O=S(f);return O=k(O),g(O)}function d(O,R){return new RegExp("(?:^|;)\\s*"+O+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',R)}function p(O,R){if(O){if(!/^[\x00-\xFF]+$/.test(R))return R;try{const P=new TextDecoder(O,{fatal:!0}),F=(0,r.stringToBytes)(R);R=P.decode(F),l=!1}catch{}}return R}function g(O){return l&&/[\x80-\xff]/.test(O)&&(O=p("utf-8",O),l&&(O=p("iso-8859-1",O))),O}function v(O){const R=[];let P;const F=d("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(P=F.exec(O))!==null;){let[,L,N,j]=P;if(L=parseInt(L,10),L in R){if(L===0)break;continue}R[L]=[N,j]}const I=[];for(let L=0;L<R.length&&L in R;++L){let[N,j]=R[L];j=S(j),N&&(j=unescape(j),L===0&&(j=T(j))),I.push(j)}return I.join("")}function S(O){if(O.startsWith('"')){const R=O.slice(1).split('\\"');for(let P=0;P<R.length;++P){const F=R[P].indexOf('"');F!==-1&&(R[P]=R[P].slice(0,F),R.length=P+1),R[P]=R[P].replace(/\\(.)/g,"$1")}O=R.join('"')}return O}function T(O){const R=O.indexOf("'");if(R===-1)return O;const P=O.slice(0,R),I=O.slice(R+1).replace(/^[^']*'/,"");return p(P,I)}function k(O){return!O.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(O)?O:O.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(R,P,F,I){if(F==="q"||F==="Q")return I=I.replace(/_/g," "),I=I.replace(/=([0-9a-fA-F]{2})/g,function(L,N){return String.fromCharCode(parseInt(N,16))}),p(P,I);try{I=atob(I)}catch{}return p(P,I)})}return""}},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var r=i(1),s=i(22);const o=200,l=206;function f(S){const T=S.response;return typeof T!="string"?T:(0,r.stringToBytes)(T).buffer}class d{constructor(T,k={}){this.url=T,this.isHttp=/^https?:/i.test(T),this.httpHeaders=this.isHttp&&k.httpHeaders||Object.create(null),this.withCredentials=k.withCredentials||!1,this.getXhr=k.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(T,k,O){const R={begin:T,end:k};for(const P in O)R[P]=O[P];return this.request(R)}requestFull(T){return this.request(T)}request(T){const k=this.getXhr(),O=this.currXhrId++,R=this.pendingRequests[O]={xhr:k};k.open("GET",this.url),k.withCredentials=this.withCredentials;for(const P in this.httpHeaders){const F=this.httpHeaders[P];F!==void 0&&k.setRequestHeader(P,F)}return this.isHttp&&"begin"in T&&"end"in T?(k.setRequestHeader("Range",`bytes=${T.begin}-${T.end-1}`),R.expectedStatus=l):R.expectedStatus=o,k.responseType="arraybuffer",T.onError&&(k.onerror=function(P){T.onError(k.status)}),k.onreadystatechange=this.onStateChange.bind(this,O),k.onprogress=this.onProgress.bind(this,O),R.onHeadersReceived=T.onHeadersReceived,R.onDone=T.onDone,R.onError=T.onError,R.onProgress=T.onProgress,k.send(null),O}onProgress(T,k){var R;const O=this.pendingRequests[T];O&&((R=O.onProgress)==null||R.call(O,k))}onStateChange(T,k){var L,N,j;const O=this.pendingRequests[T];if(!O)return;const R=O.xhr;if(R.readyState>=2&&O.onHeadersReceived&&(O.onHeadersReceived(),delete O.onHeadersReceived),R.readyState!==4||!(T in this.pendingRequests))return;if(delete this.pendingRequests[T],R.status===0&&this.isHttp){(L=O.onError)==null||L.call(O,R.status);return}const P=R.status||o;if(!(P===o&&O.expectedStatus===l)&&P!==O.expectedStatus){(N=O.onError)==null||N.call(O,R.status);return}const I=f(R);if(P===l){const z=R.getResponseHeader("Content-Range"),q=/bytes (\d+)-(\d+)\/(\d+)/.exec(z);O.onDone({begin:parseInt(q[1],10),chunk:I})}else I?O.onDone({begin:0,chunk:I}):(j=O.onError)==null||j.call(O,R.status)}getRequestXhr(T){return this.pendingRequests[T].xhr}isPendingRequest(T){return T in this.pendingRequests}abortRequest(T){const k=this.pendingRequests[T].xhr;delete this.pendingRequests[T],k.abort()}}class p{constructor(T){this._source=T,this._manager=new d(T.url,{httpHeaders:T.httpHeaders,withCredentials:T.withCredentials}),this._rangeChunkSize=T.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(T){const k=this._rangeRequestReaders.indexOf(T);k>=0&&this._rangeRequestReaders.splice(k,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader}getRangeReader(T,k){const O=new v(this._manager,T,k);return O.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(O),O}cancelAllRequests(T){var k;(k=this._fullRequestReader)==null||k.cancel(T);for(const O of this._rangeRequestReaders.slice(0))O.cancel(T)}}n.PDFNetworkStream=p;class g{constructor(T,k){this._manager=T;const O={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=k.url,this._fullRequestId=T.requestFull(O),this._headersReceivedCapability=(0,r.createPromiseCapability)(),this._disableRange=k.disableRange||!1,this._contentLength=k.length,this._rangeChunkSize=k.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const T=this._fullRequestId,k=this._manager.getRequestXhr(T),O=F=>k.getResponseHeader(F),{allowRangeRequests:R,suggestedLength:P}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:O,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});R&&(this._isRangeSupported=!0),this._contentLength=P||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(O),this._isRangeSupported&&this._manager.abortRequest(T),this._headersReceivedCapability.resolve()}_onDone(T){if(T&&(this._requests.length>0?this._requests.shift().resolve({value:T.chunk,done:!1}):this._cachedChunks.push(T.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(T){this._storedError=(0,s.createResponseStatusError)(T,this._url),this._headersReceivedCapability.reject(this._storedError);for(const k of this._requests)k.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(T){var k;(k=this.onProgress)==null||k.call(this,{loaded:T.loaded,total:T.lengthComputable?T.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=(0,r.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0,this._headersReceivedCapability.reject(T);for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class v{constructor(T,k,O){this._manager=T;const R={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=T.url,this._requestId=T.requestRange(k,O,R),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var T;(T=this.onClosed)==null||T.call(this,this)}_onDone(T){const k=T.chunk;this._requests.length>0?this._requests.shift().resolve({value:k,done:!1}):this._queuedChunk=k,this._done=!0;for(const O of this._requests)O.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(T){this._storedError=(0,s.createResponseStatusError)(T,this._url);for(const k of this._requests)k.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(T){var k;this.isStreamingSupported||(k=this.onProgress)==null||k.call(this,{loaded:T.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const k=this._queuedChunk;return this._queuedChunk=null,{value:k,done:!1}}if(this._done)return{value:void 0,done:!0};const T=(0,r.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var r=i(1),s=i(22);function o(v,S,T){return{method:"GET",headers:v,signal:T.signal,mode:"cors",credentials:S?"include":"same-origin",redirect:"follow"}}function l(v){const S=new Headers;for(const T in v){const k=v[T];k!==void 0&&S.append(T,k)}return S}function f(v){return v instanceof Uint8Array?v.buffer:v instanceof ArrayBuffer?v:((0,r.warn)(`getArrayBuffer - unexpected data format: ${v}`),new Uint8Array(v).buffer)}class d{constructor(S){this.source=S,this.isHttp=/^https?:/i.test(S.url),this.httpHeaders=this.isHttp&&S.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var S;return((S=this._fullRequestReader)==null?void 0:S._loaded)??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new p(this),this._fullRequestReader}getRangeReader(S,T){if(T<=this._progressiveDataLength)return null;const k=new g(this,S,T);return this._rangeRequestReaders.push(k),k}cancelAllRequests(S){var T;(T=this._fullRequestReader)==null||T.cancel(S);for(const k of this._rangeRequestReaders.slice(0))k.cancel(S)}}n.PDFFetchStream=d;class p{constructor(S){this._stream=S,this._reader=null,this._loaded=0,this._filename=null;const T=S.source;this._withCredentials=T.withCredentials||!1,this._contentLength=T.length,this._headersCapability=(0,r.createPromiseCapability)(),this._disableRange=T.disableRange||!1,this._rangeChunkSize=T.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._headers=l(this._stream.httpHeaders);const k=T.url;fetch(k,o(this._headers,this._withCredentials,this._abortController)).then(O=>{if(!(0,s.validateResponseStatus)(O.status))throw(0,s.createResponseStatusError)(O.status,k);this._reader=O.body.getReader(),this._headersCapability.resolve();const R=I=>O.headers.get(I),{allowRangeRequests:P,suggestedLength:F}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:R,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=F||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(R),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var k;await this._headersCapability.promise;const{value:S,done:T}=await this._reader.read();return T?{value:S,done:T}:(this._loaded+=S.byteLength,(k=this.onProgress)==null||k.call(this,{loaded:this._loaded,total:this._contentLength}),{value:f(S),done:!1})}cancel(S){var T;(T=this._reader)==null||T.cancel(S),this._abortController.abort()}}class g{constructor(S,T,k){this._stream=S,this._reader=null,this._loaded=0;const O=S.source;this._withCredentials=O.withCredentials||!1,this._readCapability=(0,r.createPromiseCapability)(),this._isStreamingSupported=!O.disableStream,this._abortController=new AbortController,this._headers=l(this._stream.httpHeaders),this._headers.append("Range",`bytes=${T}-${k-1}`);const R=O.url;fetch(R,o(this._headers,this._withCredentials,this._abortController)).then(P=>{if(!(0,s.validateResponseStatus)(P.status))throw(0,s.createResponseStatusError)(P.status,R);this._readCapability.resolve(),this._reader=P.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var k;await this._readCapability.promise;const{value:S,done:T}=await this._reader.read();return T?{value:S,done:T}:(this._loaded+=S.byteLength,(k=this.onProgress)==null||k.call(this,{loaded:this._loaded}),{value:f(S),done:!1})}cancel(S){var T;(T=this._reader)==null||T.cancel(S),this._abortController.abort()}}},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=O,n.updateTextLayer=R;var r=i(1),s=i(6);const o=1e5,l=30,f=.8,d=new Map;function p(P,F){let I;if(F&&r.FeatureTest.isOffscreenCanvasSupported)I=new OffscreenCanvas(P,P).getContext("2d",{alpha:!1});else{const L=document.createElement("canvas");L.width=L.height=P,I=L.getContext("2d",{alpha:!1})}return I}function g(P,F){const I=d.get(P);if(I)return I;const L=p(l,F);L.font=`${l}px ${P}`;const N=L.measureText("");let j=N.fontBoundingBoxAscent,z=Math.abs(N.fontBoundingBoxDescent);if(j){const H=j/(j+z);return d.set(P,H),L.canvas.width=L.canvas.height=0,H}L.strokeStyle="red",L.clearRect(0,0,l,l),L.strokeText("g",0,0);let q=L.getImageData(0,0,l,l).data;z=0;for(let H=q.length-1-3;H>=0;H-=4)if(q[H]>0){z=Math.ceil(H/4/l);break}L.clearRect(0,0,l,l),L.strokeText("A",0,l),q=L.getImageData(0,0,l,l).data,j=0;for(let H=0,W=q.length;H<W;H+=4)if(q[H]>0){j=l-Math.floor(H/4/l);break}if(L.canvas.width=L.canvas.height=0,j){const H=j/(j+z);return d.set(P,H),H}return d.set(P,f),f}function v(P,F,I){const L=document.createElement("span"),N={angle:0,canvasWidth:0,hasText:F.str!=="",hasEOL:F.hasEOL,fontSize:0};P._textDivs.push(L);const j=r.Util.transform(P._transform,F.transform);let z=Math.atan2(j[1],j[0]);const q=I[F.fontName];q.vertical&&(z+=Math.PI/2);const H=Math.hypot(j[2],j[3]),W=H*g(q.fontFamily,P._isOffscreenCanvasSupported);let U,Q;z===0?(U=j[4],Q=j[5]-W):(U=j[4]+W*Math.sin(z),Q=j[5]-W*Math.cos(z));const J="calc(var(--scale-factor)*",ne=L.style;P._container===P._rootContainer?(ne.left=`${(100*U/P._pageWidth).toFixed(2)}%`,ne.top=`${(100*Q/P._pageHeight).toFixed(2)}%`):(ne.left=`${J}${U.toFixed(2)}px)`,ne.top=`${J}${Q.toFixed(2)}px)`),ne.fontSize=`${J}${H.toFixed(2)}px)`,ne.fontFamily=q.fontFamily,N.fontSize=H,L.setAttribute("role","presentation"),L.textContent=F.str,L.dir=F.dir,P._fontInspectorEnabled&&(L.dataset.fontName=F.fontName),z!==0&&(N.angle=z*(180/Math.PI));let G=!1;if(F.str.length>1)G=!0;else if(F.str!==" "&&F.transform[0]!==F.transform[3]){const Z=Math.abs(F.transform[0]),ae=Math.abs(F.transform[3]);Z!==ae&&Math.max(Z,ae)/Math.min(Z,ae)>1.5&&(G=!0)}G&&(N.canvasWidth=q.vertical?F.height:F.width),P._textDivProperties.set(L,N),P._isReadableStream&&P._layoutText(L)}function S(P){const{div:F,scale:I,properties:L,ctx:N,prevFontSize:j,prevFontFamily:z}=P,{style:q}=F;let H="";if(L.canvasWidth!==0&&L.hasText){const{fontFamily:W}=q,{canvasWidth:U,fontSize:Q}=L;(j!==Q||z!==W)&&(N.font=`${Q*I}px ${W}`,P.prevFontSize=Q,P.prevFontFamily=W);const{width:J}=N.measureText(F.textContent);J>0&&(H=`scaleX(${U*I/J})`)}L.angle!==0&&(H=`rotate(${L.angle}deg) ${H}`),H.length>0&&(q.transform=H)}function T(P){if(P._canceled)return;const F=P._textDivs,I=P._capability;if(F.length>o){I.resolve();return}if(!P._isReadableStream)for(const N of F)P._layoutText(N);I.resolve()}class k{constructor({textContentSource:F,container:I,viewport:L,textDivs:N,textDivProperties:j,textContentItemsStr:z,isOffscreenCanvasSupported:q}){var J;this._textContentSource=F,this._isReadableStream=F instanceof ReadableStream,this._container=this._rootContainer=I,this._textDivs=N||[],this._textContentItemsStr=z||[],this._isOffscreenCanvasSupported=q,this._fontInspectorEnabled=!!((J=globalThis.FontInspector)!=null&&J.enabled),this._reader=null,this._textDivProperties=j||new WeakMap,this._canceled=!1,this._capability=(0,r.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:L.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:p(0,q)};const{pageWidth:H,pageHeight:W,pageX:U,pageY:Q}=L.rawDims;this._transform=[1,0,0,-1,-U,Q+W],this._pageWidth=H,this._pageHeight=W,(0,s.setLayerDimensions)(I,L),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(F,I){for(const L of F){if(L.str===void 0){if(L.type==="beginMarkedContentProps"||L.type==="beginMarkedContent"){const N=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),L.id!==null&&this._container.setAttribute("id",`${L.id}`),N.append(this._container)}else L.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(L.str),v(this,L,I)}}_layoutText(F){const I=this._layoutTextParams.properties=this._textDivProperties.get(F);if(this._layoutTextParams.div=F,S(this._layoutTextParams),I.hasText&&this._container.append(F),I.hasEOL){const L=document.createElement("br");L.setAttribute("role","presentation"),this._container.append(L)}}_render(){const F=(0,r.createPromiseCapability)();let I=Object.create(null);if(this._isReadableStream){const L=()=>{this._reader.read().then(({value:N,done:j})=>{if(j){F.resolve();return}Object.assign(I,N.styles),this._processItems(N.items,I),L()},F.reject)};this._reader=this._textContentSource.getReader(),L()}else if(this._textContentSource){const{items:L,styles:N}=this._textContentSource;this._processItems(L,N),F.resolve()}else throw new Error('No "textContentSource" parameter specified.');F.promise.then(()=>{I=null,T(this)},this._capability.reject)}}n.TextLayerRenderTask=k;function O(P){!P.textContentSource&&(P.textContent||P.textContentStream)&&((0,s.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),P.textContentSource=P.textContent||P.textContentStream);const F=new k(P);return F._render(),F}function R({container:P,viewport:F,textDivs:I,textDivProperties:L,isOffscreenCanvasSupported:N,mustRotate:j=!0,mustRescale:z=!0}){if(j&&(0,s.setLayerDimensions)(P,{rotation:F.rotation}),z){const q=p(0,N),W={prevFontSize:null,prevFontFamily:null,div:null,scale:F.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:q};for(const U of I)W.properties=L.get(U),W.div=U,S(W)}}},(e,n,i)=>{var p,g,v,S,T,k,O,R,P,li,I,Ji,N,ui,z,ci;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var r=i(1),s=i(5),o=i(28),l=i(29),f=i(6);const H=class{constructor(U){De(this,P);De(this,I);De(this,N);De(this,z);De(this,p,void 0);De(this,g,!1);De(this,v,this.pointerup.bind(this));De(this,S,this.pointerdown.bind(this));De(this,T,new Map);De(this,k,!1);De(this,O,!1);De(this,R,void 0);H._initialized||(H._initialized=!0,o.FreeTextEditor.initialize(U.l10n),l.InkEditor.initialize(U.l10n)),U.uiManager.registerEditorTypes([o.FreeTextEditor,l.InkEditor]),Ue(this,R,U.uiManager),this.pageIndex=U.pageIndex,this.div=U.div,Ue(this,p,U.accessibilityManager),le(this,R).addLayer(this)}get isEmpty(){return le(this,T).size===0}updateToolbar(U){le(this,R).updateToolbar(U)}updateMode(U=le(this,R).getMode()){Pe(this,z,ci).call(this),U===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),le(this,R).unselectAll(),U!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",U===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",U===r.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(U){if(!U&&le(this,R).getMode()!==r.AnnotationEditorType.INK)return;if(!U){for(const J of le(this,T).values())if(J.isEmpty()){J.setInBackground();return}}Pe(this,N,ui).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(U){le(this,R).setEditingState(U)}addCommands(U){le(this,R).addCommands(U)}enable(){this.div.style.pointerEvents="auto";for(const U of le(this,T).values())U.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const U of le(this,T).values())U.disableEditing();Pe(this,z,ci).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(U){le(this,R).getActive()!==U&&le(this,R).setActiveEditor(U)}enableClick(){this.div.addEventListener("pointerdown",le(this,S)),this.div.addEventListener("pointerup",le(this,v))}disableClick(){this.div.removeEventListener("pointerdown",le(this,S)),this.div.removeEventListener("pointerup",le(this,v))}attach(U){le(this,T).set(U.id,U)}detach(U){var Q;le(this,T).delete(U.id),(Q=le(this,p))==null||Q.removePointerInTextLayer(U.contentDiv)}remove(U){le(this,R).removeEditor(U),this.detach(U),U.div.style.display="none",setTimeout(()=>{U.div.style.display="",U.div.remove(),U.isAttachedToDOM=!1,document.activeElement===document.body&&le(this,R).focusMainContainer()},0),le(this,O)||this.addInkEditorIfNeeded(!1)}add(U){if(Pe(this,P,li).call(this,U),le(this,R).addEditor(U),this.attach(U),!U.isAttachedToDOM){const Q=U.render();this.div.append(Q),U.isAttachedToDOM=!0}this.moveEditorInDOM(U),U.onceAdded(),le(this,R).addToAnnotationStorage(U)}moveEditorInDOM(U){var Q;(Q=le(this,p))==null||Q.moveElementInDOM(this.div,U.div,U.contentDiv,!0)}addOrRebuild(U){U.needsToBeRebuilt()?U.rebuild():this.add(U)}addANewEditor(U){const Q=()=>{this.addOrRebuild(U)},J=()=>{U.remove()};this.addCommands({cmd:Q,undo:J,mustExec:!0})}addUndoableEditor(U){const Q=()=>{this.addOrRebuild(U)},J=()=>{U.remove()};this.addCommands({cmd:Q,undo:J,mustExec:!1})}getNextId(){return le(this,R).getId()}deserialize(U){switch(U.annotationType){case r.AnnotationEditorType.FREETEXT:return o.FreeTextEditor.deserialize(U,this,le(this,R));case r.AnnotationEditorType.INK:return l.InkEditor.deserialize(U,this,le(this,R))}return null}setSelected(U){le(this,R).setSelected(U)}toggleSelected(U){le(this,R).toggleSelected(U)}isSelected(U){return le(this,R).isSelected(U)}unselect(U){le(this,R).unselect(U)}pointerup(U){const{isMac:Q}=r.FeatureTest.platform;if(!(U.button!==0||U.ctrlKey&&Q)&&U.target===this.div&&le(this,k)){if(Ue(this,k,!1),!le(this,g)){Ue(this,g,!0);return}Pe(this,N,ui).call(this,U)}}pointerdown(U){const{isMac:Q}=r.FeatureTest.platform;if(U.button!==0||U.ctrlKey&&Q||U.target!==this.div)return;Ue(this,k,!0);const J=le(this,R).getActive();Ue(this,g,!J||J.isEmpty())}drop(U){const Q=U.dataTransfer.getData("text/plain"),J=le(this,R).getEditor(Q);if(!J)return;U.preventDefault(),U.dataTransfer.dropEffect="move",Pe(this,P,li).call(this,J);const ne=this.div.getBoundingClientRect(),G=U.clientX-ne.x,Z=U.clientY-ne.y;J.translate(G-J.startX,Z-J.startY),this.moveEditorInDOM(J),J.div.focus()}dragover(U){U.preventDefault()}destroy(){var U,Q;((U=le(this,R).getActive())==null?void 0:U.parent)===this&&le(this,R).setActiveEditor(null);for(const J of le(this,T).values())(Q=le(this,p))==null||Q.removePointerInTextLayer(J.contentDiv),J.setParent(null),J.isAttachedToDOM=!1,J.div.remove();this.div=null,le(this,T).clear(),le(this,R).removeLayer(this)}render({viewport:U}){this.viewport=U,(0,f.setLayerDimensions)(this.div,U),(0,s.bindEvents)(this,this.div,["dragover","drop"]);for(const Q of le(this,R).getEditors(this.pageIndex))this.add(Q);this.updateMode()}update({viewport:U}){le(this,R).commitOrRemove(),this.viewport=U,(0,f.setLayerDimensions)(this.div,{rotation:U.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:U,pageHeight:Q}=this.viewport.rawDims;return[U,Q]}};let d=H;p=new WeakMap,g=new WeakMap,v=new WeakMap,S=new WeakMap,T=new WeakMap,k=new WeakMap,O=new WeakMap,R=new WeakMap,P=new WeakSet,li=function(U){var Q;U.parent!==this&&(this.attach(U),(Q=U.parent)==null||Q.detach(U),U.setParent(this),U.div&&U.isAttachedToDOM&&(U.div.remove(),this.div.append(U.div)))},I=new WeakSet,Ji=function(U){switch(le(this,R).getMode()){case r.AnnotationEditorType.FREETEXT:return new o.FreeTextEditor(U);case r.AnnotationEditorType.INK:return new l.InkEditor(U)}return null},N=new WeakSet,ui=function(U){const Q=this.getNextId(),J=Pe(this,I,Ji).call(this,{parent:this,id:Q,x:U.offsetX,y:U.offsetY,uiManager:le(this,R)});return J&&this.add(J),J},z=new WeakSet,ci=function(){Ue(this,O,!0);for(const U of le(this,T).values())U.isEmpty()&&U.remove();Ue(this,O,!1)},at(d,"_initialized",!1),n.AnnotationEditorLayer=d},(e,n,i)=>{var f,d,p,g,v,S,T,k,O,R,Zi,F,er,L,nr,j,fi;Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var r=i(1),s=i(5),o=i(4);const q=class extends o.AnnotationEditor{constructor(U){super({...U,name:"freeTextEditor"});De(this,R);De(this,F);De(this,L);De(this,j);De(this,f,this.editorDivBlur.bind(this));De(this,d,this.editorDivFocus.bind(this));De(this,p,this.editorDivInput.bind(this));De(this,g,this.editorDivKeydown.bind(this));De(this,v,void 0);De(this,S,"");De(this,T,`${this.id}-editor`);De(this,k,!1);De(this,O,void 0);Ue(this,v,U.color||q._defaultColor||o.AnnotationEditor._defaultLineColor),Ue(this,O,U.fontSize||q._defaultFontSize)}static initialize(U){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(J=>[J,U.get(J)]));const Q=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Q.getPropertyValue("--freetext-padding"))}static updateDefaultParams(U,Q){switch(U){case r.AnnotationEditorParamsType.FREETEXT_SIZE:q._defaultFontSize=Q;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:q._defaultColor=Q;break}}updateParams(U,Q){switch(U){case r.AnnotationEditorParamsType.FREETEXT_SIZE:Pe(this,R,Zi).call(this,Q);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:Pe(this,F,er).call(this,Q);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,q._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,q._defaultColor||o.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,le(this,O)],[r.AnnotationEditorParamsType.FREETEXT_COLOR,le(this,v)]]}getInitialTranslation(){const U=this.parentScale;return[-q._internalPadding*U,-(q._internalPadding+le(this,O))*U]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",le(this,g)),this.editorDiv.addEventListener("focus",le(this,d)),this.editorDiv.addEventListener("blur",le(this,f)),this.editorDiv.addEventListener("input",le(this,p)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",le(this,T)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",le(this,g)),this.editorDiv.removeEventListener("focus",le(this,d)),this.editorDiv.removeEventListener("blur",le(this,f)),this.editorDiv.removeEventListener("input",le(this,p)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(U){super.focusin(U),U.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),le(this,k)||(Ue(this,k,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),Ue(this,S,Pe(this,L,nr).call(this).trimEnd()),Pe(this,j,fi).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(U){this.enableEditMode(),this.editorDiv.focus()}keydown(U){U.target===this.div&&U.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(U){q._keyboardManager.exec(this,U)}editorDivFocus(U){this.isEditing=!0}editorDivBlur(U){this.isEditing=!1}editorDivInput(U){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let U,Q;this.width&&(U=this.x,Q=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",le(this,T)),this.enableEditing(),q._l10nPromise.get("editor_free_text2_aria_label").then(ne=>{var G;return(G=this.editorDiv)==null?void 0:G.setAttribute("aria-label",ne)}),q._l10nPromise.get("free_text2_default_content").then(ne=>{var G;return(G=this.editorDiv)==null?void 0:G.setAttribute("default-content",ne)}),this.editorDiv.contentEditable=!0;const{style:J}=this.editorDiv;if(J.fontSize=`calc(${le(this,O)}px * var(--scale-factor))`,J.color=le(this,v),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,s.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ne,G]=this.parentDimensions;this.setAt(U*ne,Q*G,this.width*ne,this.height*G);for(const Z of le(this,S).split(`
`)){const ae=document.createElement("div");ae.append(Z?document.createTextNode(Z):document.createElement("br")),this.editorDiv.append(ae)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(U,Q,J){const ne=super.deserialize(U,Q,J);return Ue(ne,O,U.fontSize),Ue(ne,v,r.Util.makeHexColor(...U.color)),Ue(ne,S,U.value),ne}serialize(){if(this.isEmpty())return null;const U=q._internalPadding*this.parentScale,Q=this.getRect(U,U),J=o.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:le(this,v));return{annotationType:r.AnnotationEditorType.FREETEXT,color:J,fontSize:le(this,O),value:le(this,S),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation}}};let l=q;f=new WeakMap,d=new WeakMap,p=new WeakMap,g=new WeakMap,v=new WeakMap,S=new WeakMap,T=new WeakMap,k=new WeakMap,O=new WeakMap,R=new WeakSet,Zi=function(U){const Q=ne=>{this.editorDiv.style.fontSize=`calc(${ne}px * var(--scale-factor))`,this.translate(0,-(ne-le(this,O))*this.parentScale),Ue(this,O,ne),Pe(this,j,fi).call(this)},J=le(this,O);this.addCommands({cmd:()=>{Q(U)},undo:()=>{Q(J)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},F=new WeakSet,er=function(U){const Q=le(this,v);this.addCommands({cmd:()=>{Ue(this,v,this.editorDiv.style.color=U)},undo:()=>{Ue(this,v,this.editorDiv.style.color=Q)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},L=new WeakSet,nr=function(){const U=this.editorDiv.getElementsByTagName("div");if(U.length===0)return this.editorDiv.innerText;const Q=[];for(const J of U)Q.push(J.innerText.replace(/\r\n?|\n/,""));return Q.join(`
`)},j=new WeakSet,fi=function(){const[U,Q]=this.parentDimensions;let J;if(this.isAttachedToDOM)J=this.div.getBoundingClientRect();else{const{currentLayer:ne,div:G}=this,Z=G.style.display;G.style.display="hidden",ne.div.append(this.div),J=G.getBoundingClientRect(),G.remove(),G.style.display=Z}this.width=J.width/U,this.height=J.height/Q},at(l,"_freeTextDefaultContent",""),at(l,"_l10nPromise"),at(l,"_internalPadding",0),at(l,"_defaultColor",null),at(l,"_defaultFontSize",10),at(l,"_keyboardManager",new s.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],q.prototype.commitOrRemove]])),at(l,"_type","freetext"),n.FreeTextEditor=l},(e,n,i)=>{var g,v,S,T,k,O,R,P,F,I,L,N,j,z,q,rr,W,ar,Q,sr,ne,lr,Z,di,oe,ur,Se,fr,ee,dr,se,xt,he,hi,xe,Nn,we,In,ve,rn,te,gi,ce,Mn,de,mi,Oe,hr,Ie,pr,je,gr,Be,bi,Ve,Ln,Ge,an,_e,_i;Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0,Object.defineProperty(n,"fitCurve",{enumerable:!0,get:function(){return o.fitCurve}});var r=i(1),s=i(4),o=i(30),l=i(5);const f=16,d=100,Ne=class extends s.AnnotationEditor{constructor(Ce){super({...Ce,name:"inkEditor"});De(this,q);De(this,W);De(this,Q);De(this,ne);De(this,Z);De(this,oe);De(this,Se);De(this,ee);De(this,se);De(this,he);De(this,xe);De(this,we);De(this,ve);De(this,te);De(this,ce);De(this,Oe);De(this,Ie);De(this,je);De(this,Be);De(this,Ve);De(this,Ge);De(this,_e);De(this,g,0);De(this,v,0);De(this,S,0);De(this,T,this.canvasPointermove.bind(this));De(this,k,this.canvasPointerleave.bind(this));De(this,O,this.canvasPointerup.bind(this));De(this,R,this.canvasPointerdown.bind(this));De(this,P,!1);De(this,F,!1);De(this,I,null);De(this,L,null);De(this,N,0);De(this,j,0);De(this,z,null);this.color=Ce.color||null,this.thickness=Ce.thickness||null,this.opacity=Ce.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(Ce){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(Fe=>[Fe,Ce.get(Fe)]))}static updateDefaultParams(Ce,Fe){switch(Ce){case r.AnnotationEditorParamsType.INK_THICKNESS:Ne._defaultThickness=Fe;break;case r.AnnotationEditorParamsType.INK_COLOR:Ne._defaultColor=Fe;break;case r.AnnotationEditorParamsType.INK_OPACITY:Ne._defaultOpacity=Fe/100;break}}updateParams(Ce,Fe){switch(Ce){case r.AnnotationEditorParamsType.INK_THICKNESS:Pe(this,q,rr).call(this,Fe);break;case r.AnnotationEditorParamsType.INK_COLOR:Pe(this,W,ar).call(this,Fe);break;case r.AnnotationEditorParamsType.INK_OPACITY:Pe(this,Q,sr).call(this,Fe);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,Ne._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,Ne._defaultColor||s.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ne._defaultOpacity*100)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ne._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||Ne._defaultColor||s.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ne._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(Pe(this,xe,Nn).call(this),Pe(this,we,In).call(this)),this.isAttachedToDOM||(this.parent.add(this),Pe(this,ve,rn).call(this)),Pe(this,Ge,an).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,le(this,L).disconnect(),Ue(this,L,null),super.remove())}setParent(Ce){!this.parent&&Ce?this._uiManager.removeShouldRescale(this):this.parent&&Ce===null&&this._uiManager.addShouldRescale(this),super.setParent(Ce)}onScaleChanging(){const[Ce,Fe]=this.parentDimensions,qe=this.width*Ce,He=this.height*Fe;this.setDimensions(qe,He)}enableEditMode(){le(this,P)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",le(this,R)),this.canvas.addEventListener("pointerup",le(this,O)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",le(this,R)),this.canvas.removeEventListener("pointerup",le(this,O)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){le(this,P)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Ue(this,P,!0),this.div.classList.add("disabled"),Pe(this,Ge,an).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(Ce){super.focusin(Ce),this.enableEditMode()}canvasPointerdown(Ce){Ce.button!==0||!this.isInEditMode()||le(this,P)||(this.setInForeground(),Ce.type!=="mouse"&&this.div.focus(),Ce.stopPropagation(),this.canvas.addEventListener("pointerleave",le(this,k)),this.canvas.addEventListener("pointermove",le(this,T)),Pe(this,oe,ur).call(this,Ce.offsetX,Ce.offsetY))}canvasPointermove(Ce){Ce.stopPropagation(),Pe(this,Se,fr).call(this,Ce.offsetX,Ce.offsetY)}canvasPointerup(Ce){Ce.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(Ce.stopPropagation(),Pe(this,he,hi).call(this,Ce),this.setInBackground())}canvasPointerleave(Ce){Pe(this,he,hi).call(this,Ce),this.setInBackground()}render(){if(this.div)return this.div;let Ce,Fe;this.width&&(Ce=this.x,Fe=this.y),super.render(),Ne._l10nPromise.get("editor_ink2_aria_label").then(Je=>{var Ye;return(Ye=this.div)==null?void 0:Ye.setAttribute("aria-label",Je)});const[qe,He,Xe,tt]=Pe(this,ne,lr).call(this);if(this.setAt(qe,He,0,0),this.setDims(Xe,tt),Pe(this,xe,Nn).call(this),this.width){const[Je,Ye]=this.parentDimensions;this.setAt(Ce*Je,Fe*Ye,this.width*Je,this.height*Ye),Ue(this,F,!0),Pe(this,ve,rn).call(this),this.setDims(this.width*Je,this.height*Ye),Pe(this,se,xt).call(this),Pe(this,_e,_i).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Pe(this,we,In).call(this),this.div}setDimensions(Ce,Fe){const qe=Math.round(Ce),He=Math.round(Fe);if(le(this,N)===qe&&le(this,j)===He)return;Ue(this,N,qe),Ue(this,j,He),this.canvas.style.visibility="hidden",le(this,g)&&Math.abs(le(this,g)-Ce/Fe)>.01&&(Fe=Math.ceil(Ce/le(this,g)),this.setDims(Ce,Fe));const[Xe,tt]=this.parentDimensions;this.width=Ce/Xe,this.height=Fe/tt,le(this,P)&&Pe(this,te,gi).call(this,Ce,Fe),Pe(this,ve,rn).call(this),Pe(this,se,xt).call(this),this.canvas.style.visibility="visible"}static deserialize(Ce,Fe,qe){var ot,rt;const He=super.deserialize(Ce,Fe,qe);He.thickness=Ce.thickness,He.color=r.Util.makeHexColor(...Ce.color),He.opacity=Ce.opacity;const[Xe,tt]=He.pageDimensions,Je=He.width*Xe,Ye=He.height*tt,Ke=He.parentScale,et=Ce.thickness/2;Ue(He,g,Je/Ye),Ue(He,P,!0),Ue(He,N,Math.round(Je)),Ue(He,j,Math.round(Ye));for(const{bezier:ut}of Ce.paths){const it=[];He.paths.push(it);let dt=Ke*(ut[0]-et),ft=Ke*(Ye-ut[1]-et);for(let ht=2,Et=ut.length;ht<Et;ht+=6){const pt=Ke*(ut[ht]-et),yt=Ke*(Ye-ut[ht+1]-et),mt=Ke*(ut[ht+2]-et),$t=Ke*(Ye-ut[ht+3]-et),St=Ke*(ut[ht+4]-et),vt=Ke*(Ye-ut[ht+5]-et);it.push([[dt,ft],[pt,yt],[mt,$t],[St,vt]]),dt=St,ft=vt}const _t=Pe(this,de,mi).call(this,it);He.bezierPath2D.push(_t)}const ct=Pe(ot=He,Be,bi).call(ot);return Ue(He,S,Math.max(f,ct[2]-ct[0])),Ue(He,v,Math.max(f,ct[3]-ct[1])),Pe(rt=He,te,gi).call(rt,Je,Ye),He}serialize(){if(this.isEmpty())return null;const Ce=this.getRect(0,0),Fe=this.rotation%180===0?Ce[3]-Ce[1]:Ce[2]-Ce[0],qe=s.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:qe,thickness:this.thickness,opacity:this.opacity,paths:Pe(this,Oe,hr).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Fe),pageIndex:this.pageIndex,rect:Ce,rotation:this.rotation}}};let p=Ne;g=new WeakMap,v=new WeakMap,S=new WeakMap,T=new WeakMap,k=new WeakMap,O=new WeakMap,R=new WeakMap,P=new WeakMap,F=new WeakMap,I=new WeakMap,L=new WeakMap,N=new WeakMap,j=new WeakMap,z=new WeakMap,q=new WeakSet,rr=function(Ce){const Fe=this.thickness;this.addCommands({cmd:()=>{this.thickness=Ce,Pe(this,Ge,an).call(this)},undo:()=>{this.thickness=Fe,Pe(this,Ge,an).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},W=new WeakSet,ar=function(Ce){const Fe=this.color;this.addCommands({cmd:()=>{this.color=Ce,Pe(this,se,xt).call(this)},undo:()=>{this.color=Fe,Pe(this,se,xt).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Q=new WeakSet,sr=function(Ce){Ce/=100;const Fe=this.opacity;this.addCommands({cmd:()=>{this.opacity=Ce,Pe(this,se,xt).call(this)},undo:()=>{this.opacity=Fe,Pe(this,se,xt).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ne=new WeakSet,lr=function(){const{parentRotation:Ce,parentDimensions:[Fe,qe]}=this;switch(Ce){case 90:return[0,qe,qe,Fe];case 180:return[Fe,qe,Fe,qe];case 270:return[Fe,0,qe,Fe];default:return[0,0,Fe,qe]}},Z=new WeakSet,di=function(){const{ctx:Ce,color:Fe,opacity:qe,thickness:He,parentScale:Xe,scaleFactor:tt}=this;Ce.lineWidth=He*Xe/tt,Ce.lineCap="round",Ce.lineJoin="round",Ce.miterLimit=10,Ce.strokeStyle=`${Fe}${(0,l.opacityToHex)(qe)}`},oe=new WeakSet,ur=function(Ce,Fe){this.isEditing=!0,le(this,F)||(Ue(this,F,!0),Pe(this,ve,rn).call(this),this.thickness||(this.thickness=Ne._defaultThickness),this.color||(this.color=Ne._defaultColor||s.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ne._defaultOpacity)),this.currentPath.push([Ce,Fe]),Ue(this,I,null),Pe(this,Z,di).call(this),this.ctx.beginPath(),this.ctx.moveTo(Ce,Fe),Ue(this,z,()=>{le(this,z)&&(le(this,I)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):Pe(this,se,xt).call(this),this.ctx.lineTo(...le(this,I)),Ue(this,I,null),this.ctx.stroke()),window.requestAnimationFrame(le(this,z)))}),window.requestAnimationFrame(le(this,z))},Se=new WeakSet,fr=function(Ce,Fe){const[qe,He]=this.currentPath.at(-1);Ce===qe&&Fe===He||(this.currentPath.push([Ce,Fe]),Ue(this,I,[Ce,Fe]))},ee=new WeakSet,dr=function(Ce,Fe){var Ke;this.ctx.closePath(),Ue(this,z,null),Ce=Math.min(Math.max(Ce,0),this.canvas.width),Fe=Math.min(Math.max(Fe,0),this.canvas.height);const[qe,He]=this.currentPath.at(-1);(Ce!==qe||Fe!==He)&&this.currentPath.push([Ce,Fe]);let Xe;if(this.currentPath.length!==1)Xe=(0,o.fitCurve)(this.currentPath,30,null);else{const et=[Ce,Fe];Xe=[[et,et.slice(),et.slice(),et]]}const tt=Pe(Ke=Ne,de,mi).call(Ke,Xe);this.currentPath.length=0;const Je=()=>{this.paths.push(Xe),this.bezierPath2D.push(tt),this.rebuild()},Ye=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Pe(this,xe,Nn).call(this),Pe(this,we,In).call(this)),Pe(this,Ge,an).call(this))};this.addCommands({cmd:Je,undo:Ye,mustExec:!0})},se=new WeakSet,xt=function(){if(this.isEmpty()){Pe(this,ce,Mn).call(this);return}Pe(this,Z,di).call(this);const{canvas:Ce,ctx:Fe}=this;Fe.setTransform(1,0,0,1,0,0),Fe.clearRect(0,0,Ce.width,Ce.height),Pe(this,ce,Mn).call(this);for(const qe of this.bezierPath2D)Fe.stroke(qe)},he=new WeakSet,hi=function(Ce){Pe(this,ee,dr).call(this,Ce.offsetX,Ce.offsetY),this.canvas.removeEventListener("pointerleave",le(this,k)),this.canvas.removeEventListener("pointermove",le(this,T)),this.addToAnnotationStorage()},xe=new WeakSet,Nn=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Ne._l10nPromise.get("editor_ink_canvas_aria_label").then(Ce=>{var Fe;return(Fe=this.canvas)==null?void 0:Fe.setAttribute("aria-label",Ce)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},we=new WeakSet,In=function(){let Ce=null;Ue(this,L,new ResizeObserver(Fe=>{const qe=Fe[0].contentRect;qe.width&&qe.height&&(Ce!==null&&clearTimeout(Ce),Ce=setTimeout(()=>{this.fixDims(),Ce=null},d),this.setDimensions(qe.width,qe.height))})),le(this,L).observe(this.div)},ve=new WeakSet,rn=function(){if(!le(this,F))return;const[Ce,Fe]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Ce),this.canvas.height=Math.ceil(this.height*Fe),Pe(this,ce,Mn).call(this)},te=new WeakSet,gi=function(Ce,Fe){const qe=Pe(this,Ve,Ln).call(this),He=(Ce-qe)/le(this,S),Xe=(Fe-qe)/le(this,v);this.scaleFactor=Math.min(He,Xe)},ce=new WeakSet,Mn=function(){const Ce=Pe(this,Ve,Ln).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Ce,this.translationY*this.scaleFactor+Ce)},de=new WeakSet,mi=function(Ce){const Fe=new Path2D;for(let qe=0,He=Ce.length;qe<He;qe++){const[Xe,tt,Je,Ye]=Ce[qe];qe===0&&Fe.moveTo(...Xe),Fe.bezierCurveTo(tt[0],tt[1],Je[0],Je[1],Ye[0],Ye[1])}return Fe},Oe=new WeakSet,hr=function(Ce,Fe,qe,He){const tt=[],Je=this.thickness/2;let Ye,Ke;for(const et of this.paths){Ye=[],Ke=[];for(let ct=0,ot=et.length;ct<ot;ct++){const[rt,ut,it,dt]=et[ct],ft=Ce*(rt[0]+Fe)+Je,_t=He-Ce*(rt[1]+qe)-Je,ht=Ce*(ut[0]+Fe)+Je,Et=He-Ce*(ut[1]+qe)-Je,pt=Ce*(it[0]+Fe)+Je,yt=He-Ce*(it[1]+qe)-Je,mt=Ce*(dt[0]+Fe)+Je,$t=He-Ce*(dt[1]+qe)-Je;ct===0&&(Ye.push(ft,_t),Ke.push(ft,_t)),Ye.push(ht,Et,pt,yt,mt,$t),Pe(this,Ie,pr).call(this,ft,_t,ht,Et,pt,yt,mt,$t,4,Ke)}tt.push({bezier:Ye,points:Ke})}return tt},Ie=new WeakSet,pr=function(Ce,Fe,qe,He,Xe,tt,Je,Ye,Ke,et){if(Pe(this,je,gr).call(this,Ce,Fe,qe,He,Xe,tt,Je,Ye)){et.push(Je,Ye);return}for(let ct=1;ct<Ke-1;ct++){const ot=ct/Ke,rt=1-ot;let ut=ot*Ce+rt*qe,it=ot*Fe+rt*He,dt=ot*qe+rt*Xe,ft=ot*He+rt*tt;const _t=ot*Xe+rt*Je,ht=ot*tt+rt*Ye;ut=ot*ut+rt*dt,it=ot*it+rt*ft,dt=ot*dt+rt*_t,ft=ot*ft+rt*ht,ut=ot*ut+rt*dt,it=ot*it+rt*ft,et.push(ut,it)}et.push(Je,Ye)},je=new WeakSet,gr=function(Ce,Fe,qe,He,Xe,tt,Je,Ye){const et=(3*qe-2*Ce-Je)**2,ct=(3*He-2*Fe-Ye)**2,ot=(3*Xe-Ce-2*Je)**2,rt=(3*tt-Fe-2*Ye)**2;return Math.max(et,ot)+Math.max(ct,rt)<=10},Be=new WeakSet,bi=function(){let Ce=1/0,Fe=-1/0,qe=1/0,He=-1/0;for(const Xe of this.paths)for(const[tt,Je,Ye,Ke]of Xe){const et=r.Util.bezierBoundingBox(...tt,...Je,...Ye,...Ke);Ce=Math.min(Ce,et[0]),qe=Math.min(qe,et[1]),Fe=Math.max(Fe,et[2]),He=Math.max(He,et[3])}return[Ce,qe,Fe,He]},Ve=new WeakSet,Ln=function(){return le(this,P)?Math.ceil(this.thickness*this.parentScale):0},Ge=new WeakSet,an=function(Ce=!1){if(this.isEmpty())return;if(!le(this,P)){Pe(this,se,xt).call(this);return}const Fe=Pe(this,Be,bi).call(this),qe=Pe(this,Ve,Ln).call(this);Ue(this,S,Math.max(f,Fe[2]-Fe[0])),Ue(this,v,Math.max(f,Fe[3]-Fe[1]));const He=Math.ceil(qe+le(this,S)*this.scaleFactor),Xe=Math.ceil(qe+le(this,v)*this.scaleFactor),[tt,Je]=this.parentDimensions;this.width=He/tt,this.height=Xe/Je,Ue(this,g,He/Xe),Pe(this,_e,_i).call(this);const Ye=this.translationX,Ke=this.translationY;this.translationX=-Fe[0],this.translationY=-Fe[1],Pe(this,ve,rn).call(this),Pe(this,se,xt).call(this),Ue(this,N,He),Ue(this,j,Xe),this.setDims(He,Xe);const et=Ce?qe/this.scaleFactor/2:0;this.translate(Ye-this.translationX-et,Ke-this.translationY-et)},_e=new WeakSet,_i=function(){const{style:Ce}=this.div;le(this,g)>=1?(Ce.minHeight=`${f}px`,Ce.minWidth=`${Math.round(le(this,g)*f)}px`):(Ce.minWidth=`${f}px`,Ce.minHeight=`${Math.round(f/le(this,g))}px`)},De(p,de),at(p,"_defaultColor",null),at(p,"_defaultOpacity",1),at(p,"_defaultThickness",1),at(p,"_l10nPromise"),at(p,"_type","ink"),n.InkEditor=p},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.fitCurve=void 0;const r=i(31);n.fitCurve=r},e=>{function n(k,O,R){if(!Array.isArray(k))throw new TypeError("First argument should be an array");if(k.forEach(L=>{if(!Array.isArray(L)||L.some(N=>typeof N!="number")||L.length!==k[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),k=k.filter((L,N)=>N===0||!L.every((j,z)=>j===k[N-1][z])),k.length<2)return[];const P=k.length,F=v(k[1],k[0]),I=v(k[P-2],k[P-1]);return i(k,F,I,O,R)}function i(k,O,R,P,F){var L,N,j,z,q,H,W,U,Q,J,ne,G,Z;if(k.length===2)return G=S.vectorLen(S.subtract(k[0],k[1]))/3,L=[k[0],S.addArrays(k[0],S.mulItems(O,G)),S.addArrays(k[1],S.mulItems(R,G)),k[1]],[L];if(N=f(k),[L,z,H]=r(k,N,N,O,R,F),z===0||z<P)return[L];if(z<P*P)for(j=N,q=z,W=H,Z=0;Z<20;Z++){if(j=o(L,k,j),[L,z,H]=r(k,N,j,O,R,F),z<P)return[L];if(H===W){let ae=z/q;if(ae>.9999&&ae<1.0001)break}q=z,W=H}return ne=[],U=S.subtract(k[H-1],k[H+1]),U.every(ae=>ae===0)&&(U=S.subtract(k[H-1],k[H]),[U[0],U[1]]=[-U[1],U[0]]),Q=S.normalize(U),J=S.mulItems(Q,-1),ne=ne.concat(i(k.slice(0,H+1),O,Q,P,F)),ne=ne.concat(i(k.slice(H),J,R,P,F)),ne}function r(k,O,R,P,F,I){var L,N,j;return L=s(k,R,P,F),[N,j]=d(k,L,O),I&&I({bez:L,points:k,params:O,maxErr:N,maxPoint:j}),[L,N,j]}function s(k,O,R,P){var F,I,L,N,j,z,q,H,W,U,Q,J,ne,G,Z,ae,oe,pe=k[0],Se=k[k.length-1];for(F=[pe,null,null,Se],I=S.zeros_Xx2x2(O.length),ne=0,G=O.length;ne<G;ne++)ae=O[ne],oe=1-ae,L=I[ne],L[0]=S.mulItems(R,3*ae*(oe*oe)),L[1]=S.mulItems(P,3*oe*(ae*ae));for(N=[[0,0],[0,0]],j=[0,0],ne=0,G=k.length;ne<G;ne++)ae=O[ne],L=I[ne],N[0][0]+=S.dot(L[0],L[0]),N[0][1]+=S.dot(L[0],L[1]),N[1][0]+=S.dot(L[0],L[1]),N[1][1]+=S.dot(L[1],L[1]),Z=S.subtract(k[ne],T.q([pe,pe,Se,Se],ae)),j[0]+=S.dot(L[0],Z),j[1]+=S.dot(L[1],Z);return z=N[0][0]*N[1][1]-N[1][0]*N[0][1],q=N[0][0]*j[1]-N[1][0]*j[0],H=j[0]*N[1][1]-j[1]*N[0][1],W=z===0?0:H/z,U=z===0?0:q/z,J=S.vectorLen(S.subtract(pe,Se)),Q=1e-6*J,W<Q||U<Q?(F[1]=S.addArrays(pe,S.mulItems(R,J/3)),F[2]=S.addArrays(Se,S.mulItems(P,J/3))):(F[1]=S.addArrays(pe,S.mulItems(R,W)),F[2]=S.addArrays(Se,S.mulItems(P,U))),F}function o(k,O,R){return R.map((P,F)=>l(k,O[F],P))}function l(k,O,R){var P=S.subtract(T.q(k,R),O),F=T.qprime(k,R),I=S.mulMatrix(P,F),L=S.sum(S.squareItems(F))+2*S.mulMatrix(P,T.qprimeprime(k,R));return L===0?R:R-I/L}function f(k){var O=[],R,P,F;return k.forEach((I,L)=>{R=L?P+S.vectorLen(S.subtract(I,F)):0,O.push(R),P=R,F=I}),O=O.map(I=>I/P),O}function d(k,O,R){var P,F,I,L,N,j,z,q;F=0,I=Math.floor(k.length/2);const H=p(O,10);for(N=0,j=k.length;N<j;N++)z=k[N],q=g(O,R[N],H,10),L=S.subtract(T.q(O,q),z),P=L[0]*L[0]+L[1]*L[1],P>F&&(F=P,I=N);return[F,I]}var p=function(k,O){for(var R,P=[0],F=k[0],I=0,L=1;L<=O;L++)R=T.q(k,L/O),I+=S.vectorLen(S.subtract(R,F)),P.push(I),F=R;return P=P.map(N=>N/I),P};function g(k,O,R,P){if(O<0)return 0;if(O>1)return 1;for(var F,I,L,N,j,z=1;z<=P;z++)if(O<=R[z]){N=(z-1)/P,L=z/P,I=R[z-1],F=R[z],j=(O-I)/(F-I)*(L-N)+N;break}return j}function v(k,O){return S.normalize(S.subtract(k,O))}class S{static zeros_Xx2x2(O){for(var R=[];O--;)R.push([0,0]);return R}static mulItems(O,R){return O.map(P=>P*R)}static mulMatrix(O,R){return O.reduce((P,F,I)=>P+F*R[I],0)}static subtract(O,R){return O.map((P,F)=>P-R[F])}static addArrays(O,R){return O.map((P,F)=>P+R[F])}static addItems(O,R){return O.map(P=>P+R)}static sum(O){return O.reduce((R,P)=>R+P)}static dot(O,R){return S.mulMatrix(O,R)}static vectorLen(O){return Math.hypot(...O)}static divItems(O,R){return O.map(P=>P/R)}static squareItems(O){return O.map(R=>R*R)}static normalize(O){return this.divItems(O,this.vectorLen(O))}}class T{static q(O,R){var P=1-R,F=S.mulItems(O[0],P*P*P),I=S.mulItems(O[1],3*P*P*R),L=S.mulItems(O[2],3*P*R*R),N=S.mulItems(O[3],R*R*R);return S.addArrays(S.addArrays(F,I),S.addArrays(L,N))}static qprime(O,R){var P=1-R,F=S.mulItems(S.subtract(O[1],O[0]),3*P*P),I=S.mulItems(S.subtract(O[2],O[1]),6*P*R),L=S.mulItems(S.subtract(O[3],O[2]),3*R*R);return S.addArrays(S.addArrays(F,I),L)}static qprimeprime(O,R){return S.addArrays(S.mulItems(S.addArrays(S.subtract(O[2],S.mulItems(O[1],2)),O[0]),6*(1-R)),S.mulItems(S.addArrays(S.subtract(O[3],S.mulItems(O[2],2)),O[1]),6*R))}}e.exports=n,e.exports.fitCubic=i,e.exports.createTangent=v},(e,n,i)=>{var V,Wt,fe,mr,xe,yi,we,vi;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var r=i(1),s=i(6),o=i(3),l=i(33),f=i(34);const d=1e3,p=9,g=new WeakSet;function v(Te){return{width:Te[2]-Te[0],height:Te[3]-Te[1]}}class S{static create(te){switch(te.data.annotationType){case r.AnnotationType.LINK:return new k(te);case r.AnnotationType.TEXT:return new O(te);case r.AnnotationType.WIDGET:switch(te.data.fieldType){case"Tx":return new P(te);case"Btn":return te.data.radioButton?new I(te):te.data.checkBox?new F(te):new L(te);case"Ch":return new N(te)}return new R(te);case r.AnnotationType.POPUP:return new j(te);case r.AnnotationType.FREETEXT:return new q(te);case r.AnnotationType.LINE:return new H(te);case r.AnnotationType.SQUARE:return new W(te);case r.AnnotationType.CIRCLE:return new U(te);case r.AnnotationType.POLYLINE:return new Q(te);case r.AnnotationType.CARET:return new ne(te);case r.AnnotationType.INK:return new G(te);case r.AnnotationType.POLYGON:return new J(te);case r.AnnotationType.HIGHLIGHT:return new Z(te);case r.AnnotationType.UNDERLINE:return new ae(te);case r.AnnotationType.SQUIGGLY:return new oe(te);case r.AnnotationType.STRIKEOUT:return new pe(te);case r.AnnotationType.STAMP:return new Se(te);case r.AnnotationType.FILEATTACHMENT:return new ue(te);default:return new T(te)}}}class T{constructor(te,{isRenderable:ie=!1,ignoreBorder:ce=!1,createQuadrilaterals:ge=!1}={}){this.isRenderable=ie,this.data=te.data,this.layer=te.layer,this.page=te.page,this.viewport=te.viewport,this.linkService=te.linkService,this.downloadManager=te.downloadManager,this.imageResourcesPath=te.imageResourcesPath,this.renderForms=te.renderForms,this.svgFactory=te.svgFactory,this.annotationStorage=te.annotationStorage,this.enableScripting=te.enableScripting,this.hasJSActions=te.hasJSActions,this._fieldObjects=te.fieldObjects,ie&&(this.container=this._createContainer(ce)),ge&&(this.quadrilaterals=this._createQuadrilaterals(ce))}_createContainer(te=!1){const{data:ie,page:ce,viewport:ge}=this,de=document.createElement("section");de.setAttribute("data-annotation-id",ie.id);const{pageWidth:Ae,pageHeight:Oe,pageX:Re,pageY:Ie}=ge.rawDims,{width:ke,height:je}=v(ie.rect),Me=r.Util.normalizeRect([ie.rect[0],ce.view[3]-ie.rect[1]+ce.view[1],ie.rect[2],ce.view[3]-ie.rect[3]+ce.view[1]]);if(!te&&ie.borderStyle.width>0){de.style.borderWidth=`${ie.borderStyle.width}px`;const ze=ie.borderStyle.horizontalCornerRadius,Ve=ie.borderStyle.verticalCornerRadius;if(ze>0||Ve>0){const Ge=`calc(${ze}px * var(--scale-factor)) / calc(${Ve}px * var(--scale-factor))`;de.style.borderRadius=Ge}else if(this instanceof I){const Ge=`calc(${ke}px * var(--scale-factor)) / calc(${je}px * var(--scale-factor))`;de.style.borderRadius=Ge}switch(ie.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:de.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:de.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:de.style.borderBottomStyle="solid";break}const Qe=ie.borderColor||null;Qe?de.style.borderColor=r.Util.makeHexColor(Qe[0]|0,Qe[1]|0,Qe[2]|0):de.style.borderWidth=0}de.style.left=`${100*(Me[0]-Re)/Ae}%`,de.style.top=`${100*(Me[1]-Ie)/Oe}%`;const{rotation:Be}=ie;return ie.hasOwnCanvas||Be===0?(de.style.width=`${100*ke/Ae}%`,de.style.height=`${100*je/Oe}%`):this.setRotation(Be,de),de}setRotation(te,ie=this.container){const{pageWidth:ce,pageHeight:ge}=this.viewport.rawDims,{width:de,height:Ae}=v(this.data.rect);let Oe,Re;te%180===0?(Oe=100*de/ce,Re=100*Ae/ge):(Oe=100*Ae/ce,Re=100*de/ge),ie.style.width=`${Oe}%`,ie.style.height=`${Re}%`,ie.setAttribute("data-main-rotation",(360-te)%360)}get _commonActions(){const te=(ie,ce,ge)=>{const de=ge.detail[ie];ge.target.style[ce]=l.ColorConverters[`${de[0]}_HTML`](de.slice(1))};return(0,r.shadow)(this,"_commonActions",{display:ie=>{const ce=ie.detail.display%2===1;this.container.style.visibility=ce?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:ce,print:ie.detail.display===0||ie.detail.display===3})},print:ie=>{this.annotationStorage.setValue(this.data.id,{print:ie.detail.print})},hidden:ie=>{this.container.style.visibility=ie.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:ie.detail.hidden})},focus:ie=>{setTimeout(()=>ie.target.focus({preventScroll:!1}),0)},userName:ie=>{ie.target.title=ie.detail.userName},readonly:ie=>{ie.detail.readonly?ie.target.setAttribute("readonly",""):ie.target.removeAttribute("readonly")},required:ie=>{this._setRequired(ie.target,ie.detail.required)},bgColor:ie=>{te("bgColor","backgroundColor",ie)},fillColor:ie=>{te("fillColor","backgroundColor",ie)},fgColor:ie=>{te("fgColor","color",ie)},textColor:ie=>{te("textColor","color",ie)},borderColor:ie=>{te("borderColor","borderColor",ie)},strokeColor:ie=>{te("strokeColor","borderColor",ie)},rotation:ie=>{const ce=ie.detail.rotation;this.setRotation(ce),this.annotationStorage.setValue(this.data.id,{rotation:ce})}})}_dispatchEventFromSandbox(te,ie){const ce=this._commonActions;for(const ge of Object.keys(ie.detail)){const de=te[ge]||ce[ge];de==null||de(ie)}}_setDefaultPropertiesFromJS(te){if(!this.enableScripting)return;const ie=this.annotationStorage.getRawValue(this.data.id);if(!ie)return;const ce=this._commonActions;for(const[ge,de]of Object.entries(ie)){const Ae=ce[ge];if(Ae){const Oe={detail:{[ge]:de},target:te};Ae(Oe),delete ie[ge]}}}_createQuadrilaterals(te=!1){if(!this.data.quadPoints)return null;const ie=[],ce=this.data.rect;for(const ge of this.data.quadPoints)this.data.rect=[ge[2].x,ge[2].y,ge[1].x,ge[1].y],ie.push(this._createContainer(te));return this.data.rect=ce,ie}_createPopup(te,ie){let ce=this.container;this.quadrilaterals&&(te=te||this.quadrilaterals,ce=this.quadrilaterals[0]),te||(te=document.createElement("div"),te.className="popupTriggerArea",ce.append(te));const de=new z({container:ce,trigger:te,color:ie.color,titleObj:ie.titleObj,modificationDate:ie.modificationDate,contentsObj:ie.contentsObj,richText:ie.richText,hideWrapper:!0}).render();de.style.left="100%",ce.append(de)}_renderQuadrilaterals(te){for(const ie of this.quadrilaterals)ie.className=te;return this.quadrilaterals}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(te,ie=null){const ce=[];if(this._fieldObjects){const ge=this._fieldObjects[te];if(ge)for(const{page:de,id:Ae,exportValues:Oe}of ge){if(de===-1||Ae===ie)continue;const Re=typeof Oe=="string"?Oe:null,Ie=document.querySelector(`[data-element-id="${Ae}"]`);if(Ie&&!g.has(Ie)){(0,r.warn)(`_getElementsByName - element not allowed: ${Ae}`);continue}ce.push({id:Ae,exportValue:Re,domElement:Ie})}return ce}for(const ge of document.getElementsByName(te)){const{exportValue:de}=ge,Ae=ge.getAttribute("data-element-id");Ae!==ie&&g.has(ge)&&ce.push({id:Ae,exportValue:de,domElement:ge})}return ce}}class k extends T{constructor(ie,ce=null){super(ie,{isRenderable:!0,ignoreBorder:!!(ce!=null&&ce.ignoreBorder),createQuadrilaterals:!0});De(this,V);De(this,fe);this.isTooltipOnly=ie.data.isTooltipOnly}render(){const{data:ie,linkService:ce}=this,ge=document.createElement("a");ge.setAttribute("data-element-id",ie.id);let de=!1;return ie.url?(ce.addLinkAttributes(ge,ie.url,ie.newWindow),de=!0):ie.action?(this._bindNamedAction(ge,ie.action),de=!0):ie.attachment?(this._bindAttachment(ge,ie.attachment),de=!0):ie.setOCGState?(Pe(this,fe,mr).call(this,ge,ie.setOCGState),de=!0):ie.dest?(this._bindLink(ge,ie.dest),de=!0):(ie.actions&&(ie.actions.Action||ie.actions["Mouse Up"]||ie.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(ge,ie),de=!0),ie.resetForm?(this._bindResetFormAction(ge,ie.resetForm),de=!0):this.isTooltipOnly&&!de&&(this._bindLink(ge,""),de=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((Ae,Oe)=>{const Re=Oe===0?ge:ge.cloneNode();return Ae.append(Re),Ae}):(this.container.className="linkAnnotation",de&&this.container.append(ge),this.container)}_bindLink(ie,ce){ie.href=this.linkService.getDestinationHash(ce),ie.onclick=()=>(ce&&this.linkService.goToDestination(ce),!1),(ce||ce==="")&&Pe(this,V,Wt).call(this)}_bindNamedAction(ie,ce){ie.href=this.linkService.getAnchorUrl(""),ie.onclick=()=>(this.linkService.executeNamedAction(ce),!1),Pe(this,V,Wt).call(this)}_bindAttachment(ie,ce){ie.href=this.linkService.getAnchorUrl(""),ie.onclick=()=>{var ge;return(ge=this.downloadManager)==null||ge.openOrDownloadData(this.container,ce.content,ce.filename),!1},Pe(this,V,Wt).call(this)}_bindJSAction(ie,ce){ie.href=this.linkService.getAnchorUrl("");const ge=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const de of Object.keys(ce.actions)){const Ae=ge.get(de);Ae&&(ie[Ae]=()=>{var Oe;return(Oe=this.linkService.eventBus)==null||Oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ce.id,name:de}}),!1})}ie.onclick||(ie.onclick=()=>!1),Pe(this,V,Wt).call(this)}_bindResetFormAction(ie,ce){const ge=ie.onclick;if(ge||(ie.href=this.linkService.getAnchorUrl("")),Pe(this,V,Wt).call(this),!this._fieldObjects){(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),ge||(ie.onclick=()=>!1);return}ie.onclick=()=>{var je;ge==null||ge();const{fields:de,refs:Ae,include:Oe}=ce,Re=[];if(de.length!==0||Ae.length!==0){const Me=new Set(Ae);for(const Be of de){const ze=this._fieldObjects[Be]||[];for(const{id:Ve}of ze)Me.add(Ve)}for(const Be of Object.values(this._fieldObjects))for(const ze of Be)Me.has(ze.id)===Oe&&Re.push(ze)}else for(const Me of Object.values(this._fieldObjects))Re.push(...Me);const Ie=this.annotationStorage,ke=[];for(const Me of Re){const{id:Be}=Me;switch(ke.push(Be),Me.type){case"text":{const Ve=Me.defaultValue||"";Ie.setValue(Be,{value:Ve});break}case"checkbox":case"radiobutton":{const Ve=Me.defaultValue===Me.exportValues;Ie.setValue(Be,{value:Ve});break}case"combobox":case"listbox":{const Ve=Me.defaultValue||"";Ie.setValue(Be,{value:Ve});break}default:continue}const ze=document.querySelector(`[data-element-id="${Be}"]`);if(ze){if(!g.has(ze)){(0,r.warn)(`_bindResetFormAction - element not allowed: ${Be}`);continue}}else continue;ze.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((je=this.linkService.eventBus)==null||je.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ke,name:"ResetForm"}})),!1}}}V=new WeakSet,Wt=function(){this.container.setAttribute("data-internal-link","")},fe=new WeakSet,mr=function(ie,ce){ie.href=this.linkService.getAnchorUrl(""),ie.onclick=()=>(this.linkService.executeSetOCGState(ce),!1),Pe(this,V,Wt).call(this)};class O extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie})}render(){this.container.className="textAnnotation";const te=document.createElement("img");return te.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",te.alt="[{{type}} Annotation]",te.dataset.l10nId="text_annotation_type",te.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(te,this.data),this.container.append(te),this.container}}class R extends T{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(te){const{isWin:ie,isMac:ce}=r.FeatureTest.platform;return ie&&te.ctrlKey||ce&&te.metaKey}_setEventListener(te,ie,ce,ge){ie.includes("mouse")?te.addEventListener(ie,de=>{var Ae;(Ae=this.linkService.eventBus)==null||Ae.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ce,value:ge(de),shift:de.shiftKey,modifier:this._getKeyModifier(de)}})}):te.addEventListener(ie,de=>{var Ae;(Ae=this.linkService.eventBus)==null||Ae.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ce,value:ge(de)}})})}_setEventListeners(te,ie,ce){var ge;for(const[de,Ae]of ie)(Ae==="Action"||(ge=this.data.actions)!=null&&ge[Ae])&&this._setEventListener(te,de,Ae,ce)}_setBackgroundColor(te){const ie=this.data.backgroundColor||null;te.style.backgroundColor=ie===null?"transparent":r.Util.makeHexColor(ie[0],ie[1],ie[2])}_setTextStyle(te){const ie=["left","center","right"],{fontColor:ce}=this.data.defaultAppearanceData,ge=this.data.defaultAppearanceData.fontSize||p,de=te.style;let Ae;const Oe=2,Re=Ie=>Math.round(10*Ie)/10;if(this.data.multiLine){const Ie=Math.abs(this.data.rect[3]-this.data.rect[1]-Oe),ke=Math.round(Ie/(r.LINE_FACTOR*ge))||1,je=Ie/ke;Ae=Math.min(ge,Re(je/r.LINE_FACTOR))}else{const Ie=Math.abs(this.data.rect[3]-this.data.rect[1]-Oe);Ae=Math.min(ge,Re(Ie/r.LINE_FACTOR))}de.fontSize=`calc(${Ae}px * var(--scale-factor))`,de.color=r.Util.makeHexColor(ce[0],ce[1],ce[2]),this.data.textAlignment!==null&&(de.textAlign=ie[this.data.textAlignment])}_setRequired(te,ie){ie?te.setAttribute("required",!0):te.removeAttribute("required"),te.setAttribute("aria-required",ie)}}class P extends R{constructor(te){const ie=te.renderForms||!te.data.hasAppearance&&!!te.data.fieldValue;super(te,{isRenderable:ie})}setPropertyOnSiblings(te,ie,ce,ge){const de=this.annotationStorage;for(const Ae of this._getElementsByName(te.name,te.id))Ae.domElement&&(Ae.domElement[ie]=ce),de.setValue(Ae.id,{[ge]:ce})}render(){var ge;const te=this.annotationStorage,ie=this.data.id;this.container.className="textWidgetAnnotation";let ce=null;if(this.renderForms){const de=te.getValue(ie,{value:this.data.fieldValue});let Ae=de.formattedValue||de.value||"";const Oe=te.getValue(ie,{charLimit:this.data.maxLen}).charLimit;Oe&&Ae.length>Oe&&(Ae=Ae.slice(0,Oe));const Re={userValue:Ae,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(ce=document.createElement("textarea"),ce.textContent=Ae,this.data.doNotScroll&&(ce.style.overflowY="hidden")):(ce=document.createElement("input"),ce.type="text",ce.setAttribute("value",Ae),this.data.doNotScroll&&(ce.style.overflowX="hidden")),g.add(ce),ce.setAttribute("data-element-id",ie),ce.disabled=this.data.readOnly,ce.name=this.data.fieldName,ce.tabIndex=d,this._setRequired(ce,this.data.required),Oe&&(ce.maxLength=Oe),ce.addEventListener("input",ke=>{te.setValue(ie,{value:ke.target.value}),this.setPropertyOnSiblings(ce,"value",ke.target.value,"value")}),ce.addEventListener("resetform",ke=>{const je=this.data.defaultFieldValue??"";ce.value=Re.userValue=je,Re.formattedValue=null});let Ie=ke=>{const{formattedValue:je}=Re;je!=null&&(ke.target.value=je),ke.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ce.addEventListener("focus",je=>{const{target:Me}=je;Re.userValue&&(Me.value=Re.userValue),Re.lastCommittedValue=Me.value,Re.commitKey=1}),ce.addEventListener("updatefromsandbox",je=>{const Me={value(Be){Re.userValue=Be.detail.value??"",te.setValue(ie,{value:Re.userValue.toString()}),Be.target.value=Re.userValue},formattedValue(Be){const{formattedValue:ze}=Be.detail;Re.formattedValue=ze,ze!=null&&Be.target!==document.activeElement&&(Be.target.value=ze),te.setValue(ie,{formattedValue:ze})},selRange(Be){Be.target.setSelectionRange(...Be.detail.selRange)},charLimit:Be=>{var Ge;const{charLimit:ze}=Be.detail,{target:Ve}=Be;if(ze===0){Ve.removeAttribute("maxLength");return}Ve.setAttribute("maxLength",ze);let Qe=Re.userValue;!Qe||Qe.length<=ze||(Qe=Qe.slice(0,ze),Ve.value=Re.userValue=Qe,te.setValue(ie,{value:Qe}),(Ge=this.linkService.eventBus)==null||Ge.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ie,name:"Keystroke",value:Qe,willCommit:!0,commitKey:1,selStart:Ve.selectionStart,selEnd:Ve.selectionEnd}}))}};this._dispatchEventFromSandbox(Me,je)}),ce.addEventListener("keydown",je=>{var ze;Re.commitKey=1;let Me=-1;if(je.key==="Escape"?Me=0:je.key==="Enter"&&!this.data.multiLine?Me=2:je.key==="Tab"&&(Re.commitKey=3),Me===-1)return;const{value:Be}=je.target;Re.lastCommittedValue!==Be&&(Re.lastCommittedValue=Be,Re.userValue=Be,(ze=this.linkService.eventBus)==null||ze.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ie,name:"Keystroke",value:Be,willCommit:!0,commitKey:Me,selStart:je.target.selectionStart,selEnd:je.target.selectionEnd}}))});const ke=Ie;Ie=null,ce.addEventListener("blur",je=>{var Be;if(!je.relatedTarget)return;const{value:Me}=je.target;Re.userValue=Me,Re.lastCommittedValue!==Me&&((Be=this.linkService.eventBus)==null||Be.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ie,name:"Keystroke",value:Me,willCommit:!0,commitKey:Re.commitKey,selStart:je.target.selectionStart,selEnd:je.target.selectionEnd}})),ke(je)}),(ge=this.data.actions)!=null&&ge.Keystroke&&ce.addEventListener("beforeinput",je=>{var _e;Re.lastCommittedValue=null;const{data:Me,target:Be}=je,{value:ze,selectionStart:Ve,selectionEnd:Qe}=Be;let Ge=Ve,me=Qe;switch(je.inputType){case"deleteWordBackward":{const Ee=ze.substring(0,Ve).match(/\w*[^\w]*$/);Ee&&(Ge-=Ee[0].length);break}case"deleteWordForward":{const Ee=ze.substring(Ve).match(/^[^\w]*\w*/);Ee&&(me+=Ee[0].length);break}case"deleteContentBackward":Ve===Qe&&(Ge-=1);break;case"deleteContentForward":Ve===Qe&&(me+=1);break}je.preventDefault(),(_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ie,name:"Keystroke",value:ze,change:Me||"",willCommit:!1,selStart:Ge,selEnd:me}})}),this._setEventListeners(ce,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],je=>je.target.value)}if(Ie&&ce.addEventListener("blur",Ie),this.data.comb){const je=(this.data.rect[2]-this.data.rect[0])/Oe;ce.classList.add("comb"),ce.style.letterSpacing=`calc(${je}px * var(--scale-factor) - 1ch)`}}else ce=document.createElement("div"),ce.textContent=this.data.fieldValue,ce.style.verticalAlign="middle",ce.style.display="table-cell";return this._setTextStyle(ce),this._setBackgroundColor(ce),this._setDefaultPropertiesFromJS(ce),this.container.append(ce),this.container}}class F extends R{constructor(te){super(te,{isRenderable:te.renderForms})}render(){const te=this.annotationStorage,ie=this.data,ce=ie.id;let ge=te.getValue(ce,{value:ie.exportValue===ie.fieldValue}).value;typeof ge=="string"&&(ge=ge!=="Off",te.setValue(ce,{value:ge})),this.container.className="buttonWidgetAnnotation checkBox";const de=document.createElement("input");return g.add(de),de.setAttribute("data-element-id",ce),de.disabled=ie.readOnly,this._setRequired(de,this.data.required),de.type="checkbox",de.name=ie.fieldName,ge&&de.setAttribute("checked",!0),de.setAttribute("exportValue",ie.exportValue),de.tabIndex=d,de.addEventListener("change",Ae=>{const{name:Oe,checked:Re}=Ae.target;for(const Ie of this._getElementsByName(Oe,ce)){const ke=Re&&Ie.exportValue===ie.exportValue;Ie.domElement&&(Ie.domElement.checked=ke),te.setValue(Ie.id,{value:ke})}te.setValue(ce,{value:Re})}),de.addEventListener("resetform",Ae=>{const Oe=ie.defaultFieldValue||"Off";Ae.target.checked=Oe===ie.exportValue}),this.enableScripting&&this.hasJSActions&&(de.addEventListener("updatefromsandbox",Ae=>{const Oe={value(Re){Re.target.checked=Re.detail.value!=="Off",te.setValue(ce,{value:Re.target.checked})}};this._dispatchEventFromSandbox(Oe,Ae)}),this._setEventListeners(de,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ae=>Ae.target.checked)),this._setBackgroundColor(de),this._setDefaultPropertiesFromJS(de),this.container.append(de),this.container}}class I extends R{constructor(te){super(te,{isRenderable:te.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const te=this.annotationStorage,ie=this.data,ce=ie.id;let ge=te.getValue(ce,{value:ie.fieldValue===ie.buttonValue}).value;typeof ge=="string"&&(ge=ge!==ie.buttonValue,te.setValue(ce,{value:ge}));const de=document.createElement("input");if(g.add(de),de.setAttribute("data-element-id",ce),de.disabled=ie.readOnly,this._setRequired(de,this.data.required),de.type="radio",de.name=ie.fieldName,ge&&de.setAttribute("checked",!0),de.tabIndex=d,de.addEventListener("change",Ae=>{const{name:Oe,checked:Re}=Ae.target;for(const Ie of this._getElementsByName(Oe,ce))te.setValue(Ie.id,{value:!1});te.setValue(ce,{value:Re})}),de.addEventListener("resetform",Ae=>{const Oe=ie.defaultFieldValue;Ae.target.checked=Oe!=null&&Oe===ie.buttonValue}),this.enableScripting&&this.hasJSActions){const Ae=ie.buttonValue;de.addEventListener("updatefromsandbox",Oe=>{const Re={value:Ie=>{const ke=Ae===Ie.detail.value;for(const je of this._getElementsByName(Ie.target.name)){const Me=ke&&je.id===ce;je.domElement&&(je.domElement.checked=Me),te.setValue(je.id,{value:Me})}}};this._dispatchEventFromSandbox(Re,Oe)}),this._setEventListeners(de,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Oe=>Oe.target.checked)}return this._setBackgroundColor(de),this._setDefaultPropertiesFromJS(de),this.container.append(de),this.container}}class L extends k{constructor(te){super(te,{ignoreBorder:te.data.hasAppearance})}render(){const te=super.render();te.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(te.title=this.data.alternativeText);const ie=te.lastChild;return this.enableScripting&&this.hasJSActions&&ie&&(this._setDefaultPropertiesFromJS(ie),ie.addEventListener("updatefromsandbox",ce=>{this._dispatchEventFromSandbox({},ce)})),te}}class N extends R{constructor(te){super(te,{isRenderable:te.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const te=this.annotationStorage,ie=this.data.id,ce=te.getValue(ie,{value:this.data.fieldValue}),ge=document.createElement("select");g.add(ge),ge.setAttribute("data-element-id",ie),ge.disabled=this.data.readOnly,this._setRequired(ge,this.data.required),ge.name=this.data.fieldName,ge.tabIndex=d;let de=this.data.combo&&this.data.options.length>0;this.data.combo||(ge.size=this.data.options.length,this.data.multiSelect&&(ge.multiple=!0)),ge.addEventListener("resetform",ke=>{const je=this.data.defaultFieldValue;for(const Me of ge.options)Me.selected=Me.value===je});for(const ke of this.data.options){const je=document.createElement("option");je.textContent=ke.displayValue,je.value=ke.exportValue,ce.value.includes(ke.exportValue)&&(je.setAttribute("selected",!0),de=!1),ge.append(je)}let Ae=null;if(de){const ke=document.createElement("option");ke.value=" ",ke.setAttribute("hidden",!0),ke.setAttribute("selected",!0),ge.prepend(ke),Ae=()=>{ke.remove(),ge.removeEventListener("input",Ae),Ae=null},ge.addEventListener("input",Ae)}const Oe=ke=>{const je=ke?"value":"textContent",{options:Me,multiple:Be}=ge;return Be?Array.prototype.filter.call(Me,ze=>ze.selected).map(ze=>ze[je]):Me.selectedIndex===-1?null:Me[Me.selectedIndex][je]};let Re=Oe(!1);const Ie=ke=>{const je=ke.target.options;return Array.prototype.map.call(je,Me=>({displayValue:Me.textContent,exportValue:Me.value}))};return this.enableScripting&&this.hasJSActions?(ge.addEventListener("updatefromsandbox",ke=>{const je={value(Me){Ae==null||Ae();const Be=Me.detail.value,ze=new Set(Array.isArray(Be)?Be:[Be]);for(const Ve of ge.options)Ve.selected=ze.has(Ve.value);te.setValue(ie,{value:Oe(!0)}),Re=Oe(!1)},multipleSelection(Me){ge.multiple=!0},remove(Me){const Be=ge.options,ze=Me.detail.remove;Be[ze].selected=!1,ge.remove(ze),Be.length>0&&Array.prototype.findIndex.call(Be,Qe=>Qe.selected)===-1&&(Be[0].selected=!0),te.setValue(ie,{value:Oe(!0),items:Ie(Me)}),Re=Oe(!1)},clear(Me){for(;ge.length!==0;)ge.remove(0);te.setValue(ie,{value:null,items:[]}),Re=Oe(!1)},insert(Me){const{index:Be,displayValue:ze,exportValue:Ve}=Me.detail.insert,Qe=ge.children[Be],Ge=document.createElement("option");Ge.textContent=ze,Ge.value=Ve,Qe?Qe.before(Ge):ge.append(Ge),te.setValue(ie,{value:Oe(!0),items:Ie(Me)}),Re=Oe(!1)},items(Me){const{items:Be}=Me.detail;for(;ge.length!==0;)ge.remove(0);for(const ze of Be){const{displayValue:Ve,exportValue:Qe}=ze,Ge=document.createElement("option");Ge.textContent=Ve,Ge.value=Qe,ge.append(Ge)}ge.options.length>0&&(ge.options[0].selected=!0),te.setValue(ie,{value:Oe(!0),items:Ie(Me)}),Re=Oe(!1)},indices(Me){const Be=new Set(Me.detail.indices);for(const ze of Me.target.options)ze.selected=Be.has(ze.index);te.setValue(ie,{value:Oe(!0)}),Re=Oe(!1)},editable(Me){Me.target.disabled=!Me.detail.editable}};this._dispatchEventFromSandbox(je,ke)}),ge.addEventListener("input",ke=>{var Me;const je=Oe(!0);te.setValue(ie,{value:je}),ke.preventDefault(),(Me=this.linkService.eventBus)==null||Me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ie,name:"Keystroke",value:Re,changeEx:je,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(ge,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],ke=>ke.target.value)):ge.addEventListener("input",function(ke){te.setValue(ie,{value:Oe(!0)})}),this.data.combo&&this._setTextStyle(ge),this._setBackgroundColor(ge),this._setDefaultPropertiesFromJS(ge),this.container.append(ge),this.container}}const be=class extends T{constructor(te){var ge,de,Ae;const{data:ie}=te,ce=!be.IGNORE_TYPES.has(ie.parentType)&&!!((ge=ie.titleObj)!=null&&ge.str||(de=ie.contentsObj)!=null&&de.str||(Ae=ie.richText)!=null&&Ae.str);super(te,{isRenderable:ce})}render(){this.container.className="popupAnnotation";const te=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(te.length===0)return this.container;const ie=new z({container:this.container,trigger:Array.from(te),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),ce=this.page,ge=r.Util.normalizeRect([this.data.parentRect[0],ce.view[3]-this.data.parentRect[1]+ce.view[1],this.data.parentRect[2],ce.view[3]-this.data.parentRect[3]+ce.view[1]]),de=ge[0]+this.data.parentRect[2]-this.data.parentRect[0],Ae=ge[1],{pageWidth:Oe,pageHeight:Re,pageX:Ie,pageY:ke}=this.viewport.rawDims;return this.container.style.left=`${100*(de-Ie)/Oe}%`,this.container.style.top=`${100*(Ae-ke)/Re}%`,this.container.append(ie.render()),this.container}};let j=be;at(j,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class z{constructor(te){this.container=te.container,this.trigger=te.trigger,this.color=te.color,this.titleObj=te.titleObj,this.modificationDate=te.modificationDate,this.contentsObj=te.contentsObj,this.richText=te.richText,this.hideWrapper=te.hideWrapper||!1,this.pinned=!1}render(){var Oe,Re;const ie=document.createElement("div");ie.className="popupWrapper",this.hideElement=this.hideWrapper?ie:this.container,this.hideElement.hidden=!0;const ce=document.createElement("div");ce.className="popup";const ge=this.color;if(ge){const Ie=.7*(255-ge[0])+ge[0],ke=.7*(255-ge[1])+ge[1],je=.7*(255-ge[2])+ge[2];ce.style.backgroundColor=r.Util.makeHexColor(Ie|0,ke|0,je|0)}const de=document.createElement("h1");de.dir=this.titleObj.dir,de.textContent=this.titleObj.str,ce.append(de);const Ae=s.PDFDateString.toDateObject(this.modificationDate);if(Ae){const Ie=document.createElement("span");Ie.className="popupDate",Ie.textContent="{{date}}, {{time}}",Ie.dataset.l10nId="annotation_date_string",Ie.dataset.l10nArgs=JSON.stringify({date:Ae.toLocaleDateString(),time:Ae.toLocaleTimeString()}),ce.append(Ie)}if((Oe=this.richText)!=null&&Oe.str&&(!((Re=this.contentsObj)!=null&&Re.str)||this.contentsObj.str===this.richText.str))f.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:ce}),ce.lastChild.className="richText popupContent";else{const Ie=this._formatContents(this.contentsObj);ce.append(Ie)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Ie of this.trigger)Ie.addEventListener("click",this._toggle.bind(this)),Ie.addEventListener("mouseover",this._show.bind(this,!1)),Ie.addEventListener("mouseout",this._hide.bind(this,!1));return ce.addEventListener("click",this._hide.bind(this,!0)),ie.append(ce),ie}_formatContents({str:te,dir:ie}){const ce=document.createElement("p");ce.className="popupContent",ce.dir=ie;const ge=te.split(/(?:\r\n?|\n)/);for(let de=0,Ae=ge.length;de<Ae;++de){const Oe=ge[de];ce.append(document.createTextNode(Oe)),de<Ae-1&&ce.append(document.createElement("br"))}return ce}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(te=!1){te&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(te=!0){te&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class q extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0}),this.textContent=te.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const te=document.createElement("div");te.className="annotationTextContent",te.setAttribute("role","comment");for(const ie of this.textContent){const ce=document.createElement("span");ce.textContent=ie,te.append(ce)}this.container.append(te)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class H extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const te=this.data,{width:ie,height:ce}=v(te.rect),ge=this.svgFactory.create(ie,ce,!0),de=this.svgFactory.createElement("svg:line");return de.setAttribute("x1",te.rect[2]-te.lineCoordinates[0]),de.setAttribute("y1",te.rect[3]-te.lineCoordinates[1]),de.setAttribute("x2",te.rect[2]-te.lineCoordinates[2]),de.setAttribute("y2",te.rect[3]-te.lineCoordinates[3]),de.setAttribute("stroke-width",te.borderStyle.width||1),de.setAttribute("stroke","transparent"),de.setAttribute("fill","transparent"),ge.append(de),this.container.append(ge),this._createPopup(de,te),this.container}}class W extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const te=this.data,{width:ie,height:ce}=v(te.rect),ge=this.svgFactory.create(ie,ce,!0),de=te.borderStyle.width,Ae=this.svgFactory.createElement("svg:rect");return Ae.setAttribute("x",de/2),Ae.setAttribute("y",de/2),Ae.setAttribute("width",ie-de),Ae.setAttribute("height",ce-de),Ae.setAttribute("stroke-width",de||1),Ae.setAttribute("stroke","transparent"),Ae.setAttribute("fill","transparent"),ge.append(Ae),this.container.append(ge),this._createPopup(Ae,te),this.container}}class U extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const te=this.data,{width:ie,height:ce}=v(te.rect),ge=this.svgFactory.create(ie,ce,!0),de=te.borderStyle.width,Ae=this.svgFactory.createElement("svg:ellipse");return Ae.setAttribute("cx",ie/2),Ae.setAttribute("cy",ce/2),Ae.setAttribute("rx",ie/2-de/2),Ae.setAttribute("ry",ce/2-de/2),Ae.setAttribute("stroke-width",de||1),Ae.setAttribute("stroke","transparent"),Ae.setAttribute("fill","transparent"),ge.append(Ae),this.container.append(ge),this._createPopup(Ae,te),this.container}}class Q extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const te=this.data,{width:ie,height:ce}=v(te.rect),ge=this.svgFactory.create(ie,ce,!0);let de=[];for(const Oe of te.vertices){const Re=Oe.x-te.rect[0],Ie=te.rect[3]-Oe.y;de.push(Re+","+Ie)}de=de.join(" ");const Ae=this.svgFactory.createElement(this.svgElementName);return Ae.setAttribute("points",de),Ae.setAttribute("stroke-width",te.borderStyle.width||1),Ae.setAttribute("stroke","transparent"),Ae.setAttribute("fill","transparent"),ge.append(Ae),this.container.append(ge),this._createPopup(Ae,te),this.container}}class J extends Q{constructor(te){super(te),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ne extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class G extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const te=this.data,{width:ie,height:ce}=v(te.rect),ge=this.svgFactory.create(ie,ce,!0);for(const de of te.inkLists){let Ae=[];for(const Re of de){const Ie=Re.x-te.rect[0],ke=te.rect[3]-Re.y;Ae.push(`${Ie},${ke}`)}Ae=Ae.join(" ");const Oe=this.svgFactory.createElement(this.svgElementName);Oe.setAttribute("points",Ae),Oe.setAttribute("stroke-width",te.borderStyle.width||1),Oe.setAttribute("stroke","transparent"),Oe.setAttribute("fill","transparent"),this._createPopup(Oe,te),ge.append(Oe)}return this.container.append(ge),this.container}}class Z extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class ae extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class oe extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class pe extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class Se extends T{constructor(te){var ce,ge,de;const ie=!!(te.data.hasPopup||(ce=te.data.titleObj)!=null&&ce.str||(ge=te.data.contentsObj)!=null&&ge.str||(de=te.data.richText)!=null&&de.str);super(te,{isRenderable:ie,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ue extends T{constructor(te){var ge;super(te,{isRenderable:!0});const{filename:ie,content:ce}=this.data.file;this.filename=(0,s.getFilenameFromUrl)(ie,!0),this.content=ce,(ge=this.linkService.eventBus)==null||ge.dispatch("fileattachmentannotation",{source:this,filename:ie,content:ce})}render(){var ie,ce;this.container.className="fileAttachmentAnnotation";let te;return this.data.hasAppearance?te=document.createElement("div"):(te=document.createElement("img"),te.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),te.className="popupTriggerArea",te.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((ie=this.data.titleObj)!=null&&ie.str||(ce=this.data.contentsObj)!=null&&ce.str||this.data.richText)&&this._createPopup(te,this.data),this.container.append(te),this.container}_download(){var te;(te=this.downloadManager)==null||te.openOrDownloadData(this.container,this.content,this.filename)}}const ve=class{static render(te){var Re,Ie;const{annotations:ie,div:ce,viewport:ge,accessibilityManager:de}=te;(0,s.setLayerDimensions)(ce,ge);const Ae={data:null,layer:ce,page:te.page,viewport:ge,linkService:te.linkService,downloadManager:te.downloadManager,imageResourcesPath:te.imageResourcesPath||"",renderForms:te.renderForms!==!1,svgFactory:new s.DOMSVGFactory,annotationStorage:te.annotationStorage||new o.AnnotationStorage,enableScripting:te.enableScripting===!0,hasJSActions:te.hasJSActions,fieldObjects:te.fieldObjects};let Oe=0;for(const ke of ie){if(ke.annotationType!==r.AnnotationType.POPUP){const{width:Be,height:ze}=v(ke.rect);if(Be<=0||ze<=0)continue}Ae.data=ke;const je=S.create(Ae);if(!je.isRenderable)continue;const Me=je.render();if(ke.hidden&&(Me.style.visibility="hidden"),Array.isArray(Me))for(const Be of Me)Be.style.zIndex=Oe++,Pe(Re=ve,xe,yi).call(Re,Be,ke.id,ce,de);else Me.style.zIndex=Oe++,je instanceof j?ce.prepend(Me):Pe(Ie=ve,xe,yi).call(Ie,Me,ke.id,ce,de)}Pe(this,we,vi).call(this,ce,te.annotationCanvasMap)}static update(te){const{annotationCanvasMap:ie,div:ce,viewport:ge}=te;(0,s.setLayerDimensions)(ce,{rotation:ge.rotation}),Pe(this,we,vi).call(this,ce,ie),ce.hidden=!1}};let ee=ve;xe=new WeakSet,yi=function(te,ie,ce,ge){const de=te.firstChild||te;de.id=`${s.AnnotationPrefix}${ie}`,ce.append(te),ge==null||ge.moveElementInDOM(ce,te,de,!1)},we=new WeakSet,vi=function(te,ie){if(ie){for(const[ce,ge]of ie){const de=te.querySelector(`[data-annotation-id="${ce}"]`);if(!de)continue;const{firstChild:Ae}=de;Ae?Ae.nodeName==="CANVAS"?Ae.replaceWith(ge):Ae.before(ge):de.append(ge)}ie.clear()}},De(ee,xe),De(ee,we),n.AnnotationLayer=ee},(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function i(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}class r{static CMYK_G([o,l,f,d]){return["G",1-Math.min(1,.3*o+.59*f+.11*l+d)]}static G_CMYK([o]){return["CMYK",0,0,0,1-o]}static G_RGB([o]){return["RGB",o,o,o]}static G_HTML([o]){const l=i(o);return`#${l}${l}${l}`}static RGB_G([o,l,f]){return["G",.3*o+.59*l+.11*f]}static RGB_HTML([o,l,f]){const d=i(o),p=i(l),g=i(f);return`#${d}${p}${g}`}static T_HTML(){return"#00000000"}static CMYK_RGB([o,l,f,d]){return["RGB",1-Math.min(1,o+d),1-Math.min(1,f+d),1-Math.min(1,l+d)]}static CMYK_HTML(o){const l=this.CMYK_RGB(o).slice(1);return this.RGB_HTML(l)}static RGB_CMYK([o,l,f]){const d=1-o,p=1-l,g=1-f,v=Math.min(d,p,g);return["CMYK",d,p,g,v]}}n.ColorConverters=r},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var r=i(19);class s{static setupStorage(l,f,d,p,g){const v=p.getValue(f,{value:null});switch(d.name){case"textarea":if(v.value!==null&&(l.textContent=v.value),g==="print")break;l.addEventListener("input",S=>{p.setValue(f,{value:S.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(v.value===d.attributes.xfaOn?l.setAttribute("checked",!0):v.value===d.attributes.xfaOff&&l.removeAttribute("checked"),g==="print")break;l.addEventListener("change",S=>{p.setValue(f,{value:S.target.checked?S.target.getAttribute("xfaOn"):S.target.getAttribute("xfaOff")})})}else{if(v.value!==null&&l.setAttribute("value",v.value),g==="print")break;l.addEventListener("input",S=>{p.setValue(f,{value:S.target.value})})}break;case"select":if(v.value!==null)for(const S of d.children)S.attributes.value===v.value&&(S.attributes.selected=!0);l.addEventListener("input",S=>{const T=S.target.options,k=T.selectedIndex===-1?"":T[T.selectedIndex].value;p.setValue(f,{value:k})});break}}static setAttributes({html:l,element:f,storage:d=null,intent:p,linkService:g}){const{attributes:v}=f,S=l instanceof HTMLAnchorElement;v.type==="radio"&&(v.name=`${v.name}-${p}`);for(const[T,k]of Object.entries(v))if(k!=null)switch(T){case"class":k.length&&l.setAttribute(T,k.join(" "));break;case"dataId":break;case"id":l.setAttribute("data-element-id",k);break;case"style":Object.assign(l.style,k);break;case"textContent":l.textContent=k;break;default:(!S||T!=="href"&&T!=="newWindow")&&l.setAttribute(T,k)}S&&g.addLinkAttributes(l,v.href,v.newWindow),d&&v.dataId&&this.setupStorage(l,v.dataId,f,d)}static render(l){var O;const f=l.annotationStorage,d=l.linkService,p=l.xfaHtml,g=l.intent||"display",v=document.createElement(p.name);p.attributes&&this.setAttributes({html:v,element:p,intent:g,linkService:d});const S=[[p,-1,v]],T=l.div;if(T.append(v),l.viewport){const R=`matrix(${l.viewport.transform.join(",")})`;T.style.transform=R}g!=="richText"&&T.setAttribute("class","xfaLayer xfaFont");const k=[];for(;S.length>0;){const[R,P,F]=S.at(-1);if(P+1===R.children.length){S.pop();continue}const I=R.children[++S.at(-1)[1]];if(I===null)continue;const{name:L}=I;if(L==="#text"){const j=document.createTextNode(I.value);k.push(j),F.append(j);continue}let N;if((O=I==null?void 0:I.attributes)!=null&&O.xmlns?N=document.createElementNS(I.attributes.xmlns,L):N=document.createElement(L),F.append(N),I.attributes&&this.setAttributes({html:N,element:I,storage:f,intent:g,linkService:d}),I.children&&I.children.length>0)S.push([I,-1,N]);else if(I.value){const j=document.createTextNode(I.value);r.XfaText.shouldBuildText(L)&&k.push(j),N.append(j)}}for(const R of T.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))R.setAttribute("readOnly",!0);return{textDivs:k}}static update(l){const f=`matrix(${l.viewport.transform.join(",")})`;l.div.style.transform=f,l.div.hidden=!1}}n.XfaLayer=s},(e,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var r=i(6),s=i(1),o=i(10);let l=class{constructor(){(0,s.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=l;{let O=function(N){let j=[];const z=[];for(const q of N){if(q.fn==="save"){j.push({fnId:92,fn:"group",items:[]}),z.push(j),j=j.at(-1).items;continue}q.fn==="restore"?j=z.pop():j.push(q)}return j},R=function(N){if(Number.isInteger(N))return N.toString();const j=N.toFixed(10);let z=j.length-1;if(j[z]!=="0")return j;do z--;while(j[z]==="0");return j.substring(0,j[z]==="."?z:z+1)},P=function(N){if(N[4]===0&&N[5]===0){if(N[1]===0&&N[2]===0)return N[0]===1&&N[3]===1?"":`scale(${R(N[0])} ${R(N[3])})`;if(N[0]===N[3]&&N[1]===-N[2]){const j=Math.acos(N[0])*180/Math.PI;return`rotate(${R(j)})`}}else if(N[0]===1&&N[1]===0&&N[2]===0&&N[3]===1)return`translate(${R(N[4])} ${R(N[5])})`;return`matrix(${R(N[0])} ${R(N[1])} ${R(N[2])} ${R(N[3])} ${R(N[4])} ${R(N[5])})`};const f={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},d="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/1999/xlink",g=["butt","round","square"],v=["miter","round","bevel"],S=function(N,j="",z=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!z)return URL.createObjectURL(new Blob([N],{type:j}));const q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let H=`data:${j};base64,`;for(let W=0,U=N.length;W<U;W+=3){const Q=N[W]&255,J=N[W+1]&255,ne=N[W+2]&255,G=Q>>2,Z=(Q&3)<<4|J>>4,ae=W+1<U?(J&15)<<2|ne>>6:64,oe=W+2<U?ne&63:64;H+=q[G]+q[Z]+q[ae]+q[oe]}return H},T=function(){const N=new Uint8Array([137,80,78,71,13,10,26,10]),j=12,z=new Int32Array(256);for(let ne=0;ne<256;ne++){let G=ne;for(let Z=0;Z<8;Z++)G&1?G=3988292384^G>>1&2147483647:G=G>>1&2147483647;z[ne]=G}function q(ne,G,Z){let ae=-1;for(let oe=G;oe<Z;oe++){const pe=(ae^ne[oe])&255,Se=z[pe];ae=ae>>>8^Se}return ae^-1}function H(ne,G,Z,ae){let oe=ae;const pe=G.length;Z[oe]=pe>>24&255,Z[oe+1]=pe>>16&255,Z[oe+2]=pe>>8&255,Z[oe+3]=pe&255,oe+=4,Z[oe]=ne.charCodeAt(0)&255,Z[oe+1]=ne.charCodeAt(1)&255,Z[oe+2]=ne.charCodeAt(2)&255,Z[oe+3]=ne.charCodeAt(3)&255,oe+=4,Z.set(G,oe),oe+=G.length;const Se=q(Z,ae+4,oe);Z[oe]=Se>>24&255,Z[oe+1]=Se>>16&255,Z[oe+2]=Se>>8&255,Z[oe+3]=Se&255}function W(ne,G,Z){let ae=1,oe=0;for(let pe=G;pe<Z;++pe)ae=(ae+(ne[pe]&255))%65521,oe=(oe+ae)%65521;return oe<<16|ae}function U(ne){if(!o.isNodeJS)return Q(ne);try{let G;parseInt(process.versions.node)>=8?G=ne:G=Buffer.from(ne);const Z=require$$2.deflateSync(G,{level:9});return Z instanceof Uint8Array?Z:new Uint8Array(Z)}catch(G){(0,s.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+G)}return Q(ne)}function Q(ne){let G=ne.length;const Z=65535,ae=Math.ceil(G/Z),oe=new Uint8Array(2+G+ae*5+4);let pe=0;oe[pe++]=120,oe[pe++]=156;let Se=0;for(;G>Z;)oe[pe++]=0,oe[pe++]=255,oe[pe++]=255,oe[pe++]=0,oe[pe++]=0,oe.set(ne.subarray(Se,Se+Z),pe),pe+=Z,Se+=Z,G-=Z;oe[pe++]=1,oe[pe++]=G&255,oe[pe++]=G>>8&255,oe[pe++]=~G&65535&255,oe[pe++]=(~G&65535)>>8&255,oe.set(ne.subarray(Se),pe),pe+=ne.length-Se;const ue=W(ne,0,ne.length);return oe[pe++]=ue>>24&255,oe[pe++]=ue>>16&255,oe[pe++]=ue>>8&255,oe[pe++]=ue&255,oe}function J(ne,G,Z,ae){const oe=ne.width,pe=ne.height;let Se,ue,ee;const V=ne.data;switch(G){case s.ImageKind.GRAYSCALE_1BPP:ue=0,Se=1,ee=oe+7>>3;break;case s.ImageKind.RGB_24BPP:ue=2,Se=8,ee=oe*3;break;case s.ImageKind.RGBA_32BPP:ue=6,Se=8,ee=oe*4;break;default:throw new Error("invalid format")}const se=new Uint8Array((1+ee)*pe);let fe=0,he=0;for(let ve=0;ve<pe;++ve)se[fe++]=0,se.set(V.subarray(he,he+ee),fe),he+=ee,fe+=ee;if(G===s.ImageKind.GRAYSCALE_1BPP&&ae){fe=0;for(let ve=0;ve<pe;ve++){fe++;for(let Te=0;Te<ee;Te++)se[fe++]^=255}}const be=new Uint8Array([oe>>24&255,oe>>16&255,oe>>8&255,oe&255,pe>>24&255,pe>>16&255,pe>>8&255,pe&255,Se,ue,0,0,0]),xe=U(se),ye=N.length+j*3+be.length+xe.length,we=new Uint8Array(ye);let $e=0;return we.set(N,$e),$e+=N.length,H("IHDR",be,we,$e),$e+=j+be.length,H("IDATA",xe,we,$e),$e+=j+xe.length,H("IEND",new Uint8Array(0),we,$e),S(we,"image/png",Z)}return function(G,Z,ae){const oe=G.kind===void 0?s.ImageKind.GRAYSCALE_1BPP:G.kind;return J(G,oe,Z,ae)}}();class k{constructor(){this.fontSizeScale=1,this.fontWeight=f.fontWeight,this.fontSize=0,this.textMatrix=s.IDENTITY_MATRIX,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=s.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=f.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(j,z){this.x=j,this.y=z}}let F=0,I=0,L=0;n.SVGGraphics=l=class{constructor(N,j,z=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new k,this.transformMatrix=s.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=N,this.objs=j,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!z,this._operatorIdMapping=[];for(const q in s.OPS)this._operatorIdMapping[s.OPS[q]]=q}getObject(N,j=null){return typeof N=="string"?N.startsWith("g_")?this.commonObjs.get(N):this.objs.get(N):j}save(){this.transformStack.push(this.transformMatrix);const N=this.current;this.extraStack.push(N),this.current=N.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(N){this.save(),this.executeOpTree(N),this.restore()}loadDependencies(N){const j=N.fnArray,z=N.argsArray;for(let q=0,H=j.length;q<H;q++)if(j[q]===s.OPS.dependency)for(const W of z[q]){const U=W.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(J=>{U.get(W,J)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(N,j,z,q,H,W){const U=[N,j,z,q,H,W];this.transformMatrix=s.Util.transform(this.transformMatrix,U),this.tgrp=null}getSVG(N,j){this.viewport=j;const z=this._initialize(j);return this.loadDependencies(N).then(()=>(this.transformMatrix=s.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(N)),z))}convertOpList(N){const j=this._operatorIdMapping,z=N.argsArray,q=N.fnArray,H=[];for(let W=0,U=q.length;W<U;W++){const Q=q[W];H.push({fnId:Q,fn:j[Q],args:z[W]})}return O(H)}executeOpTree(N){for(const j of N){const z=j.fn,q=j.fnId,H=j.args;switch(q|0){case s.OPS.beginText:this.beginText();break;case s.OPS.dependency:break;case s.OPS.setLeading:this.setLeading(H);break;case s.OPS.setLeadingMoveText:this.setLeadingMoveText(H[0],H[1]);break;case s.OPS.setFont:this.setFont(H);break;case s.OPS.showText:this.showText(H[0]);break;case s.OPS.showSpacedText:this.showText(H[0]);break;case s.OPS.endText:this.endText();break;case s.OPS.moveText:this.moveText(H[0],H[1]);break;case s.OPS.setCharSpacing:this.setCharSpacing(H[0]);break;case s.OPS.setWordSpacing:this.setWordSpacing(H[0]);break;case s.OPS.setHScale:this.setHScale(H[0]);break;case s.OPS.setTextMatrix:this.setTextMatrix(H[0],H[1],H[2],H[3],H[4],H[5]);break;case s.OPS.setTextRise:this.setTextRise(H[0]);break;case s.OPS.setTextRenderingMode:this.setTextRenderingMode(H[0]);break;case s.OPS.setLineWidth:this.setLineWidth(H[0]);break;case s.OPS.setLineJoin:this.setLineJoin(H[0]);break;case s.OPS.setLineCap:this.setLineCap(H[0]);break;case s.OPS.setMiterLimit:this.setMiterLimit(H[0]);break;case s.OPS.setFillRGBColor:this.setFillRGBColor(H[0],H[1],H[2]);break;case s.OPS.setStrokeRGBColor:this.setStrokeRGBColor(H[0],H[1],H[2]);break;case s.OPS.setStrokeColorN:this.setStrokeColorN(H);break;case s.OPS.setFillColorN:this.setFillColorN(H);break;case s.OPS.shadingFill:this.shadingFill(H[0]);break;case s.OPS.setDash:this.setDash(H[0],H[1]);break;case s.OPS.setRenderingIntent:this.setRenderingIntent(H[0]);break;case s.OPS.setFlatness:this.setFlatness(H[0]);break;case s.OPS.setGState:this.setGState(H[0]);break;case s.OPS.fill:this.fill();break;case s.OPS.eoFill:this.eoFill();break;case s.OPS.stroke:this.stroke();break;case s.OPS.fillStroke:this.fillStroke();break;case s.OPS.eoFillStroke:this.eoFillStroke();break;case s.OPS.clip:this.clip("nonzero");break;case s.OPS.eoClip:this.clip("evenodd");break;case s.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.OPS.paintImageXObject:this.paintImageXObject(H[0]);break;case s.OPS.paintInlineImageXObject:this.paintInlineImageXObject(H[0]);break;case s.OPS.paintImageMaskXObject:this.paintImageMaskXObject(H[0]);break;case s.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(H[0],H[1]);break;case s.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.OPS.closePath:this.closePath();break;case s.OPS.closeStroke:this.closeStroke();break;case s.OPS.closeFillStroke:this.closeFillStroke();break;case s.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case s.OPS.nextLine:this.nextLine();break;case s.OPS.transform:this.transform(H[0],H[1],H[2],H[3],H[4],H[5]);break;case s.OPS.constructPath:this.constructPath(H[0],H[1]);break;case s.OPS.endPath:this.endPath();break;case 92:this.group(j.items);break;default:(0,s.warn)(`Unimplemented operator ${z}`);break}}}setWordSpacing(N){this.current.wordSpacing=N}setCharSpacing(N){this.current.charSpacing=N}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(N,j,z,q,H,W){const U=this.current;U.textMatrix=U.lineMatrix=[N,j,z,q,H,W],U.textMatrixScale=Math.hypot(N,j),U.x=U.lineX=0,U.y=U.lineY=0,U.xcoords=[],U.ycoords=[],U.tspan=this.svgFactory.createElement("svg:tspan"),U.tspan.setAttributeNS(null,"font-family",U.fontFamily),U.tspan.setAttributeNS(null,"font-size",`${R(U.fontSize)}px`),U.tspan.setAttributeNS(null,"y",R(-U.y)),U.txtElement=this.svgFactory.createElement("svg:text"),U.txtElement.append(U.tspan)}beginText(){const N=this.current;N.x=N.lineX=0,N.y=N.lineY=0,N.textMatrix=s.IDENTITY_MATRIX,N.lineMatrix=s.IDENTITY_MATRIX,N.textMatrixScale=1,N.tspan=this.svgFactory.createElement("svg:tspan"),N.txtElement=this.svgFactory.createElement("svg:text"),N.txtgrp=this.svgFactory.createElement("svg:g"),N.xcoords=[],N.ycoords=[]}moveText(N,j){const z=this.current;z.x=z.lineX+=N,z.y=z.lineY+=j,z.xcoords=[],z.ycoords=[],z.tspan=this.svgFactory.createElement("svg:tspan"),z.tspan.setAttributeNS(null,"font-family",z.fontFamily),z.tspan.setAttributeNS(null,"font-size",`${R(z.fontSize)}px`),z.tspan.setAttributeNS(null,"y",R(-z.y))}showText(N){const j=this.current,z=j.font,q=j.fontSize;if(q===0)return;const H=j.fontSizeScale,W=j.charSpacing,U=j.wordSpacing,Q=j.fontDirection,J=j.textHScale*Q,ne=z.vertical,G=ne?1:-1,Z=z.defaultVMetrics,ae=q*j.fontMatrix[0];let oe=0;for(const ue of N){if(ue===null){oe+=Q*U;continue}else if(typeof ue=="number"){oe+=G*ue*q/1e3;continue}const ee=(ue.isSpace?U:0)+W,V=ue.fontChar;let se,fe,he=ue.width;if(ne){let xe;const ye=ue.vmetric||Z;xe=ue.vmetric?ye[1]:he*.5,xe=-xe*ae;const we=ye[2]*ae;he=ye?-ye[0]:he,se=xe/H,fe=(oe+we)/H}else se=oe/H,fe=0;(ue.isInFont||z.missingFile)&&(j.xcoords.push(j.x+se),ne&&j.ycoords.push(-j.y+fe),j.tspan.textContent+=V);let be;ne?be=he*ae-ee*Q:be=he*ae+ee*Q,oe+=be}j.tspan.setAttributeNS(null,"x",j.xcoords.map(R).join(" ")),ne?j.tspan.setAttributeNS(null,"y",j.ycoords.map(R).join(" ")):j.tspan.setAttributeNS(null,"y",R(-j.y)),ne?j.y-=oe:j.x+=oe*J,j.tspan.setAttributeNS(null,"font-family",j.fontFamily),j.tspan.setAttributeNS(null,"font-size",`${R(j.fontSize)}px`),j.fontStyle!==f.fontStyle&&j.tspan.setAttributeNS(null,"font-style",j.fontStyle),j.fontWeight!==f.fontWeight&&j.tspan.setAttributeNS(null,"font-weight",j.fontWeight);const pe=j.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;if(pe===s.TextRenderingMode.FILL||pe===s.TextRenderingMode.FILL_STROKE?(j.fillColor!==f.fillColor&&j.tspan.setAttributeNS(null,"fill",j.fillColor),j.fillAlpha<1&&j.tspan.setAttributeNS(null,"fill-opacity",j.fillAlpha)):j.textRenderingMode===s.TextRenderingMode.ADD_TO_PATH?j.tspan.setAttributeNS(null,"fill","transparent"):j.tspan.setAttributeNS(null,"fill","none"),pe===s.TextRenderingMode.STROKE||pe===s.TextRenderingMode.FILL_STROKE){const ue=1/(j.textMatrixScale||1);this._setStrokeAttributes(j.tspan,ue)}let Se=j.textMatrix;j.textRise!==0&&(Se=Se.slice(),Se[5]+=j.textRise),j.txtElement.setAttributeNS(null,"transform",`${P(Se)} scale(${R(J)}, -1)`),j.txtElement.setAttributeNS(d,"xml:space","preserve"),j.txtElement.append(j.tspan),j.txtgrp.append(j.txtElement),this._ensureTransformGroup().append(j.txtElement)}setLeadingMoveText(N,j){this.setLeading(-j),this.moveText(N,j)}addFontStyle(N){if(!N.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const j=S(N.data,N.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${N.loadedName}"; src: url(${j}); }
`}setFont(N){const j=this.current,z=this.commonObjs.get(N[0]);let q=N[1];j.font=z,this.embedFonts&&!z.missingFile&&!this.embeddedFonts[z.loadedName]&&(this.addFontStyle(z),this.embeddedFonts[z.loadedName]=z),j.fontMatrix=z.fontMatrix||s.FONT_IDENTITY_MATRIX;let H="normal";z.black?H="900":z.bold&&(H="bold");const W=z.italic?"italic":"normal";q<0?(q=-q,j.fontDirection=-1):j.fontDirection=1,j.fontSize=q,j.fontFamily=z.loadedName,j.fontWeight=H,j.fontStyle=W,j.tspan=this.svgFactory.createElement("svg:tspan"),j.tspan.setAttributeNS(null,"y",R(-j.y)),j.xcoords=[],j.ycoords=[]}endText(){var j;const N=this.current;N.textRenderingMode&s.TextRenderingMode.ADD_TO_PATH_FLAG&&((j=N.txtElement)!=null&&j.hasChildNodes())&&(N.element=N.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(N){N>0&&(this.current.lineWidth=N)}setLineCap(N){this.current.lineCap=g[N]}setLineJoin(N){this.current.lineJoin=v[N]}setMiterLimit(N){this.current.miterLimit=N}setStrokeAlpha(N){this.current.strokeAlpha=N}setStrokeRGBColor(N,j,z){this.current.strokeColor=s.Util.makeHexColor(N,j,z)}setFillAlpha(N){this.current.fillAlpha=N}setFillRGBColor(N,j,z){this.current.fillColor=s.Util.makeHexColor(N,j,z),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(N){this.current.strokeColor=this._makeColorN_Pattern(N)}setFillColorN(N){this.current.fillColor=this._makeColorN_Pattern(N)}shadingFill(N){const j=this.viewport.width,z=this.viewport.height,q=s.Util.inverseTransform(this.transformMatrix),H=s.Util.applyTransform([0,0],q),W=s.Util.applyTransform([0,z],q),U=s.Util.applyTransform([j,0],q),Q=s.Util.applyTransform([j,z],q),J=Math.min(H[0],W[0],U[0],Q[0]),ne=Math.min(H[1],W[1],U[1],Q[1]),G=Math.max(H[0],W[0],U[0],Q[0]),Z=Math.max(H[1],W[1],U[1],Q[1]),ae=this.svgFactory.createElement("svg:rect");ae.setAttributeNS(null,"x",J),ae.setAttributeNS(null,"y",ne),ae.setAttributeNS(null,"width",G-J),ae.setAttributeNS(null,"height",Z-ne),ae.setAttributeNS(null,"fill",this._makeShadingPattern(N)),this.current.fillAlpha<1&&ae.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ae)}_makeColorN_Pattern(N){return N[0]==="TilingPattern"?this._makeTilingPattern(N):this._makeShadingPattern(N)}_makeTilingPattern(N){const j=N[1],z=N[2],q=N[3]||s.IDENTITY_MATRIX,[H,W,U,Q]=N[4],J=N[5],ne=N[6],G=N[7],Z=`shading${L++}`,[ae,oe,pe,Se]=s.Util.normalizeRect([...s.Util.applyTransform([H,W],q),...s.Util.applyTransform([U,Q],q)]),[ue,ee]=s.Util.singularValueDecompose2dScale(q),V=J*ue,se=ne*ee,fe=this.svgFactory.createElement("svg:pattern");fe.setAttributeNS(null,"id",Z),fe.setAttributeNS(null,"patternUnits","userSpaceOnUse"),fe.setAttributeNS(null,"width",V),fe.setAttributeNS(null,"height",se),fe.setAttributeNS(null,"x",`${ae}`),fe.setAttributeNS(null,"y",`${oe}`);const he=this.svg,be=this.transformMatrix,xe=this.current.fillColor,ye=this.current.strokeColor,we=this.svgFactory.create(pe-ae,Se-oe);if(this.svg=we,this.transformMatrix=q,G===2){const $e=s.Util.makeHexColor(...j);this.current.fillColor=$e,this.current.strokeColor=$e}return this.executeOpTree(this.convertOpList(z)),this.svg=he,this.transformMatrix=be,this.current.fillColor=xe,this.current.strokeColor=ye,fe.append(we.childNodes[0]),this.defs.append(fe),`url(#${Z})`}_makeShadingPattern(N){switch(typeof N=="string"&&(N=this.objs.get(N)),N[0]){case"RadialAxial":const j=`shading${L++}`,z=N[3];let q;switch(N[1]){case"axial":const H=N[4],W=N[5];q=this.svgFactory.createElement("svg:linearGradient"),q.setAttributeNS(null,"id",j),q.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),q.setAttributeNS(null,"x1",H[0]),q.setAttributeNS(null,"y1",H[1]),q.setAttributeNS(null,"x2",W[0]),q.setAttributeNS(null,"y2",W[1]);break;case"radial":const U=N[4],Q=N[5],J=N[6],ne=N[7];q=this.svgFactory.createElement("svg:radialGradient"),q.setAttributeNS(null,"id",j),q.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),q.setAttributeNS(null,"cx",Q[0]),q.setAttributeNS(null,"cy",Q[1]),q.setAttributeNS(null,"r",ne),q.setAttributeNS(null,"fx",U[0]),q.setAttributeNS(null,"fy",U[1]),q.setAttributeNS(null,"fr",J);break;default:throw new Error(`Unknown RadialAxial type: ${N[1]}`)}for(const H of z){const W=this.svgFactory.createElement("svg:stop");W.setAttributeNS(null,"offset",H[0]),W.setAttributeNS(null,"stop-color",H[1]),q.append(W)}return this.defs.append(q),`url(#${j})`;case"Mesh":return(0,s.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${N[0]}`)}}setDash(N,j){this.current.dashArray=N,this.current.dashPhase=j}constructPath(N,j){const z=this.current;let q=z.x,H=z.y,W=[],U=0;for(const Q of N)switch(Q|0){case s.OPS.rectangle:q=j[U++],H=j[U++];const J=j[U++],ne=j[U++],G=q+J,Z=H+ne;W.push("M",R(q),R(H),"L",R(G),R(H),"L",R(G),R(Z),"L",R(q),R(Z),"Z");break;case s.OPS.moveTo:q=j[U++],H=j[U++],W.push("M",R(q),R(H));break;case s.OPS.lineTo:q=j[U++],H=j[U++],W.push("L",R(q),R(H));break;case s.OPS.curveTo:q=j[U+4],H=j[U+5],W.push("C",R(j[U]),R(j[U+1]),R(j[U+2]),R(j[U+3]),R(q),R(H)),U+=6;break;case s.OPS.curveTo2:W.push("C",R(q),R(H),R(j[U]),R(j[U+1]),R(j[U+2]),R(j[U+3])),q=j[U+2],H=j[U+3],U+=4;break;case s.OPS.curveTo3:q=j[U+2],H=j[U+3],W.push("C",R(j[U]),R(j[U+1]),R(q),R(H),R(q),R(H)),U+=4;break;case s.OPS.closePath:W.push("Z");break}W=W.join(" "),z.path&&N.length>0&&N[0]!==s.OPS.rectangle&&N[0]!==s.OPS.moveTo?W=z.path.getAttributeNS(null,"d")+W:(z.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(z.path)),z.path.setAttributeNS(null,"d",W),z.path.setAttributeNS(null,"fill","none"),z.element=z.path,z.setCurrentPoint(q,H)}endPath(){const N=this.current;if(N.path=null,!this.pendingClip)return;if(!N.element){this.pendingClip=null;return}const j=`clippath${F++}`,z=this.svgFactory.createElement("svg:clipPath");z.setAttributeNS(null,"id",j),z.setAttributeNS(null,"transform",P(this.transformMatrix));const q=N.element.cloneNode(!0);if(this.pendingClip==="evenodd"?q.setAttributeNS(null,"clip-rule","evenodd"):q.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,z.append(q),this.defs.append(z),N.activeClipUrl){N.clipGroup=null;for(const H of this.extraStack)H.clipGroup=null;z.setAttributeNS(null,"clip-path",N.activeClipUrl)}N.activeClipUrl=`url(#${j})`,this.tgrp=null}clip(N){this.pendingClip=N}closePath(){const N=this.current;if(N.path){const j=`${N.path.getAttributeNS(null,"d")}Z`;N.path.setAttributeNS(null,"d",j)}}setLeading(N){this.current.leading=-N}setTextRise(N){this.current.textRise=N}setTextRenderingMode(N){this.current.textRenderingMode=N}setHScale(N){this.current.textHScale=N/100}setRenderingIntent(N){}setFlatness(N){}setGState(N){for(const[j,z]of N)switch(j){case"LW":this.setLineWidth(z);break;case"LC":this.setLineCap(z);break;case"LJ":this.setLineJoin(z);break;case"ML":this.setMiterLimit(z);break;case"D":this.setDash(z[0],z[1]);break;case"RI":this.setRenderingIntent(z);break;case"FL":this.setFlatness(z);break;case"Font":this.setFont(z);break;case"CA":this.setStrokeAlpha(z);break;case"ca":this.setFillAlpha(z);break;default:(0,s.warn)(`Unimplemented graphic state operator ${j}`);break}}fill(){const N=this.current;N.element&&(N.element.setAttributeNS(null,"fill",N.fillColor),N.element.setAttributeNS(null,"fill-opacity",N.fillAlpha),this.endPath())}stroke(){const N=this.current;N.element&&(this._setStrokeAttributes(N.element),N.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(N,j=1){const z=this.current;let q=z.dashArray;j!==1&&q.length>0&&(q=q.map(function(H){return j*H})),N.setAttributeNS(null,"stroke",z.strokeColor),N.setAttributeNS(null,"stroke-opacity",z.strokeAlpha),N.setAttributeNS(null,"stroke-miterlimit",R(z.miterLimit)),N.setAttributeNS(null,"stroke-linecap",z.lineCap),N.setAttributeNS(null,"stroke-linejoin",z.lineJoin),N.setAttributeNS(null,"stroke-width",R(j*z.lineWidth)+"px"),N.setAttributeNS(null,"stroke-dasharray",q.map(R).join(" ")),N.setAttributeNS(null,"stroke-dashoffset",R(j*z.dashPhase)+"px")}eoFill(){var N;(N=this.current.element)==null||N.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var N;(N=this.current.element)==null||N.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width","1px"),N.setAttributeNS(null,"height","1px"),N.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(N)}paintImageXObject(N){const j=this.getObject(N);if(!j){(0,s.warn)(`Dependent image with object ID ${N} is not ready yet`);return}this.paintInlineImageXObject(j)}paintInlineImageXObject(N,j){const z=N.width,q=N.height,H=T(N,this.forceDataSchema,!!j),W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",R(z)),W.setAttributeNS(null,"height",R(q)),this.current.element=W,this.clip("nonzero");const U=this.svgFactory.createElement("svg:image");U.setAttributeNS(p,"xlink:href",H),U.setAttributeNS(null,"x","0"),U.setAttributeNS(null,"y",R(-q)),U.setAttributeNS(null,"width",R(z)+"px"),U.setAttributeNS(null,"height",R(q)+"px"),U.setAttributeNS(null,"transform",`scale(${R(1/z)} ${R(-1/q)})`),j?j.append(U):this._ensureTransformGroup().append(U)}paintImageMaskXObject(N){const j=this.getObject(N.data,N);if(j.bitmap){(0,s.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const z=this.current,q=j.width,H=j.height,W=z.fillColor;z.maskId=`mask${I++}`;const U=this.svgFactory.createElement("svg:mask");U.setAttributeNS(null,"id",z.maskId);const Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x","0"),Q.setAttributeNS(null,"y","0"),Q.setAttributeNS(null,"width",R(q)),Q.setAttributeNS(null,"height",R(H)),Q.setAttributeNS(null,"fill",W),Q.setAttributeNS(null,"mask",`url(#${z.maskId})`),this.defs.append(U),this._ensureTransformGroup().append(Q),this.paintInlineImageXObject(j,U)}paintFormXObjectBegin(N,j){if(Array.isArray(N)&&N.length===6&&this.transform(N[0],N[1],N[2],N[3],N[4],N[5]),j){const z=j[2]-j[0],q=j[3]-j[1],H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x",j[0]),H.setAttributeNS(null,"y",j[1]),H.setAttributeNS(null,"width",R(z)),H.setAttributeNS(null,"height",R(q)),this.current.element=H,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(N){const j=this.svgFactory.create(N.width,N.height),z=this.svgFactory.createElement("svg:defs");j.append(z),this.defs=z;const q=this.svgFactory.createElement("svg:g");return q.setAttributeNS(null,"transform",P(N.transform)),j.append(q),this.svg=q,j}_ensureClipGroup(){if(!this.current.clipGroup){const N=this.svgFactory.createElement("svg:g");N.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(N),this.current.clipGroup=N}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",P(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var n=__webpack_module_cache__[e];if(n!==void 0)return n.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__w_pdfjs_require__),i.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return o.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return l.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return f.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return d.GlobalWorkerOptions}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return i.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return i.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return p.SVGGraphics}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return n.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return g.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return i.build}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return n.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return i.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return s.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return s.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return i.version}});var n=__w_pdfjs_require__(1),i=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),s=__w_pdfjs_require__(26),o=__w_pdfjs_require__(27),l=__w_pdfjs_require__(5),f=__w_pdfjs_require__(32),d=__w_pdfjs_require__(14),p=__w_pdfjs_require__(35),g=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);function create_default_slot$2(e){let n;const i=e[6].default,r=create_slot(i,e,e[12],null);return{c(){r&&r.c()},l(s){r&&r.l(s)},m(s,o){r&&r.m(s,o),n=!0},p(s,o){r&&r.p&&(!n||o&4096)&&update_slot_base(r,i,s,s[12],n?get_slot_changes(i,s[12],o,null):get_all_dirty_from_scope(s[12]),null)},i(s){n||(transition_in(r,s),n=!0)},o(s){transition_out(r,s),n=!1},d(s){r&&r.d(s)}}}function create_fragment$9(e){let n,i,r,s,o,l,f;function d(T){e[7](T)}function p(T){e[8](T)}function g(T){e[9](T)}function v(T){e[10](T)}let S={$$slots:{default:[create_default_slot$2]},$$scope:{ctx:e}};return e[0]!==void 0&&(S.name=e[0]),e[1]!==void 0&&(S.value=e[1]),e[2]!==void 0&&(S.disabled=e[2]),e[3]!==void 0&&(S.color=e[3]),i=new Radio({props:S}),binding_callbacks.push(()=>bind$3(i,"name",d)),binding_callbacks.push(()=>bind$3(i,"value",p)),binding_callbacks.push(()=>bind$3(i,"disabled",g)),binding_callbacks.push(()=>bind$3(i,"color",v)),i.$on("change",e[11]),{c(){n=element$2("div"),create_component(i.$$.fragment),this.h()},l(T){n=claim_element(T,"DIV",{class:!0});var k=children$2(n);claim_component(i.$$.fragment,k),k.forEach(detach),this.h()},h(){attr$6(n,"class",e[4])},m(T,k){insert_hydration(T,n,k),mount_component(i,n,null),f=!0},p(T,[k]){const O={};k&4096&&(O.$$scope={dirty:k,ctx:T}),!r&&k&1&&(r=!0,O.name=T[0],add_flush_callback(()=>r=!1)),!s&&k&2&&(s=!0,O.value=T[1],add_flush_callback(()=>s=!1)),!o&&k&4&&(o=!0,O.disabled=T[2],add_flush_callback(()=>o=!1)),!l&&k&8&&(l=!0,O.color=T[3],add_flush_callback(()=>l=!1)),i.$set(O),(!f||k&16)&&attr$6(n,"class",T[4])},i(T){f||(transition_in(i.$$.fragment,T),f=!0)},o(T){transition_out(i.$$.fragment,T),f=!1},d(T){T&&detach(n),destroy_component(i)}}}function instance$9(e,n,i){let{$$slots:r={},$$scope:s}=n,{name:o=""}=n,{value:l=""}=n,{disabled:f=!1}=n,{color:d="purple"}=n,{classes:p="bg-violet-50 p-2 rounded-lg w-fit"}=n;const g=createEventDispatcher();function v(R){o=R,i(0,o)}function S(R){l=R,i(1,l)}function T(R){f=R,i(2,f)}function k(R){d=R,i(3,d)}const O=R=>g("change",{detail:R.detail});return e.$$set=R=>{"name"in R&&i(0,o=R.name),"value"in R&&i(1,l=R.value),"disabled"in R&&i(2,f=R.disabled),"color"in R&&i(3,d=R.color),"classes"in R&&i(4,p=R.classes),"$$scope"in R&&i(12,s=R.$$scope)},[o,l,f,d,p,g,r,v,S,T,k,O,s]}class Radio_1 extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$9,create_fragment$9,safe_not_equal,{name:0,value:1,disabled:2,color:3,classes:4})}}function get_each_context$2(e,n,i){const r=e.slice();return r[13]=n[i],r[14]=n,r[15]=i,r}function create_default_slot$1(e){let n=e[13]+"",i,r;return{c(){i=text$3(n),r=space()},l(s){i=claim_text(s,n),r=claim_space(s)},m(s,o){insert_hydration(s,i,o),insert_hydration(s,r,o)},p(s,o){o&1&&n!==(n=s[13]+"")&&set_data(i,n)},d(s){s&&detach(i),s&&detach(r)}}}function create_each_block$2(e){let n,i,r,s,o,l;function f(T){e[8](T,e[13],e[14],e[15])}function d(T){e[9](T)}function p(T){e[10](T)}function g(T){e[11](T)}function v(...T){return e[12](e[15],...T)}let S={name:"radio-group",class:e[2]?"text-gray-400":"text-purple-500",checked:e[1]===e[15],$$slots:{default:[create_default_slot$1]},$$scope:{ctx:e}};return e[13]!==void 0&&(S.value=e[13]),e[2]!==void 0&&(S.disabled=e[2]),e[3]!==void 0&&(S.color=e[3]),e[5]!==void 0&&(S.group=e[5]),n=new Radio({props:S}),binding_callbacks.push(()=>bind$3(n,"value",f)),binding_callbacks.push(()=>bind$3(n,"disabled",d)),binding_callbacks.push(()=>bind$3(n,"color",p)),binding_callbacks.push(()=>bind$3(n,"group",g)),n.$on("change",v),{c(){create_component(n.$$.fragment)},l(T){claim_component(n.$$.fragment,T)},m(T,k){mount_component(n,T,k),l=!0},p(T,k){e=T;const O={};k&4&&(O.class=e[2]?"text-gray-400":"text-purple-500"),k&2&&(O.checked=e[1]===e[15]),k&65537&&(O.$$scope={dirty:k,ctx:e}),!i&&k&1&&(i=!0,O.value=e[13],add_flush_callback(()=>i=!1)),!r&&k&4&&(r=!0,O.disabled=e[2],add_flush_callback(()=>r=!1)),!s&&k&8&&(s=!0,O.color=e[3],add_flush_callback(()=>s=!1)),!o&&k&32&&(o=!0,O.group=e[5],add_flush_callback(()=>o=!1)),n.$set(O)},i(T){l||(transition_in(n.$$.fragment,T),l=!0)},o(T){transition_out(n.$$.fragment,T),l=!1},d(T){destroy_component(n,T)}}}function create_fragment$8(e){let n,i,r=e[0],s=[];for(let l=0;l<r.length;l+=1)s[l]=create_each_block$2(get_each_context$2(e,r,l));const o=l=>transition_out(s[l],1,1,()=>{s[l]=null});return{c(){n=element$2("div");for(let l=0;l<s.length;l+=1)s[l].c();this.h()},l(l){n=claim_element(l,"DIV",{class:!0});var f=children$2(n);for(let d=0;d<s.length;d+=1)s[d].l(f);f.forEach(detach),this.h()},h(){attr$6(n,"class",e[4])},m(l,f){insert_hydration(l,n,f);for(let d=0;d<s.length;d+=1)s[d].m(n,null);i=!0},p(l,[f]){if(f&111){r=l[0];let d;for(d=0;d<r.length;d+=1){const p=get_each_context$2(l,r,d);s[d]?(s[d].p(p,f),transition_in(s[d],1)):(s[d]=create_each_block$2(p),s[d].c(),transition_in(s[d],1),s[d].m(n,null))}for(group_outros(),d=r.length;d<s.length;d+=1)o(d);check_outros()}(!i||f&16)&&attr$6(n,"class",l[4])},i(l){if(!i){for(let f=0;f<r.length;f+=1)transition_in(s[f]);i=!0}},o(l){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)transition_out(s[f]);i=!1},d(l){l&&detach(n),destroy_each(s,l)}}}function instance$8(e,n,i){let{values:r}=n,{selected:s=void 0}=n,o=s!==void 0?r[s]:void 0,{disabled:l=!1}=n,{color:f="purple"}=n,{horizontal:d=!0}=n,{classes:p="bg-violet-50 p-2 rounded-lg w-fit"}=n;p+=d?" flex flex-row space-x-4":" flex flex-col space-y-2",console.log("selected,",s);const g=createEventDispatcher();function v(R,P,F,I){F[I]=R,i(0,r)}function S(R){l=R,i(2,l)}function T(R){f=R,i(3,f)}function k(R){o=R,i(5,o)}const O=(R,P)=>{i(1,s=R),g("change",{index:R})};return e.$$set=R=>{"values"in R&&i(0,r=R.values),"selected"in R&&i(1,s=R.selected),"disabled"in R&&i(2,l=R.disabled),"color"in R&&i(3,f=R.color),"horizontal"in R&&i(7,d=R.horizontal),"classes"in R&&i(4,p=R.classes)},[r,s,l,f,p,o,g,d,v,S,T,k,O]}class RadioGroup extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$8,create_fragment$8,safe_not_equal,{values:0,selected:1,disabled:2,color:3,horizontal:7,classes:4})}}var lib$5={},Parser$3={},Tokenizer={},decode={},decodeDataHtml={};Object.defineProperty(decodeDataHtml,"__esModule",{value:!0});decodeDataHtml.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(e){return e.charCodeAt(0)}));var decodeDataXml={};Object.defineProperty(decodeDataXml,"__esModule",{value:!0});decodeDataXml.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(e){return e.charCodeAt(0)}));var decode_codepoint={};(function(e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.replaceCodePoint=e.fromCodePoint=void 0;var i=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);e.fromCodePoint=(n=String.fromCodePoint)!==null&&n!==void 0?n:function(o){var l="";return o>65535&&(o-=65536,l+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),l+=String.fromCharCode(o),l};function r(o){var l;return o>=55296&&o<=57343||o>1114111?65533:(l=i.get(o))!==null&&l!==void 0?l:o}e.replaceCodePoint=r;function s(o){return(0,e.fromCodePoint)(r(o))}e.default=s})(decode_codepoint);(function(e){var n=commonjsGlobal&&commonjsGlobal.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(e,"__esModule",{value:!0}),e.decodeXML=e.decodeHTMLStrict=e.decodeHTML=e.determineBranch=e.BinTrieFlags=e.fromCodePoint=e.replaceCodePoint=e.decodeCodePoint=e.xmlDecodeTree=e.htmlDecodeTree=void 0;var i=n(decodeDataHtml);e.htmlDecodeTree=i.default;var r=n(decodeDataXml);e.xmlDecodeTree=r.default;var s=n(decode_codepoint);e.decodeCodePoint=s.default;var o=decode_codepoint;Object.defineProperty(e,"replaceCodePoint",{enumerable:!0,get:function(){return o.replaceCodePoint}}),Object.defineProperty(e,"fromCodePoint",{enumerable:!0,get:function(){return o.fromCodePoint}});var l;(function(O){O[O.NUM=35]="NUM",O[O.SEMI=59]="SEMI",O[O.ZERO=48]="ZERO",O[O.NINE=57]="NINE",O[O.LOWER_A=97]="LOWER_A",O[O.LOWER_F=102]="LOWER_F",O[O.LOWER_X=120]="LOWER_X",O[O.To_LOWER_BIT=32]="To_LOWER_BIT"})(l||(l={}));var f;(function(O){O[O.VALUE_LENGTH=49152]="VALUE_LENGTH",O[O.BRANCH_LENGTH=16256]="BRANCH_LENGTH",O[O.JUMP_TABLE=127]="JUMP_TABLE"})(f=e.BinTrieFlags||(e.BinTrieFlags={}));function d(O){return function(P,F){for(var I="",L=0,N=0;(N=P.indexOf("&",N))>=0;){if(I+=P.slice(L,N),L=N,N+=1,P.charCodeAt(N)===l.NUM){var j=N+1,z=10,q=P.charCodeAt(j);(q|l.To_LOWER_BIT)===l.LOWER_X&&(z=16,N+=1,j+=1);do q=P.charCodeAt(++N);while(q>=l.ZERO&&q<=l.NINE||z===16&&(q|l.To_LOWER_BIT)>=l.LOWER_A&&(q|l.To_LOWER_BIT)<=l.LOWER_F);if(j!==N){var H=P.substring(j,N),W=parseInt(H,z);if(P.charCodeAt(N)===l.SEMI)N+=1;else if(F)continue;I+=(0,s.default)(W),L=N}continue}for(var U=0,Q=1,J=0,ne=O[J];N<P.length&&(J=p(O,ne,J+1,P.charCodeAt(N)),!(J<0));N++,Q++){ne=O[J];var G=ne&f.VALUE_LENGTH;if(G){(!F||P.charCodeAt(N)===l.SEMI)&&(U=J,Q=0);var Z=(G>>14)-1;if(Z===0)break;J+=Z}}if(U!==0){var Z=(O[U]&f.VALUE_LENGTH)>>14;I+=Z===1?String.fromCharCode(O[U]&~f.VALUE_LENGTH):Z===2?String.fromCharCode(O[U+1]):String.fromCharCode(O[U+1],O[U+2]),L=N-Q+1}}return I+P.slice(L)}}function p(O,R,P,F){var I=(R&f.BRANCH_LENGTH)>>7,L=R&f.JUMP_TABLE;if(I===0)return L!==0&&F===L?P:-1;if(L){var N=F-L;return N<0||N>=I?-1:O[P+N]-1}for(var j=P,z=j+I-1;j<=z;){var q=j+z>>>1,H=O[q];if(H<F)j=q+1;else if(H>F)z=q-1;else return O[q+I]}return-1}e.determineBranch=p;var g=d(i.default),v=d(r.default);function S(O){return g(O,!1)}e.decodeHTML=S;function T(O){return g(O,!0)}e.decodeHTMLStrict=T;function k(O){return v(O,!0)}e.decodeXML=k})(decode);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.QuoteType=void 0;var n=decode,i;(function(S){S[S.Tab=9]="Tab",S[S.NewLine=10]="NewLine",S[S.FormFeed=12]="FormFeed",S[S.CarriageReturn=13]="CarriageReturn",S[S.Space=32]="Space",S[S.ExclamationMark=33]="ExclamationMark",S[S.Num=35]="Num",S[S.Amp=38]="Amp",S[S.SingleQuote=39]="SingleQuote",S[S.DoubleQuote=34]="DoubleQuote",S[S.Dash=45]="Dash",S[S.Slash=47]="Slash",S[S.Zero=48]="Zero",S[S.Nine=57]="Nine",S[S.Semi=59]="Semi",S[S.Lt=60]="Lt",S[S.Eq=61]="Eq",S[S.Gt=62]="Gt",S[S.Questionmark=63]="Questionmark",S[S.UpperA=65]="UpperA",S[S.LowerA=97]="LowerA",S[S.UpperF=70]="UpperF",S[S.LowerF=102]="LowerF",S[S.UpperZ=90]="UpperZ",S[S.LowerZ=122]="LowerZ",S[S.LowerX=120]="LowerX",S[S.OpeningSquareBracket=91]="OpeningSquareBracket"})(i||(i={}));var r;(function(S){S[S.Text=1]="Text",S[S.BeforeTagName=2]="BeforeTagName",S[S.InTagName=3]="InTagName",S[S.InSelfClosingTag=4]="InSelfClosingTag",S[S.BeforeClosingTagName=5]="BeforeClosingTagName",S[S.InClosingTagName=6]="InClosingTagName",S[S.AfterClosingTagName=7]="AfterClosingTagName",S[S.BeforeAttributeName=8]="BeforeAttributeName",S[S.InAttributeName=9]="InAttributeName",S[S.AfterAttributeName=10]="AfterAttributeName",S[S.BeforeAttributeValue=11]="BeforeAttributeValue",S[S.InAttributeValueDq=12]="InAttributeValueDq",S[S.InAttributeValueSq=13]="InAttributeValueSq",S[S.InAttributeValueNq=14]="InAttributeValueNq",S[S.BeforeDeclaration=15]="BeforeDeclaration",S[S.InDeclaration=16]="InDeclaration",S[S.InProcessingInstruction=17]="InProcessingInstruction",S[S.BeforeComment=18]="BeforeComment",S[S.CDATASequence=19]="CDATASequence",S[S.InSpecialComment=20]="InSpecialComment",S[S.InCommentLike=21]="InCommentLike",S[S.BeforeSpecialS=22]="BeforeSpecialS",S[S.SpecialStartSequence=23]="SpecialStartSequence",S[S.InSpecialTag=24]="InSpecialTag",S[S.BeforeEntity=25]="BeforeEntity",S[S.BeforeNumericEntity=26]="BeforeNumericEntity",S[S.InNamedEntity=27]="InNamedEntity",S[S.InNumericEntity=28]="InNumericEntity",S[S.InHexEntity=29]="InHexEntity"})(r||(r={}));function s(S){return S===i.Space||S===i.NewLine||S===i.Tab||S===i.FormFeed||S===i.CarriageReturn}function o(S){return S===i.Slash||S===i.Gt||s(S)}function l(S){return S>=i.Zero&&S<=i.Nine}function f(S){return S>=i.LowerA&&S<=i.LowerZ||S>=i.UpperA&&S<=i.UpperZ}function d(S){return S>=i.UpperA&&S<=i.UpperF||S>=i.LowerA&&S<=i.LowerF}var p;(function(S){S[S.NoValue=0]="NoValue",S[S.Unquoted=1]="Unquoted",S[S.Single=2]="Single",S[S.Double=3]="Double"})(p=e.QuoteType||(e.QuoteType={}));var g={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},v=function(){function S(T,k){var O=T.xmlMode,R=O===void 0?!1:O,P=T.decodeEntities,F=P===void 0?!0:P;this.cbs=k,this.state=r.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=r.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=R,this.decodeEntities=F,this.entityTrie=R?n.xmlDecodeTree:n.htmlDecodeTree}return S.prototype.reset=function(){this.state=r.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=r.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},S.prototype.write=function(T){this.offset+=this.buffer.length,this.buffer=T,this.parse()},S.prototype.end=function(){this.running&&this.finish()},S.prototype.pause=function(){this.running=!1},S.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},S.prototype.getIndex=function(){return this.index},S.prototype.getSectionStart=function(){return this.sectionStart},S.prototype.stateText=function(T){T===i.Lt||!this.decodeEntities&&this.fastForwardTo(i.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=r.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&T===i.Amp&&(this.state=r.BeforeEntity)},S.prototype.stateSpecialStartSequence=function(T){var k=this.sequenceIndex===this.currentSequence.length,O=k?o(T):(T|32)===this.currentSequence[this.sequenceIndex];if(!O)this.isSpecial=!1;else if(!k){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=r.InTagName,this.stateInTagName(T)},S.prototype.stateInSpecialTag=function(T){if(this.sequenceIndex===this.currentSequence.length){if(T===i.Gt||s(T)){var k=this.index-this.currentSequence.length;if(this.sectionStart<k){var O=this.index;this.index=k,this.cbs.ontext(this.sectionStart,k),this.index=O}this.isSpecial=!1,this.sectionStart=k+2,this.stateInClosingTagName(T);return}this.sequenceIndex=0}(T|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===g.TitleEnd?this.decodeEntities&&T===i.Amp&&(this.state=r.BeforeEntity):this.fastForwardTo(i.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(T===i.Lt)},S.prototype.stateCDATASequence=function(T){T===g.Cdata[this.sequenceIndex]?++this.sequenceIndex===g.Cdata.length&&(this.state=r.InCommentLike,this.currentSequence=g.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=r.InDeclaration,this.stateInDeclaration(T))},S.prototype.fastForwardTo=function(T){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===T)return!0;return this.index=this.buffer.length+this.offset-1,!1},S.prototype.stateInCommentLike=function(T){T===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===g.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=r.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):T!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},S.prototype.isTagStartChar=function(T){return this.xmlMode?!o(T):f(T)},S.prototype.startSpecial=function(T,k){this.isSpecial=!0,this.currentSequence=T,this.sequenceIndex=k,this.state=r.SpecialStartSequence},S.prototype.stateBeforeTagName=function(T){if(T===i.ExclamationMark)this.state=r.BeforeDeclaration,this.sectionStart=this.index+1;else if(T===i.Questionmark)this.state=r.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(T)){var k=T|32;this.sectionStart=this.index,!this.xmlMode&&k===g.TitleEnd[2]?this.startSpecial(g.TitleEnd,3):this.state=!this.xmlMode&&k===g.ScriptEnd[2]?r.BeforeSpecialS:r.InTagName}else T===i.Slash?this.state=r.BeforeClosingTagName:(this.state=r.Text,this.stateText(T))},S.prototype.stateInTagName=function(T){o(T)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(T))},S.prototype.stateBeforeClosingTagName=function(T){s(T)||(T===i.Gt?this.state=r.Text:(this.state=this.isTagStartChar(T)?r.InClosingTagName:r.InSpecialComment,this.sectionStart=this.index))},S.prototype.stateInClosingTagName=function(T){(T===i.Gt||s(T))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=r.AfterClosingTagName,this.stateAfterClosingTagName(T))},S.prototype.stateAfterClosingTagName=function(T){(T===i.Gt||this.fastForwardTo(i.Gt))&&(this.state=r.Text,this.sectionStart=this.index+1)},S.prototype.stateBeforeAttributeName=function(T){T===i.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=r.InSpecialTag,this.sequenceIndex=0):this.state=r.Text,this.baseState=this.state,this.sectionStart=this.index+1):T===i.Slash?this.state=r.InSelfClosingTag:s(T)||(this.state=r.InAttributeName,this.sectionStart=this.index)},S.prototype.stateInSelfClosingTag=function(T){T===i.Gt?(this.cbs.onselfclosingtag(this.index),this.state=r.Text,this.baseState=r.Text,this.sectionStart=this.index+1,this.isSpecial=!1):s(T)||(this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(T))},S.prototype.stateInAttributeName=function(T){(T===i.Eq||o(T))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=r.AfterAttributeName,this.stateAfterAttributeName(T))},S.prototype.stateAfterAttributeName=function(T){T===i.Eq?this.state=r.BeforeAttributeValue:T===i.Slash||T===i.Gt?(this.cbs.onattribend(p.NoValue,this.index),this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(T)):s(T)||(this.cbs.onattribend(p.NoValue,this.index),this.state=r.InAttributeName,this.sectionStart=this.index)},S.prototype.stateBeforeAttributeValue=function(T){T===i.DoubleQuote?(this.state=r.InAttributeValueDq,this.sectionStart=this.index+1):T===i.SingleQuote?(this.state=r.InAttributeValueSq,this.sectionStart=this.index+1):s(T)||(this.sectionStart=this.index,this.state=r.InAttributeValueNq,this.stateInAttributeValueNoQuotes(T))},S.prototype.handleInAttributeValue=function(T,k){T===k||!this.decodeEntities&&this.fastForwardTo(k)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(k===i.DoubleQuote?p.Double:p.Single,this.index),this.state=r.BeforeAttributeName):this.decodeEntities&&T===i.Amp&&(this.baseState=this.state,this.state=r.BeforeEntity)},S.prototype.stateInAttributeValueDoubleQuotes=function(T){this.handleInAttributeValue(T,i.DoubleQuote)},S.prototype.stateInAttributeValueSingleQuotes=function(T){this.handleInAttributeValue(T,i.SingleQuote)},S.prototype.stateInAttributeValueNoQuotes=function(T){s(T)||T===i.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(p.Unquoted,this.index),this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(T)):this.decodeEntities&&T===i.Amp&&(this.baseState=this.state,this.state=r.BeforeEntity)},S.prototype.stateBeforeDeclaration=function(T){T===i.OpeningSquareBracket?(this.state=r.CDATASequence,this.sequenceIndex=0):this.state=T===i.Dash?r.BeforeComment:r.InDeclaration},S.prototype.stateInDeclaration=function(T){(T===i.Gt||this.fastForwardTo(i.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=r.Text,this.sectionStart=this.index+1)},S.prototype.stateInProcessingInstruction=function(T){(T===i.Gt||this.fastForwardTo(i.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=r.Text,this.sectionStart=this.index+1)},S.prototype.stateBeforeComment=function(T){T===i.Dash?(this.state=r.InCommentLike,this.currentSequence=g.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=r.InDeclaration},S.prototype.stateInSpecialComment=function(T){(T===i.Gt||this.fastForwardTo(i.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=r.Text,this.sectionStart=this.index+1)},S.prototype.stateBeforeSpecialS=function(T){var k=T|32;k===g.ScriptEnd[3]?this.startSpecial(g.ScriptEnd,4):k===g.StyleEnd[3]?this.startSpecial(g.StyleEnd,4):(this.state=r.InTagName,this.stateInTagName(T))},S.prototype.stateBeforeEntity=function(T){this.entityExcess=1,this.entityResult=0,T===i.Num?this.state=r.BeforeNumericEntity:T===i.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=r.InNamedEntity,this.stateInNamedEntity(T))},S.prototype.stateInNamedEntity=function(T){if(this.entityExcess+=1,this.trieIndex=(0,n.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,T),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var k=this.trieCurrent&n.BinTrieFlags.VALUE_LENGTH;if(k){var O=(k>>14)-1;if(!this.allowLegacyEntity()&&T!==i.Semi)this.trieIndex+=O;else{var R=this.index-this.entityExcess+1;R>this.sectionStart&&this.emitPartial(this.sectionStart,R),this.entityResult=this.trieIndex,this.trieIndex+=O,this.entityExcess=0,this.sectionStart=this.index+1,O===0&&this.emitNamedEntity()}}},S.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var T=(this.entityTrie[this.entityResult]&n.BinTrieFlags.VALUE_LENGTH)>>14;switch(T){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~n.BinTrieFlags.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},S.prototype.stateBeforeNumericEntity=function(T){(T|32)===i.LowerX?(this.entityExcess++,this.state=r.InHexEntity):(this.state=r.InNumericEntity,this.stateInNumericEntity(T))},S.prototype.emitNumericEntity=function(T){var k=this.index-this.entityExcess-1,O=k+2+Number(this.state===r.InHexEntity);O!==this.index&&(k>this.sectionStart&&this.emitPartial(this.sectionStart,k),this.sectionStart=this.index+Number(T),this.emitCodePoint((0,n.replaceCodePoint)(this.entityResult))),this.state=this.baseState},S.prototype.stateInNumericEntity=function(T){T===i.Semi?this.emitNumericEntity(!0):l(T)?(this.entityResult=this.entityResult*10+(T-i.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},S.prototype.stateInHexEntity=function(T){T===i.Semi?this.emitNumericEntity(!0):l(T)?(this.entityResult=this.entityResult*16+(T-i.Zero),this.entityExcess++):d(T)?(this.entityResult=this.entityResult*16+((T|32)-i.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},S.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===r.Text||this.baseState===r.InSpecialTag)},S.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===r.Text||this.state===r.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===r.InAttributeValueDq||this.state===r.InAttributeValueSq||this.state===r.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},S.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},S.prototype.parse=function(){for(;this.shouldContinue();){var T=this.buffer.charCodeAt(this.index-this.offset);this.state===r.Text?this.stateText(T):this.state===r.SpecialStartSequence?this.stateSpecialStartSequence(T):this.state===r.InSpecialTag?this.stateInSpecialTag(T):this.state===r.CDATASequence?this.stateCDATASequence(T):this.state===r.InAttributeValueDq?this.stateInAttributeValueDoubleQuotes(T):this.state===r.InAttributeName?this.stateInAttributeName(T):this.state===r.InCommentLike?this.stateInCommentLike(T):this.state===r.InSpecialComment?this.stateInSpecialComment(T):this.state===r.BeforeAttributeName?this.stateBeforeAttributeName(T):this.state===r.InTagName?this.stateInTagName(T):this.state===r.InClosingTagName?this.stateInClosingTagName(T):this.state===r.BeforeTagName?this.stateBeforeTagName(T):this.state===r.AfterAttributeName?this.stateAfterAttributeName(T):this.state===r.InAttributeValueSq?this.stateInAttributeValueSingleQuotes(T):this.state===r.BeforeAttributeValue?this.stateBeforeAttributeValue(T):this.state===r.BeforeClosingTagName?this.stateBeforeClosingTagName(T):this.state===r.AfterClosingTagName?this.stateAfterClosingTagName(T):this.state===r.BeforeSpecialS?this.stateBeforeSpecialS(T):this.state===r.InAttributeValueNq?this.stateInAttributeValueNoQuotes(T):this.state===r.InSelfClosingTag?this.stateInSelfClosingTag(T):this.state===r.InDeclaration?this.stateInDeclaration(T):this.state===r.BeforeDeclaration?this.stateBeforeDeclaration(T):this.state===r.BeforeComment?this.stateBeforeComment(T):this.state===r.InProcessingInstruction?this.stateInProcessingInstruction(T):this.state===r.InNamedEntity?this.stateInNamedEntity(T):this.state===r.BeforeEntity?this.stateBeforeEntity(T):this.state===r.InHexEntity?this.stateInHexEntity(T):this.state===r.InNumericEntity?this.stateInNumericEntity(T):this.stateBeforeNumericEntity(T),this.index++}this.cleanup()},S.prototype.finish=function(){this.state===r.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},S.prototype.handleTrailingData=function(){var T=this.buffer.length+this.offset;this.state===r.InCommentLike?this.currentSequence===g.CdataEnd?this.cbs.oncdata(this.sectionStart,T,0):this.cbs.oncomment(this.sectionStart,T,0):this.state===r.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===r.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===r.InTagName||this.state===r.BeforeAttributeName||this.state===r.BeforeAttributeValue||this.state===r.AfterAttributeName||this.state===r.InAttributeName||this.state===r.InAttributeValueSq||this.state===r.InAttributeValueDq||this.state===r.InAttributeValueNq||this.state===r.InClosingTagName||this.cbs.ontext(this.sectionStart,T)},S.prototype.emitPartial=function(T,k){this.baseState!==r.Text&&this.baseState!==r.InSpecialTag?this.cbs.onattribdata(T,k):this.cbs.ontext(T,k)},S.prototype.emitCodePoint=function(T){this.baseState!==r.Text&&this.baseState!==r.InSpecialTag?this.cbs.onattribentity(T):this.cbs.ontextentity(T)},S}();e.default=v})(Tokenizer);var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,n,i,r){r===void 0&&(r=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(e,r,s)}:function(e,n,i,r){r===void 0&&(r=i),e[r]=n[i]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding$1(n,e,i);return __setModuleDefault$1(n,e),n};Object.defineProperty(Parser$3,"__esModule",{value:!0});Parser$3.Parser=void 0;var Tokenizer_js_1=__importStar$1(Tokenizer),decode_js_1=decode,formTags=new Set(["input","option","optgroup","select","button","datalist","textarea"]),pTag=new Set(["p"]),tableSectionTags=new Set(["thead","tbody"]),ddtTags=new Set(["dd","dt"]),rtpTags=new Set(["rt","rp"]),openImpliesClose=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",pTag],["h1",pTag],["h2",pTag],["h3",pTag],["h4",pTag],["h5",pTag],["h6",pTag],["select",formTags],["input",formTags],["output",formTags],["button",formTags],["datalist",formTags],["textarea",formTags],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",ddtTags],["dt",ddtTags],["address",pTag],["article",pTag],["aside",pTag],["blockquote",pTag],["details",pTag],["div",pTag],["dl",pTag],["fieldset",pTag],["figcaption",pTag],["figure",pTag],["footer",pTag],["form",pTag],["header",pTag],["hr",pTag],["main",pTag],["nav",pTag],["ol",pTag],["pre",pTag],["section",pTag],["table",pTag],["ul",pTag],["rt",rtpTags],["rp",rtpTags],["tbody",tableSectionTags],["tfoot",tableSectionTags]]),voidElements=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),foreignContextElements=new Set(["math","svg"]),htmlIntegrationElements=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),reNameEnd=/\s|\//,Parser$2=function(){function e(n,i){i===void 0&&(i={});var r,s,o,l,f;this.options=i,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=n??{},this.lowerCaseTagNames=(r=i.lowerCaseTags)!==null&&r!==void 0?r:!i.xmlMode,this.lowerCaseAttributeNames=(s=i.lowerCaseAttributeNames)!==null&&s!==void 0?s:!i.xmlMode,this.tokenizer=new((o=i.Tokenizer)!==null&&o!==void 0?o:Tokenizer_js_1.default)(this.options,this),(f=(l=this.cbs).onparserinit)===null||f===void 0||f.call(l,this)}return e.prototype.ontext=function(n,i){var r,s,o=this.getSlice(n,i);this.endIndex=i-1,(s=(r=this.cbs).ontext)===null||s===void 0||s.call(r,o),this.startIndex=i},e.prototype.ontextentity=function(n){var i,r,s=this.tokenizer.getSectionStart();this.endIndex=s-1,(r=(i=this.cbs).ontext)===null||r===void 0||r.call(i,(0,decode_js_1.fromCodePoint)(n)),this.startIndex=s},e.prototype.isVoidElement=function(n){return!this.options.xmlMode&&voidElements.has(n)},e.prototype.onopentagname=function(n,i){this.endIndex=i;var r=this.getSlice(n,i);this.lowerCaseTagNames&&(r=r.toLowerCase()),this.emitOpenTag(r)},e.prototype.emitOpenTag=function(n){var i,r,s,o;this.openTagStart=this.startIndex,this.tagname=n;var l=!this.options.xmlMode&&openImpliesClose.get(n);if(l)for(;this.stack.length>0&&l.has(this.stack[this.stack.length-1]);){var f=this.stack.pop();(r=(i=this.cbs).onclosetag)===null||r===void 0||r.call(i,f,!0)}this.isVoidElement(n)||(this.stack.push(n),foreignContextElements.has(n)?this.foreignContext.push(!0):htmlIntegrationElements.has(n)&&this.foreignContext.push(!1)),(o=(s=this.cbs).onopentagname)===null||o===void 0||o.call(s,n),this.cbs.onopentag&&(this.attribs={})},e.prototype.endOpenTag=function(n){var i,r;this.startIndex=this.openTagStart,this.attribs&&((r=(i=this.cbs).onopentag)===null||r===void 0||r.call(i,this.tagname,this.attribs,n),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},e.prototype.onopentagend=function(n){this.endIndex=n,this.endOpenTag(!1),this.startIndex=n+1},e.prototype.onclosetag=function(n,i){var r,s,o,l,f,d;this.endIndex=i;var p=this.getSlice(n,i);if(this.lowerCaseTagNames&&(p=p.toLowerCase()),(foreignContextElements.has(p)||htmlIntegrationElements.has(p))&&this.foreignContext.pop(),this.isVoidElement(p))!this.options.xmlMode&&p==="br"&&((s=(r=this.cbs).onopentagname)===null||s===void 0||s.call(r,"br"),(l=(o=this.cbs).onopentag)===null||l===void 0||l.call(o,"br",{},!0),(d=(f=this.cbs).onclosetag)===null||d===void 0||d.call(f,"br",!1));else{var g=this.stack.lastIndexOf(p);if(g!==-1)if(this.cbs.onclosetag)for(var v=this.stack.length-g;v--;)this.cbs.onclosetag(this.stack.pop(),v!==0);else this.stack.length=g;else!this.options.xmlMode&&p==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=i+1},e.prototype.onselfclosingtag=function(n){this.endIndex=n,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=n+1):this.onopentagend(n)},e.prototype.closeCurrentTag=function(n){var i,r,s=this.tagname;this.endOpenTag(n),this.stack[this.stack.length-1]===s&&((r=(i=this.cbs).onclosetag)===null||r===void 0||r.call(i,s,!n),this.stack.pop())},e.prototype.onattribname=function(n,i){this.startIndex=n;var r=this.getSlice(n,i);this.attribname=this.lowerCaseAttributeNames?r.toLowerCase():r},e.prototype.onattribdata=function(n,i){this.attribvalue+=this.getSlice(n,i)},e.prototype.onattribentity=function(n){this.attribvalue+=(0,decode_js_1.fromCodePoint)(n)},e.prototype.onattribend=function(n,i){var r,s;this.endIndex=i,(s=(r=this.cbs).onattribute)===null||s===void 0||s.call(r,this.attribname,this.attribvalue,n===Tokenizer_js_1.QuoteType.Double?'"':n===Tokenizer_js_1.QuoteType.Single?"'":n===Tokenizer_js_1.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},e.prototype.getInstructionName=function(n){var i=n.search(reNameEnd),r=i<0?n:n.substr(0,i);return this.lowerCaseTagNames&&(r=r.toLowerCase()),r},e.prototype.ondeclaration=function(n,i){this.endIndex=i;var r=this.getSlice(n,i);if(this.cbs.onprocessinginstruction){var s=this.getInstructionName(r);this.cbs.onprocessinginstruction("!".concat(s),"!".concat(r))}this.startIndex=i+1},e.prototype.onprocessinginstruction=function(n,i){this.endIndex=i;var r=this.getSlice(n,i);if(this.cbs.onprocessinginstruction){var s=this.getInstructionName(r);this.cbs.onprocessinginstruction("?".concat(s),"?".concat(r))}this.startIndex=i+1},e.prototype.oncomment=function(n,i,r){var s,o,l,f;this.endIndex=i,(o=(s=this.cbs).oncomment)===null||o===void 0||o.call(s,this.getSlice(n,i-r)),(f=(l=this.cbs).oncommentend)===null||f===void 0||f.call(l),this.startIndex=i+1},e.prototype.oncdata=function(n,i,r){var s,o,l,f,d,p,g,v,S,T;this.endIndex=i;var k=this.getSlice(n,i-r);this.options.xmlMode||this.options.recognizeCDATA?((o=(s=this.cbs).oncdatastart)===null||o===void 0||o.call(s),(f=(l=this.cbs).ontext)===null||f===void 0||f.call(l,k),(p=(d=this.cbs).oncdataend)===null||p===void 0||p.call(d)):((v=(g=this.cbs).oncomment)===null||v===void 0||v.call(g,"[CDATA[".concat(k,"]]")),(T=(S=this.cbs).oncommentend)===null||T===void 0||T.call(S)),this.startIndex=i+1},e.prototype.onend=function(){var n,i;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var r=this.stack.length;r>0;this.cbs.onclosetag(this.stack[--r],!0));}(i=(n=this.cbs).onend)===null||i===void 0||i.call(n)},e.prototype.reset=function(){var n,i,r,s;(i=(n=this.cbs).onreset)===null||i===void 0||i.call(n),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(s=(r=this.cbs).onparserinit)===null||s===void 0||s.call(r,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},e.prototype.parseComplete=function(n){this.reset(),this.end(n)},e.prototype.getSlice=function(n,i){for(;n-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var r=this.buffers[0].slice(n-this.bufferOffset,i-this.bufferOffset);i-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),r+=this.buffers[0].slice(0,i-this.bufferOffset);return r},e.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},e.prototype.write=function(n){var i,r;if(this.ended){(r=(i=this.cbs).onerror)===null||r===void 0||r.call(i,new Error(".write() after done!"));return}this.buffers.push(n),this.tokenizer.running&&(this.tokenizer.write(n),this.writeIndex++)},e.prototype.end=function(n){var i,r;if(this.ended){(r=(i=this.cbs).onerror)===null||r===void 0||r.call(i,Error(".end() after done!"));return}n&&this.write(n),this.ended=!0,this.tokenizer.end()},e.prototype.pause=function(){this.tokenizer.pause()},e.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},e.prototype.parseChunk=function(n){this.write(n)},e.prototype.done=function(n){this.end(n)},e}();Parser$3.Parser=Parser$2;var lib$4={},lib$3={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Doctype=e.CDATA=e.Tag=e.Style=e.Script=e.Comment=e.Directive=e.Text=e.Root=e.isTag=e.ElementType=void 0;var n;(function(r){r.Root="root",r.Text="text",r.Directive="directive",r.Comment="comment",r.Script="script",r.Style="style",r.Tag="tag",r.CDATA="cdata",r.Doctype="doctype"})(n=e.ElementType||(e.ElementType={}));function i(r){return r.type===n.Tag||r.type===n.Script||r.type===n.Style}e.isTag=i,e.Root=n.Root,e.Text=n.Text,e.Directive=n.Directive,e.Comment=n.Comment,e.Script=n.Script,e.Style=n.Style,e.Tag=n.Tag,e.CDATA=n.CDATA,e.Doctype=n.Doctype})(lib$3);var node$1={},__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(){var e=function(n,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])},e(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(n,i);function r(){this.constructor=n}n.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign$1=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$1=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},__assign$1.apply(this,arguments)};Object.defineProperty(node$1,"__esModule",{value:!0});node$1.cloneNode=node$1.hasChildren=node$1.isDocument=node$1.isDirective=node$1.isComment=node$1.isText=node$1.isCDATA=node$1.isTag=node$1.Element=node$1.Document=node$1.CDATA=node$1.NodeWithChildren=node$1.ProcessingInstruction=node$1.Comment=node$1.Text=node$1.DataNode=node$1.Node=void 0;var domelementtype_1$1=lib$3,Node$8=function(){function e(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent},set:function(n){this.parent=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this.prev},set:function(n){this.prev=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this.next},set:function(n){this.next=n},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(n){return n===void 0&&(n=!1),cloneNode$1(this,n)},e}();node$1.Node=Node$8;var DataNode=function(e){__extends$1(n,e);function n(i){var r=e.call(this)||this;return r.data=i,r}return Object.defineProperty(n.prototype,"nodeValue",{get:function(){return this.data},set:function(i){this.data=i},enumerable:!1,configurable:!0}),n}(Node$8);node$1.DataNode=DataNode;var Text$1=function(e){__extends$1(n,e);function n(){var i=e!==null&&e.apply(this,arguments)||this;return i.type=domelementtype_1$1.ElementType.Text,i}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),n}(DataNode);node$1.Text=Text$1;var Comment$5=function(e){__extends$1(n,e);function n(){var i=e!==null&&e.apply(this,arguments)||this;return i.type=domelementtype_1$1.ElementType.Comment,i}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),n}(DataNode);node$1.Comment=Comment$5;var ProcessingInstruction=function(e){__extends$1(n,e);function n(i,r){var s=e.call(this,r)||this;return s.name=i,s.type=domelementtype_1$1.ElementType.Directive,s}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),n}(DataNode);node$1.ProcessingInstruction=ProcessingInstruction;var NodeWithChildren=function(e){__extends$1(n,e);function n(i){var r=e.call(this)||this;return r.children=i,r}return Object.defineProperty(n.prototype,"firstChild",{get:function(){var i;return(i=this.children[0])!==null&&i!==void 0?i:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"childNodes",{get:function(){return this.children},set:function(i){this.children=i},enumerable:!1,configurable:!0}),n}(Node$8);node$1.NodeWithChildren=NodeWithChildren;var CDATA=function(e){__extends$1(n,e);function n(){var i=e!==null&&e.apply(this,arguments)||this;return i.type=domelementtype_1$1.ElementType.CDATA,i}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),n}(NodeWithChildren);node$1.CDATA=CDATA;var Document$4=function(e){__extends$1(n,e);function n(){var i=e!==null&&e.apply(this,arguments)||this;return i.type=domelementtype_1$1.ElementType.Root,i}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),n}(NodeWithChildren);node$1.Document=Document$4;var Element$1=function(e){__extends$1(n,e);function n(i,r,s,o){s===void 0&&(s=[]),o===void 0&&(o=i==="script"?domelementtype_1$1.ElementType.Script:i==="style"?domelementtype_1$1.ElementType.Style:domelementtype_1$1.ElementType.Tag);var l=e.call(this,s)||this;return l.name=i,l.attribs=r,l.type=o,l}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tagName",{get:function(){return this.name},set:function(i){this.name=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"attributes",{get:function(){var i=this;return Object.keys(this.attribs).map(function(r){var s,o;return{name:r,value:i.attribs[r],namespace:(s=i["x-attribsNamespace"])===null||s===void 0?void 0:s[r],prefix:(o=i["x-attribsPrefix"])===null||o===void 0?void 0:o[r]}})},enumerable:!1,configurable:!0}),n}(NodeWithChildren);node$1.Element=Element$1;function isTag(e){return(0,domelementtype_1$1.isTag)(e)}node$1.isTag=isTag;function isCDATA(e){return e.type===domelementtype_1$1.ElementType.CDATA}node$1.isCDATA=isCDATA;function isText$1(e){return e.type===domelementtype_1$1.ElementType.Text}node$1.isText=isText$1;function isComment(e){return e.type===domelementtype_1$1.ElementType.Comment}node$1.isComment=isComment;function isDirective(e){return e.type===domelementtype_1$1.ElementType.Directive}node$1.isDirective=isDirective;function isDocument(e){return e.type===domelementtype_1$1.ElementType.Root}node$1.isDocument=isDocument;function hasChildren(e){return Object.prototype.hasOwnProperty.call(e,"children")}node$1.hasChildren=hasChildren;function cloneNode$1(e,n){n===void 0&&(n=!1);var i;if(isText$1(e))i=new Text$1(e.data);else if(isComment(e))i=new Comment$5(e.data);else if(isTag(e)){var r=n?cloneChildren(e.children):[],s=new Element$1(e.name,__assign$1({},e.attribs),r);r.forEach(function(d){return d.parent=s}),e.namespace!=null&&(s.namespace=e.namespace),e["x-attribsNamespace"]&&(s["x-attribsNamespace"]=__assign$1({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(s["x-attribsPrefix"]=__assign$1({},e["x-attribsPrefix"])),i=s}else if(isCDATA(e)){var r=n?cloneChildren(e.children):[],o=new CDATA(r);r.forEach(function(p){return p.parent=o}),i=o}else if(isDocument(e)){var r=n?cloneChildren(e.children):[],l=new Document$4(r);r.forEach(function(p){return p.parent=l}),e["x-mode"]&&(l["x-mode"]=e["x-mode"]),i=l}else if(isDirective(e)){var f=new ProcessingInstruction(e.name,e.data);e["x-name"]!=null&&(f["x-name"]=e["x-name"],f["x-publicId"]=e["x-publicId"],f["x-systemId"]=e["x-systemId"]),i=f}else throw new Error("Not implemented yet: ".concat(e.type));return i.startIndex=e.startIndex,i.endIndex=e.endIndex,e.sourceCodeLocation!=null&&(i.sourceCodeLocation=e.sourceCodeLocation),i}node$1.cloneNode=cloneNode$1;function cloneChildren(e){for(var n=e.map(function(r){return cloneNode$1(r,!0)}),i=1;i<n.length;i++)n[i].prev=n[i-1],n[i-1].next=n[i];return n}(function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(f,d,p,g){g===void 0&&(g=p);var v=Object.getOwnPropertyDescriptor(d,p);(!v||("get"in v?!d.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(f,g,v)}:function(f,d,p,g){g===void 0&&(g=p),f[g]=d[p]}),i=commonjsGlobal&&commonjsGlobal.__exportStar||function(f,d){for(var p in f)p!=="default"&&!Object.prototype.hasOwnProperty.call(d,p)&&n(d,f,p)};Object.defineProperty(e,"__esModule",{value:!0}),e.DomHandler=void 0;var r=lib$3,s=node$1;i(node$1,e);var o={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},l=function(){function f(d,p,g){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof p=="function"&&(g=p,p=o),typeof d=="object"&&(p=d,d=void 0),this.callback=d??null,this.options=p??o,this.elementCB=g??null}return f.prototype.onparserinit=function(d){this.parser=d},f.prototype.onreset=function(){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},f.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},f.prototype.onerror=function(d){this.handleCallback(d)},f.prototype.onclosetag=function(){this.lastNode=null;var d=this.tagStack.pop();this.options.withEndIndices&&(d.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(d)},f.prototype.onopentag=function(d,p){var g=this.options.xmlMode?r.ElementType.Tag:void 0,v=new s.Element(d,p,void 0,g);this.addNode(v),this.tagStack.push(v)},f.prototype.ontext=function(d){var p=this.lastNode;if(p&&p.type===r.ElementType.Text)p.data+=d,this.options.withEndIndices&&(p.endIndex=this.parser.endIndex);else{var g=new s.Text(d);this.addNode(g),this.lastNode=g}},f.prototype.oncomment=function(d){if(this.lastNode&&this.lastNode.type===r.ElementType.Comment){this.lastNode.data+=d;return}var p=new s.Comment(d);this.addNode(p),this.lastNode=p},f.prototype.oncommentend=function(){this.lastNode=null},f.prototype.oncdatastart=function(){var d=new s.Text(""),p=new s.CDATA([d]);this.addNode(p),d.parent=p,this.lastNode=d},f.prototype.oncdataend=function(){this.lastNode=null},f.prototype.onprocessinginstruction=function(d,p){var g=new s.ProcessingInstruction(d,p);this.addNode(g)},f.prototype.handleCallback=function(d){if(typeof this.callback=="function")this.callback(d,this.dom);else if(d)throw d},f.prototype.addNode=function(d){var p=this.tagStack[this.tagStack.length-1],g=p.children[p.children.length-1];this.options.withStartIndices&&(d.startIndex=this.parser.startIndex),this.options.withEndIndices&&(d.endIndex=this.parser.endIndex),p.children.push(d),g&&(d.prev=g,g.next=d),d.parent=p,this.lastNode=null},f}();e.DomHandler=l,e.default=l})(lib$4);var lib$2={},stringify$6={},lib$1={},lib={},encode$2={},encodeHtml={};Object.defineProperty(encodeHtml,"__esModule",{value:!0});function restoreDiff(e){for(var n=1;n<e.length;n++)e[n][0]+=e[n-1][0]+1;return e}encodeHtml.default=new Map(restoreDiff([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(restoreDiff([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(restoreDiff([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(restoreDiff([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var _escape={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.escapeText=e.escapeAttribute=e.escapeUTF8=e.escape=e.encodeXML=e.getCodePoint=e.xmlReplacer=void 0,e.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var n=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);e.getCodePoint=String.prototype.codePointAt!=null?function(s,o){return s.codePointAt(o)}:function(s,o){return(s.charCodeAt(o)&64512)===55296?(s.charCodeAt(o)-55296)*1024+s.charCodeAt(o+1)-56320+65536:s.charCodeAt(o)};function i(s){for(var o="",l=0,f;(f=e.xmlReplacer.exec(s))!==null;){var d=f.index,p=s.charCodeAt(d),g=n.get(p);g!==void 0?(o+=s.substring(l,d)+g,l=d+1):(o+="".concat(s.substring(l,d),"&#x").concat((0,e.getCodePoint)(s,d).toString(16),";"),l=e.xmlReplacer.lastIndex+=Number((p&64512)===55296))}return o+s.substr(l)}e.encodeXML=i,e.escape=i;function r(s,o){return function(f){for(var d,p=0,g="";d=s.exec(f);)p!==d.index&&(g+=f.substring(p,d.index)),g+=o.get(d[0].charCodeAt(0)),p=d.index+1;return g+f.substring(p)}}e.escapeUTF8=r(/[&<>'"]/g,n),e.escapeAttribute=r(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),e.escapeText=r(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))})(_escape);var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(encode$2,"__esModule",{value:!0});encode$2.encodeNonAsciiHTML=encode$2.encodeHTML=void 0;var encode_html_js_1=__importDefault$1(encodeHtml),escape_js_1=_escape,htmlReplacer=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function encodeHTML(e){return encodeHTMLTrieRe(htmlReplacer,e)}encode$2.encodeHTML=encodeHTML;function encodeNonAsciiHTML(e){return encodeHTMLTrieRe(escape_js_1.xmlReplacer,e)}encode$2.encodeNonAsciiHTML=encodeNonAsciiHTML;function encodeHTMLTrieRe(e,n){for(var i="",r=0,s;(s=e.exec(n))!==null;){var o=s.index;i+=n.substring(r,o);var l=n.charCodeAt(o),f=encode_html_js_1.default.get(l);if(typeof f=="object"){if(o+1<n.length){var d=n.charCodeAt(o+1),p=typeof f.n=="number"?f.n===d?f.o:void 0:f.n.get(d);if(p!==void 0){i+=p,r=e.lastIndex+=1;continue}}f=f.v}if(f!==void 0)i+=f,r=o+1;else{var g=(0,escape_js_1.getCodePoint)(n,o);i+="&#x".concat(g.toString(16),";"),r=e.lastIndex+=Number(g!==l)}}return i+n.substr(r)}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.decodeXMLStrict=e.decodeHTML5Strict=e.decodeHTML4Strict=e.decodeHTML5=e.decodeHTML4=e.decodeHTMLStrict=e.decodeHTML=e.decodeXML=e.encodeHTML5=e.encodeHTML4=e.encodeNonAsciiHTML=e.encodeHTML=e.escapeText=e.escapeAttribute=e.escapeUTF8=e.escape=e.encodeXML=e.encode=e.decodeStrict=e.decode=e.EncodingMode=e.DecodingMode=e.EntityLevel=void 0;var n=decode,i=encode$2,r=_escape,s;(function(T){T[T.XML=0]="XML",T[T.HTML=1]="HTML"})(s=e.EntityLevel||(e.EntityLevel={}));var o;(function(T){T[T.Legacy=0]="Legacy",T[T.Strict=1]="Strict"})(o=e.DecodingMode||(e.DecodingMode={}));var l;(function(T){T[T.UTF8=0]="UTF8",T[T.ASCII=1]="ASCII",T[T.Extensive=2]="Extensive",T[T.Attribute=3]="Attribute",T[T.Text=4]="Text"})(l=e.EncodingMode||(e.EncodingMode={}));function f(T,k){k===void 0&&(k=s.XML);var O=typeof k=="number"?{level:k}:k;return O.level===s.HTML?O.mode===o.Strict?(0,n.decodeHTMLStrict)(T):(0,n.decodeHTML)(T):(0,n.decodeXML)(T)}e.decode=f;function d(T,k){k===void 0&&(k=s.XML);var O=typeof k=="number"?{level:k}:k;return O.level===s.HTML?O.mode===o.Legacy?(0,n.decodeHTML)(T):(0,n.decodeHTMLStrict)(T):(0,n.decodeXML)(T)}e.decodeStrict=d;function p(T,k){k===void 0&&(k=s.XML);var O=typeof k=="number"?{level:k}:k;return O.mode===l.UTF8?(0,r.escapeUTF8)(T):O.mode===l.Attribute?(0,r.escapeAttribute)(T):O.mode===l.Text?(0,r.escapeText)(T):O.level===s.HTML?O.mode===l.ASCII?(0,i.encodeNonAsciiHTML)(T):(0,i.encodeHTML)(T):(0,r.encodeXML)(T)}e.encode=p;var g=_escape;Object.defineProperty(e,"encodeXML",{enumerable:!0,get:function(){return g.encodeXML}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return g.escape}}),Object.defineProperty(e,"escapeUTF8",{enumerable:!0,get:function(){return g.escapeUTF8}}),Object.defineProperty(e,"escapeAttribute",{enumerable:!0,get:function(){return g.escapeAttribute}}),Object.defineProperty(e,"escapeText",{enumerable:!0,get:function(){return g.escapeText}});var v=encode$2;Object.defineProperty(e,"encodeHTML",{enumerable:!0,get:function(){return v.encodeHTML}}),Object.defineProperty(e,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return v.encodeNonAsciiHTML}}),Object.defineProperty(e,"encodeHTML4",{enumerable:!0,get:function(){return v.encodeHTML}}),Object.defineProperty(e,"encodeHTML5",{enumerable:!0,get:function(){return v.encodeHTML}});var S=decode;Object.defineProperty(e,"decodeXML",{enumerable:!0,get:function(){return S.decodeXML}}),Object.defineProperty(e,"decodeHTML",{enumerable:!0,get:function(){return S.decodeHTML}}),Object.defineProperty(e,"decodeHTMLStrict",{enumerable:!0,get:function(){return S.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML4",{enumerable:!0,get:function(){return S.decodeHTML}}),Object.defineProperty(e,"decodeHTML5",{enumerable:!0,get:function(){return S.decodeHTML}}),Object.defineProperty(e,"decodeHTML4Strict",{enumerable:!0,get:function(){return S.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML5Strict",{enumerable:!0,get:function(){return S.decodeHTMLStrict}}),Object.defineProperty(e,"decodeXMLStrict",{enumerable:!0,get:function(){return S.decodeXML}})})(lib);var foreignNames={};Object.defineProperty(foreignNames,"__esModule",{value:!0});foreignNames.attributeNames=foreignNames.elementNames=void 0;foreignNames.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(e){return[e.toLowerCase(),e]}));foreignNames.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(e){return[e.toLowerCase(),e]}));var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},__assign.apply(this,arguments)},__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,n,i,r){r===void 0&&(r=i);var s=Object.getOwnPropertyDescriptor(n,i);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(e,r,s)}:function(e,n,i,r){r===void 0&&(r=i),e[r]=n[i]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(n,e,i);return __setModuleDefault(n,e),n};Object.defineProperty(lib$1,"__esModule",{value:!0});lib$1.render=void 0;var ElementType=__importStar(lib$3),entities_1=lib,foreignNames_js_1=foreignNames,unencodedElements=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function replaceQuotes(e){return e.replace(/"/g,"&quot;")}function formatAttributes(e,n){var i;if(e){var r=((i=n.encodeEntities)!==null&&i!==void 0?i:n.decodeEntities)===!1?replaceQuotes:n.xmlMode||n.encodeEntities!=="utf8"?entities_1.encodeXML:entities_1.escapeAttribute;return Object.keys(e).map(function(s){var o,l,f=(o=e[s])!==null&&o!==void 0?o:"";return n.xmlMode==="foreign"&&(s=(l=foreignNames_js_1.attributeNames.get(s))!==null&&l!==void 0?l:s),!n.emptyAttrs&&!n.xmlMode&&f===""?s:"".concat(s,'="').concat(r(f),'"')}).join(" ")}}var singleTag=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function render(e,n){n===void 0&&(n={});for(var i=("length"in e)?e:[e],r="",s=0;s<i.length;s++)r+=renderNode(i[s],n);return r}lib$1.render=render;lib$1.default=render;function renderNode(e,n){switch(e.type){case ElementType.Root:return render(e.children,n);case ElementType.Doctype:case ElementType.Directive:return renderDirective(e);case ElementType.Comment:return renderComment(e);case ElementType.CDATA:return renderCdata(e);case ElementType.Script:case ElementType.Style:case ElementType.Tag:return renderTag(e,n);case ElementType.Text:return renderText(e,n)}}var foreignModeIntegrationPoints=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),foreignElements=new Set(["svg","math"]);function renderTag(e,n){var i;n.xmlMode==="foreign"&&(e.name=(i=foreignNames_js_1.elementNames.get(e.name))!==null&&i!==void 0?i:e.name,e.parent&&foreignModeIntegrationPoints.has(e.parent.name)&&(n=__assign(__assign({},n),{xmlMode:!1}))),!n.xmlMode&&foreignElements.has(e.name)&&(n=__assign(__assign({},n),{xmlMode:"foreign"}));var r="<".concat(e.name),s=formatAttributes(e.attribs,n);return s&&(r+=" ".concat(s)),e.children.length===0&&(n.xmlMode?n.selfClosingTags!==!1:n.selfClosingTags&&singleTag.has(e.name))?(n.xmlMode||(r+=" "),r+="/>"):(r+=">",e.children.length>0&&(r+=render(e.children,n)),(n.xmlMode||!singleTag.has(e.name))&&(r+="</".concat(e.name,">"))),r}function renderDirective(e){return"<".concat(e.data,">")}function renderText(e,n){var i,r=e.data||"";return((i=n.encodeEntities)!==null&&i!==void 0?i:n.decodeEntities)!==!1&&!(!n.xmlMode&&e.parent&&unencodedElements.has(e.parent.name))&&(r=n.xmlMode||n.encodeEntities!=="utf8"?(0,entities_1.encodeXML)(r):(0,entities_1.escapeText)(r)),r}function renderCdata(e){return"<![CDATA[".concat(e.children[0].data,"]]>")}function renderComment(e){return"<!--".concat(e.data,"-->")}var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(stringify$6,"__esModule",{value:!0});stringify$6.innerText=stringify$6.textContent=stringify$6.getText=stringify$6.getInnerHTML=stringify$6.getOuterHTML=void 0;var domhandler_1$3=lib$4,dom_serializer_1=__importDefault(lib$1),domelementtype_1=lib$3;function getOuterHTML(e,n){return(0,dom_serializer_1.default)(e,n)}stringify$6.getOuterHTML=getOuterHTML;function getInnerHTML(e,n){return(0,domhandler_1$3.hasChildren)(e)?e.children.map(function(i){return getOuterHTML(i,n)}).join(""):""}stringify$6.getInnerHTML=getInnerHTML;function getText(e){return Array.isArray(e)?e.map(getText).join(""):(0,domhandler_1$3.isTag)(e)?e.name==="br"?`
`:getText(e.children):(0,domhandler_1$3.isCDATA)(e)?getText(e.children):(0,domhandler_1$3.isText)(e)?e.data:""}stringify$6.getText=getText;function textContent(e){return Array.isArray(e)?e.map(textContent).join(""):(0,domhandler_1$3.hasChildren)(e)&&!(0,domhandler_1$3.isComment)(e)?textContent(e.children):(0,domhandler_1$3.isText)(e)?e.data:""}stringify$6.textContent=textContent;function innerText$1(e){return Array.isArray(e)?e.map(innerText$1).join(""):(0,domhandler_1$3.hasChildren)(e)&&(e.type===domelementtype_1.ElementType.Tag||(0,domhandler_1$3.isCDATA)(e))?innerText$1(e.children):(0,domhandler_1$3.isText)(e)?e.data:""}stringify$6.innerText=innerText$1;var traversal={};Object.defineProperty(traversal,"__esModule",{value:!0});traversal.prevElementSibling=traversal.nextElementSibling=traversal.getName=traversal.hasAttrib=traversal.getAttributeValue=traversal.getSiblings=traversal.getParent=traversal.getChildren=void 0;var domhandler_1$2=lib$4;function getChildren(e){return(0,domhandler_1$2.hasChildren)(e)?e.children:[]}traversal.getChildren=getChildren;function getParent(e){return e.parent||null}traversal.getParent=getParent;function getSiblings(e){var n,i,r=getParent(e);if(r!=null)return getChildren(r);for(var s=[e],o=e.prev,l=e.next;o!=null;)s.unshift(o),n=o,o=n.prev;for(;l!=null;)s.push(l),i=l,l=i.next;return s}traversal.getSiblings=getSiblings;function getAttributeValue(e,n){var i;return(i=e.attribs)===null||i===void 0?void 0:i[n]}traversal.getAttributeValue=getAttributeValue;function hasAttrib(e,n){return e.attribs!=null&&Object.prototype.hasOwnProperty.call(e.attribs,n)&&e.attribs[n]!=null}traversal.hasAttrib=hasAttrib;function getName$1(e){return e.name}traversal.getName=getName$1;function nextElementSibling(e){for(var n,i=e.next;i!==null&&!(0,domhandler_1$2.isTag)(i);)n=i,i=n.next;return i}traversal.nextElementSibling=nextElementSibling;function prevElementSibling(e){for(var n,i=e.prev;i!==null&&!(0,domhandler_1$2.isTag)(i);)n=i,i=n.prev;return i}traversal.prevElementSibling=prevElementSibling;var manipulation={};Object.defineProperty(manipulation,"__esModule",{value:!0});manipulation.prepend=manipulation.prependChild=manipulation.append=manipulation.appendChild=manipulation.replaceElement=manipulation.removeElement=void 0;function removeElement(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){var n=e.parent.children;n.splice(n.lastIndexOf(e),1)}}manipulation.removeElement=removeElement;function replaceElement(e,n){var i=n.prev=e.prev;i&&(i.next=n);var r=n.next=e.next;r&&(r.prev=n);var s=n.parent=e.parent;if(s){var o=s.children;o[o.lastIndexOf(e)]=n,e.parent=null}}manipulation.replaceElement=replaceElement;function appendChild(e,n){if(removeElement(n),n.next=null,n.parent=e,e.children.push(n)>1){var i=e.children[e.children.length-2];i.next=n,n.prev=i}else n.prev=null}manipulation.appendChild=appendChild;function append$2(e,n){removeElement(n);var i=e.parent,r=e.next;if(n.next=r,n.prev=e,e.next=n,n.parent=i,r){if(r.prev=n,i){var s=i.children;s.splice(s.lastIndexOf(r),0,n)}}else i&&i.children.push(n)}manipulation.append=append$2;function prependChild(e,n){if(removeElement(n),n.parent=e,n.prev=null,e.children.unshift(n)!==1){var i=e.children[1];i.prev=n,n.next=i}else n.next=null}manipulation.prependChild=prependChild;function prepend(e,n){removeElement(n);var i=e.parent;if(i){var r=i.children;r.splice(r.indexOf(e),0,n)}e.prev&&(e.prev.next=n),n.parent=i,n.prev=e.prev,n.next=e,e.prev=n}manipulation.prepend=prepend;var querying={};Object.defineProperty(querying,"__esModule",{value:!0});querying.findAll=querying.existsOne=querying.findOne=querying.findOneChild=querying.find=querying.filter=void 0;var domhandler_1$1=lib$4;function filter$3(e,n,i,r){return i===void 0&&(i=!0),r===void 0&&(r=1/0),Array.isArray(n)||(n=[n]),find$3(e,n,i,r)}querying.filter=filter$3;function find$3(e,n,i,r){for(var s=[],o=0,l=n;o<l.length;o++){var f=l[o];if(e(f)&&(s.push(f),--r<=0))break;if(i&&(0,domhandler_1$1.hasChildren)(f)&&f.children.length>0){var d=find$3(e,f.children,i,r);if(s.push.apply(s,d),r-=d.length,r<=0)break}}return s}querying.find=find$3;function findOneChild(e,n){return n.find(e)}querying.findOneChild=findOneChild;function findOne(e,n,i){i===void 0&&(i=!0);for(var r=null,s=0;s<n.length&&!r;s++){var o=n[s];if((0,domhandler_1$1.isTag)(o))e(o)?r=o:i&&o.children.length>0&&(r=findOne(e,o.children,!0));else continue}return r}querying.findOne=findOne;function existsOne(e,n){return n.some(function(i){return(0,domhandler_1$1.isTag)(i)&&(e(i)||i.children.length>0&&existsOne(e,i.children))})}querying.existsOne=existsOne;function findAll(e,n){for(var i,r=[],s=n.filter(domhandler_1$1.isTag),o;o=s.shift();){var l=(i=o.children)===null||i===void 0?void 0:i.filter(domhandler_1$1.isTag);l&&l.length>0&&s.unshift.apply(s,l),e(o)&&r.push(o)}return r}querying.findAll=findAll;var legacy={};Object.defineProperty(legacy,"__esModule",{value:!0});legacy.getElementsByTagType=legacy.getElementsByTagName=legacy.getElementById=legacy.getElements=legacy.testElement=void 0;var domhandler_1=lib$4,querying_js_1=querying,Checks={tag_name:function(e){return typeof e=="function"?function(n){return(0,domhandler_1.isTag)(n)&&e(n.name)}:e==="*"?domhandler_1.isTag:function(n){return(0,domhandler_1.isTag)(n)&&n.name===e}},tag_type:function(e){return typeof e=="function"?function(n){return e(n.type)}:function(n){return n.type===e}},tag_contains:function(e){return typeof e=="function"?function(n){return(0,domhandler_1.isText)(n)&&e(n.data)}:function(n){return(0,domhandler_1.isText)(n)&&n.data===e}}};function getAttribCheck(e,n){return typeof n=="function"?function(i){return(0,domhandler_1.isTag)(i)&&n(i.attribs[e])}:function(i){return(0,domhandler_1.isTag)(i)&&i.attribs[e]===n}}function combineFuncs(e,n){return function(i){return e(i)||n(i)}}function compileTest(e){var n=Object.keys(e).map(function(i){var r=e[i];return Object.prototype.hasOwnProperty.call(Checks,i)?Checks[i](r):getAttribCheck(i,r)});return n.length===0?null:n.reduce(combineFuncs)}function testElement(e,n){var i=compileTest(e);return i?i(n):!0}legacy.testElement=testElement;function getElements(e,n,i,r){r===void 0&&(r=1/0);var s=compileTest(e);return s?(0,querying_js_1.filter)(s,n,i,r):[]}legacy.getElements=getElements;function getElementById(e,n,i){return i===void 0&&(i=!0),Array.isArray(n)||(n=[n]),(0,querying_js_1.findOne)(getAttribCheck("id",e),n,i)}legacy.getElementById=getElementById;function getElementsByTagName(e,n,i,r){return i===void 0&&(i=!0),r===void 0&&(r=1/0),(0,querying_js_1.filter)(Checks.tag_name(e),n,i,r)}legacy.getElementsByTagName=getElementsByTagName;function getElementsByTagType(e,n,i,r){return i===void 0&&(i=!0),r===void 0&&(r=1/0),(0,querying_js_1.filter)(Checks.tag_type(e),n,i,r)}legacy.getElementsByTagType=getElementsByTagType;var helpers={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniqueSort=e.compareDocumentPosition=e.DocumentPosition=e.removeSubsets=void 0;var n=lib$4;function i(l){for(var f=l.length;--f>=0;){var d=l[f];if(f>0&&l.lastIndexOf(d,f-1)>=0){l.splice(f,1);continue}for(var p=d.parent;p;p=p.parent)if(l.includes(p)){l.splice(f,1);break}}return l}e.removeSubsets=i;var r;(function(l){l[l.DISCONNECTED=1]="DISCONNECTED",l[l.PRECEDING=2]="PRECEDING",l[l.FOLLOWING=4]="FOLLOWING",l[l.CONTAINS=8]="CONTAINS",l[l.CONTAINED_BY=16]="CONTAINED_BY"})(r=e.DocumentPosition||(e.DocumentPosition={}));function s(l,f){var d=[],p=[];if(l===f)return 0;for(var g=(0,n.hasChildren)(l)?l:l.parent;g;)d.unshift(g),g=g.parent;for(g=(0,n.hasChildren)(f)?f:f.parent;g;)p.unshift(g),g=g.parent;for(var v=Math.min(d.length,p.length),S=0;S<v&&d[S]===p[S];)S++;if(S===0)return r.DISCONNECTED;var T=d[S-1],k=T.children,O=d[S],R=p[S];return k.indexOf(O)>k.indexOf(R)?T===f?r.FOLLOWING|r.CONTAINED_BY:r.FOLLOWING:T===l?r.PRECEDING|r.CONTAINS:r.PRECEDING}e.compareDocumentPosition=s;function o(l){return l=l.filter(function(f,d,p){return!p.includes(f,d+1)}),l.sort(function(f,d){var p=s(f,d);return p&r.PRECEDING?-1:p&r.FOLLOWING?1:0}),l}e.uniqueSort=o})(helpers);var feeds={};Object.defineProperty(feeds,"__esModule",{value:!0});feeds.getFeed=void 0;var stringify_js_1=stringify$6,legacy_js_1=legacy;function getFeed(e){var n=getOneElement(isValidFeed,e);return n?n.name==="feed"?getAtomFeed(n):getRssFeed(n):null}feeds.getFeed=getFeed;function getAtomFeed(e){var n,i=e.children,r={type:"atom",items:(0,legacy_js_1.getElementsByTagName)("entry",i).map(function(l){var f,d=l.children,p={media:getMediaElements(d)};addConditionally(p,"id","id",d),addConditionally(p,"title","title",d);var g=(f=getOneElement("link",d))===null||f===void 0?void 0:f.attribs.href;g&&(p.link=g);var v=fetch$1("summary",d)||fetch$1("content",d);v&&(p.description=v);var S=fetch$1("updated",d);return S&&(p.pubDate=new Date(S)),p})};addConditionally(r,"id","id",i),addConditionally(r,"title","title",i);var s=(n=getOneElement("link",i))===null||n===void 0?void 0:n.attribs.href;s&&(r.link=s),addConditionally(r,"description","subtitle",i);var o=fetch$1("updated",i);return o&&(r.updated=new Date(o)),addConditionally(r,"author","email",i,!0),r}function getRssFeed(e){var n,i,r=(i=(n=getOneElement("channel",e.children))===null||n===void 0?void 0:n.children)!==null&&i!==void 0?i:[],s={type:e.name.substr(0,3),id:"",items:(0,legacy_js_1.getElementsByTagName)("item",e.children).map(function(l){var f=l.children,d={media:getMediaElements(f)};addConditionally(d,"id","guid",f),addConditionally(d,"title","title",f),addConditionally(d,"link","link",f),addConditionally(d,"description","description",f);var p=fetch$1("pubDate",f);return p&&(d.pubDate=new Date(p)),d})};addConditionally(s,"title","title",r),addConditionally(s,"link","link",r),addConditionally(s,"description","description",r);var o=fetch$1("lastBuildDate",r);return o&&(s.updated=new Date(o)),addConditionally(s,"author","managingEditor",r,!0),s}var MEDIA_KEYS_STRING=["url","type","lang"],MEDIA_KEYS_INT=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function getMediaElements(e){return(0,legacy_js_1.getElementsByTagName)("media:content",e).map(function(n){for(var i=n.attribs,r={medium:i.medium,isDefault:!!i.isDefault},s=0,o=MEDIA_KEYS_STRING;s<o.length;s++){var l=o[s];i[l]&&(r[l]=i[l])}for(var f=0,d=MEDIA_KEYS_INT;f<d.length;f++){var l=d[f];i[l]&&(r[l]=parseInt(i[l],10))}return i.expression&&(r.expression=i.expression),r})}function getOneElement(e,n){return(0,legacy_js_1.getElementsByTagName)(e,n,!0,1)[0]}function fetch$1(e,n,i){return i===void 0&&(i=!1),(0,stringify_js_1.textContent)((0,legacy_js_1.getElementsByTagName)(e,n,i,1)).trim()}function addConditionally(e,n,i,r,s){s===void 0&&(s=!1);var o=fetch$1(i,r,s);o&&(e[n]=o)}function isValidFeed(e){return e==="rss"||e==="feed"||e==="rdf:RDF"}(function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(s,o,l,f){f===void 0&&(f=l);var d=Object.getOwnPropertyDescriptor(o,l);(!d||("get"in d?!o.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return o[l]}}),Object.defineProperty(s,f,d)}:function(s,o,l,f){f===void 0&&(f=l),s[f]=o[l]}),i=commonjsGlobal&&commonjsGlobal.__exportStar||function(s,o){for(var l in s)l!=="default"&&!Object.prototype.hasOwnProperty.call(o,l)&&n(o,s,l)};Object.defineProperty(e,"__esModule",{value:!0}),e.hasChildren=e.isDocument=e.isComment=e.isText=e.isCDATA=e.isTag=void 0,i(stringify$6,e),i(traversal,e),i(manipulation,e),i(querying,e),i(legacy,e),i(helpers,e),i(feeds,e);var r=lib$4;Object.defineProperty(e,"isTag",{enumerable:!0,get:function(){return r.isTag}}),Object.defineProperty(e,"isCDATA",{enumerable:!0,get:function(){return r.isCDATA}}),Object.defineProperty(e,"isText",{enumerable:!0,get:function(){return r.isText}}),Object.defineProperty(e,"isComment",{enumerable:!0,get:function(){return r.isComment}}),Object.defineProperty(e,"isDocument",{enumerable:!0,get:function(){return r.isDocument}}),Object.defineProperty(e,"hasChildren",{enumerable:!0,get:function(){return r.hasChildren}})})(lib$2);(function(e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(k,O,R,P){P===void 0&&(P=R);var F=Object.getOwnPropertyDescriptor(O,R);(!F||("get"in F?!O.__esModule:F.writable||F.configurable))&&(F={enumerable:!0,get:function(){return O[R]}}),Object.defineProperty(k,P,F)}:function(k,O,R,P){P===void 0&&(P=R),k[P]=O[R]}),i=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(k,O){Object.defineProperty(k,"default",{enumerable:!0,value:O})}:function(k,O){k.default=O}),r=commonjsGlobal&&commonjsGlobal.__importStar||function(k){if(k&&k.__esModule)return k;var O={};if(k!=null)for(var R in k)R!=="default"&&Object.prototype.hasOwnProperty.call(k,R)&&n(O,k,R);return i(O,k),O},s=commonjsGlobal&&commonjsGlobal.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultHandler=e.DomUtils=e.parseFeed=e.getFeed=e.ElementType=e.Tokenizer=e.createDomStream=e.parseDOM=e.parseDocument=e.DomHandler=e.Parser=void 0;var o=Parser$3;Object.defineProperty(e,"Parser",{enumerable:!0,get:function(){return o.Parser}});var l=lib$4;Object.defineProperty(e,"DomHandler",{enumerable:!0,get:function(){return l.DomHandler}}),Object.defineProperty(e,"DefaultHandler",{enumerable:!0,get:function(){return l.DomHandler}});function f(k,O){var R=new l.DomHandler(void 0,O);return new o.Parser(R,O).end(k),R.root}e.parseDocument=f;function d(k,O){return f(k,O).children}e.parseDOM=d;function p(k,O,R){var P=new l.DomHandler(k,O,R);return new o.Parser(P,O)}e.createDomStream=p;var g=Tokenizer;Object.defineProperty(e,"Tokenizer",{enumerable:!0,get:function(){return s(g).default}});var v=r(lib$3);e.ElementType=v;var S=lib$2;Object.defineProperty(e,"getFeed",{enumerable:!0,get:function(){return S.getFeed}});function T(k,O){return O===void 0&&(O={xmlMode:!0}),(0,S.getFeed)(d(k,O))}e.parseFeed=T,e.DomUtils=r(lib$2)})(lib$5);var escapeStringRegexp$1=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},isPlainObject$2={};Object.defineProperty(isPlainObject$2,"__esModule",{value:!0});/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function isObject$1(e){return Object.prototype.toString.call(e)==="[object Object]"}function isPlainObject$1(e){var n,i;return isObject$1(e)===!1?!1:(n=e.constructor,n===void 0?!0:(i=n.prototype,!(isObject$1(i)===!1||i.hasOwnProperty("isPrototypeOf")===!1)))}isPlainObject$2.isPlainObject=isPlainObject$1;var isMergeableObject=function e(n){return isNonNullObject(n)&&!isSpecial(n)};function isNonNullObject(e){return!!e&&typeof e=="object"}function isSpecial(e){var n=Object.prototype.toString.call(e);return n==="[object RegExp]"||n==="[object Date]"||isReactElement(e)}var canUseSymbol=typeof Symbol=="function"&&Symbol.for,REACT_ELEMENT_TYPE=canUseSymbol?Symbol.for("react.element"):60103;function isReactElement(e){return e.$$typeof===REACT_ELEMENT_TYPE}function emptyTarget(e){return Array.isArray(e)?[]:{}}function cloneUnlessOtherwiseSpecified(e,n){return n.clone!==!1&&n.isMergeableObject(e)?deepmerge$1(emptyTarget(e),e,n):e}function defaultArrayMerge(e,n,i){return e.concat(n).map(function(r){return cloneUnlessOtherwiseSpecified(r,i)})}function getMergeFunction(e,n){if(!n.customMerge)return deepmerge$1;var i=n.customMerge(e);return typeof i=="function"?i:deepmerge$1}function getEnumerableOwnPropertySymbols(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(n){return e.propertyIsEnumerable(n)}):[]}function getKeys(e){return Object.keys(e).concat(getEnumerableOwnPropertySymbols(e))}function propertyIsOnObject(e,n){try{return n in e}catch{return!1}}function propertyIsUnsafe(e,n){return propertyIsOnObject(e,n)&&!(Object.hasOwnProperty.call(e,n)&&Object.propertyIsEnumerable.call(e,n))}function mergeObject(e,n,i){var r={};return i.isMergeableObject(e)&&getKeys(e).forEach(function(s){r[s]=cloneUnlessOtherwiseSpecified(e[s],i)}),getKeys(n).forEach(function(s){propertyIsUnsafe(e,s)||(propertyIsOnObject(e,s)&&i.isMergeableObject(n[s])?r[s]=getMergeFunction(s,i)(e[s],n[s],i):r[s]=cloneUnlessOtherwiseSpecified(n[s],i))}),r}function deepmerge$1(e,n,i){i=i||{},i.arrayMerge=i.arrayMerge||defaultArrayMerge,i.isMergeableObject=i.isMergeableObject||isMergeableObject,i.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var r=Array.isArray(n),s=Array.isArray(e),o=r===s;return o?r?i.arrayMerge(e,n,i):mergeObject(e,n,i):cloneUnlessOtherwiseSpecified(n,i)}deepmerge$1.all=function e(n,i){if(!Array.isArray(n))throw new Error("first argument should be an array");return n.reduce(function(r,s){return deepmerge$1(r,s,i)},{})};var deepmerge_1=deepmerge$1,cjs=deepmerge_1,parseSrcsetExports={},parseSrcset$1={get exports(){return parseSrcsetExports},set exports(e){parseSrcsetExports=e}};(function(e){(function(n,i){e.exports?e.exports=i():n.parseSrcset=i()})(commonjsGlobal,function(){return function(n){function i(L){return L===" "||L==="	"||L===`
`||L==="\f"||L==="\r"}function r(L){var N,j=L.exec(n.substring(R));if(j)return N=j[0],R+=N.length,N}for(var s=n.length,o=/^[ \t\n\r\u000c]+/,l=/^[, \t\n\r\u000c]+/,f=/^[^ \t\n\r\u000c]+/,d=/[,]+$/,p=/^\d+$/,g=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,v,S,T,k,O,R=0,P=[];;){if(r(l),R>=s)return P;v=r(f),S=[],v.slice(-1)===","?(v=v.replace(d,""),I()):F()}function F(){for(r(o),T="",k="in descriptor";;){if(O=n.charAt(R),k==="in descriptor")if(i(O))T&&(S.push(T),T="",k="after descriptor");else if(O===","){R+=1,T&&S.push(T),I();return}else if(O==="(")T=T+O,k="in parens";else if(O===""){T&&S.push(T),I();return}else T=T+O;else if(k==="in parens")if(O===")")T=T+O,k="in descriptor";else if(O===""){S.push(T),I();return}else T=T+O;else if(k==="after descriptor"&&!i(O))if(O===""){I();return}else k="in descriptor",R-=1;R+=1}}function I(){var L=!1,N,j,z,q,H={},W,U,Q,J,ne;for(q=0;q<S.length;q++)W=S[q],U=W[W.length-1],Q=W.substring(0,W.length-1),J=parseInt(Q,10),ne=parseFloat(Q),p.test(Q)&&U==="w"?((N||j)&&(L=!0),J===0?L=!0:N=J):g.test(Q)&&U==="x"?((N||j||z)&&(L=!0),ne<0?L=!0:j=ne):p.test(Q)&&U==="h"?((z||j)&&(L=!0),J===0?L=!0:z=J):L=!0;L?console&&console.log&&console.log("Invalid srcset descriptor found in '"+n+"' at '"+W+"'."):(H.url=v,N&&(H.w=N),j&&(H.d=j),z&&(H.h=z),P.push(H))}}})})(parseSrcset$1);var picocolors_browserExports={},picocolors_browser={get exports(){return picocolors_browserExports},set exports(e){picocolors_browserExports=e}},x$4=String,create$3=function(){return{isColorSupported:!1,reset:x$4,bold:x$4,dim:x$4,italic:x$4,underline:x$4,inverse:x$4,hidden:x$4,strikethrough:x$4,black:x$4,red:x$4,green:x$4,yellow:x$4,blue:x$4,magenta:x$4,cyan:x$4,white:x$4,gray:x$4,bgBlack:x$4,bgRed:x$4,bgGreen:x$4,bgYellow:x$4,bgBlue:x$4,bgMagenta:x$4,bgCyan:x$4,bgWhite:x$4}};picocolors_browser.exports=create$3();picocolors_browserExports.createColors=create$3;let pico=picocolors_browserExports,terminalHighlight$1=require$$2,CssSyntaxError$3=class extends Error{constructor(n,i,r,s,o,l){super(n),this.name="CssSyntaxError",this.reason=n,o&&(this.file=o),s&&(this.source=s),l&&(this.plugin=l),typeof i<"u"&&typeof r<"u"&&(typeof i=="number"?(this.line=i,this.column=r):(this.line=i.line,this.column=i.column,this.endLine=r.line,this.endColumn=r.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,CssSyntaxError$3)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(n){if(!this.source)return"";let i=this.source;n==null&&(n=pico.isColorSupported),terminalHighlight$1&&n&&(i=terminalHighlight$1(i));let r=i.split(/\r?\n/),s=Math.max(this.line-3,0),o=Math.min(this.line+2,r.length),l=String(o).length,f,d;if(n){let{bold:p,red:g,gray:v}=pico.createColors(!0);f=S=>p(g(S)),d=S=>v(S)}else f=d=p=>p;return r.slice(s,o).map((p,g)=>{let v=s+1+g,S=" "+(" "+v).slice(-l)+" | ";if(v===this.line){let T=d(S.replace(/\d/g," "))+p.slice(0,this.column-1).replace(/[^\t]/g," ");return f(">")+d(S)+p+`
 `+T+f("^")}return" "+d(S)+p}).join(`
`)}toString(){let n=this.showSourceCode();return n&&(n=`

`+n+`
`),this.name+": "+this.message+n}};var cssSyntaxError=CssSyntaxError$3;CssSyntaxError$3.default=CssSyntaxError$3;var symbols$3={};symbols$3.isClean=Symbol("isClean");symbols$3.my=Symbol("my");const DEFAULT_RAW={colon:": ",indent:"    ",beforeDecl:`
`,beforeRule:`
`,beforeOpen:" ",beforeClose:`
`,beforeComment:`
`,after:`
`,emptyBody:"",commentLeft:" ",commentRight:" ",semicolon:!1};function capitalize$1(e){return e[0].toUpperCase()+e.slice(1)}let Stringifier$2=class{constructor(n){this.builder=n}stringify(n,i){if(!this[n.type])throw new Error("Unknown AST node type "+n.type+". Maybe you need to change PostCSS stringifier.");this[n.type](n,i)}document(n){this.body(n)}root(n){this.body(n),n.raws.after&&this.builder(n.raws.after)}comment(n){let i=this.raw(n,"left","commentLeft"),r=this.raw(n,"right","commentRight");this.builder("/*"+i+n.text+r+"*/",n)}decl(n,i){let r=this.raw(n,"between","colon"),s=n.prop+r+this.rawValue(n,"value");n.important&&(s+=n.raws.important||" !important"),i&&(s+=";"),this.builder(s,n)}rule(n){this.block(n,this.rawValue(n,"selector")),n.raws.ownSemicolon&&this.builder(n.raws.ownSemicolon,n,"end")}atrule(n,i){let r="@"+n.name,s=n.params?this.rawValue(n,"params"):"";if(typeof n.raws.afterName<"u"?r+=n.raws.afterName:s&&(r+=" "),n.nodes)this.block(n,r+s);else{let o=(n.raws.between||"")+(i?";":"");this.builder(r+s+o,n)}}body(n){let i=n.nodes.length-1;for(;i>0&&n.nodes[i].type==="comment";)i-=1;let r=this.raw(n,"semicolon");for(let s=0;s<n.nodes.length;s++){let o=n.nodes[s],l=this.raw(o,"before");l&&this.builder(l),this.stringify(o,i!==s||r)}}block(n,i){let r=this.raw(n,"between","beforeOpen");this.builder(i+r+"{",n,"start");let s;n.nodes&&n.nodes.length?(this.body(n),s=this.raw(n,"after")):s=this.raw(n,"after","emptyBody"),s&&this.builder(s),this.builder("}",n,"end")}raw(n,i,r){let s;if(r||(r=i),i&&(s=n.raws[i],typeof s<"u"))return s;let o=n.parent;if(r==="before"&&(!o||o.type==="root"&&o.first===n||o&&o.type==="document"))return"";if(!o)return DEFAULT_RAW[r];let l=n.root();if(l.rawCache||(l.rawCache={}),typeof l.rawCache[r]<"u")return l.rawCache[r];if(r==="before"||r==="after")return this.beforeAfter(n,r);{let f="raw"+capitalize$1(r);this[f]?s=this[f](l,n):l.walk(d=>{if(s=d.raws[i],typeof s<"u")return!1})}return typeof s>"u"&&(s=DEFAULT_RAW[r]),l.rawCache[r]=s,s}rawSemicolon(n){let i;return n.walk(r=>{if(r.nodes&&r.nodes.length&&r.last.type==="decl"&&(i=r.raws.semicolon,typeof i<"u"))return!1}),i}rawEmptyBody(n){let i;return n.walk(r=>{if(r.nodes&&r.nodes.length===0&&(i=r.raws.after,typeof i<"u"))return!1}),i}rawIndent(n){if(n.raws.indent)return n.raws.indent;let i;return n.walk(r=>{let s=r.parent;if(s&&s!==n&&s.parent&&s.parent===n&&typeof r.raws.before<"u"){let o=r.raws.before.split(`
`);return i=o[o.length-1],i=i.replace(/\S/g,""),!1}}),i}rawBeforeComment(n,i){let r;return n.walkComments(s=>{if(typeof s.raws.before<"u")return r=s.raws.before,r.includes(`
`)&&(r=r.replace(/[^\n]+$/,"")),!1}),typeof r>"u"?r=this.raw(i,null,"beforeDecl"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeDecl(n,i){let r;return n.walkDecls(s=>{if(typeof s.raws.before<"u")return r=s.raws.before,r.includes(`
`)&&(r=r.replace(/[^\n]+$/,"")),!1}),typeof r>"u"?r=this.raw(i,null,"beforeRule"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeRule(n){let i;return n.walk(r=>{if(r.nodes&&(r.parent!==n||n.first!==r)&&typeof r.raws.before<"u")return i=r.raws.before,i.includes(`
`)&&(i=i.replace(/[^\n]+$/,"")),!1}),i&&(i=i.replace(/\S/g,"")),i}rawBeforeClose(n){let i;return n.walk(r=>{if(r.nodes&&r.nodes.length>0&&typeof r.raws.after<"u")return i=r.raws.after,i.includes(`
`)&&(i=i.replace(/[^\n]+$/,"")),!1}),i&&(i=i.replace(/\S/g,"")),i}rawBeforeOpen(n){let i;return n.walk(r=>{if(r.type!=="decl"&&(i=r.raws.between,typeof i<"u"))return!1}),i}rawColon(n){let i;return n.walkDecls(r=>{if(typeof r.raws.between<"u")return i=r.raws.between.replace(/[^\s:]/g,""),!1}),i}beforeAfter(n,i){let r;n.type==="decl"?r=this.raw(n,null,"beforeDecl"):n.type==="comment"?r=this.raw(n,null,"beforeComment"):i==="before"?r=this.raw(n,null,"beforeRule"):r=this.raw(n,null,"beforeClose");let s=n.parent,o=0;for(;s&&s.type!=="root";)o+=1,s=s.parent;if(r.includes(`
`)){let l=this.raw(n,null,"indent");if(l.length)for(let f=0;f<o;f++)r+=l}return r}rawValue(n,i){let r=n[i],s=n.raws[i];return s&&s.value===r?s.raw:r}};var stringifier=Stringifier$2;Stringifier$2.default=Stringifier$2;let Stringifier$1=stringifier;function stringify$5(e,n){new Stringifier$1(n).stringify(e)}var stringify_1=stringify$5;stringify$5.default=stringify$5;let{isClean:isClean$2,my:my$2}=symbols$3,CssSyntaxError$2=cssSyntaxError,Stringifier=stringifier,stringify$4=stringify_1;function cloneNode(e,n){let i=new e.constructor;for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r)||r==="proxyCache")continue;let s=e[r],o=typeof s;r==="parent"&&o==="object"?n&&(i[r]=n):r==="source"?i[r]=s:Array.isArray(s)?i[r]=s.map(l=>cloneNode(l,i)):(o==="object"&&s!==null&&(s=cloneNode(s)),i[r]=s)}return i}let Node$7=class{constructor(n={}){this.raws={},this[isClean$2]=!1,this[my$2]=!0;for(let i in n)if(i==="nodes"){this.nodes=[];for(let r of n[i])typeof r.clone=="function"?this.append(r.clone()):this.append(r)}else this[i]=n[i]}error(n,i={}){if(this.source){let{start:r,end:s}=this.rangeBy(i);return this.source.input.error(n,{line:r.line,column:r.column},{line:s.line,column:s.column},i)}return new CssSyntaxError$2(n)}warn(n,i,r){let s={node:this};for(let o in r)s[o]=r[o];return n.warn(i,s)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}toString(n=stringify$4){n.stringify&&(n=n.stringify);let i="";return n(this,r=>{i+=r}),i}assign(n={}){for(let i in n)this[i]=n[i];return this}clone(n={}){let i=cloneNode(this);for(let r in n)i[r]=n[r];return i}cloneBefore(n={}){let i=this.clone(n);return this.parent.insertBefore(this,i),i}cloneAfter(n={}){let i=this.clone(n);return this.parent.insertAfter(this,i),i}replaceWith(...n){if(this.parent){let i=this,r=!1;for(let s of n)s===this?r=!0:r?(this.parent.insertAfter(i,s),i=s):this.parent.insertBefore(i,s);r||this.remove()}return this}next(){if(!this.parent)return;let n=this.parent.index(this);return this.parent.nodes[n+1]}prev(){if(!this.parent)return;let n=this.parent.index(this);return this.parent.nodes[n-1]}before(n){return this.parent.insertBefore(this,n),this}after(n){return this.parent.insertAfter(this,n),this}root(){let n=this;for(;n.parent&&n.parent.type!=="document";)n=n.parent;return n}raw(n,i){return new Stringifier().raw(this,n,i)}cleanRaws(n){delete this.raws.before,delete this.raws.after,n||delete this.raws.between}toJSON(n,i){let r={},s=i==null;i=i||new Map;let o=0;for(let l in this){if(!Object.prototype.hasOwnProperty.call(this,l)||l==="parent"||l==="proxyCache")continue;let f=this[l];if(Array.isArray(f))r[l]=f.map(d=>typeof d=="object"&&d.toJSON?d.toJSON(null,i):d);else if(typeof f=="object"&&f.toJSON)r[l]=f.toJSON(null,i);else if(l==="source"){let d=i.get(f.input);d==null&&(d=o,i.set(f.input,o),o++),r[l]={inputId:d,start:f.start,end:f.end}}else r[l]=f}return s&&(r.inputs=[...i.keys()].map(l=>l.toJSON())),r}positionInside(n){let i=this.toString(),r=this.source.start.column,s=this.source.start.line;for(let o=0;o<n;o++)i[o]===`
`?(r=1,s+=1):r+=1;return{line:s,column:r}}positionBy(n){let i=this.source.start;if(n.index)i=this.positionInside(n.index);else if(n.word){let r=this.toString().indexOf(n.word);r!==-1&&(i=this.positionInside(r))}return i}rangeBy(n){let i={line:this.source.start.line,column:this.source.start.column},r=this.source.end?{line:this.source.end.line,column:this.source.end.column+1}:{line:i.line,column:i.column+1};if(n.word){let s=this.toString().indexOf(n.word);s!==-1&&(i=this.positionInside(s),r=this.positionInside(s+n.word.length))}else n.start?i={line:n.start.line,column:n.start.column}:n.index&&(i=this.positionInside(n.index)),n.end?r={line:n.end.line,column:n.end.column}:n.endIndex?r=this.positionInside(n.endIndex):n.index&&(r=this.positionInside(n.index+1));return(r.line<i.line||r.line===i.line&&r.column<=i.column)&&(r={line:i.line,column:i.column+1}),{start:i,end:r}}getProxyProcessor(){return{set(n,i,r){return n[i]===r||(n[i]=r,(i==="prop"||i==="value"||i==="name"||i==="params"||i==="important"||i==="text")&&n.markDirty()),!0},get(n,i){return i==="proxyOf"?n:i==="root"?()=>n.root().toProxy():n[i]}}}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}addToError(n){if(n.postcssNode=this,n.stack&&this.source&&/\n\s{4}at /.test(n.stack)){let i=this.source;n.stack=n.stack.replace(/\n\s{4}at /,`$&${i.input.from}:${i.start.line}:${i.start.column}$&`)}return n}markDirty(){if(this[isClean$2]){this[isClean$2]=!1;let n=this;for(;n=n.parent;)n[isClean$2]=!1}}get proxyOf(){return this}};var node=Node$7;Node$7.default=Node$7;let Node$6=node,Declaration$4=class extends Node$6{constructor(n){n&&typeof n.value<"u"&&typeof n.value!="string"&&(n={...n,value:String(n.value)}),super(n),this.type="decl"}get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}};var declaration=Declaration$4;Declaration$4.default=Declaration$4;let urlAlphabet="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",customAlphabet=(e,n=21)=>(i=n)=>{let r="",s=i;for(;s--;)r+=e[Math.random()*e.length|0];return r},nanoid$1=(e=21)=>{let n="",i=e;for(;i--;)n+=urlAlphabet[Math.random()*64|0];return n};const nonSecure=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet,nanoid:nanoid$1},Symbol.toStringTag,{value:"Module"})),require$$3=getAugmentedNamespace(nonSecure);let{SourceMapConsumer:SourceMapConsumer$2,SourceMapGenerator:SourceMapGenerator$2}=require$$2,{existsSync,readFileSync}=require$$2,{dirname:dirname$1,join:join$2}=require$$2;function fromBase64(e){return Buffer?Buffer.from(e,"base64").toString():window.atob(e)}let PreviousMap$2=class{constructor(n,i){if(i.map===!1)return;this.loadAnnotation(n),this.inline=this.startWith(this.annotation,"data:");let r=i.map?i.map.prev:void 0,s=this.loadMap(i.from,r);!this.mapFile&&i.from&&(this.mapFile=i.from),this.mapFile&&(this.root=dirname$1(this.mapFile)),s&&(this.text=s)}consumer(){return this.consumerCache||(this.consumerCache=new SourceMapConsumer$2(this.text)),this.consumerCache}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}startWith(n,i){return n?n.substr(0,i.length)===i:!1}getAnnotationURL(n){return n.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}loadAnnotation(n){let i=n.match(/\/\*\s*# sourceMappingURL=/gm);if(!i)return;let r=n.lastIndexOf(i.pop()),s=n.indexOf("*/",r);r>-1&&s>-1&&(this.annotation=this.getAnnotationURL(n.substring(r,s)))}decodeInline(n){let i=/^data:application\/json;charset=utf-?8;base64,/,r=/^data:application\/json;base64,/,s=/^data:application\/json;charset=utf-?8,/,o=/^data:application\/json,/;if(s.test(n)||o.test(n))return decodeURIComponent(n.substr(RegExp.lastMatch.length));if(i.test(n)||r.test(n))return fromBase64(n.substr(RegExp.lastMatch.length));let l=n.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+l)}loadFile(n){if(this.root=dirname$1(n),existsSync(n))return this.mapFile=n,readFileSync(n,"utf-8").toString().trim()}loadMap(n,i){if(i===!1)return!1;if(i){if(typeof i=="string")return i;if(typeof i=="function"){let r=i(n);if(r){let s=this.loadFile(r);if(!s)throw new Error("Unable to load previous source map: "+r.toString());return s}}else{if(i instanceof SourceMapConsumer$2)return SourceMapGenerator$2.fromSourceMap(i).toString();if(i instanceof SourceMapGenerator$2)return i.toString();if(this.isMap(i))return JSON.stringify(i);throw new Error("Unsupported previous source map format: "+i.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let r=this.annotation;return n&&(r=join$2(dirname$1(n),r)),this.loadFile(r)}}}isMap(n){return typeof n!="object"?!1:typeof n.mappings=="string"||typeof n._mappings=="string"||Array.isArray(n.sections)}};var previousMap=PreviousMap$2;PreviousMap$2.default=PreviousMap$2;let{SourceMapConsumer:SourceMapConsumer$1,SourceMapGenerator:SourceMapGenerator$1}=require$$2,{fileURLToPath,pathToFileURL:pathToFileURL$1}=require$$2,{resolve:resolve$2,isAbsolute}=require$$2,{nanoid}=require$$3,terminalHighlight=require$$2,CssSyntaxError$1=cssSyntaxError,PreviousMap$1=previousMap,fromOffsetCache=Symbol("fromOffsetCache"),sourceMapAvailable$1=Boolean(SourceMapConsumer$1&&SourceMapGenerator$1),pathAvailable$1=Boolean(resolve$2&&isAbsolute),Input$4=class{constructor(n,i={}){if(n===null||typeof n>"u"||typeof n=="object"&&!n.toString)throw new Error(`PostCSS received ${n} instead of CSS string`);if(this.css=n.toString(),this.css[0]==="\uFEFF"||this.css[0]===""?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,i.from&&(!pathAvailable$1||/^\w+:\/\//.test(i.from)||isAbsolute(i.from)?this.file=i.from:this.file=resolve$2(i.from)),pathAvailable$1&&sourceMapAvailable$1){let r=new PreviousMap$1(this.css,i);if(r.text){this.map=r;let s=r.consumer().file;!this.file&&s&&(this.file=this.mapResolve(s))}}this.file||(this.id="<input css "+nanoid(6)+">"),this.map&&(this.map.file=this.from)}fromOffset(n){let i,r;if(this[fromOffsetCache])r=this[fromOffsetCache];else{let o=this.css.split(`
`);r=new Array(o.length);let l=0;for(let f=0,d=o.length;f<d;f++)r[f]=l,l+=o[f].length+1;this[fromOffsetCache]=r}i=r[r.length-1];let s=0;if(n>=i)s=r.length-1;else{let o=r.length-2,l;for(;s<o;)if(l=s+(o-s>>1),n<r[l])o=l-1;else if(n>=r[l+1])s=l+1;else{s=l;break}}return{line:s+1,col:n-r[s]+1}}error(n,i,r,s={}){let o,l,f;if(i&&typeof i=="object"){let p=i,g=r;if(typeof p.offset=="number"){let v=this.fromOffset(p.offset);i=v.line,r=v.col}else i=p.line,r=p.column;if(typeof g.offset=="number"){let v=this.fromOffset(g.offset);l=v.line,f=v.col}else l=g.line,f=g.column}else if(!r){let p=this.fromOffset(i);i=p.line,r=p.col}let d=this.origin(i,r,l,f);return d?o=new CssSyntaxError$1(n,d.endLine===void 0?d.line:{line:d.line,column:d.column},d.endLine===void 0?d.column:{line:d.endLine,column:d.endColumn},d.source,d.file,s.plugin):o=new CssSyntaxError$1(n,l===void 0?i:{line:i,column:r},l===void 0?r:{line:l,column:f},this.css,this.file,s.plugin),o.input={line:i,column:r,endLine:l,endColumn:f,source:this.css},this.file&&(pathToFileURL$1&&(o.input.url=pathToFileURL$1(this.file).toString()),o.input.file=this.file),o}origin(n,i,r,s){if(!this.map)return!1;let o=this.map.consumer(),l=o.originalPositionFor({line:n,column:i});if(!l.source)return!1;let f;typeof r=="number"&&(f=o.originalPositionFor({line:r,column:s}));let d;isAbsolute(l.source)?d=pathToFileURL$1(l.source):d=new URL(l.source,this.map.consumer().sourceRoot||pathToFileURL$1(this.map.mapFile));let p={url:d.toString(),line:l.line,column:l.column,endLine:f&&f.line,endColumn:f&&f.column};if(d.protocol==="file:")if(fileURLToPath)p.file=fileURLToPath(d);else throw new Error("file: protocol is not available in this PostCSS build");let g=o.sourceContentFor(l.source);return g&&(p.source=g),p}mapResolve(n){return/^\w+:\/\//.test(n)?n:resolve$2(this.map.consumer().sourceRoot||this.map.root||".",n)}get from(){return this.file||this.id}toJSON(){let n={};for(let i of["hasBOM","css","file","id"])this[i]!=null&&(n[i]=this[i]);return this.map&&(n.map={...this.map},n.map.consumerCache&&(n.map.consumerCache=void 0)),n}};var input=Input$4;Input$4.default=Input$4;terminalHighlight&&terminalHighlight.registerInput&&terminalHighlight.registerInput(Input$4);let{SourceMapConsumer,SourceMapGenerator}=require$$2,{dirname,resolve:resolve$1,relative,sep}=require$$2,{pathToFileURL}=require$$2,Input$3=input,sourceMapAvailable=Boolean(SourceMapConsumer&&SourceMapGenerator),pathAvailable=Boolean(dirname&&resolve$1&&relative&&sep),MapGenerator$2=class{constructor(n,i,r,s){this.stringify=n,this.mapOpts=r.map||{},this.root=i,this.opts=r,this.css=s,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(n=>{if(n.source&&n.source.input.map){let i=n.source.input.map;this.previousMaps.includes(i)||this.previousMaps.push(i)}});else{let n=new Input$3(this.css,this.opts);n.map&&this.previousMaps.push(n.map)}return this.previousMaps}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let n=this.mapOpts.annotation;return typeof n<"u"&&n!==!0?!1:this.previous().length?this.previous().some(i=>i.inline):!0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(n=>n.withContent()):!0}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let n;for(let i=this.root.nodes.length-1;i>=0;i--)n=this.root.nodes[i],n.type==="comment"&&n.text.indexOf("# sourceMappingURL=")===0&&this.root.removeChild(i)}else this.css&&(this.css=this.css.replace(/(\n)?\/\*#[\S\s]*?\*\/$/gm,""))}setSourcesContent(){let n={};if(this.root)this.root.walk(i=>{if(i.source){let r=i.source.input.from;if(r&&!n[r]){n[r]=!0;let s=this.usesFileUrls?this.toFileUrl(r):this.toUrl(this.path(r));this.map.setSourceContent(s,i.source.input.css)}}});else if(this.css){let i=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(i,this.css)}}applyPrevMaps(){for(let n of this.previous()){let i=this.toUrl(this.path(n.file)),r=n.root||dirname(n.file),s;this.mapOpts.sourcesContent===!1?(s=new SourceMapConsumer(n.text),s.sourcesContent&&(s.sourcesContent=s.sourcesContent.map(()=>null))):s=n.consumer(),this.map.applySourceMap(s,i,this.toUrl(this.path(r)))}}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(n=>n.annotation):!0}toBase64(n){return Buffer?Buffer.from(n).toString("base64"):window.btoa(unescape(encodeURIComponent(n)))}addAnnotation(){let n;this.isInline()?n="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?n=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?n=this.mapOpts.annotation(this.opts.to,this.root):n=this.outputFile()+".map";let i=`
`;this.css.includes(`\r
`)&&(i=`\r
`),this.css+=i+"/*# sourceMappingURL="+n+" */"}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let n=this.previous()[0].consumer();n.file=this.outputFile(),this.map=SourceMapGenerator.fromSourceMap(n)}else this.map=new SourceMapGenerator({file:this.outputFile()}),this.map.addMapping({source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>",generated:{line:1,column:0},original:{line:1,column:0}});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}path(n){if(n.indexOf("<")===0||/^\w+:\/\//.test(n)||this.mapOpts.absolute)return n;let i=this.opts.to?dirname(this.opts.to):".";return typeof this.mapOpts.annotation=="string"&&(i=dirname(resolve$1(i,this.mapOpts.annotation))),n=relative(i,n),n}toUrl(n){return sep==="\\"&&(n=n.replace(/\\/g,"/")),encodeURI(n).replace(/[#?]/g,encodeURIComponent)}toFileUrl(n){if(pathToFileURL)return pathToFileURL(n).toString();throw new Error("`map.absolute` option is not available in this PostCSS build")}sourcePath(n){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(n.source.input.from):this.toUrl(this.path(n.source.input.from))}generateString(){this.css="",this.map=new SourceMapGenerator({file:this.outputFile()});let n=1,i=1,r="<no source>",s={source:"",generated:{line:0,column:0},original:{line:0,column:0}},o,l;this.stringify(this.root,(f,d,p)=>{if(this.css+=f,d&&p!=="end"&&(s.generated.line=n,s.generated.column=i-1,d.source&&d.source.start?(s.source=this.sourcePath(d),s.original.line=d.source.start.line,s.original.column=d.source.start.column-1,this.map.addMapping(s)):(s.source=r,s.original.line=1,s.original.column=0,this.map.addMapping(s))),o=f.match(/\n/g),o?(n+=o.length,l=f.lastIndexOf(`
`),i=f.length-l):i+=f.length,d&&p!=="start"){let g=d.parent||{raws:{}};(!(d.type==="decl"||d.type==="atrule"&&!d.nodes)||d!==g.last||g.raws.semicolon)&&(d.source&&d.source.end?(s.source=this.sourcePath(d),s.original.line=d.source.end.line,s.original.column=d.source.end.column-1,s.generated.line=n,s.generated.column=i-2,this.map.addMapping(s)):(s.source=r,s.original.line=1,s.original.column=0,s.generated.line=n,s.generated.column=i-1,this.map.addMapping(s)))}})}generate(){if(this.clearAnnotation(),pathAvailable&&sourceMapAvailable&&this.isMap())return this.generateMap();{let n="";return this.stringify(this.root,i=>{n+=i}),[n]}}};var mapGenerator=MapGenerator$2;let Node$5=node,Comment$4=class extends Node$5{constructor(n){super(n),this.type="comment"}};var comment=Comment$4;Comment$4.default=Comment$4;let{isClean:isClean$1,my:my$1}=symbols$3,Declaration$3=declaration,Comment$3=comment,Node$4=node,parse$b,Rule$4,AtRule$4,Root$6;function cleanSource(e){return e.map(n=>(n.nodes&&(n.nodes=cleanSource(n.nodes)),delete n.source,n))}function markDirtyUp(e){if(e[isClean$1]=!1,e.proxyOf.nodes)for(let n of e.proxyOf.nodes)markDirtyUp(n)}let Container$7=class extends Node$4{push(n){return n.parent=this,this.proxyOf.nodes.push(n),this}each(n){if(!this.proxyOf.nodes)return;let i=this.getIterator(),r,s;for(;this.indexes[i]<this.proxyOf.nodes.length&&(r=this.indexes[i],s=n(this.proxyOf.nodes[r],r),s!==!1);)this.indexes[i]+=1;return delete this.indexes[i],s}walk(n){return this.each((i,r)=>{let s;try{s=n(i,r)}catch(o){throw i.addToError(o)}return s!==!1&&i.walk&&(s=i.walk(n)),s})}walkDecls(n,i){return i?n instanceof RegExp?this.walk((r,s)=>{if(r.type==="decl"&&n.test(r.prop))return i(r,s)}):this.walk((r,s)=>{if(r.type==="decl"&&r.prop===n)return i(r,s)}):(i=n,this.walk((r,s)=>{if(r.type==="decl")return i(r,s)}))}walkRules(n,i){return i?n instanceof RegExp?this.walk((r,s)=>{if(r.type==="rule"&&n.test(r.selector))return i(r,s)}):this.walk((r,s)=>{if(r.type==="rule"&&r.selector===n)return i(r,s)}):(i=n,this.walk((r,s)=>{if(r.type==="rule")return i(r,s)}))}walkAtRules(n,i){return i?n instanceof RegExp?this.walk((r,s)=>{if(r.type==="atrule"&&n.test(r.name))return i(r,s)}):this.walk((r,s)=>{if(r.type==="atrule"&&r.name===n)return i(r,s)}):(i=n,this.walk((r,s)=>{if(r.type==="atrule")return i(r,s)}))}walkComments(n){return this.walk((i,r)=>{if(i.type==="comment")return n(i,r)})}append(...n){for(let i of n){let r=this.normalize(i,this.last);for(let s of r)this.proxyOf.nodes.push(s)}return this.markDirty(),this}prepend(...n){n=n.reverse();for(let i of n){let r=this.normalize(i,this.first,"prepend").reverse();for(let s of r)this.proxyOf.nodes.unshift(s);for(let s in this.indexes)this.indexes[s]=this.indexes[s]+r.length}return this.markDirty(),this}cleanRaws(n){if(super.cleanRaws(n),this.nodes)for(let i of this.nodes)i.cleanRaws(n)}insertBefore(n,i){let r=this.index(n),s=r===0?"prepend":!1,o=this.normalize(i,this.proxyOf.nodes[r],s).reverse();r=this.index(n);for(let f of o)this.proxyOf.nodes.splice(r,0,f);let l;for(let f in this.indexes)l=this.indexes[f],r<=l&&(this.indexes[f]=l+o.length);return this.markDirty(),this}insertAfter(n,i){let r=this.index(n),s=this.normalize(i,this.proxyOf.nodes[r]).reverse();r=this.index(n);for(let l of s)this.proxyOf.nodes.splice(r+1,0,l);let o;for(let l in this.indexes)o=this.indexes[l],r<o&&(this.indexes[l]=o+s.length);return this.markDirty(),this}removeChild(n){n=this.index(n),this.proxyOf.nodes[n].parent=void 0,this.proxyOf.nodes.splice(n,1);let i;for(let r in this.indexes)i=this.indexes[r],i>=n&&(this.indexes[r]=i-1);return this.markDirty(),this}removeAll(){for(let n of this.proxyOf.nodes)n.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}replaceValues(n,i,r){return r||(r=i,i={}),this.walkDecls(s=>{i.props&&!i.props.includes(s.prop)||i.fast&&!s.value.includes(i.fast)||(s.value=s.value.replace(n,r))}),this.markDirty(),this}every(n){return this.nodes.every(n)}some(n){return this.nodes.some(n)}index(n){return typeof n=="number"?n:(n.proxyOf&&(n=n.proxyOf),this.proxyOf.nodes.indexOf(n))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}normalize(n,i){if(typeof n=="string")n=cleanSource(parse$b(n).nodes);else if(Array.isArray(n)){n=n.slice(0);for(let s of n)s.parent&&s.parent.removeChild(s,"ignore")}else if(n.type==="root"&&this.type!=="document"){n=n.nodes.slice(0);for(let s of n)s.parent&&s.parent.removeChild(s,"ignore")}else if(n.type)n=[n];else if(n.prop){if(typeof n.value>"u")throw new Error("Value field is missed in node creation");typeof n.value!="string"&&(n.value=String(n.value)),n=[new Declaration$3(n)]}else if(n.selector)n=[new Rule$4(n)];else if(n.name)n=[new AtRule$4(n)];else if(n.text)n=[new Comment$3(n)];else throw new Error("Unknown node type in node creation");return n.map(s=>(s[my$1]||Container$7.rebuild(s),s=s.proxyOf,s.parent&&s.parent.removeChild(s),s[isClean$1]&&markDirtyUp(s),typeof s.raws.before>"u"&&i&&typeof i.raws.before<"u"&&(s.raws.before=i.raws.before.replace(/\S/g,"")),s.parent=this.proxyOf,s))}getProxyProcessor(){return{set(n,i,r){return n[i]===r||(n[i]=r,(i==="name"||i==="params"||i==="selector")&&n.markDirty()),!0},get(n,i){return i==="proxyOf"?n:n[i]?i==="each"||typeof i=="string"&&i.startsWith("walk")?(...r)=>n[i](...r.map(s=>typeof s=="function"?(o,l)=>s(o.toProxy(),l):s)):i==="every"||i==="some"?r=>n[i]((s,...o)=>r(s.toProxy(),...o)):i==="root"?()=>n.root().toProxy():i==="nodes"?n.nodes.map(r=>r.toProxy()):i==="first"||i==="last"?n[i].toProxy():n[i]:n[i]}}}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let n=this.lastEach;return this.indexes[n]=0,n}};Container$7.registerParse=e=>{parse$b=e};Container$7.registerRule=e=>{Rule$4=e};Container$7.registerAtRule=e=>{AtRule$4=e};Container$7.registerRoot=e=>{Root$6=e};var container=Container$7;Container$7.default=Container$7;Container$7.rebuild=e=>{e.type==="atrule"?Object.setPrototypeOf(e,AtRule$4.prototype):e.type==="rule"?Object.setPrototypeOf(e,Rule$4.prototype):e.type==="decl"?Object.setPrototypeOf(e,Declaration$3.prototype):e.type==="comment"?Object.setPrototypeOf(e,Comment$3.prototype):e.type==="root"&&Object.setPrototypeOf(e,Root$6.prototype),e[my$1]=!0,e.nodes&&e.nodes.forEach(n=>{Container$7.rebuild(n)})};let Container$6=container,LazyResult$4,Processor$3,Document$3=class extends Container$6{constructor(n){super({type:"document",...n}),this.nodes||(this.nodes=[])}toResult(n={}){return new LazyResult$4(new Processor$3,this,n).stringify()}};Document$3.registerLazyResult=e=>{LazyResult$4=e};Document$3.registerProcessor=e=>{Processor$3=e};var document$1=Document$3;Document$3.default=Document$3;let Warning$2=class{constructor(n,i={}){if(this.type="warning",this.text=n,i.node&&i.node.source){let r=i.node.rangeBy(i);this.line=r.start.line,this.column=r.start.column,this.endLine=r.end.line,this.endColumn=r.end.column}for(let r in i)this[r]=i[r]}toString(){return this.node?this.node.error(this.text,{plugin:this.plugin,index:this.index,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var warning=Warning$2;Warning$2.default=Warning$2;let Warning$1=warning,Result$3=class{constructor(n,i,r){this.processor=n,this.messages=[],this.root=i,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(n,i={}){i.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(i.plugin=this.lastPlugin.postcssPlugin);let r=new Warning$1(n,i);return this.messages.push(r),r}warnings(){return this.messages.filter(n=>n.type==="warning")}get content(){return this.css}};var result=Result$3;Result$3.default=Result$3;const SINGLE_QUOTE="'".charCodeAt(0),DOUBLE_QUOTE='"'.charCodeAt(0),BACKSLASH="\\".charCodeAt(0),SLASH="/".charCodeAt(0),NEWLINE$1=`
`.charCodeAt(0),SPACE=" ".charCodeAt(0),FEED="\f".charCodeAt(0),TAB="	".charCodeAt(0),CR="\r".charCodeAt(0),OPEN_SQUARE="[".charCodeAt(0),CLOSE_SQUARE="]".charCodeAt(0),OPEN_PARENTHESES="(".charCodeAt(0),CLOSE_PARENTHESES=")".charCodeAt(0),OPEN_CURLY="{".charCodeAt(0),CLOSE_CURLY="}".charCodeAt(0),SEMICOLON=";".charCodeAt(0),ASTERISK="*".charCodeAt(0),COLON$1=":".charCodeAt(0),AT="@".charCodeAt(0),RE_AT_END=/[\t\n\f\r "#'()/;[\\\]{}]/g,RE_WORD_END=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,RE_BAD_BRACKET=/.[\n"'(/\\]/,RE_HEX_ESCAPE=/[\da-f]/i;var tokenize$1=function e(n,i={}){let r=n.css.valueOf(),s=i.ignoreErrors,o,l,f,d,p,g,v,S,T,k,O=r.length,R=0,P=[],F=[];function I(){return R}function L(q){throw n.error("Unclosed "+q,R)}function N(){return F.length===0&&R>=O}function j(q){if(F.length)return F.pop();if(R>=O)return;let H=q?q.ignoreUnclosed:!1;switch(o=r.charCodeAt(R),o){case NEWLINE$1:case SPACE:case TAB:case CR:case FEED:{l=R;do l+=1,o=r.charCodeAt(l);while(o===SPACE||o===NEWLINE$1||o===TAB||o===CR||o===FEED);k=["space",r.slice(R,l)],R=l-1;break}case OPEN_SQUARE:case CLOSE_SQUARE:case OPEN_CURLY:case CLOSE_CURLY:case COLON$1:case SEMICOLON:case CLOSE_PARENTHESES:{let W=String.fromCharCode(o);k=[W,W,R];break}case OPEN_PARENTHESES:{if(S=P.length?P.pop()[1]:"",T=r.charCodeAt(R+1),S==="url"&&T!==SINGLE_QUOTE&&T!==DOUBLE_QUOTE&&T!==SPACE&&T!==NEWLINE$1&&T!==TAB&&T!==FEED&&T!==CR){l=R;do{if(g=!1,l=r.indexOf(")",l+1),l===-1)if(s||H){l=R;break}else L("bracket");for(v=l;r.charCodeAt(v-1)===BACKSLASH;)v-=1,g=!g}while(g);k=["brackets",r.slice(R,l+1),R,l],R=l}else l=r.indexOf(")",R+1),d=r.slice(R,l+1),l===-1||RE_BAD_BRACKET.test(d)?k=["(","(",R]:(k=["brackets",d,R,l],R=l);break}case SINGLE_QUOTE:case DOUBLE_QUOTE:{f=o===SINGLE_QUOTE?"'":'"',l=R;do{if(g=!1,l=r.indexOf(f,l+1),l===-1)if(s||H){l=R+1;break}else L("string");for(v=l;r.charCodeAt(v-1)===BACKSLASH;)v-=1,g=!g}while(g);k=["string",r.slice(R,l+1),R,l],R=l;break}case AT:{RE_AT_END.lastIndex=R+1,RE_AT_END.test(r),RE_AT_END.lastIndex===0?l=r.length-1:l=RE_AT_END.lastIndex-2,k=["at-word",r.slice(R,l+1),R,l],R=l;break}case BACKSLASH:{for(l=R,p=!0;r.charCodeAt(l+1)===BACKSLASH;)l+=1,p=!p;if(o=r.charCodeAt(l+1),p&&o!==SLASH&&o!==SPACE&&o!==NEWLINE$1&&o!==TAB&&o!==CR&&o!==FEED&&(l+=1,RE_HEX_ESCAPE.test(r.charAt(l)))){for(;RE_HEX_ESCAPE.test(r.charAt(l+1));)l+=1;r.charCodeAt(l+1)===SPACE&&(l+=1)}k=["word",r.slice(R,l+1),R,l],R=l;break}default:{o===SLASH&&r.charCodeAt(R+1)===ASTERISK?(l=r.indexOf("*/",R+2)+1,l===0&&(s||H?l=r.length:L("comment")),k=["comment",r.slice(R,l+1),R,l],R=l):(RE_WORD_END.lastIndex=R+1,RE_WORD_END.test(r),RE_WORD_END.lastIndex===0?l=r.length-1:l=RE_WORD_END.lastIndex-2,k=["word",r.slice(R,l+1),R,l],P.push(k),R=l);break}}return R++,k}function z(q){F.push(q)}return{back:z,nextToken:j,endOfFile:N,position:I}};let Container$5=container,AtRule$3=class extends Container$5{constructor(n){super(n),this.type="atrule"}append(...n){return this.proxyOf.nodes||(this.nodes=[]),super.append(...n)}prepend(...n){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...n)}};var atRule=AtRule$3;AtRule$3.default=AtRule$3;Container$5.registerAtRule(AtRule$3);let Container$4=container,LazyResult$3,Processor$2,Root$5=class extends Container$4{constructor(n){super(n),this.type="root",this.nodes||(this.nodes=[])}removeChild(n,i){let r=this.index(n);return!i&&r===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[r].raws.before),super.removeChild(n)}normalize(n,i,r){let s=super.normalize(n);if(i){if(r==="prepend")this.nodes.length>1?i.raws.before=this.nodes[1].raws.before:delete i.raws.before;else if(this.first!==i)for(let o of s)o.raws.before=i.raws.before}return s}toResult(n={}){return new LazyResult$3(new Processor$2,this,n).stringify()}};Root$5.registerLazyResult=e=>{LazyResult$3=e};Root$5.registerProcessor=e=>{Processor$2=e};var root=Root$5;Root$5.default=Root$5;Container$4.registerRoot(Root$5);let list$2={split(e,n,i){let r=[],s="",o=!1,l=0,f=!1,d="",p=!1;for(let g of e)p?p=!1:g==="\\"?p=!0:f?g===d&&(f=!1):g==='"'||g==="'"?(f=!0,d=g):g==="("?l+=1:g===")"?l>0&&(l-=1):l===0&&n.includes(g)&&(o=!0),o?(s!==""&&r.push(s.trim()),s="",o=!1):s+=g;return(i||s!=="")&&r.push(s.trim()),r},space(e){let n=[" ",`
`,"	"];return list$2.split(e,n)},comma(e){return list$2.split(e,[","],!0)}};var list_1=list$2;list$2.default=list$2;let Container$3=container,list$1=list_1,Rule$3=class extends Container$3{constructor(n){super(n),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return list$1.comma(this.selector)}set selectors(n){let i=this.selector?this.selector.match(/,\s*/):null,r=i?i[0]:","+this.raw("between","beforeOpen");this.selector=n.join(r)}};var rule$3=Rule$3;Rule$3.default=Rule$3;Container$3.registerRule(Rule$3);let Declaration$2=declaration,tokenizer=tokenize$1,Comment$2=comment,AtRule$2=atRule,Root$4=root,Rule$2=rule$3;const SAFE_COMMENT_NEIGHBOR={empty:!0,space:!0};function findLastWithPosition(e){for(let n=e.length-1;n>=0;n--){let i=e[n],r=i[3]||i[2];if(r)return r}}let Parser$1=class{constructor(n){this.input=n,this.root=new Root$4,this.current=this.root,this.spaces="",this.semicolon=!1,this.customProperty=!1,this.createTokenizer(),this.root.source={input:n,start:{offset:0,line:1,column:1}}}createTokenizer(){this.tokenizer=tokenizer(this.input)}parse(){let n;for(;!this.tokenizer.endOfFile();)switch(n=this.tokenizer.nextToken(),n[0]){case"space":this.spaces+=n[1];break;case";":this.freeSemicolon(n);break;case"}":this.end(n);break;case"comment":this.comment(n);break;case"at-word":this.atrule(n);break;case"{":this.emptyRule(n);break;default:this.other(n);break}this.endFile()}comment(n){let i=new Comment$2;this.init(i,n[2]),i.source.end=this.getPosition(n[3]||n[2]);let r=n[1].slice(2,-2);if(/^\s*$/.test(r))i.text="",i.raws.left=r,i.raws.right="";else{let s=r.match(/^(\s*)([^]*\S)(\s*)$/);i.text=s[2],i.raws.left=s[1],i.raws.right=s[3]}}emptyRule(n){let i=new Rule$2;this.init(i,n[2]),i.selector="",i.raws.between="",this.current=i}other(n){let i=!1,r=null,s=!1,o=null,l=[],f=n[1].startsWith("--"),d=[],p=n;for(;p;){if(r=p[0],d.push(p),r==="("||r==="[")o||(o=p),l.push(r==="("?")":"]");else if(f&&s&&r==="{")o||(o=p),l.push("}");else if(l.length===0)if(r===";")if(s){this.decl(d,f);return}else break;else if(r==="{"){this.rule(d);return}else if(r==="}"){this.tokenizer.back(d.pop()),i=!0;break}else r===":"&&(s=!0);else r===l[l.length-1]&&(l.pop(),l.length===0&&(o=null));p=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(i=!0),l.length>0&&this.unclosedBracket(o),i&&s){if(!f)for(;d.length&&(p=d[d.length-1][0],!(p!=="space"&&p!=="comment"));)this.tokenizer.back(d.pop());this.decl(d,f)}else this.unknownWord(d)}rule(n){n.pop();let i=new Rule$2;this.init(i,n[0][2]),i.raws.between=this.spacesAndCommentsFromEnd(n),this.raw(i,"selector",n),this.current=i}decl(n,i){let r=new Declaration$2;this.init(r,n[0][2]);let s=n[n.length-1];for(s[0]===";"&&(this.semicolon=!0,n.pop()),r.source.end=this.getPosition(s[3]||s[2]||findLastWithPosition(n));n[0][0]!=="word";)n.length===1&&this.unknownWord(n),r.raws.before+=n.shift()[1];for(r.source.start=this.getPosition(n[0][2]),r.prop="";n.length;){let p=n[0][0];if(p===":"||p==="space"||p==="comment")break;r.prop+=n.shift()[1]}r.raws.between="";let o;for(;n.length;)if(o=n.shift(),o[0]===":"){r.raws.between+=o[1];break}else o[0]==="word"&&/\w/.test(o[1])&&this.unknownWord([o]),r.raws.between+=o[1];(r.prop[0]==="_"||r.prop[0]==="*")&&(r.raws.before+=r.prop[0],r.prop=r.prop.slice(1));let l=[],f;for(;n.length&&(f=n[0][0],!(f!=="space"&&f!=="comment"));)l.push(n.shift());this.precheckMissedSemicolon(n);for(let p=n.length-1;p>=0;p--){if(o=n[p],o[1].toLowerCase()==="!important"){r.important=!0;let g=this.stringFrom(n,p);g=this.spacesFromEnd(n)+g,g!==" !important"&&(r.raws.important=g);break}else if(o[1].toLowerCase()==="important"){let g=n.slice(0),v="";for(let S=p;S>0;S--){let T=g[S][0];if(v.trim().indexOf("!")===0&&T!=="space")break;v=g.pop()[1]+v}v.trim().indexOf("!")===0&&(r.important=!0,r.raws.important=v,n=g)}if(o[0]!=="space"&&o[0]!=="comment")break}n.some(p=>p[0]!=="space"&&p[0]!=="comment")&&(r.raws.between+=l.map(p=>p[1]).join(""),l=[]),this.raw(r,"value",l.concat(n),i),r.value.includes(":")&&!i&&this.checkMissedSemicolon(n)}atrule(n){let i=new AtRule$2;i.name=n[1].slice(1),i.name===""&&this.unnamedAtrule(i,n),this.init(i,n[2]);let r,s,o,l=!1,f=!1,d=[],p=[];for(;!this.tokenizer.endOfFile();){if(n=this.tokenizer.nextToken(),r=n[0],r==="("||r==="["?p.push(r==="("?")":"]"):r==="{"&&p.length>0?p.push("}"):r===p[p.length-1]&&p.pop(),p.length===0)if(r===";"){i.source.end=this.getPosition(n[2]),this.semicolon=!0;break}else if(r==="{"){f=!0;break}else if(r==="}"){if(d.length>0){for(o=d.length-1,s=d[o];s&&s[0]==="space";)s=d[--o];s&&(i.source.end=this.getPosition(s[3]||s[2]))}this.end(n);break}else d.push(n);else d.push(n);if(this.tokenizer.endOfFile()){l=!0;break}}i.raws.between=this.spacesAndCommentsFromEnd(d),d.length?(i.raws.afterName=this.spacesAndCommentsFromStart(d),this.raw(i,"params",d),l&&(n=d[d.length-1],i.source.end=this.getPosition(n[3]||n[2]),this.spaces=i.raws.between,i.raws.between="")):(i.raws.afterName="",i.params=""),f&&(i.nodes=[],this.current=i)}end(n){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(n[2]),this.current=this.current.parent):this.unexpectedClose(n)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces}freeSemicolon(n){if(this.spaces+=n[1],this.current.nodes){let i=this.current.nodes[this.current.nodes.length-1];i&&i.type==="rule"&&!i.raws.ownSemicolon&&(i.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(n){let i=this.input.fromOffset(n);return{offset:n,line:i.line,column:i.col}}init(n,i){this.current.push(n),n.source={start:this.getPosition(i),input:this.input},n.raws.before=this.spaces,this.spaces="",n.type!=="comment"&&(this.semicolon=!1)}raw(n,i,r,s){let o,l,f=r.length,d="",p=!0,g,v;for(let S=0;S<f;S+=1)o=r[S],l=o[0],l==="space"&&S===f-1&&!s?p=!1:l==="comment"?(v=r[S-1]?r[S-1][0]:"empty",g=r[S+1]?r[S+1][0]:"empty",!SAFE_COMMENT_NEIGHBOR[v]&&!SAFE_COMMENT_NEIGHBOR[g]?d.slice(-1)===","?p=!1:d+=o[1]:p=!1):d+=o[1];if(!p){let S=r.reduce((T,k)=>T+k[1],"");n.raws[i]={value:d,raw:S}}n[i]=d}spacesAndCommentsFromEnd(n){let i,r="";for(;n.length&&(i=n[n.length-1][0],!(i!=="space"&&i!=="comment"));)r=n.pop()[1]+r;return r}spacesAndCommentsFromStart(n){let i,r="";for(;n.length&&(i=n[0][0],!(i!=="space"&&i!=="comment"));)r+=n.shift()[1];return r}spacesFromEnd(n){let i,r="";for(;n.length&&(i=n[n.length-1][0],i==="space");)r=n.pop()[1]+r;return r}stringFrom(n,i){let r="";for(let s=i;s<n.length;s++)r+=n[s][1];return n.splice(i,n.length-i),r}colon(n){let i=0,r,s,o;for(let[l,f]of n.entries()){if(r=f,s=r[0],s==="("&&(i+=1),s===")"&&(i-=1),i===0&&s===":")if(!o)this.doubleColon(r);else{if(o[0]==="word"&&o[1]==="progid")continue;return l}o=r}return!1}unclosedBracket(n){throw this.input.error("Unclosed bracket",{offset:n[2]},{offset:n[2]+1})}unknownWord(n){throw this.input.error("Unknown word",{offset:n[0][2]},{offset:n[0][2]+n[0][1].length})}unexpectedClose(n){throw this.input.error("Unexpected }",{offset:n[2]},{offset:n[2]+1})}unclosedBlock(){let n=this.current.source.start;throw this.input.error("Unclosed block",n.line,n.column)}doubleColon(n){throw this.input.error("Double colon",{offset:n[2]},{offset:n[2]+n[1].length})}unnamedAtrule(n,i){throw this.input.error("At-rule without name",{offset:i[2]},{offset:i[2]+i[1].length})}precheckMissedSemicolon(){}checkMissedSemicolon(n){let i=this.colon(n);if(i===!1)return;let r=0,s;for(let o=i-1;o>=0&&(s=n[o],!(s[0]!=="space"&&(r+=1,r===2)));o--);throw this.input.error("Missed semicolon",s[0]==="word"?s[3]+1:s[2])}};var parser$2=Parser$1;let Container$2=container,Parser=parser$2,Input$2=input;function parse$a(e,n){let i=new Input$2(e,n),r=new Parser(i);try{r.parse()}catch(s){throw s}return r.root}var parse_1=parse$a;parse$a.default=parse$a;Container$2.registerParse(parse$a);let{isClean,my}=symbols$3,MapGenerator$1=mapGenerator,stringify$3=stringify_1,Container$1=container,Document$2=document$1,Result$2=result,parse$9=parse_1,Root$3=root;const TYPE_TO_CLASS_NAME={document:"Document",root:"Root",atrule:"AtRule",rule:"Rule",decl:"Declaration",comment:"Comment"},PLUGIN_PROPS={postcssPlugin:!0,prepare:!0,Once:!0,Document:!0,Root:!0,Declaration:!0,Rule:!0,AtRule:!0,Comment:!0,DeclarationExit:!0,RuleExit:!0,AtRuleExit:!0,CommentExit:!0,RootExit:!0,DocumentExit:!0,OnceExit:!0},NOT_VISITORS={postcssPlugin:!0,prepare:!0,Once:!0},CHILDREN=0;function isPromise(e){return typeof e=="object"&&typeof e.then=="function"}function getEvents(e){let n=!1,i=TYPE_TO_CLASS_NAME[e.type];return e.type==="decl"?n=e.prop.toLowerCase():e.type==="atrule"&&(n=e.name.toLowerCase()),n&&e.append?[i,i+"-"+n,CHILDREN,i+"Exit",i+"Exit-"+n]:n?[i,i+"-"+n,i+"Exit",i+"Exit-"+n]:e.append?[i,CHILDREN,i+"Exit"]:[i,i+"Exit"]}function toStack(e){let n;return e.type==="document"?n=["Document",CHILDREN,"DocumentExit"]:e.type==="root"?n=["Root",CHILDREN,"RootExit"]:n=getEvents(e),{node:e,events:n,eventIndex:0,visitors:[],visitorIndex:0,iterator:0}}function cleanMarks(e){return e[isClean]=!1,e.nodes&&e.nodes.forEach(n=>cleanMarks(n)),e}let postcss$1={},LazyResult$2=class{constructor(n,i,r){this.stringified=!1,this.processed=!1;let s;if(typeof i=="object"&&i!==null&&(i.type==="root"||i.type==="document"))s=cleanMarks(i);else if(i instanceof LazyResult$2||i instanceof Result$2)s=cleanMarks(i.root),i.map&&(typeof r.map>"u"&&(r.map={}),r.map.inline||(r.map.inline=!1),r.map.prev=i.map);else{let o=parse$9;r.syntax&&(o=r.syntax.parse),r.parser&&(o=r.parser),o.parse&&(o=o.parse);try{s=o(i,r)}catch(l){this.processed=!0,this.error=l}s&&!s[my]&&Container$1.rebuild(s)}this.result=new Result$2(n,s,r),this.helpers={...postcss$1,result:this.result,postcss:postcss$1},this.plugins=this.processor.plugins.map(o=>typeof o=="object"&&o.prepare?{...o,...o.prepare(this.result)}:o)}get[Symbol.toStringTag](){return"LazyResult"}get processor(){return this.result.processor}get opts(){return this.result.opts}get css(){return this.stringify().css}get content(){return this.stringify().content}get map(){return this.stringify().map}get root(){return this.sync().root}get messages(){return this.sync().messages}warnings(){return this.sync().warnings()}toString(){return this.css}then(n,i){return this.async().then(n,i)}catch(n){return this.async().catch(n)}finally(n){return this.async().then(n,n)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let n of this.plugins){let i=this.runOnRoot(n);if(isPromise(i))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let n=this.result.root;for(;!n[isClean];)n[isClean]=!0,this.walkSync(n);if(this.listeners.OnceExit)if(n.type==="document")for(let i of n.nodes)this.visitSync(this.listeners.OnceExit,i);else this.visitSync(this.listeners.OnceExit,n)}return this.result}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let n=this.result.opts,i=stringify$3;n.syntax&&(i=n.syntax.stringify),n.stringifier&&(i=n.stringifier),i.stringify&&(i=i.stringify);let s=new MapGenerator$1(i,this.result.root,this.result.opts).generate();return this.result.css=s[0],this.result.map=s[1],this.result}walkSync(n){n[isClean]=!0;let i=getEvents(n);for(let r of i)if(r===CHILDREN)n.nodes&&n.each(s=>{s[isClean]||this.walkSync(s)});else{let s=this.listeners[r];if(s&&this.visitSync(s,n.toProxy()))return}}visitSync(n,i){for(let[r,s]of n){this.result.lastPlugin=r;let o;try{o=s(i,this.helpers)}catch(l){throw this.handleError(l,i.proxyOf)}if(i.type!=="root"&&i.type!=="document"&&!i.parent)return!0;if(isPromise(o))throw this.getAsyncError()}}runOnRoot(n){this.result.lastPlugin=n;try{if(typeof n=="object"&&n.Once){if(this.result.root.type==="document"){let i=this.result.root.nodes.map(r=>n.Once(r,this.helpers));return isPromise(i[0])?Promise.all(i):i}return n.Once(this.result.root,this.helpers)}else if(typeof n=="function")return n(this.result.root,this.result)}catch(i){throw this.handleError(i)}}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(n,i){let r=this.result.lastPlugin;try{i&&i.addToError(n),this.error=n,n.name==="CssSyntaxError"&&!n.plugin?(n.plugin=r.postcssPlugin,n.setMessage()):r.postcssVersion}catch(s){console&&console.error&&console.error(s)}return n}async runAsync(){this.plugin=0;for(let n=0;n<this.plugins.length;n++){let i=this.plugins[n],r=this.runOnRoot(i);if(isPromise(r))try{await r}catch(s){throw this.handleError(s)}}if(this.prepareVisitors(),this.hasListener){let n=this.result.root;for(;!n[isClean];){n[isClean]=!0;let i=[toStack(n)];for(;i.length>0;){let r=this.visitTick(i);if(isPromise(r))try{await r}catch(s){let o=i[i.length-1].node;throw this.handleError(s,o)}}}if(this.listeners.OnceExit)for(let[i,r]of this.listeners.OnceExit){this.result.lastPlugin=i;try{if(n.type==="document"){let s=n.nodes.map(o=>r(o,this.helpers));await Promise.all(s)}else await r(n,this.helpers)}catch(s){throw this.handleError(s)}}}return this.processed=!0,this.stringify()}prepareVisitors(){this.listeners={};let n=(i,r,s)=>{this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push([i,s])};for(let i of this.plugins)if(typeof i=="object")for(let r in i){if(!PLUGIN_PROPS[r]&&/^[A-Z]/.test(r))throw new Error(`Unknown event ${r} in ${i.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!NOT_VISITORS[r])if(typeof i[r]=="object")for(let s in i[r])s==="*"?n(i,r,i[r][s]):n(i,r+"-"+s.toLowerCase(),i[r][s]);else typeof i[r]=="function"&&n(i,r,i[r])}this.hasListener=Object.keys(this.listeners).length>0}visitTick(n){let i=n[n.length-1],{node:r,visitors:s}=i;if(r.type!=="root"&&r.type!=="document"&&!r.parent){n.pop();return}if(s.length>0&&i.visitorIndex<s.length){let[l,f]=s[i.visitorIndex];i.visitorIndex+=1,i.visitorIndex===s.length&&(i.visitors=[],i.visitorIndex=0),this.result.lastPlugin=l;try{return f(r.toProxy(),this.helpers)}catch(d){throw this.handleError(d,r)}}if(i.iterator!==0){let l=i.iterator,f;for(;f=r.nodes[r.indexes[l]];)if(r.indexes[l]+=1,!f[isClean]){f[isClean]=!0,n.push(toStack(f));return}i.iterator=0,delete r.indexes[l]}let o=i.events;for(;i.eventIndex<o.length;){let l=o[i.eventIndex];if(i.eventIndex+=1,l===CHILDREN){r.nodes&&r.nodes.length&&(r[isClean]=!0,i.iterator=r.getIterator());return}else if(this.listeners[l]){i.visitors=this.listeners[l];return}}n.pop()}};LazyResult$2.registerPostcss=e=>{postcss$1=e};var lazyResult=LazyResult$2;LazyResult$2.default=LazyResult$2;Root$3.registerLazyResult(LazyResult$2);Document$2.registerLazyResult(LazyResult$2);let MapGenerator=mapGenerator,stringify$2=stringify_1,parse$8=parse_1;const Result$1=result;let NoWorkResult$1=class{constructor(n,i,r){i=i.toString(),this.stringified=!1,this._processor=n,this._css=i,this._opts=r,this._map=void 0;let s,o=stringify$2;this.result=new Result$1(this._processor,s,this._opts),this.result.css=i;let l=this;Object.defineProperty(this.result,"root",{get(){return l.root}});let f=new MapGenerator(o,s,this._opts,i);if(f.isMap()){let[d,p]=f.generate();d&&(this.result.css=d),p&&(this.result.map=p)}}get[Symbol.toStringTag](){return"NoWorkResult"}get processor(){return this.result.processor}get opts(){return this.result.opts}get css(){return this.result.css}get content(){return this.result.css}get map(){return this.result.map}get root(){if(this._root)return this._root;let n,i=parse$8;try{n=i(this._css,this._opts)}catch(r){this.error=r}if(this.error)throw this.error;return this._root=n,n}get messages(){return[]}warnings(){return[]}toString(){return this._css}then(n,i){return this.async().then(n,i)}catch(n){return this.async().catch(n)}finally(n){return this.async().then(n,n)}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}sync(){if(this.error)throw this.error;return this.result}};var noWorkResult=NoWorkResult$1;NoWorkResult$1.default=NoWorkResult$1;let NoWorkResult=noWorkResult,LazyResult$1=lazyResult,Document$1=document$1,Root$2=root,Processor$1=class{constructor(n=[]){this.version="8.4.21",this.plugins=this.normalize(n)}use(n){return this.plugins=this.plugins.concat(this.normalize([n])),this}process(n,i={}){return this.plugins.length===0&&typeof i.parser>"u"&&typeof i.stringifier>"u"&&typeof i.syntax>"u"?new NoWorkResult(this,n,i):new LazyResult$1(this,n,i)}normalize(n){let i=[];for(let r of n)if(r.postcss===!0?r=r():r.postcss&&(r=r.postcss),typeof r=="object"&&Array.isArray(r.plugins))i=i.concat(r.plugins);else if(typeof r=="object"&&r.postcssPlugin)i.push(r);else if(typeof r=="function")i.push(r);else if(!(typeof r=="object"&&(r.parse||r.stringify)))throw new Error(r+" is not a PostCSS plugin");return i}};var processor=Processor$1;Processor$1.default=Processor$1;Root$2.registerProcessor(Processor$1);Document$1.registerProcessor(Processor$1);let Declaration$1=declaration,PreviousMap=previousMap,Comment$1=comment,AtRule$1=atRule,Input$1=input,Root$1=root,Rule$1=rule$3;function fromJSON$1(e,n){if(Array.isArray(e))return e.map(s=>fromJSON$1(s));let{inputs:i,...r}=e;if(i){n=[];for(let s of i){let o={...s,__proto__:Input$1.prototype};o.map&&(o.map={...o.map,__proto__:PreviousMap.prototype}),n.push(o)}}if(r.nodes&&(r.nodes=e.nodes.map(s=>fromJSON$1(s,n))),r.source){let{inputId:s,...o}=r.source;r.source=o,s!=null&&(r.source.input=n[s])}if(r.type==="root")return new Root$1(r);if(r.type==="decl")return new Declaration$1(r);if(r.type==="rule")return new Rule$1(r);if(r.type==="comment")return new Comment$1(r);if(r.type==="atrule")return new AtRule$1(r);throw new Error("Unknown node type: "+e.type)}var fromJSON_1=fromJSON$1;fromJSON$1.default=fromJSON$1;let CssSyntaxError=cssSyntaxError,Declaration=declaration,LazyResult=lazyResult,Container=container,Processor=processor,stringify$1=stringify_1,fromJSON=fromJSON_1,Document=document$1,Warning=warning,Comment=comment,AtRule=atRule,Result=result,Input=input,parse$7=parse_1,list=list_1,Rule=rule$3,Root=root,Node$3=node;function postcss(...e){return e.length===1&&Array.isArray(e[0])&&(e=e[0]),new Processor(e)}postcss.plugin=function e(n,i){let r=!1;function s(...l){console&&console.warn&&!r&&(r=!0,console.warn(n+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),{}.LANG&&{}.LANG.startsWith("cn")&&console.warn(n+`:  postcss.plugin . :
https://www.w3ctech.com/topic/2226`));let f=i(...l);return f.postcssPlugin=n,f.postcssVersion=new Processor().version,f}let o;return Object.defineProperty(s,"postcss",{get(){return o||(o=s()),o}}),s.process=function(l,f,d){return postcss([s(d)]).process(l,f)},s};postcss.stringify=stringify$1;postcss.parse=parse$7;postcss.fromJSON=fromJSON;postcss.list=list;postcss.comment=e=>new Comment(e);postcss.atRule=e=>new AtRule(e);postcss.decl=e=>new Declaration(e);postcss.rule=e=>new Rule(e);postcss.root=e=>new Root(e);postcss.document=e=>new Document(e);postcss.CssSyntaxError=CssSyntaxError;postcss.Declaration=Declaration;postcss.Container=Container;postcss.Processor=Processor;postcss.Document=Document;postcss.Comment=Comment;postcss.Warning=Warning;postcss.AtRule=AtRule;postcss.Result=Result;postcss.Input=Input;postcss.Rule=Rule;postcss.Root=Root;postcss.Node=Node$3;LazyResult.registerPostcss(postcss);var postcss_1=postcss;postcss.default=postcss;const htmlparser=lib$5,escapeStringRegexp=escapeStringRegexp$1,{isPlainObject}=isPlainObject$2,deepmerge=cjs,parseSrcset=parseSrcsetExports,{parse:postcssParse}=postcss_1,mediaTags=["img","audio","video","picture","svg","object","map","iframe","embed"],vulnerableTags=["script","style"];function each(e,n){e&&Object.keys(e).forEach(function(i){n(e[i],i)})}function has$2(e,n){return{}.hasOwnProperty.call(e,n)}function filter$2(e,n){const i=[];return each(e,function(r){n(r)&&i.push(r)}),i}function isEmptyObject(e){for(const n in e)if(has$2(e,n))return!1;return!0}function stringifySrcset(e){return e.map(function(n){if(!n.url)throw new Error("URL missing");return n.url+(n.w?` ${n.w}w`:"")+(n.h?` ${n.h}h`:"")+(n.d?` ${n.d}x`:"")}).join(", ")}var sanitizeHtml_1=sanitizeHtml;const VALID_HTML_ATTRIBUTE_NAME=/^[^\0\t\n\f\r /<=>]+$/;function sanitizeHtml(e,n,i){if(e==null)return"";typeof e=="number"&&(e=e.toString());let r="",s="";function o(ne,G){const Z=this;this.tag=ne,this.attribs=G||{},this.tagPosition=r.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(O.length){const ae=O[O.length-1];ae.text+=Z.text}},this.updateParentNodeMediaChildren=function(){O.length&&mediaTags.includes(this.tag)&&O[O.length-1].mediaChildren.push(this.tag)}}n=Object.assign({},sanitizeHtml.defaults,n),n.parser=Object.assign({},htmlParserDefaults,n.parser),vulnerableTags.forEach(function(ne){n.allowedTags!==!1&&(n.allowedTags||[]).indexOf(ne)>-1&&!n.allowVulnerableTags&&console.warn(`

 Your \`allowedTags\` option includes, \`${ne}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});const l=n.nonTextTags||["script","style","textarea","option"];let f,d;n.allowedAttributes&&(f={},d={},each(n.allowedAttributes,function(ne,G){f[G]=[];const Z=[];ne.forEach(function(ae){typeof ae=="string"&&ae.indexOf("*")>=0?Z.push(escapeStringRegexp(ae).replace(/\\\*/g,".*")):f[G].push(ae)}),Z.length&&(d[G]=new RegExp("^("+Z.join("|")+")$"))}));const p={},g={},v={};each(n.allowedClasses,function(ne,G){f&&(has$2(f,G)||(f[G]=[]),f[G].push("class")),p[G]=[],v[G]=[];const Z=[];ne.forEach(function(ae){typeof ae=="string"&&ae.indexOf("*")>=0?Z.push(escapeStringRegexp(ae).replace(/\\\*/g,".*")):ae instanceof RegExp?v[G].push(ae):p[G].push(ae)}),Z.length&&(g[G]=new RegExp("^("+Z.join("|")+")$"))});const S={};let T;each(n.transformTags,function(ne,G){let Z;typeof ne=="function"?Z=ne:typeof ne=="string"&&(Z=sanitizeHtml.simpleTransform(ne)),G==="*"?T=Z:S[G]=Z});let k,O,R,P,F,I,L=!1;j();const N=new htmlparser.Parser({onopentag:function(ne,G){if(n.enforceHtmlBoundary&&ne==="html"&&j(),F){I++;return}const Z=new o(ne,G);O.push(Z);let ae=!1;const oe=!!Z.text;let pe;if(has$2(S,ne)&&(pe=S[ne](ne,G),Z.attribs=G=pe.attribs,pe.text!==void 0&&(Z.innerText=pe.text),ne!==pe.tagName&&(Z.name=ne=pe.tagName,P[k]=pe.tagName)),T&&(pe=T(ne,G),Z.attribs=G=pe.attribs,ne!==pe.tagName&&(Z.name=ne=pe.tagName,P[k]=pe.tagName)),(n.allowedTags!==!1&&(n.allowedTags||[]).indexOf(ne)===-1||n.disallowedTagsMode==="recursiveEscape"&&!isEmptyObject(R)||n.nestingLimit!=null&&k>=n.nestingLimit)&&(ae=!0,R[k]=!0,n.disallowedTagsMode==="discard"&&l.indexOf(ne)!==-1&&(F=!0,I=1),R[k]=!0),k++,ae){if(n.disallowedTagsMode==="discard")return;s=r,r=""}r+="<"+ne,ne==="script"&&(n.allowedScriptHostnames||n.allowedScriptDomains)&&(Z.innerText=""),(!f||has$2(f,ne)||f["*"])&&each(G,function(Se,ue){if(!VALID_HTML_ATTRIBUTE_NAME.test(ue)){delete Z.attribs[ue];return}let ee=!1;if(!f||has$2(f,ne)&&f[ne].indexOf(ue)!==-1||f["*"]&&f["*"].indexOf(ue)!==-1||has$2(d,ne)&&d[ne].test(ue)||d["*"]&&d["*"].test(ue))ee=!0;else if(f&&f[ne]){for(const V of f[ne])if(isPlainObject(V)&&V.name&&V.name===ue){ee=!0;let se="";if(V.multiple===!0){const fe=Se.split(" ");for(const he of fe)V.values.indexOf(he)!==-1&&(se===""?se=he:se+=" "+he)}else V.values.indexOf(Se)>=0&&(se=Se);Se=se}}if(ee){if(n.allowedSchemesAppliedToAttributes.indexOf(ue)!==-1&&q(ne,Se)){delete Z.attribs[ue];return}if(ne==="script"&&ue==="src"){let V=!0;try{const se=H(Se);if(n.allowedScriptHostnames||n.allowedScriptDomains){const fe=(n.allowedScriptHostnames||[]).find(function(be){return be===se.url.hostname}),he=(n.allowedScriptDomains||[]).find(function(be){return se.url.hostname===be||se.url.hostname.endsWith(`.${be}`)});V=fe||he}}catch{V=!1}if(!V){delete Z.attribs[ue];return}}if(ne==="iframe"&&ue==="src"){let V=!0;try{const se=H(Se);if(se.isRelativeUrl)V=has$2(n,"allowIframeRelativeUrls")?n.allowIframeRelativeUrls:!n.allowedIframeHostnames&&!n.allowedIframeDomains;else if(n.allowedIframeHostnames||n.allowedIframeDomains){const fe=(n.allowedIframeHostnames||[]).find(function(be){return be===se.url.hostname}),he=(n.allowedIframeDomains||[]).find(function(be){return se.url.hostname===be||se.url.hostname.endsWith(`.${be}`)});V=fe||he}}catch{V=!1}if(!V){delete Z.attribs[ue];return}}if(ue==="srcset")try{let V=parseSrcset(Se);if(V.forEach(function(se){q("srcset",se.url)&&(se.evil=!0)}),V=filter$2(V,function(se){return!se.evil}),V.length)Se=stringifySrcset(filter$2(V,function(se){return!se.evil})),Z.attribs[ue]=Se;else{delete Z.attribs[ue];return}}catch{delete Z.attribs[ue];return}if(ue==="class"){const V=p[ne],se=p["*"],fe=g[ne],he=v[ne],be=g["*"],xe=[fe,be].concat(he).filter(function(ye){return ye});if(V&&se?Se=J(Se,deepmerge(V,se),xe):Se=J(Se,V||se,xe),!Se.length){delete Z.attribs[ue];return}}if(ue==="style"){if(n.parseStyleAttributes)try{const V=postcssParse(ne+" {"+Se+"}"),se=W(V,n.allowedStyles);if(Se=U(se),Se.length===0){delete Z.attribs[ue];return}}catch{console.warn('Failed to parse "'+ne+" {"+Se+`}", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547`),delete Z.attribs[ue];return}else if(n.allowedStyles)throw new Error("allowedStyles option cannot be used together with parseStyleAttributes: false.")}r+=" "+ue,Se&&Se.length&&(r+='="'+z(Se,!0)+'"')}else delete Z.attribs[ue]}),n.selfClosing.indexOf(ne)!==-1?r+=" />":(r+=">",Z.innerText&&!oe&&!n.textFilter&&(r+=z(Z.innerText),L=!0)),ae&&(r=s+z(r),s="")},ontext:function(ne){if(F)return;const G=O[O.length-1];let Z;if(G&&(Z=G.tag,ne=G.innerText!==void 0?G.innerText:ne),n.disallowedTagsMode==="discard"&&(Z==="script"||Z==="style"))r+=ne;else{const ae=z(ne,!1);n.textFilter&&!L?r+=n.textFilter(ae,Z):L||(r+=ae)}if(O.length){const ae=O[O.length-1];ae.text+=ne}},onclosetag:function(ne){if(F)if(I--,!I)F=!1;else return;const G=O.pop();if(!G)return;if(G.tag!==ne){O.push(G);return}F=n.enforceHtmlBoundary?ne==="html":!1,k--;const Z=R[k];if(Z){if(delete R[k],n.disallowedTagsMode==="discard"){G.updateParentNodeText();return}s=r,r=""}if(P[k]&&(ne=P[k],delete P[k]),n.exclusiveFilter&&n.exclusiveFilter(G)){r=r.substr(0,G.tagPosition);return}if(G.updateParentNodeMediaChildren(),G.updateParentNodeText(),n.selfClosing.indexOf(ne)!==-1){Z&&(r=s,s="");return}r+="</"+ne+">",Z&&(r=s+z(r),s=""),L=!1}},n.parser);return N.write(e),N.end(),r;function j(){r="",k=0,O=[],R={},P={},F=!1,I=0}function z(ne,G){return typeof ne!="string"&&(ne=ne+""),n.parser.decodeEntities&&(ne=ne.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),G&&(ne=ne.replace(/"/g,"&quot;"))),ne=ne.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),G&&(ne=ne.replace(/"/g,"&quot;")),ne}function q(ne,G){for(G=G.replace(/[\x00-\x20]+/g,"");;){const oe=G.indexOf("<!--");if(oe===-1)break;const pe=G.indexOf("-->",oe+4);if(pe===-1)break;G=G.substring(0,oe)+G.substring(pe+3)}const Z=G.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!Z)return G.match(/^[/\\]{2}/)?!n.allowProtocolRelative:!1;const ae=Z[1].toLowerCase();return has$2(n.allowedSchemesByTag,ne)?n.allowedSchemesByTag[ne].indexOf(ae)===-1:!n.allowedSchemes||n.allowedSchemes.indexOf(ae)===-1}function H(ne){if(ne=ne.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),ne.startsWith("relative:"))throw new Error("relative: exploit attempt");let G="relative://relative-site";for(let oe=0;oe<100;oe++)G+=`/${oe}`;const Z=new URL(ne,G);return{isRelativeUrl:Z&&Z.hostname==="relative-site"&&Z.protocol==="relative:",url:Z}}function W(ne,G){if(!G)return ne;const Z=ne.nodes[0];let ae;return G[Z.selector]&&G["*"]?ae=deepmerge(G[Z.selector],G["*"]):ae=G[Z.selector]||G["*"],ae&&(ne.nodes[0].nodes=Z.nodes.reduce(Q(ae),[])),ne}function U(ne){return ne.nodes[0].nodes.reduce(function(G,Z){return G.push(`${Z.prop}:${Z.value}${Z.important?" !important":""}`),G},[]).join(";")}function Q(ne){return function(G,Z){return has$2(ne,Z.prop)&&ne[Z.prop].some(function(oe){return oe.test(Z.value)})&&G.push(Z),G}}function J(ne,G,Z){return G?(ne=ne.split(/\s+/),ne.filter(function(ae){return G.indexOf(ae)!==-1||Z.some(function(oe){return oe.test(ae)})}).join(" ")):ne}}const htmlParserDefaults={decodeEntities:!0};sanitizeHtml.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0};sanitizeHtml.simpleTransform=function(e,n,i){return i=i===void 0?!0:i,n=n||{},function(r,s){let o;if(i)for(o in n)s[o]=n[o];else s=n;return{tagName:e,attribs:s}}};const sanitizeHtml$1=sanitizeHtml_1,RawHTML_svelte_svelte_type_style_lang="";function create_else_block$1(e){let n,i;return{c(){n=element$2("div"),i=element$2("iframe"),this.h()},l(r){n=claim_element(r,"DIV",{class:!0});var s=children$2(n);i=claim_element(s,"IFRAME",{srcdoc:!0,title:!0,class:!0,frameborder:!0,style:!0}),children$2(i).forEach(detach),s.forEach(detach),this.h()},h(){attr$6(i,"srcdoc",e[1]),attr$6(i,"title","title"),attr$6(i,"class","rounded-md"),attr$6(i,"frameborder","0"),set_style(i,"height","100%"),set_style(i,"width","100%"),attr$6(n,"class","h-full w-full rounded-md shadow-md border-black")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},p(r,s){s&2&&attr$6(i,"srcdoc",r[1])},i:noop$6,o:noop$6,d(r){r&&detach(n)}}}function create_if_block_1(e){let n,i;return{c(){n=element$2("div"),i=element$2("iframe"),this.h()},l(r){n=claim_element(r,"DIV",{class:!0});var s=children$2(n);i=claim_element(s,"IFRAME",{srcdoc:!0,title:!0,class:!0,frameborder:!0,style:!0}),children$2(i).forEach(detach),s.forEach(detach),this.h()},h(){attr$6(i,"srcdoc",e[1]),attr$6(i,"title","title"),attr$6(i,"class","rounded-md"),attr$6(i,"frameborder","0"),set_style(i,"height","100%"),set_style(i,"width","100%"),attr$6(n,"class","thumbnail h-full aspect-square rounded-md shadow-md border-black svelte-12l5iv3")},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},p(r,s){s&2&&attr$6(i,"srcdoc",r[1])},i:noop$6,o:noop$6,d(r){r&&detach(n)}}}function create_if_block$2(e){let n,i,r;return i=new Globe2({}),{c(){n=element$2("span"),create_component(i.$$.fragment)},l(s){n=claim_element(s,"SPAN",{});var o=children$2(n);claim_component(i.$$.fragment,o),o.forEach(detach)},m(s,o){insert_hydration(s,n,o),mount_component(i,n,null),r=!0},p:noop$6,i(s){r||(transition_in(i.$$.fragment,s),r=!0)},o(s){transition_out(i.$$.fragment,s),r=!1},d(s){s&&detach(n),destroy_component(i)}}}function create_fragment$7(e){let n,i,r,s;const o=[create_if_block$2,create_if_block_1,create_else_block$1],l=[];function f(d,p){return d[0]==="icon"?0:d[0]==="thumbnail"?1:2}return n=f(e),i=l[n]=o[n](e),{c(){i.c(),r=empty()},l(d){i.l(d),r=empty()},m(d,p){l[n].m(d,p),insert_hydration(d,r,p),s=!0},p(d,[p]){let g=n;n=f(d),n===g?l[n].p(d,p):(group_outros(),transition_out(l[g],1,1,()=>{l[g]=null}),check_outros(),i=l[n],i?i.p(d,p):(i=l[n]=o[n](d),i.c()),transition_in(i,1),i.m(r.parentNode,r))},i(d){s||(transition_in(i),s=!0)},o(d){transition_out(i),s=!1},d(d){l[n].d(d),d&&detach(r)}}}function instance$7(e,n,i){let r,{html:s}=n,{view:o="full"}=n;return console.log(s),e.$$set=l=>{"html"in l&&i(2,s=l.html),"view"in l&&i(0,o=l.view)},e.$$.update=()=>{e.$$.dirty&4&&i(1,r=sanitizeHtml$1(s))},[o,r,s]}class RawHTML extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$7,create_fragment$7,safe_not_equal,{html:2,view:0})}}function get_each_context$1(e,n,i){const r=e.slice();return r[9]=n[i],r}function create_each_block$1(e){let n,i=e[9].name+"",r,s;return{c(){n=element$2("option"),r=text$3(i),this.h()},l(o){n=claim_element(o,"OPTION",{});var l=children$2(n);r=claim_text(l,i),l.forEach(detach),this.h()},h(){n.__value=s=e[9].value,n.value=n.__value},m(o,l){insert_hydration(o,n,l),append_hydration(n,r)},p(o,l){l&2&&i!==(i=o[9].name+"")&&set_data(r,i),l&2&&s!==(s=o[9].value)&&(n.__value=s,n.value=n.__value)},d(o){o&&detach(n)}}}function create_fragment$6(e){let n,i,r,s=e[1],o=[];for(let l=0;l<s.length;l+=1)o[l]=create_each_block$1(get_each_context$1(e,s,l));return{c(){n=element$2("select");for(let l=0;l<o.length;l+=1)o[l].c();this.h()},l(l){n=claim_element(l,"SELECT",{class:!0});var f=children$2(n);for(let d=0;d<o.length;d+=1)o[d].l(f);f.forEach(detach),this.h()},h(){attr$6(n,"class","rounded-md bg-slate-100 border-0 px-3 text-slate-600 w-full"),e[0]===void 0&&add_render_callback(()=>e[8].call(n))},m(l,f){insert_hydration(l,n,f);for(let d=0;d<o.length;d+=1)o[d].m(n,null);select_option(n,e[0]),i||(r=[listen(n,"change",e[7]),listen(n,"change",e[8])],i=!0)},p(l,[f]){if(f&2){s=l[1];let d;for(d=0;d<s.length;d+=1){const p=get_each_context$1(l,s,d);o[d]?o[d].p(p,f):(o[d]=create_each_block$1(p),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}f&3&&select_option(n,l[0])},i:noop$6,o:noop$6,d(l){l&&detach(n),destroy_each(o,l),i=!1,run_all(r)}}}function instance$6(e,n,i){let r,{values:s}=n,{labels:o}=n,{value:l}=n,{disabled:f=!1}=n,{classes:d=""}=n;const p=createEventDispatcher(),g=S=>p("change",{value:l});function v(){l=select_value(this),i(0,l),i(1,r),i(3,s),i(4,o)}return e.$$set=S=>{"values"in S&&i(3,s=S.values),"labels"in S&&i(4,o=S.labels),"value"in S&&i(0,l=S.value),"disabled"in S&&i(5,f=S.disabled),"classes"in S&&i(6,d=S.classes)},e.$$.update=()=>{e.$$.dirty&24&&i(1,r=s.map((S,T)=>({value:S,name:o[T]})))},[l,r,p,s,o,f,d,g,v]}class Select extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$6,create_fragment$6,safe_not_equal,{values:3,labels:4,value:0,disabled:5,classes:6})}}const RowCard_svelte_svelte_type_style_lang="";function create_fragment$5(e){let n,i,r,s=[{type:"range"},e[2],{class:e[1]}],o={};for(let l=0;l<s.length;l+=1)o=assign(o,s[l]);return{c(){n=element$2("input"),this.h()},l(l){n=claim_element(l,"INPUT",{type:!0,class:!0}),this.h()},h(){set_attributes(n,o)},m(l,f){insert_hydration(l,n,f),n.autofocus&&n.focus(),set_input_value(n,e[0]),i||(r=[listen(n,"change",e[8]),listen(n,"input",e[8]),listen(n,"change",e[3]),listen(n,"click",e[4]),listen(n,"keydown",e[5]),listen(n,"keypress",e[6]),listen(n,"keyup",e[7])],i=!0)},p(l,[f]){set_attributes(n,o=get_spread_update(s,[{type:"range"},f&4&&l[2],f&2&&{class:l[1]}])),f&1&&set_input_value(n,l[0])},i:noop$6,o:noop$6,d(l){l&&detach(n),i=!1,run_all(r)}}}function instance$5(e,n,i){const r=["value","classes"];let s=compute_rest_props(n,r),{value:o}=n,{classes:l=""}=n;function f(T){bubble.call(this,e,T)}function d(T){bubble.call(this,e,T)}function p(T){bubble.call(this,e,T)}function g(T){bubble.call(this,e,T)}function v(T){bubble.call(this,e,T)}function S(){o=to_number(this.value),i(0,o)}return e.$$set=T=>{n=assign(assign({},n),exclude_internal_props(T)),i(2,s=compute_rest_props(n,r)),"value"in T&&i(0,o=T.value),"classes"in T&&i(1,l=T.classes)},[o,l,s,f,d,p,g,v,S]}class Range extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$5,create_fragment$5,safe_not_equal,{value:0,classes:1})}}function create_fragment$4(e){let n,i,r,s,o,l,f,d,p,g,v,S,T,k,O,R,P,F,I,L,N;function j(Q){e[7](Q)}function z(Q){e[8](Q)}function q(Q){e[9](Q)}function H(Q){e[10](Q)}function W(Q){e[11](Q)}let U={classes:"accent-purple-500"};return e[0]!==void 0&&(U.value=e[0]),e[1]!==void 0&&(U.min=e[1]),e[2]!==void 0&&(U.max=e[2]),e[3]!==void 0&&(U.step=e[3]),e[4]!==void 0&&(U.disabled=e[4]),d=new Range({props:U}),binding_callbacks.push(()=>bind$3(d,"value",j)),binding_callbacks.push(()=>bind$3(d,"min",z)),binding_callbacks.push(()=>bind$3(d,"max",q)),binding_callbacks.push(()=>bind$3(d,"step",H)),binding_callbacks.push(()=>bind$3(d,"disabled",W)),d.$on("change",e[12]),{c(){n=element$2("div"),i=element$2("div"),r=element$2("div"),s=element$2("p"),o=text$3(e[0]),f=space(),create_component(d.$$.fragment),k=space(),O=element$2("div"),R=element$2("div"),P=text$3(e[1]),F=space(),I=element$2("div"),L=text$3(e[2]),this.h()},l(Q){n=claim_element(Q,"DIV",{class:!0});var J=children$2(n);i=claim_element(J,"DIV",{class:!0});var ne=children$2(i);r=claim_element(ne,"DIV",{class:!0});var G=children$2(r);s=claim_element(G,"P",{class:!0,style:!0});var Z=children$2(s);o=claim_text(Z,e[0]),Z.forEach(detach),G.forEach(detach),f=claim_space(ne),claim_component(d.$$.fragment,ne),k=claim_space(ne),O=claim_element(ne,"DIV",{class:!0});var ae=children$2(O);R=claim_element(ae,"DIV",{class:!0});var oe=children$2(R);P=claim_text(oe,e[1]),oe.forEach(detach),F=claim_space(ae),I=claim_element(ae,"DIV",{class:!0});var pe=children$2(I);L=claim_text(pe,e[2]),pe.forEach(detach),ae.forEach(detach),ne.forEach(detach),J.forEach(detach),this.h()},h(){attr$6(s,"class","text-sm text-purple-500"),attr$6(s,"style",l=`margin-left: ${(e[0]-e[1])/(e[2]-e[1])*100}%`),attr$6(r,"class","-ml-2 px-2 w-full"),attr$6(R,"class","flex-1 text-sm text-purple-400"),attr$6(I,"class","flex-1 text-sm text-purple-400 text-right"),attr$6(O,"class","flex"),attr$6(i,"class","flex flex-col"),attr$6(n,"class",e[5])},m(Q,J){insert_hydration(Q,n,J),append_hydration(n,i),append_hydration(i,r),append_hydration(r,s),append_hydration(s,o),append_hydration(i,f),mount_component(d,i,null),append_hydration(i,k),append_hydration(i,O),append_hydration(O,R),append_hydration(R,P),append_hydration(O,F),append_hydration(O,I),append_hydration(I,L),N=!0},p(Q,[J]){(!N||J&1)&&set_data(o,Q[0]),(!N||J&7&&l!==(l=`margin-left: ${(Q[0]-Q[1])/(Q[2]-Q[1])*100}%`))&&attr$6(s,"style",l);const ne={};!p&&J&1&&(p=!0,ne.value=Q[0],add_flush_callback(()=>p=!1)),!g&&J&2&&(g=!0,ne.min=Q[1],add_flush_callback(()=>g=!1)),!v&&J&4&&(v=!0,ne.max=Q[2],add_flush_callback(()=>v=!1)),!S&&J&8&&(S=!0,ne.step=Q[3],add_flush_callback(()=>S=!1)),!T&&J&16&&(T=!0,ne.disabled=Q[4],add_flush_callback(()=>T=!1)),d.$set(ne),(!N||J&2)&&set_data(P,Q[1]),(!N||J&4)&&set_data(L,Q[2]),(!N||J&32)&&attr$6(n,"class",Q[5])},i(Q){N||(transition_in(d.$$.fragment,Q),N=!0)},o(Q){transition_out(d.$$.fragment,Q),N=!1},d(Q){Q&&detach(n),destroy_component(d)}}}function instance$4(e,n,i){let{value:r=0}=n,{min:s=0}=n,{max:o=100}=n,{step:l=1}=n,{disabled:f=!1}=n,{classes:d="bg-violet-50 p-2 rounded-lg w-fit"}=n;const p=createEventDispatcher();function g(R){r=R,i(0,r)}function v(R){s=R,i(1,s)}function S(R){o=R,i(2,o)}function T(R){l=R,i(3,l)}function k(R){f=R,i(4,f)}const O=R=>p("change",{value:r});return e.$$set=R=>{"value"in R&&i(0,r=R.value),"min"in R&&i(1,s=R.min),"max"in R&&i(2,o=R.max),"step"in R&&i(3,l=R.step),"disabled"in R&&i(4,f=R.disabled),"classes"in R&&i(5,d=R.classes)},[r,s,o,l,f,d,p,g,v,S,T,k,O]}class Slider extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$4,create_fragment$4,safe_not_equal,{value:0,min:1,max:2,step:3,disabled:4,classes:5})}}const SvelteTooltip_svelte_svelte_type_style_lang="",Sort_svelte_svelte_type_style_lang="",Table_svelte_svelte_type_style_lang="";function get_each_context(e,n,i){const r=e.slice();return r[4]=n[i].id,r[5]=n[i].component,r}function get_each_context_1(e,n,i){const r=e.slice();return r[8]=n[i].label,r[4]=n[i].id,r}function create_each_block_1(e){let n,i=e[8]+"",r,s,o,l,f;function d(){return e[3](e[4])}return{c(){n=element$2("button"),r=text$3(i),s=space(),this.h()},l(p){n=claim_element(p,"BUTTON",{class:!0});var g=children$2(n);r=claim_text(g,i),s=claim_space(g),g.forEach(detach),this.h()},h(){attr$6(n,"class",o=e[1]===e[4]?"active inline-block py-1 px-4 text-lg font-medium text-center text-white bg-violet-600 rounded-lg":"inline-block py-1 px-4 text-lg font-medium text-center text-gray-500 rounded-lg hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-white")},m(p,g){insert_hydration(p,n,g),append_hydration(n,r),append_hydration(n,s),l||(f=listen(n,"click",d),l=!0)},p(p,g){e=p,g&1&&i!==(i=e[8]+"")&&set_data(r,i),g&3&&o!==(o=e[1]===e[4]?"active inline-block py-1 px-4 text-lg font-medium text-center text-white bg-violet-600 rounded-lg":"inline-block py-1 px-4 text-lg font-medium text-center text-gray-500 rounded-lg hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-white")&&attr$6(n,"class",o)},d(p){p&&detach(n),l=!1,f()}}}function create_if_block$1(e){let n,i;const r=[e[5]];let s={};for(let o=0;o<r.length;o+=1)s=assign(s,r[o]);return n=new DynamicComponent({props:s}),{c(){create_component(n.$$.fragment)},l(o){claim_component(n.$$.fragment,o)},m(o,l){mount_component(n,o,l),i=!0},p(o,l){const f=l&1?get_spread_update(r,[get_spread_object(o[5])]):{};n.$set(f)},i(o){i||(transition_in(n.$$.fragment,o),i=!0)},o(o){transition_out(n.$$.fragment,o),i=!1},d(o){destroy_component(n,o)}}}function create_each_block(e){let n,i,r=e[4]===e[1]&&create_if_block$1(e);return{c(){r&&r.c(),n=empty()},l(s){r&&r.l(s),n=empty()},m(s,o){r&&r.m(s,o),insert_hydration(s,n,o),i=!0},p(s,o){s[4]===s[1]?r?(r.p(s,o),o&3&&transition_in(r,1)):(r=create_if_block$1(s),r.c(),transition_in(r,1),r.m(n.parentNode,n)):r&&(group_outros(),transition_out(r,1,1,()=>{r=null}),check_outros())},i(s){i||(transition_in(r),i=!0)},o(s){transition_out(r),i=!1},d(s){r&&r.d(s),s&&detach(n)}}}function create_fragment$3(e){let n,i,r,s,o,l=e[0],f=[];for(let v=0;v<l.length;v+=1)f[v]=create_each_block_1(get_each_context_1(e,l,v));let d=e[0],p=[];for(let v=0;v<d.length;v+=1)p[v]=create_each_block(get_each_context(e,d,v));const g=v=>transition_out(p[v],1,1,()=>{p[v]=null});return{c(){n=element$2("div"),i=element$2("div");for(let v=0;v<f.length;v+=1)f[v].c();r=space();for(let v=0;v<p.length;v+=1)p[v].c();s=empty(),this.h()},l(v){n=claim_element(v,"DIV",{class:!0});var S=children$2(n);i=claim_element(S,"DIV",{class:!0});var T=children$2(i);for(let k=0;k<f.length;k+=1)f[k].l(T);T.forEach(detach),S.forEach(detach),r=claim_space(v);for(let k=0;k<p.length;k+=1)p[k].l(v);s=empty(),this.h()},h(){attr$6(i,"class","flex-grow flex justify-center"),attr$6(n,"class","flex mb-2")},m(v,S){insert_hydration(v,n,S),append_hydration(n,i);for(let T=0;T<f.length;T+=1)f[T].m(i,null);insert_hydration(v,r,S);for(let T=0;T<p.length;T+=1)p[T].m(v,S);insert_hydration(v,s,S),o=!0},p(v,[S]){if(S&7){l=v[0];let T;for(T=0;T<l.length;T+=1){const k=get_each_context_1(v,l,T);f[T]?f[T].p(k,S):(f[T]=create_each_block_1(k),f[T].c(),f[T].m(i,null))}for(;T<f.length;T+=1)f[T].d(1);f.length=l.length}if(S&3){d=v[0];let T;for(T=0;T<d.length;T+=1){const k=get_each_context(v,d,T);p[T]?(p[T].p(k,S),transition_in(p[T],1)):(p[T]=create_each_block(k),p[T].c(),transition_in(p[T],1),p[T].m(s.parentNode,s))}for(group_outros(),T=d.length;T<p.length;T+=1)g(T);check_outros()}},i(v){if(!o){for(let S=0;S<d.length;S+=1)transition_in(p[S]);o=!0}},o(v){p=p.filter(Boolean);for(let S=0;S<p.length;S+=1)transition_out(p[S]);o=!1},d(v){v&&detach(n),destroy_each(f,v),v&&detach(r),destroy_each(p,v),v&&detach(s)}}}function instance$3(e,n,i){let{tabs:r=[]}=n,s=r[0].id;function o(f){i(1,s=f===s?"":f)}const l=f=>o(f);return e.$$set=f=>{"tabs"in f&&i(0,r=f.tabs)},[r,s,o,l]}class Tabs extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$3,create_fragment$3,safe_not_equal,{tabs:0})}}function create_else_block(e){let n,i;return{c(){n=element$2("div"),i=text$3(e[0]),this.h()},l(r){n=claim_element(r,"DIV",{class:!0});var s=children$2(n);i=claim_text(s,e[0]),s.forEach(detach),this.h()},h(){attr$6(n,"class",e[2])},m(r,s){insert_hydration(r,n,s),append_hydration(n,i)},p(r,s){s&1&&set_data(i,r[0]),s&4&&attr$6(n,"class",r[2])},d(r){r&&detach(n)}}}function create_if_block(e){let n,i,r;return{c(){n=element$2("input"),this.h()},l(s){n=claim_element(s,"INPUT",{class:!0}),this.h()},h(){attr$6(n,"class","input w-full")},m(s,o){insert_hydration(s,n,o),set_input_value(n,e[0]),i||(r=[listen(n,"change",e[4]),listen(n,"input",e[5])],i=!0)},p(s,o){o&1&&n.value!==s[0]&&set_input_value(n,s[0])},d(s){s&&detach(n),i=!1,run_all(r)}}}function create_fragment$2(e){let n;function i(o,l){return o[1]?create_if_block:create_else_block}let r=i(e),s=r(e);return{c(){s.c(),n=empty()},l(o){s.l(o),n=empty()},m(o,l){s.m(o,l),insert_hydration(o,n,l)},p(o,[l]){r===(r=i(o))&&s?s.p(o,l):(s.d(1),s=r(o),s&&(s.c(),s.m(n.parentNode,n)))},i:noop$6,o:noop$6,d(o){s.d(o),o&&detach(n)}}}function instance$2(e,n,i){let{data:r}=n,{editable:s=!1}=n,{classes:o=""}=n;const l=getContext$1("cellEdit"),f=()=>{l(r)};function d(){r=this.value,i(0,r)}return e.$$set=p=>{"data"in p&&i(0,r=p.data),"editable"in p&&i(1,s=p.editable),"classes"in p&&i(2,o=p.classes)},[r,s,o,l,f,d]}class Text extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$2,create_fragment$2,safe_not_equal,{data:0,editable:1,classes:2})}}function create_fragment$1(e){let n,i,r,s,o,l;return{c(){n=element$2("label"),i=element$2("input"),r=space(),s=element$2("div"),this.h()},l(f){n=claim_element(f,"LABEL",{class:!0});var d=children$2(n);i=claim_element(d,"INPUT",{type:!0,class:!0}),r=claim_space(d),s=claim_element(d,"DIV",{class:!0}),children$2(s).forEach(detach),d.forEach(detach),this.h()},h(){attr$6(i,"type","checkbox"),i.__value="",i.value=i.__value,attr$6(i,"class","sr-only peer"),attr$6(s,"class","w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"),attr$6(n,"class","relative inline-flex items-center cursor-pointer w-fit")},m(f,d){insert_hydration(f,n,d),append_hydration(n,i),i.checked=e[0],append_hydration(n,r),append_hydration(n,s),o||(l=[listen(i,"change",e[2]),listen(i,"change",e[3])],o=!0)},p(f,[d]){d&1&&(i.checked=f[0])},i:noop$6,o:noop$6,d(f){f&&detach(n),o=!1,run_all(l)}}}function instance$1(e,n,i){let r=createEventDispatcher(),{value:s=!1}=n;const o=f=>{r("change",{value:f.target.checked})};function l(){s=this.checked,i(0,s)}return e.$$set=f=>{"value"in f&&i(0,s=f.value)},[s,r,o,l]}class Toggle extends SvelteComponent{constructor(n){super(),init$1(this,n,instance$1,create_fragment$1,safe_not_equal,{value:0})}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var __extends=globalThis&&globalThis.__extends||function(){var e=function(n,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])},e(n,i)};return function(n,i){e(n,i);function r(){this.constructor=n}n.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),_hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwnProperty(e,n){return _hasOwnProperty.call(e,n)}function _objectKeys(e){if(Array.isArray(e)){for(var n=new Array(e.length),i=0;i<n.length;i++)n[i]=""+i;return n}if(Object.keys)return Object.keys(e);var r=[];for(var s in e)hasOwnProperty(e,s)&&r.push(s);return r}function _deepClone(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function isInteger$1(e){for(var n=0,i=e.length,r;n<i;){if(r=e.charCodeAt(n),r>=48&&r<=57){n++;continue}return!1}return!0}function escapePathComponent(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapePathComponent(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function hasUndefined(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var n=0,i=e.length;n<i;n++)if(hasUndefined(e[n]))return!0}else if(typeof e=="object"){for(var r=_objectKeys(e),s=r.length,o=0;o<s;o++)if(hasUndefined(e[r[o]]))return!0}}return!1}function patchErrorMessageFormatter(e,n){var i=[e];for(var r in n){var s=typeof n[r]=="object"?JSON.stringify(n[r],null,2):n[r];typeof s<"u"&&i.push(r+": "+s)}return i.join(`
`)}var PatchError=function(e){__extends(n,e);function n(i,r,s,o,l){var f=this.constructor,d=e.call(this,patchErrorMessageFormatter(i,{name:r,index:s,operation:o,tree:l}))||this;return d.name=r,d.index=s,d.operation=o,d.tree=l,Object.setPrototypeOf(d,f.prototype),d.message=patchErrorMessageFormatter(i,{name:r,index:s,operation:o,tree:l}),d}return n}(Error),JsonPatchError=PatchError,deepClone=_deepClone,objOps={add:function(e,n,i){return e[n]=this.value,{newDocument:i}},remove:function(e,n,i){var r=e[n];return delete e[n],{newDocument:i,removed:r}},replace:function(e,n,i){var r=e[n];return e[n]=this.value,{newDocument:i,removed:r}},move:function(e,n,i){var r=getValueByPointer(i,this.path);r&&(r=_deepClone(r));var s=applyOperation(i,{op:"remove",path:this.from}).removed;return applyOperation(i,{op:"add",path:this.path,value:s}),{newDocument:i,removed:r}},copy:function(e,n,i){var r=getValueByPointer(i,this.from);return applyOperation(i,{op:"add",path:this.path,value:_deepClone(r)}),{newDocument:i}},test:function(e,n,i){return{newDocument:i,test:_areEquals(e[n],this.value)}},_get:function(e,n,i){return this.value=e[n],{newDocument:i}}},arrOps={add:function(e,n,i){return isInteger$1(n)?e.splice(n,0,this.value):e[n]=this.value,{newDocument:i,index:n}},remove:function(e,n,i){var r=e.splice(n,1);return{newDocument:i,removed:r[0]}},replace:function(e,n,i){var r=e[n];return e[n]=this.value,{newDocument:i,removed:r}},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};function getValueByPointer(e,n){if(n=="")return e;var i={op:"_get",path:n};return applyOperation(e,i),i.value}function applyOperation(e,n,i,r,s,o){if(i===void 0&&(i=!1),r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=0),i&&(typeof i=="function"?i(n,0,e,n.path):validator(n,0)),n.path===""){var l={newDocument:e};if(n.op==="add")return l.newDocument=n.value,l;if(n.op==="replace")return l.newDocument=n.value,l.removed=e,l;if(n.op==="move"||n.op==="copy")return l.newDocument=getValueByPointer(e,n.from),n.op==="move"&&(l.removed=e),l;if(n.op==="test"){if(l.test=_areEquals(e,n.value),l.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,n,e);return l.newDocument=e,l}else{if(n.op==="remove")return l.removed=e,l.newDocument=null,l;if(n.op==="_get")return n.value=e,l;if(i)throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,n,e);return l}}else{r||(e=_deepClone(e));var f=n.path||"",d=f.split("/"),p=e,g=1,v=d.length,S=void 0,T=void 0,k=void 0;for(typeof i=="function"?k=i:k=validator;;){if(T=d[g],T&&T.indexOf("~")!=-1&&(T=unescapePathComponent(T)),s&&(T=="__proto__"||T=="prototype"&&g>0&&d[g-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(i&&S===void 0&&(p[T]===void 0?S=d.slice(0,g).join("/"):g==v-1&&(S=n.path),S!==void 0&&k(n,0,e,S)),g++,Array.isArray(p)){if(T==="-")T=p.length;else{if(i&&!isInteger$1(T))throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,n,e);isInteger$1(T)&&(T=~~T)}if(g>=v){if(i&&n.op==="add"&&T>p.length)throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,n,e);var l=arrOps[n.op].call(n,p,T,e);if(l.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,n,e);return l}}else if(g>=v){var l=objOps[n.op].call(n,p,T,e);if(l.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,n,e);return l}if(p=p[T],i&&g<v&&(!p||typeof p!="object"))throw new JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,n,e)}}}function applyPatch(e,n,i,r,s){if(r===void 0&&(r=!0),s===void 0&&(s=!0),i&&!Array.isArray(n))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=_deepClone(e));for(var o=new Array(n.length),l=0,f=n.length;l<f;l++)o[l]=applyOperation(e,n[l],i,!0,s,l),e=o[l].newDocument;return o.newDocument=e,o}function applyReducer(e,n,i){var r=applyOperation(e,n);if(r.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",i,n,e);return r.newDocument}function validator(e,n,i,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,e,i);if(objOps[e.op]){if(typeof e.path!="string")throw new JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,e,i);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",n,e,i);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,e,i);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,e,i);if((e.op==="add"||e.op==="replace"||e.op==="test")&&hasUndefined(e.value))throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,e,i);if(i){if(e.op=="add"){var s=e.path.split("/").length,o=r.split("/").length;if(s!==o+1&&s!==o)throw new JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,e,i)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,e,i)}else if(e.op==="move"||e.op==="copy"){var l={op:"_get",path:e.from,value:void 0},f=validate([l],i);if(f&&f.name==="OPERATION_PATH_UNRESOLVABLE")throw new JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,e,i)}}}else throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,e,i)}function validate(e,n,i){try{if(!Array.isArray(e))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(n)applyPatch(_deepClone(n),_deepClone(e),i||!0);else{i=i||validator;for(var r=0;r<e.length;r++)i(e[r],r,n,void 0)}}catch(s){if(s instanceof JsonPatchError)return s;throw s}}function _areEquals(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){var i=Array.isArray(e),r=Array.isArray(n),s,o,l;if(i&&r){if(o=e.length,o!=n.length)return!1;for(s=o;s--!==0;)if(!_areEquals(e[s],n[s]))return!1;return!0}if(i!=r)return!1;var f=Object.keys(e);if(o=f.length,o!==Object.keys(n).length)return!1;for(s=o;s--!==0;)if(!n.hasOwnProperty(f[s]))return!1;for(s=o;s--!==0;)if(l=f[s],!_areEquals(e[l],n[l]))return!1;return!0}return e!==e&&n!==n}const core=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError,_areEquals,applyOperation,applyPatch,applyReducer,deepClone,getValueByPointer,validate,validator},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var beforeDict=new WeakMap,Mirror=function(){function e(n){this.observers=new Map,this.obj=n}return e}(),ObserverInfo=function(){function e(n,i){this.callback=n,this.observer=i}return e}();function getMirror(e){return beforeDict.get(e)}function getObserverFromMirror(e,n){return e.observers.get(n)}function removeObserverFromMirror(e,n){e.observers.delete(n.callback)}function unobserve(e,n){n.unobserve()}function observe(e,n){var i=[],r,s=getMirror(e);if(!s)s=new Mirror(e),beforeDict.set(e,s);else{var o=getObserverFromMirror(s,n);r=o&&o.observer}if(r)return r;if(r={},s.value=_deepClone(e),n){r.callback=n,r.next=null;var l=function(){generate$1(r)},f=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",f),window.addEventListener("keyup",f),window.addEventListener("mousedown",f),window.addEventListener("keydown",f),window.addEventListener("change",f))}return r.patches=i,r.object=e,r.unobserve=function(){generate$1(r),clearTimeout(r.next),removeObserverFromMirror(s,r),typeof window<"u"&&(window.removeEventListener("mouseup",f),window.removeEventListener("keyup",f),window.removeEventListener("mousedown",f),window.removeEventListener("keydown",f),window.removeEventListener("change",f))},s.observers.set(n,new ObserverInfo(n,r)),r}function generate$1(e,n){n===void 0&&(n=!1);var i=beforeDict.get(e.object);_generate(i.value,e.object,e.patches,"",n),e.patches.length&&applyPatch(i.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function _generate(e,n,i,r,s){if(n!==e){typeof n.toJSON=="function"&&(n=n.toJSON());for(var o=_objectKeys(n),l=_objectKeys(e),f=!1,d=l.length-1;d>=0;d--){var p=l[d],g=e[p];if(hasOwnProperty(n,p)&&!(n[p]===void 0&&g!==void 0&&Array.isArray(n)===!1)){var v=n[p];typeof g=="object"&&g!=null&&typeof v=="object"&&v!=null&&Array.isArray(g)===Array.isArray(v)?_generate(g,v,i,r+"/"+escapePathComponent(p),s):g!==v&&(s&&i.push({op:"test",path:r+"/"+escapePathComponent(p),value:_deepClone(g)}),i.push({op:"replace",path:r+"/"+escapePathComponent(p),value:_deepClone(v)}))}else Array.isArray(e)===Array.isArray(n)?(s&&i.push({op:"test",path:r+"/"+escapePathComponent(p),value:_deepClone(g)}),i.push({op:"remove",path:r+"/"+escapePathComponent(p)}),f=!0):(s&&i.push({op:"test",path:r,value:e}),i.push({op:"replace",path:r,value:n}))}if(!(!f&&o.length==l.length))for(var d=0;d<o.length;d++){var p=o[d];!hasOwnProperty(e,p)&&n[p]!==void 0&&i.push({op:"add",path:r+"/"+escapePathComponent(p),value:_deepClone(n[p])})}}}function compare$9(e,n,i){i===void 0&&(i=!1);var r=[];return _generate(e,n,r,"",i),r}const duplex=Object.freeze(Object.defineProperty({__proto__:null,compare:compare$9,generate:generate$1,observe,unobserve},Symbol.toStringTag,{value:"Module"}));Object.assign({},core,duplex,{JsonPatchError:PatchError,deepClone:_deepClone,escapePathComponent,unescapePathComponent});function accessor(e,n,i){return e.fields=n||[],e.fname=i,e}function accessorName(e){return e==null?null:e.fname}function accessorFields(e){return e==null?null:e.fields}function getter(e){return e.length===1?get1(e[0]):getN(e)}const get1=e=>function(n){return n[e]},getN=e=>{const n=e.length;return function(i){for(let r=0;r<n;++r)i=i[e[r]];return i}};function error(e){throw Error(e)}function splitAccessPath(e){const n=[],i=e.length;let r=null,s=0,o="",l,f,d;e=e+"";function p(){n.push(o+e.substring(l,f)),o="",l=f+1}for(l=f=0;f<i;++f)if(d=e[f],d==="\\")o+=e.substring(l,f),o+=e.substring(++f,++f),l=f;else if(d===r)p(),r=null,s=-1;else{if(r)continue;l===s&&d==='"'||l===s&&d==="'"?(l=f+1,r=d):d==="."&&!s?f>l?p():l=f+1:d==="["?(f>l&&p(),s=l=f+1):d==="]"&&(s||error("Access path missing open bracket: "+e),s>0&&p(),s=0,l=f+1)}return s&&error("Access path missing closing bracket: "+e),r&&error("Access path missing closing quote: "+e),f>l&&(f++,p()),n}function field$1(e,n,i){const r=splitAccessPath(e);return e=r.length===1?r[0]:e,accessor((i&&i.get||getter)(r),[e],n||e)}const id=field$1("id"),identity$6=accessor(e=>e,[],"identity"),zero$4=accessor(()=>0,[],"zero"),one$2=accessor(()=>1,[],"one"),truthy=accessor(()=>!0,[],"true"),falsy=accessor(()=>!1,[],"false");function log$1$1(e,n,i){const r=[n].concat([].slice.call(i));console[e].apply(console,r)}const None$2=0,Error$1=1,Warn=2,Info=3,Debug=4;function logger(e,n,i=log$1$1){let r=e||None$2;return{level(s){return arguments.length?(r=+s,this):r},error(){return r>=Error$1&&i(n||"error","ERROR",arguments),this},warn(){return r>=Warn&&i(n||"warn","WARN",arguments),this},info(){return r>=Info&&i(n||"log","INFO",arguments),this},debug(){return r>=Debug&&i(n||"log","DEBUG",arguments),this}}}var isArray=Array.isArray;function isObject(e){return e===Object(e)}const isLegalKey=e=>e!=="__proto__";function mergeConfig(...e){return e.reduce((n,i)=>{for(const r in i)if(r==="signals")n.signals=mergeNamed(n.signals,i.signals);else{const s=r==="legend"?{layout:1}:r==="style"?!0:null;writeConfig(n,r,i[r],s)}return n},{})}function writeConfig(e,n,i,r){if(!isLegalKey(n))return;let s,o;if(isObject(i)&&!isArray(i)){o=isObject(e[n])?e[n]:e[n]={};for(s in i)r&&(r===!0||r[s])?writeConfig(o,s,i[s]):isLegalKey(s)&&(o[s]=i[s])}else e[n]=i}function mergeNamed(e,n){if(e==null)return n;const i={},r=[];function s(o){i[o.name]||(i[o.name]=1,r.push(o))}return n.forEach(s),e.forEach(s),r}function peek$1(e){return e[e.length-1]}function toNumber(e){return e==null||e===""?null:+e}const exp$2=e=>n=>e*Math.exp(n),log$4=e=>n=>Math.log(e*n),symlog$1=e=>n=>Math.sign(n)*Math.log1p(Math.abs(n/e)),symexp=e=>n=>Math.sign(n)*Math.expm1(Math.abs(n))*e,pow$4=e=>n=>n<0?-Math.pow(-n,e):Math.pow(n,e);function pan(e,n,i,r){const s=i(e[0]),o=i(peek$1(e)),l=(o-s)*n;return[r(s-l),r(o-l)]}function panLinear(e,n){return pan(e,n,toNumber,identity$6)}function panLog(e,n){var i=Math.sign(e[0]);return pan(e,n,log$4(i),exp$2(i))}function panPow(e,n,i){return pan(e,n,pow$4(i),pow$4(1/i))}function panSymlog(e,n,i){return pan(e,n,symlog$1(i),symexp(i))}function zoom$2(e,n,i,r,s){const o=r(e[0]),l=r(peek$1(e)),f=n!=null?r(n):(o+l)/2;return[s(f+(o-f)*i),s(f+(l-f)*i)]}function zoomLinear(e,n,i){return zoom$2(e,n,i,toNumber,identity$6)}function zoomLog(e,n,i){const r=Math.sign(e[0]);return zoom$2(e,n,i,log$4(r),exp$2(r))}function zoomPow(e,n,i,r){return zoom$2(e,n,i,pow$4(r),pow$4(1/r))}function zoomSymlog(e,n,i,r){return zoom$2(e,n,i,symlog$1(r),symexp(r))}function quarter(e){return 1+~~(new Date(e).getMonth()/3)}function utcquarter(e){return 1+~~(new Date(e).getUTCMonth()/3)}function array$5(e){return e!=null?isArray(e)?e:[e]:[]}function clampRange(e,n,i){let r=e[0],s=e[1],o;return s<r&&(o=s,s=r,r=o),o=s-r,o>=i-n?[n,i]:[r=Math.min(Math.max(r,n),i-o),r+o]}function isFunction(e){return typeof e=="function"}const DESCENDING="descending";function compare$8(e,n,i){i=i||{},n=array$5(n)||[];const r=[],s=[],o={},l=i.comparator||comparator$1;return array$5(e).forEach((f,d)=>{f!=null&&(r.push(n[d]===DESCENDING?-1:1),s.push(f=isFunction(f)?f:field$1(f,null,i)),(accessorFields(f)||[]).forEach(p=>o[p]=1))}),s.length===0?null:accessor(l(s,r),Object.keys(o))}const ascending$3=(e,n)=>(e<n||e==null)&&n!=null?-1:(e>n||n==null)&&e!=null?1:(n=n instanceof Date?+n:n,(e=e instanceof Date?+e:e)!==e&&n===n?-1:n!==n&&e===e?1:0),comparator$1=(e,n)=>e.length===1?compare1(e[0],n[0]):compareN(e,n,e.length),compare1=(e,n)=>function(i,r){return ascending$3(e(i),e(r))*n},compareN=(e,n,i)=>(n.push(0),function(r,s){let o,l=0,f=-1;for(;l===0&&++f<i;)o=e[f],l=ascending$3(o(r),o(s));return l*n[f]});function constant$4(e){return isFunction(e)?e:()=>e}function debounce(e,n){let i;return r=>{i&&clearTimeout(i),i=setTimeout(()=>(n(r),i=null),e)}}function extend$1(e){for(let n,i,r=1,s=arguments.length;r<s;++r){n=arguments[r];for(i in n)e[i]=n[i]}return e}function extent(e,n){let i=0,r,s,o,l;if(e&&(r=e.length))if(n==null){for(s=e[i];i<r&&(s==null||s!==s);s=e[++i]);for(o=l=s;i<r;++i)s=e[i],s!=null&&(s<o&&(o=s),s>l&&(l=s))}else{for(s=n(e[i]);i<r&&(s==null||s!==s);s=n(e[++i]));for(o=l=s;i<r;++i)s=n(e[i]),s!=null&&(s<o&&(o=s),s>l&&(l=s))}return[o,l]}function extentIndex(e,n){const i=e.length;let r=-1,s,o,l,f,d;if(n==null){for(;++r<i;)if(o=e[r],o!=null&&o>=o){s=l=o;break}if(r===i)return[-1,-1];for(f=d=r;++r<i;)o=e[r],o!=null&&(s>o&&(s=o,f=r),l<o&&(l=o,d=r))}else{for(;++r<i;)if(o=n(e[r],r,e),o!=null&&o>=o){s=l=o;break}if(r===i)return[-1,-1];for(f=d=r;++r<i;)o=n(e[r],r,e),o!=null&&(s>o&&(s=o,f=r),l<o&&(l=o,d=r))}return[f,d]}const hop=Object.prototype.hasOwnProperty;function has$1(e,n){return hop.call(e,n)}const NULL={};function fastmap(e){let n={},i;function r(o){return has$1(n,o)&&n[o]!==NULL}const s={size:0,empty:0,object:n,has:r,get(o){return r(o)?n[o]:void 0},set(o,l){return r(o)||(++s.size,n[o]===NULL&&--s.empty),n[o]=l,this},delete(o){return r(o)&&(--s.size,++s.empty,n[o]=NULL),this},clear(){s.size=s.empty=0,s.object=n={}},test(o){return arguments.length?(i=o,s):i},clean(){const o={};let l=0;for(const f in n){const d=n[f];d!==NULL&&(!i||!i(d))&&(o[f]=d,++l)}s.size=l,s.empty=0,s.object=n=o}};return e&&Object.keys(e).forEach(o=>{s.set(o,e[o])}),s}function flush(e,n,i,r,s,o){if(!i&&i!==0)return o;const l=+i;let f=e[0],d=peek$1(e),p;d<f&&(p=f,f=d,d=p),p=Math.abs(n-f);const g=Math.abs(d-n);return p<g&&p<=l?r:g<=l?s:o}function inherits(e,n,i){const r=e.prototype=Object.create(n.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),extend$1(r,i)}function inrange(e,n,i,r){let s=n[0],o=n[n.length-1],l;return s>o&&(l=s,s=o,o=l),i=i===void 0||i,r=r===void 0||r,(i?s<=e:s<e)&&(r?e<=o:e<o)}function isBoolean$2(e){return typeof e=="boolean"}function isDate$1(e){return Object.prototype.toString.call(e)==="[object Date]"}function isIterable(e){return e&&isFunction(e[Symbol.iterator])}function isNumber$1(e){return typeof e=="number"}function isRegExp(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function isString(e){return typeof e=="string"}function key(e,n,i){e&&(e=n?array$5(e).map(f=>f.replace(/\\(.)/g,"$1")):array$5(e));const r=e&&e.length,s=i&&i.get||getter,o=f=>s(n?[f]:splitAccessPath(f));let l;if(!r)l=function(){return""};else if(r===1){const f=o(e[0]);l=function(d){return""+f(d)}}else{const f=e.map(o);l=function(d){let p=""+f[0](d),g=0;for(;++g<r;)p+="|"+f[g](d);return p}}return accessor(l,e,"key")}function lerp(e,n){const i=e[0],r=peek$1(e),s=+n;return s?s===1?r:i+s*(r-i):i}const DEFAULT_MAX_SIZE=1e4;function lruCache$1(e){e=+e||DEFAULT_MAX_SIZE;let n,i,r;const s=()=>{n={},i={},r=0},o=(l,f)=>(++r>e&&(i=n,n={},r=1),n[l]=f);return s(),{clear:s,has:l=>has$1(n,l)||has$1(i,l),get:l=>has$1(n,l)?n[l]:has$1(i,l)?o(l,i[l]):void 0,set:(l,f)=>has$1(n,l)?n[l]=f:o(l,f)}}function merge$3(e,n,i,r){const s=n.length,o=i.length;if(!o)return n;if(!s)return i;const l=r||new n.constructor(s+o);let f=0,d=0,p=0;for(;f<s&&d<o;++p)l[p]=e(n[f],i[d])>0?i[d++]:n[f++];for(;f<s;++f,++p)l[p]=n[f];for(;d<o;++d,++p)l[p]=i[d];return l}function repeat(e,n){let i="";for(;--n>=0;)i+=e;return i}function pad$2(e,n,i,r){const s=i||" ",o=e+"",l=n-o.length;return l<=0?o:r==="left"?repeat(s,l)+o:r==="center"?repeat(s,~~(l/2))+o+repeat(s,Math.ceil(l/2)):o+repeat(s,l)}function span(e){return e&&peek$1(e)-e[0]||0}function $(e){return isArray(e)?"["+e.map($)+"]":isObject(e)||isString(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function toBoolean(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const defaultParser=e=>isNumber$1(e)||isDate$1(e)?e:Date.parse(e);function toDate(e,n){return n=n||defaultParser,e==null||e===""?null:n(e)}function toString(e){return e==null||e===""?null:e+""}function toSet(e){const n={},i=e.length;for(let r=0;r<i;++r)n[e[r]]=!0;return n}function truncate$1(e,n,i,r){const s=r??"",o=e+"",l=o.length,f=Math.max(0,n-s.length);return l<=n?o:i==="left"?s+o.slice(l-f):i==="center"?o.slice(0,Math.ceil(f/2))+s+o.slice(l-~~(f/2)):o.slice(0,f)+s}function visitArray(e,n,i){if(e)if(n){const r=e.length;for(let s=0;s<r;++s){const o=n(e[s]);o&&i(o,s,e)}}else e.forEach(i)}var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(e){return new Function("d","return {"+e.map(function(n,i){return JSON.stringify(n)+": d["+i+'] || ""'}).join(",")+"}")}function customConverter(e,n){var i=objectConverter(e);return function(r,s){return n(i(r),s,e)}}function inferColumns(e){var n=Object.create(null),i=[];return e.forEach(function(r){for(var s in r)s in n||i.push(n[s]=s)}),i}function pad$1(e,n){var i=e+"",r=i.length;return r<n?new Array(n-r+1).join(0)+i:i}function formatYear$1(e){return e<0?"-"+pad$1(-e,6):e>9999?"+"+pad$1(e,6):pad$1(e,4)}function formatDate(e){var n=e.getUTCHours(),i=e.getUTCMinutes(),r=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":formatYear$1(e.getUTCFullYear())+"-"+pad$1(e.getUTCMonth()+1,2)+"-"+pad$1(e.getUTCDate(),2)+(s?"T"+pad$1(n,2)+":"+pad$1(i,2)+":"+pad$1(r,2)+"."+pad$1(s,3)+"Z":r?"T"+pad$1(n,2)+":"+pad$1(i,2)+":"+pad$1(r,2)+"Z":i||n?"T"+pad$1(n,2)+":"+pad$1(i,2)+"Z":"")}function dsvFormat(e){var n=new RegExp('["'+e+`
\r]`),i=e.charCodeAt(0);function r(v,S){var T,k,O=s(v,function(R,P){if(T)return T(R,P-1);k=R,T=S?customConverter(R,S):objectConverter(R)});return O.columns=k||[],O}function s(v,S){var T=[],k=v.length,O=0,R=0,P,F=k<=0,I=!1;v.charCodeAt(k-1)===NEWLINE&&--k,v.charCodeAt(k-1)===RETURN&&--k;function L(){if(F)return EOF;if(I)return I=!1,EOL;var j,z=O,q;if(v.charCodeAt(z)===QUOTE){for(;O++<k&&v.charCodeAt(O)!==QUOTE||v.charCodeAt(++O)===QUOTE;);return(j=O)>=k?F=!0:(q=v.charCodeAt(O++))===NEWLINE?I=!0:q===RETURN&&(I=!0,v.charCodeAt(O)===NEWLINE&&++O),v.slice(z+1,j-1).replace(/""/g,'"')}for(;O<k;){if((q=v.charCodeAt(j=O++))===NEWLINE)I=!0;else if(q===RETURN)I=!0,v.charCodeAt(O)===NEWLINE&&++O;else if(q!==i)continue;return v.slice(z,j)}return F=!0,v.slice(z,k)}for(;(P=L())!==EOF;){for(var N=[];P!==EOL&&P!==EOF;)N.push(P),P=L();S&&(N=S(N,R++))==null||T.push(N)}return T}function o(v,S){return v.map(function(T){return S.map(function(k){return g(T[k])}).join(e)})}function l(v,S){return S==null&&(S=inferColumns(v)),[S.map(g).join(e)].concat(o(v,S)).join(`
`)}function f(v,S){return S==null&&(S=inferColumns(v)),o(v,S).join(`
`)}function d(v){return v.map(p).join(`
`)}function p(v){return v.map(g).join(e)}function g(v){return v==null?"":v instanceof Date?formatDate(v):n.test(v+="")?'"'+v.replace(/"/g,'""')+'"':v}return{parse:r,parseRows:s,format:l,formatBody:f,formatRows:d,formatRow:p,formatValue:g}}function identity$5(e){return e}function transform$3(e){if(e==null)return identity$5;var n,i,r=e.scale[0],s=e.scale[1],o=e.translate[0],l=e.translate[1];return function(f,d){d||(n=i=0);var p=2,g=f.length,v=new Array(g);for(v[0]=(n+=f[0])*r+o,v[1]=(i+=f[1])*s+l;p<g;)v[p]=f[p],++p;return v}}function reverse$2(e,n){for(var i,r=e.length,s=r-n;s<--r;)i=e[s],e[s++]=e[r],e[r]=i}function feature(e,n){return typeof n=="string"&&(n=e.objects[n]),n.type==="GeometryCollection"?{type:"FeatureCollection",features:n.geometries.map(function(i){return feature$1(e,i)})}:feature$1(e,n)}function feature$1(e,n){var i=n.id,r=n.bbox,s=n.properties==null?{}:n.properties,o=object$1(e,n);return i==null&&r==null?{type:"Feature",properties:s,geometry:o}:r==null?{type:"Feature",id:i,properties:s,geometry:o}:{type:"Feature",id:i,bbox:r,properties:s,geometry:o}}function object$1(e,n){var i=transform$3(e.transform),r=e.arcs;function s(g,v){v.length&&v.pop();for(var S=r[g<0?~g:g],T=0,k=S.length;T<k;++T)v.push(i(S[T],T));g<0&&reverse$2(v,k)}function o(g){return i(g)}function l(g){for(var v=[],S=0,T=g.length;S<T;++S)s(g[S],v);return v.length<2&&v.push(v[0]),v}function f(g){for(var v=l(g);v.length<4;)v.push(v[0]);return v}function d(g){return g.map(f)}function p(g){var v=g.type,S;switch(v){case"GeometryCollection":return{type:v,geometries:g.geometries.map(p)};case"Point":S=o(g.coordinates);break;case"MultiPoint":S=g.coordinates.map(o);break;case"LineString":S=l(g.arcs);break;case"MultiLineString":S=g.arcs.map(l);break;case"Polygon":S=d(g.arcs);break;case"MultiPolygon":S=g.arcs.map(d);break;default:return null}return{type:v,coordinates:S}}return p(n)}function stitch(e,n){var i={},r={},s={},o=[],l=-1;n.forEach(function(p,g){var v=e.arcs[p<0?~p:p],S;v.length<3&&!v[1][0]&&!v[1][1]&&(S=n[++l],n[l]=p,n[g]=S)}),n.forEach(function(p){var g=f(p),v=g[0],S=g[1],T,k;if(T=s[v])if(delete s[T.end],T.push(p),T.end=S,k=r[S]){delete r[k.start];var O=k===T?T:T.concat(k);r[O.start=T.start]=s[O.end=k.end]=O}else r[T.start]=s[T.end]=T;else if(T=r[S])if(delete r[T.start],T.unshift(p),T.start=v,k=s[v]){delete s[k.end];var R=k===T?T:k.concat(T);r[R.start=k.start]=s[R.end=T.end]=R}else r[T.start]=s[T.end]=T;else T=[p],r[T.start=v]=s[T.end=S]=T});function f(p){var g=e.arcs[p<0?~p:p],v=g[0],S;return e.transform?(S=[0,0],g.forEach(function(T){S[0]+=T[0],S[1]+=T[1]})):S=g[g.length-1],p<0?[S,v]:[v,S]}function d(p,g){for(var v in p){var S=p[v];delete g[S.start],delete S.start,delete S.end,S.forEach(function(T){i[T<0?~T:T]=1}),o.push(S)}}return d(s,r),d(r,s),n.forEach(function(p){i[p<0?~p:p]||o.push([p])}),o}function mesh(e){return object$1(e,meshArcs.apply(this,arguments))}function meshArcs(e,n,i){var r,s,o;if(arguments.length>1)r=extractArcs(e,n,i);else for(s=0,r=new Array(o=e.arcs.length);s<o;++s)r[s]=s;return{type:"MultiLineString",arcs:stitch(e,r)}}function extractArcs(e,n,i){var r=[],s=[],o;function l(v){var S=v<0?~v:v;(s[S]||(s[S]=[])).push({i:v,g:o})}function f(v){v.forEach(l)}function d(v){v.forEach(f)}function p(v){v.forEach(d)}function g(v){switch(o=v,v.type){case"GeometryCollection":v.geometries.forEach(g);break;case"LineString":f(v.arcs);break;case"MultiLineString":case"Polygon":d(v.arcs);break;case"MultiPolygon":p(v.arcs);break}}return g(n),s.forEach(i==null?function(v){r.push(v[0].i)}:function(v){i(v[0].g,v[v.length-1].g)&&r.push(v[0].i)}),r}function ascending$2(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function descending$1(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function bisector$1(e){let n,i,r;e.length!==2?(n=ascending$2,i=(f,d)=>ascending$2(e(f),d),r=(f,d)=>e(f)-d):(n=e===ascending$2||e===descending$1?e:zero$3,i=e,r=e);function s(f,d,p=0,g=f.length){if(p<g){if(n(d,d)!==0)return g;do{const v=p+g>>>1;i(f[v],d)<0?p=v+1:g=v}while(p<g)}return p}function o(f,d,p=0,g=f.length){if(p<g){if(n(d,d)!==0)return g;do{const v=p+g>>>1;i(f[v],d)<=0?p=v+1:g=v}while(p<g)}return p}function l(f,d,p=0,g=f.length){const v=s(f,d,p,g-1);return v>p&&r(f[v-1],d)>-r(f[v],d)?v-1:v}return{left:s,center:l,right:o}}function zero$3(){return 0}function number$6(e){return e===null?NaN:+e}function*numbers$2(e,n){if(n===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(yield i);else{let i=-1;for(let r of e)(r=n(r,++i,e))!=null&&(r=+r)>=r&&(yield r)}}const ascendingBisect=bisector$1(ascending$2),bisectRight$1=ascendingBisect.right,bisectLeft$1=ascendingBisect.left;bisector$1(number$6).center;const bisect$1=bisectRight$1;function variance(e,n){let i=0,r,s=0,o=0;if(n===void 0)for(let l of e)l!=null&&(l=+l)>=l&&(r=l-s,s+=r/++i,o+=r*(l-s));else{let l=-1;for(let f of e)(f=n(f,++l,e))!=null&&(f=+f)>=f&&(r=f-s,s+=r/++i,o+=r*(f-s))}if(i>1)return o/(i-1)}function deviation(e,n){const i=variance(e,n);return i&&Math.sqrt(i)}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const i=this._partials;let r=0;for(let s=0;s<this._n&&s<32;s++){const o=i[s],l=n+o,f=Math.abs(n)<Math.abs(o)?n-(l-o):o-(l-n);f&&(i[r++]=f),n=l}return i[r]=n,this._n=r+1,this}valueOf(){const n=this._partials;let i=this._n,r,s,o,l=0;if(i>0){for(l=n[--i];i>0&&(r=l,s=n[--i],l=r+s,o=s-(l-r),!o););i>0&&(o<0&&n[i-1]<0||o>0&&n[i-1]>0)&&(s=o*2,r=l+s,s==r-l&&(l=r))}return l}}class InternMap extends Map{constructor(n,i=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),n!=null)for(const[r,s]of n)this.set(r,s)}get(n){return super.get(intern_get(this,n))}has(n){return super.has(intern_get(this,n))}set(n,i){return super.set(intern_set(this,n),i)}delete(n){return super.delete(intern_delete(this,n))}}class InternSet extends Set{constructor(n,i=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),n!=null)for(const r of n)this.add(r)}has(n){return super.has(intern_get(this,n))}add(n){return super.add(intern_set(this,n))}delete(n){return super.delete(intern_delete(this,n))}}function intern_get({_intern:e,_key:n},i){const r=n(i);return e.has(r)?e.get(r):i}function intern_set({_intern:e,_key:n},i){const r=n(i);return e.has(r)?e.get(r):(e.set(r,i),i)}function intern_delete({_intern:e,_key:n},i){const r=n(i);return e.has(r)&&(i=e.get(r),e.delete(r)),i}function keyof(e){return e!==null&&typeof e=="object"?e.valueOf():e}function permute(e,n){return Array.from(n,i=>e[i])}function compareDefined(e=ascending$2){if(e===ascending$2)return ascendingDefined;if(typeof e!="function")throw new TypeError("compare is not a function");return(n,i)=>{const r=e(n,i);return r||r===0?r:(e(i,i)===0)-(e(n,n)===0)}}function ascendingDefined(e,n){return(e==null||!(e>=e))-(n==null||!(n>=n))||(e<n?-1:e>n?1:0)}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,n,i){const r=(n-e)/Math.max(0,i),s=Math.floor(Math.log10(r)),o=r/Math.pow(10,s),l=o>=e10?10:o>=e5?5:o>=e2?2:1;let f,d,p;return s<0?(p=Math.pow(10,-s)/l,f=Math.round(e*p),d=Math.round(n*p),f/p<e&&++f,d/p>n&&--d,p=-p):(p=Math.pow(10,s)*l,f=Math.round(e/p),d=Math.round(n/p),f*p<e&&++f,d*p>n&&--d),d<f&&.5<=i&&i<2?tickSpec(e,n,i*2):[f,d,p]}function ticks(e,n,i){if(n=+n,e=+e,i=+i,!(i>0))return[];if(e===n)return[e];const r=n<e,[s,o,l]=r?tickSpec(n,e,i):tickSpec(e,n,i);if(!(o>=s))return[];const f=o-s+1,d=new Array(f);if(r)if(l<0)for(let p=0;p<f;++p)d[p]=(o-p)/-l;else for(let p=0;p<f;++p)d[p]=(o-p)*l;else if(l<0)for(let p=0;p<f;++p)d[p]=(s+p)/-l;else for(let p=0;p<f;++p)d[p]=(s+p)*l;return d}function tickIncrement(e,n,i){return n=+n,e=+e,i=+i,tickSpec(e,n,i)[2]}function tickStep(e,n,i){n=+n,e=+e,i=+i;const r=n<e,s=r?tickIncrement(n,e,i):tickIncrement(e,n,i);return(r?-1:1)*(s<0?1/-s:s)}function max$2(e,n){let i;if(n===void 0)for(const r of e)r!=null&&(i<r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let s of e)(s=n(s,++r,e))!=null&&(i<s||i===void 0&&s>=s)&&(i=s)}return i}function min$2(e,n){let i;if(n===void 0)for(const r of e)r!=null&&(i>r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let s of e)(s=n(s,++r,e))!=null&&(i>s||i===void 0&&s>=s)&&(i=s)}return i}function quickselect(e,n,i=0,r=1/0,s){if(n=Math.floor(n),i=Math.floor(Math.max(0,i)),r=Math.floor(Math.min(e.length-1,r)),!(i<=n&&n<=r))return e;for(s=s===void 0?ascendingDefined:compareDefined(s);r>i;){if(r-i>600){const d=r-i+1,p=n-i+1,g=Math.log(d),v=.5*Math.exp(2*g/3),S=.5*Math.sqrt(g*v*(d-v)/d)*(p-d/2<0?-1:1),T=Math.max(i,Math.floor(n-p*v/d+S)),k=Math.min(r,Math.floor(n+(d-p)*v/d+S));quickselect(e,n,T,k,s)}const o=e[n];let l=i,f=r;for(swap$1(e,i,n),s(e[r],o)>0&&swap$1(e,i,r);l<f;){for(swap$1(e,l,f),++l,--f;s(e[l],o)<0;)++l;for(;s(e[f],o)>0;)--f}s(e[i],o)===0?swap$1(e,i,f):(++f,swap$1(e,f,r)),f<=n&&(i=f+1),n<=f&&(r=f-1)}return e}function swap$1(e,n,i){const r=e[n];e[n]=e[i],e[i]=r}function quantile$1(e,n,i){if(e=Float64Array.from(numbers$2(e,i)),!(!(r=e.length)||isNaN(n=+n))){if(n<=0||r<2)return min$2(e);if(n>=1)return max$2(e);var r,s=(r-1)*n,o=Math.floor(s),l=max$2(quickselect(e,o).subarray(0,o+1)),f=min$2(e.subarray(o+1));return l+(f-l)*(s-o)}}function quantileSorted(e,n,i=number$6){if(!(!(r=e.length)||isNaN(n=+n))){if(n<=0||r<2)return+i(e[0],0,e);if(n>=1)return+i(e[r-1],r-1,e);var r,s=(r-1)*n,o=Math.floor(s),l=+i(e[o],o,e),f=+i(e[o+1],o+1,e);return l+(f-l)*(s-o)}}function mean(e,n){let i=0,r=0;if(n===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(++i,r+=s);else{let s=-1;for(let o of e)(o=n(o,++s,e))!=null&&(o=+o)>=o&&(++i,r+=o)}if(i)return r/i}function median(e,n){return quantile$1(e,.5,n)}function*flatten(e){for(const n of e)yield*n}function merge$2(e){return Array.from(flatten(e))}function range$4(e,n,i){e=+e,n=+n,i=(s=arguments.length)<2?(n=e,e=0,1):s<3?1:+i;for(var r=-1,s=Math.max(0,Math.ceil((n-e)/i))|0,o=new Array(s);++r<s;)o[r]=e+r*i;return o}function sum$1(e,n){let i=0;if(n===void 0)for(let r of e)(r=+r)&&(i+=r);else{let r=-1;for(let s of e)(s=+n(s,++r,e))&&(i+=s)}return i}function formatDecimal(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function formatDecimalParts(e,n){if((i=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var i,r=e.slice(0,i);return[r.length>1?r[0]+r.slice(2):r,+e.slice(i+1)]}function exponent(e){return e=formatDecimalParts(Math.abs(e)),e?e[1]:NaN}function formatGroup(e,n){return function(i,r){for(var s=i.length,o=[],l=0,f=e[0],d=0;s>0&&f>0&&(d+f+1>r&&(f=Math.max(1,r-d)),o.push(i.substring(s-=f,s+f)),!((d+=f+1)>r));)f=e[l=(l+1)%e.length];return o.reverse().join(n)}}function formatNumerals(e){return function(n){return n.replace(/[0-9]/g,function(i){return e[+i]})}}var re$2=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){if(!(n=re$2.exec(e)))throw new Error("invalid format: "+e);var n;return new FormatSpecifier({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(e){e:for(var n=e.length,i=1,r=-1,s;i<n;++i)switch(e[i]){case".":r=s=i;break;case"0":r===0&&(r=i),s=i;break;default:if(!+e[i])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(s+1):e}var prefixExponent;function formatPrefixAuto(e,n){var i=formatDecimalParts(e,n);if(!i)return e+"";var r=i[0],s=i[1],o=s-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,l=r.length;return o===l?r:o>l?r+new Array(o-l+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+formatDecimalParts(e,Math.max(0,n+o-1))[0]}function formatRounded(e,n){var i=formatDecimalParts(e,n);if(!i)return e+"";var r=i[0],s=i[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const formatTypes={"%":(e,n)=>(e*100).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:formatDecimal,e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>formatRounded(e*100,n),r:formatRounded,s:formatPrefixAuto,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity$4(e){return e}var map$1=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(e){var n=e.grouping===void 0||e.thousands===void 0?identity$4:formatGroup(map$1.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?identity$4:formatNumerals(map$1.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",f=e.minus===void 0?"":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function p(v){v=formatSpecifier(v);var S=v.fill,T=v.align,k=v.sign,O=v.symbol,R=v.zero,P=v.width,F=v.comma,I=v.precision,L=v.trim,N=v.type;N==="n"?(F=!0,N="g"):formatTypes[N]||(I===void 0&&(I=12),L=!0,N="g"),(R||S==="0"&&T==="=")&&(R=!0,S="0",T="=");var j=O==="$"?i:O==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",z=O==="$"?r:/[%p]/.test(N)?l:"",q=formatTypes[N],H=/[defgprs%]/.test(N);I=I===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function W(U){var Q=j,J=z,ne,G,Z;if(N==="c")J=q(U)+J,U="";else{U=+U;var ae=U<0||1/U<0;if(U=isNaN(U)?d:q(Math.abs(U),I),L&&(U=formatTrim(U)),ae&&+U==0&&k!=="+"&&(ae=!1),Q=(ae?k==="("?k:f:k==="-"||k==="("?"":k)+Q,J=(N==="s"?prefixes[8+prefixExponent/3]:"")+J+(ae&&k==="("?")":""),H){for(ne=-1,G=U.length;++ne<G;)if(Z=U.charCodeAt(ne),48>Z||Z>57){J=(Z===46?s+U.slice(ne+1):U.slice(ne))+J,U=U.slice(0,ne);break}}}F&&!R&&(U=n(U,1/0));var oe=Q.length+U.length+J.length,pe=oe<P?new Array(P-oe+1).join(S):"";switch(F&&R&&(U=n(pe+U,pe.length?P-J.length:1/0),pe=""),T){case"<":U=Q+U+J+pe;break;case"=":U=Q+pe+U+J;break;case"^":U=pe.slice(0,oe=pe.length>>1)+Q+U+J+pe.slice(oe);break;default:U=pe+Q+U+J;break}return o(U)}return W.toString=function(){return v+""},W}function g(v,S){var T=p((v=formatSpecifier(v),v.type="f",v)),k=Math.max(-8,Math.min(8,Math.floor(exponent(S)/3)))*3,O=Math.pow(10,-k),R=prefixes[8+k/3];return function(P){return T(O*P)+R}}return{format:p,formatPrefix:g}}var locale$2,format$3,formatPrefix;defaultLocale$2({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$2(e){return locale$2=formatLocale$1(e),format$3=locale$2.format,formatPrefix=locale$2.formatPrefix,locale$2}function precisionFixed(e){return Math.max(0,-exponent(Math.abs(e)))}function precisionPrefix(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(n)/3)))*3-exponent(Math.abs(e)))}function precisionRound(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,exponent(n)-exponent(e))+1}const t0$2=new Date,t1$1=new Date;function timeInterval$1(e,n,i,r){function s(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return s.floor=o=>(e(o=new Date(+o)),o),s.ceil=o=>(e(o=new Date(o-1)),n(o,1),e(o),o),s.round=o=>{const l=s(o),f=s.ceil(o);return o-l<f-o?l:f},s.offset=(o,l)=>(n(o=new Date(+o),l==null?1:Math.floor(l)),o),s.range=(o,l,f)=>{const d=[];if(o=s.ceil(o),f=f==null?1:Math.floor(f),!(o<l)||!(f>0))return d;let p;do d.push(p=new Date(+o)),n(o,f),e(o);while(p<o&&o<l);return d},s.filter=o=>timeInterval$1(l=>{if(l>=l)for(;e(l),!o(l);)l.setTime(l-1)},(l,f)=>{if(l>=l)if(f<0)for(;++f<=0;)for(;n(l,-1),!o(l););else for(;--f>=0;)for(;n(l,1),!o(l););}),i&&(s.count=(o,l)=>(t0$2.setTime(+o),t1$1.setTime(+l),e(t0$2),e(t1$1),Math.floor(i(t0$2,t1$1))),s.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?s.filter(r?l=>r(l)%o===0:l=>s.count(0,l)%o===0):s)),s}const millisecond=timeInterval$1(()=>{},(e,n)=>{e.setTime(+e+n)},(e,n)=>n-e);millisecond.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?timeInterval$1(n=>{n.setTime(Math.floor(n/e)*e)},(n,i)=>{n.setTime(+n+i*e)},(n,i)=>(i-n)/e):millisecond);millisecond.range;const durationSecond$1=1e3,durationMinute$1=durationSecond$1*60,durationHour$1=durationMinute$1*60,durationDay$1=durationHour$1*24,durationWeek$1=durationDay$1*7,durationMonth$1=durationDay$1*30,durationYear$1=durationDay$1*365,second=timeInterval$1(e=>{e.setTime(e-e.getMilliseconds())},(e,n)=>{e.setTime(+e+n*durationSecond$1)},(e,n)=>(n-e)/durationSecond$1,e=>e.getUTCSeconds());second.range;const timeMinute=timeInterval$1(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond$1)},(e,n)=>{e.setTime(+e+n*durationMinute$1)},(e,n)=>(n-e)/durationMinute$1,e=>e.getMinutes());timeMinute.range;const utcMinute=timeInterval$1(e=>{e.setUTCSeconds(0,0)},(e,n)=>{e.setTime(+e+n*durationMinute$1)},(e,n)=>(n-e)/durationMinute$1,e=>e.getUTCMinutes());utcMinute.range;const timeHour=timeInterval$1(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond$1-e.getMinutes()*durationMinute$1)},(e,n)=>{e.setTime(+e+n*durationHour$1)},(e,n)=>(n-e)/durationHour$1,e=>e.getHours());timeHour.range;const utcHour=timeInterval$1(e=>{e.setUTCMinutes(0,0,0)},(e,n)=>{e.setTime(+e+n*durationHour$1)},(e,n)=>(n-e)/durationHour$1,e=>e.getUTCHours());utcHour.range;const timeDay=timeInterval$1(e=>e.setHours(0,0,0,0),(e,n)=>e.setDate(e.getDate()+n),(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute$1)/durationDay$1,e=>e.getDate()-1);timeDay.range;const utcDay=timeInterval$1(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/durationDay$1,e=>e.getUTCDate()-1);utcDay.range;const unixDay=timeInterval$1(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/durationDay$1,e=>Math.floor(e/durationDay$1));unixDay.range;function timeWeekday(e){return timeInterval$1(n=>{n.setDate(n.getDate()-(n.getDay()+7-e)%7),n.setHours(0,0,0,0)},(n,i)=>{n.setDate(n.getDate()+i*7)},(n,i)=>(i-n-(i.getTimezoneOffset()-n.getTimezoneOffset())*durationMinute$1)/durationWeek$1)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(e){return timeInterval$1(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7),n.setUTCHours(0,0,0,0)},(n,i)=>{n.setUTCDate(n.getUTCDate()+i*7)},(n,i)=>(i-n)/durationWeek$1)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval$1(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,n)=>{e.setMonth(e.getMonth()+n)},(e,n)=>n.getMonth()-e.getMonth()+(n.getFullYear()-e.getFullYear())*12,e=>e.getMonth());timeMonth.range;const utcMonth=timeInterval$1(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCMonth(e.getUTCMonth()+n)},(e,n)=>n.getUTCMonth()-e.getUTCMonth()+(n.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());utcMonth.range;const timeYear=timeInterval$1(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n)},(e,n)=>n.getFullYear()-e.getFullYear(),e=>e.getFullYear());timeYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval$1(n=>{n.setFullYear(Math.floor(n.getFullYear()/e)*e),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,i)=>{n.setFullYear(n.getFullYear()+i*e)});timeYear.range;const utcYear=timeInterval$1(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n)},(e,n)=>n.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());utcYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval$1(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/e)*e),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,i)=>{n.setUTCFullYear(n.getUTCFullYear()+i*e)});utcYear.range;function ticker(e,n,i,r,s,o){const l=[[second,1,durationSecond$1],[second,5,5*durationSecond$1],[second,15,15*durationSecond$1],[second,30,30*durationSecond$1],[o,1,durationMinute$1],[o,5,5*durationMinute$1],[o,15,15*durationMinute$1],[o,30,30*durationMinute$1],[s,1,durationHour$1],[s,3,3*durationHour$1],[s,6,6*durationHour$1],[s,12,12*durationHour$1],[r,1,durationDay$1],[r,2,2*durationDay$1],[i,1,durationWeek$1],[n,1,durationMonth$1],[n,3,3*durationMonth$1],[e,1,durationYear$1]];function f(p,g,v){const S=g<p;S&&([p,g]=[g,p]);const T=v&&typeof v.range=="function"?v:d(p,g,v),k=T?T.range(p,+g+1):[];return S?k.reverse():k}function d(p,g,v){const S=Math.abs(g-p)/v,T=bisector$1(([,,R])=>R).right(l,S);if(T===l.length)return e.every(tickStep(p/durationYear$1,g/durationYear$1,v));if(T===0)return millisecond.every(Math.max(tickStep(p,g,v),1));const[k,O]=l[S/l[T-1][2]<l[T][2]/S?T-1:T];return k.every(O)}return[f,d]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute),YEAR="year",QUARTER="quarter",MONTH="month",WEEK="week",DATE="date",DAY="day",DAYOFYEAR="dayofyear",HOURS="hours",MINUTES="minutes",SECONDS="seconds",MILLISECONDS="milliseconds",TIME_UNITS=[YEAR,QUARTER,MONTH,WEEK,DATE,DAY,DAYOFYEAR,HOURS,MINUTES,SECONDS,MILLISECONDS],UNITS=TIME_UNITS.reduce((e,n,i)=>(e[n]=1+i,e),{});function timeUnits(e){const n=array$5(e).slice(),i={};return n.length||error("Missing time unit."),n.forEach(s=>{has$1(UNITS,s)?i[s]=1:error("Invalid time unit: ".concat(s,"."))}),(i[WEEK]||i[DAY]?1:0)+(i[QUARTER]||i[MONTH]||i[DATE]?1:0)+(i[DAYOFYEAR]?1:0)>1&&error("Incompatible time units: ".concat(e)),n.sort((s,o)=>UNITS[s]-UNITS[o]),n}const defaultSpecifiers={[YEAR]:"%Y ",[QUARTER]:"Q%q ",[MONTH]:"%b ",[DATE]:"%d ",[WEEK]:"W%U ",[DAY]:"%a ",[DAYOFYEAR]:"%j ",[HOURS]:"%H:00",[MINUTES]:"00:%M",[SECONDS]:":%S",[MILLISECONDS]:".%L",["".concat(YEAR,"-").concat(MONTH)]:"%Y-%m ",["".concat(YEAR,"-").concat(MONTH,"-").concat(DATE)]:"%Y-%m-%d ",["".concat(HOURS,"-").concat(MINUTES)]:"%H:%M"};function timeUnitSpecifier(e,n){const i=extend$1({},defaultSpecifiers,n),r=timeUnits(e),s=r.length;let o="",l=0,f,d;for(l=0;l<s;)for(f=r.length;f>l;--f)if(d=r.slice(l,f).join("-"),i[d]!=null){o+=i[d],l=f;break}return o.trim()}const t0$1=new Date;function localYear(e){return t0$1.setFullYear(e),t0$1.setMonth(0),t0$1.setDate(1),t0$1.setHours(0,0,0,0),t0$1}function dayofyear(e){return localDayOfYear(new Date(e))}function week(e){return localWeekNum(new Date(e))}function localDayOfYear(e){return timeDay.count(localYear(e.getFullYear())-1,e)}function localWeekNum(e){return timeSunday.count(localYear(e.getFullYear())-1,e)}function localFirst(e){return localYear(e).getDay()}function localDate$1(e,n,i,r,s,o,l){if(0<=e&&e<100){const f=new Date(-1,n,i,r,s,o,l);return f.setFullYear(e),f}return new Date(e,n,i,r,s,o,l)}function utcdayofyear(e){return utcDayOfYear(new Date(e))}function utcweek(e){return utcWeekNum(new Date(e))}function utcDayOfYear(e){const n=Date.UTC(e.getUTCFullYear(),0,1);return utcDay.count(n-1,e)}function utcWeekNum(e){const n=Date.UTC(e.getUTCFullYear(),0,1);return utcSunday.count(n-1,e)}function utcFirst(e){return t0$1.setTime(Date.UTC(e,0,1)),t0$1.getUTCDay()}function utcDate$1(e,n,i,r,s,o,l){if(0<=e&&e<100){const f=new Date(Date.UTC(-1,n,i,r,s,o,l));return f.setUTCFullYear(i.y),f}return new Date(Date.UTC(e,n,i,r,s,o,l))}function floor(e,n,i,r,s){const o=n||1,l=peek$1(e),f=(P,F,I)=>(I=I||P,getUnit(i[I],r[I],P===l&&o,F)),d=new Date,p=toSet(e),g=p[YEAR]?f(YEAR):constant$4(2012),v=p[MONTH]?f(MONTH):p[QUARTER]?f(QUARTER):zero$4,S=p[WEEK]&&p[DAY]?f(DAY,1,WEEK+DAY):p[WEEK]?f(WEEK,1):p[DAY]?f(DAY,1):p[DATE]?f(DATE,1):p[DAYOFYEAR]?f(DAYOFYEAR,1):one$2,T=p[HOURS]?f(HOURS):zero$4,k=p[MINUTES]?f(MINUTES):zero$4,O=p[SECONDS]?f(SECONDS):zero$4,R=p[MILLISECONDS]?f(MILLISECONDS):zero$4;return function(P){d.setTime(+P);const F=g(d);return s(F,v(d),S(d,F),T(d),k(d),O(d),R(d))}}function getUnit(e,n,i,r){const s=i<=1?e:r?(o,l)=>r+i*Math.floor((e(o,l)-r)/i):(o,l)=>i*Math.floor(e(o,l)/i);return n?(o,l)=>n(s(o,l),l):s}function weekday(e,n,i){return n+e*7-(i+6)%7}const localGet={[YEAR]:e=>e.getFullYear(),[QUARTER]:e=>Math.floor(e.getMonth()/3),[MONTH]:e=>e.getMonth(),[DATE]:e=>e.getDate(),[HOURS]:e=>e.getHours(),[MINUTES]:e=>e.getMinutes(),[SECONDS]:e=>e.getSeconds(),[MILLISECONDS]:e=>e.getMilliseconds(),[DAYOFYEAR]:e=>localDayOfYear(e),[WEEK]:e=>localWeekNum(e),[WEEK+DAY]:(e,n)=>weekday(localWeekNum(e),e.getDay(),localFirst(n)),[DAY]:(e,n)=>weekday(1,e.getDay(),localFirst(n))},localInv={[QUARTER]:e=>3*e,[WEEK]:(e,n)=>weekday(e,0,localFirst(n))};function timeFloor(e,n){return floor(e,n||1,localGet,localInv,localDate$1)}const utcGet={[YEAR]:e=>e.getUTCFullYear(),[QUARTER]:e=>Math.floor(e.getUTCMonth()/3),[MONTH]:e=>e.getUTCMonth(),[DATE]:e=>e.getUTCDate(),[HOURS]:e=>e.getUTCHours(),[MINUTES]:e=>e.getUTCMinutes(),[SECONDS]:e=>e.getUTCSeconds(),[MILLISECONDS]:e=>e.getUTCMilliseconds(),[DAYOFYEAR]:e=>utcDayOfYear(e),[WEEK]:e=>utcWeekNum(e),[DAY]:(e,n)=>weekday(1,e.getUTCDay(),utcFirst(n)),[WEEK+DAY]:(e,n)=>weekday(utcWeekNum(e),e.getUTCDay(),utcFirst(n))},utcInv={[QUARTER]:e=>3*e,[WEEK]:(e,n)=>weekday(e,0,utcFirst(n))};function utcFloor(e,n){return floor(e,n||1,utcGet,utcInv,utcDate$1)}const timeIntervals={[YEAR]:timeYear,[QUARTER]:timeMonth.every(3),[MONTH]:timeMonth,[WEEK]:timeSunday,[DATE]:timeDay,[DAY]:timeDay,[DAYOFYEAR]:timeDay,[HOURS]:timeHour,[MINUTES]:timeMinute,[SECONDS]:second,[MILLISECONDS]:millisecond},utcIntervals={[YEAR]:utcYear,[QUARTER]:utcMonth.every(3),[MONTH]:utcMonth,[WEEK]:utcSunday,[DATE]:utcDay,[DAY]:utcDay,[DAYOFYEAR]:utcDay,[HOURS]:utcHour,[MINUTES]:utcMinute,[SECONDS]:second,[MILLISECONDS]:millisecond};function timeInterval(e){return timeIntervals[e]}function utcInterval(e){return utcIntervals[e]}function offset$3(e,n,i){return e?e.offset(n,i):void 0}function timeOffset(e,n,i){return offset$3(timeInterval(e),n,i)}function utcOffset(e,n,i){return offset$3(utcInterval(e),n,i)}function sequence$1(e,n,i,r){return e?e.range(n,i,r):void 0}function timeSequence(e,n,i,r){return sequence$1(timeInterval(e),n,i,r)}function utcSequence(e,n,i,r){return sequence$1(utcInterval(e),n,i,r)}const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,Milli=[YEAR,MONTH,DATE,HOURS,MINUTES,SECONDS,MILLISECONDS],Seconds=Milli.slice(0,-1),Minutes=Seconds.slice(0,-1),Hours=Minutes.slice(0,-1),Day=Hours.slice(0,-1),Week=[YEAR,WEEK],Month=[YEAR,MONTH],Year=[YEAR],intervals=[[Seconds,1,durationSecond],[Seconds,5,5*durationSecond],[Seconds,15,15*durationSecond],[Seconds,30,30*durationSecond],[Minutes,1,durationMinute],[Minutes,5,5*durationMinute],[Minutes,15,15*durationMinute],[Minutes,30,30*durationMinute],[Hours,1,durationHour],[Hours,3,3*durationHour],[Hours,6,6*durationHour],[Hours,12,12*durationHour],[Day,1,durationDay],[Week,1,durationWeek],[Month,1,durationMonth],[Month,3,3*durationMonth],[Year,1,durationYear]];function bin$2(e){const n=e.extent,i=e.maxbins||40,r=Math.abs(span(n))/i;let s=bisector$1(f=>f[2]).right(intervals,r),o,l;return s===intervals.length?(o=Year,l=tickStep(n[0]/durationYear,n[1]/durationYear,i)):s?(s=intervals[r/intervals[s-1][2]<intervals[s][2]/r?s-1:s],o=s[0],l=s[1]):(o=Milli,l=Math.max(tickStep(n[0],n[1],i),1)),{units:o,step:l}}function localDate(e){if(0<=e.y&&e.y<100){var n=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return n.setFullYear(e.y),n}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate(e){if(0<=e.y&&e.y<100){var n=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return n.setUTCFullYear(e.y),n}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newDate(e,n,i){return{y:e,m:n,d:i,H:0,M:0,S:0,L:0}}function formatLocale(e){var n=e.dateTime,i=e.date,r=e.time,s=e.periods,o=e.days,l=e.shortDays,f=e.months,d=e.shortMonths,p=formatRe(s),g=formatLookup(s),v=formatRe(o),S=formatLookup(o),T=formatRe(l),k=formatLookup(l),O=formatRe(f),R=formatLookup(f),P=formatRe(d),F=formatLookup(d),I={a:ae,A:oe,b:pe,B:Se,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:ue,q:ee,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},L={a:V,A:se,b:fe,B:he,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:be,q:xe,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},N={a:W,A:U,b:Q,B:J,c:ne,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:H,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:G,X:Z,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};I.x=j(i,I),I.X=j(r,I),I.c=j(n,I),L.x=j(i,L),L.X=j(r,L),L.c=j(n,L);function j(ye,we){return function($e){var ve=[],Te=-1,te=0,ie=ye.length,ce,ge,de;for($e instanceof Date||($e=new Date(+$e));++Te<ie;)ye.charCodeAt(Te)===37&&(ve.push(ye.slice(te,Te)),(ge=pads[ce=ye.charAt(++Te)])!=null?ce=ye.charAt(++Te):ge=ce==="e"?" ":"0",(de=we[ce])&&(ce=de($e,ge)),ve.push(ce),te=Te+1);return ve.push(ye.slice(te,Te)),ve.join("")}}function z(ye,we){return function($e){var ve=newDate(1900,void 0,1),Te=q(ve,ye,$e+="",0),te,ie;if(Te!=$e.length)return null;if("Q"in ve)return new Date(ve.Q);if("s"in ve)return new Date(ve.s*1e3+("L"in ve?ve.L:0));if(we&&!("Z"in ve)&&(ve.Z=0),"p"in ve&&(ve.H=ve.H%12+ve.p*12),ve.m===void 0&&(ve.m="q"in ve?ve.q:0),"V"in ve){if(ve.V<1||ve.V>53)return null;"w"in ve||(ve.w=1),"Z"in ve?(te=utcDate(newDate(ve.y,0,1)),ie=te.getUTCDay(),te=ie>4||ie===0?utcMonday.ceil(te):utcMonday(te),te=utcDay.offset(te,(ve.V-1)*7),ve.y=te.getUTCFullYear(),ve.m=te.getUTCMonth(),ve.d=te.getUTCDate()+(ve.w+6)%7):(te=localDate(newDate(ve.y,0,1)),ie=te.getDay(),te=ie>4||ie===0?timeMonday.ceil(te):timeMonday(te),te=timeDay.offset(te,(ve.V-1)*7),ve.y=te.getFullYear(),ve.m=te.getMonth(),ve.d=te.getDate()+(ve.w+6)%7)}else("W"in ve||"U"in ve)&&("w"in ve||(ve.w="u"in ve?ve.u%7:"W"in ve?1:0),ie="Z"in ve?utcDate(newDate(ve.y,0,1)).getUTCDay():localDate(newDate(ve.y,0,1)).getDay(),ve.m=0,ve.d="W"in ve?(ve.w+6)%7+ve.W*7-(ie+5)%7:ve.w+ve.U*7-(ie+6)%7);return"Z"in ve?(ve.H+=ve.Z/100|0,ve.M+=ve.Z%100,utcDate(ve)):localDate(ve)}}function q(ye,we,$e,ve){for(var Te=0,te=we.length,ie=$e.length,ce,ge;Te<te;){if(ve>=ie)return-1;if(ce=we.charCodeAt(Te++),ce===37){if(ce=we.charAt(Te++),ge=N[ce in pads?we.charAt(Te++):ce],!ge||(ve=ge(ye,$e,ve))<0)return-1}else if(ce!=$e.charCodeAt(ve++))return-1}return ve}function H(ye,we,$e){var ve=p.exec(we.slice($e));return ve?(ye.p=g.get(ve[0].toLowerCase()),$e+ve[0].length):-1}function W(ye,we,$e){var ve=T.exec(we.slice($e));return ve?(ye.w=k.get(ve[0].toLowerCase()),$e+ve[0].length):-1}function U(ye,we,$e){var ve=v.exec(we.slice($e));return ve?(ye.w=S.get(ve[0].toLowerCase()),$e+ve[0].length):-1}function Q(ye,we,$e){var ve=P.exec(we.slice($e));return ve?(ye.m=F.get(ve[0].toLowerCase()),$e+ve[0].length):-1}function J(ye,we,$e){var ve=O.exec(we.slice($e));return ve?(ye.m=R.get(ve[0].toLowerCase()),$e+ve[0].length):-1}function ne(ye,we,$e){return q(ye,n,we,$e)}function G(ye,we,$e){return q(ye,i,we,$e)}function Z(ye,we,$e){return q(ye,r,we,$e)}function ae(ye){return l[ye.getDay()]}function oe(ye){return o[ye.getDay()]}function pe(ye){return d[ye.getMonth()]}function Se(ye){return f[ye.getMonth()]}function ue(ye){return s[+(ye.getHours()>=12)]}function ee(ye){return 1+~~(ye.getMonth()/3)}function V(ye){return l[ye.getUTCDay()]}function se(ye){return o[ye.getUTCDay()]}function fe(ye){return d[ye.getUTCMonth()]}function he(ye){return f[ye.getUTCMonth()]}function be(ye){return s[+(ye.getUTCHours()>=12)]}function xe(ye){return 1+~~(ye.getUTCMonth()/3)}return{format:function(ye){var we=j(ye+="",I);return we.toString=function(){return ye},we},parse:function(ye){var we=z(ye+="",!1);return we.toString=function(){return ye},we},utcFormat:function(ye){var we=j(ye+="",L);return we.toString=function(){return ye},we},utcParse:function(ye){var we=z(ye+="",!0);return we.toString=function(){return ye},we}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(e,n,i){var r=e<0?"-":"",s=(r?-e:e)+"",o=s.length;return r+(o<i?new Array(i-o+1).join(n)+s:s)}function requote(e){return e.replace(requoteRe,"\\$&")}function formatRe(e){return new RegExp("^(?:"+e.map(requote).join("|")+")","i")}function formatLookup(e){return new Map(e.map((n,i)=>[n.toLowerCase(),i]))}function parseWeekdayNumberSunday(e,n,i){var r=numberRe.exec(n.slice(i,i+1));return r?(e.w=+r[0],i+r[0].length):-1}function parseWeekdayNumberMonday(e,n,i){var r=numberRe.exec(n.slice(i,i+1));return r?(e.u=+r[0],i+r[0].length):-1}function parseWeekNumberSunday(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.U=+r[0],i+r[0].length):-1}function parseWeekNumberISO(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.V=+r[0],i+r[0].length):-1}function parseWeekNumberMonday(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.W=+r[0],i+r[0].length):-1}function parseFullYear(e,n,i){var r=numberRe.exec(n.slice(i,i+4));return r?(e.y=+r[0],i+r[0].length):-1}function parseYear(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),i+r[0].length):-1}function parseZone(e,n,i){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(i,i+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),i+r[0].length):-1}function parseQuarter(e,n,i){var r=numberRe.exec(n.slice(i,i+1));return r?(e.q=r[0]*3-3,i+r[0].length):-1}function parseMonthNumber(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.m=r[0]-1,i+r[0].length):-1}function parseDayOfMonth(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.d=+r[0],i+r[0].length):-1}function parseDayOfYear(e,n,i){var r=numberRe.exec(n.slice(i,i+3));return r?(e.m=0,e.d=+r[0],i+r[0].length):-1}function parseHour24(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.H=+r[0],i+r[0].length):-1}function parseMinutes(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.M=+r[0],i+r[0].length):-1}function parseSeconds(e,n,i){var r=numberRe.exec(n.slice(i,i+2));return r?(e.S=+r[0],i+r[0].length):-1}function parseMilliseconds(e,n,i){var r=numberRe.exec(n.slice(i,i+3));return r?(e.L=+r[0],i+r[0].length):-1}function parseMicroseconds(e,n,i){var r=numberRe.exec(n.slice(i,i+6));return r?(e.L=Math.floor(r[0]/1e3),i+r[0].length):-1}function parseLiteralPercent(e,n,i){var r=percentRe.exec(n.slice(i,i+1));return r?i+r[0].length:-1}function parseUnixTimestamp(e,n,i){var r=numberRe.exec(n.slice(i));return r?(e.Q=+r[0],i+r[0].length):-1}function parseUnixTimestampSeconds(e,n,i){var r=numberRe.exec(n.slice(i));return r?(e.s=+r[0],i+r[0].length):-1}function formatDayOfMonth(e,n){return pad(e.getDate(),n,2)}function formatHour24(e,n){return pad(e.getHours(),n,2)}function formatHour12(e,n){return pad(e.getHours()%12||12,n,2)}function formatDayOfYear(e,n){return pad(1+timeDay.count(timeYear(e),e),n,3)}function formatMilliseconds(e,n){return pad(e.getMilliseconds(),n,3)}function formatMicroseconds(e,n){return formatMilliseconds(e,n)+"000"}function formatMonthNumber(e,n){return pad(e.getMonth()+1,n,2)}function formatMinutes(e,n){return pad(e.getMinutes(),n,2)}function formatSeconds(e,n){return pad(e.getSeconds(),n,2)}function formatWeekdayNumberMonday(e){var n=e.getDay();return n===0?7:n}function formatWeekNumberSunday(e,n){return pad(timeSunday.count(timeYear(e)-1,e),n,2)}function dISO(e){var n=e.getDay();return n>=4||n===0?timeThursday(e):timeThursday.ceil(e)}function formatWeekNumberISO(e,n){return e=dISO(e),pad(timeThursday.count(timeYear(e),e)+(timeYear(e).getDay()===4),n,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,n){return pad(timeMonday.count(timeYear(e)-1,e),n,2)}function formatYear(e,n){return pad(e.getFullYear()%100,n,2)}function formatYearISO(e,n){return e=dISO(e),pad(e.getFullYear()%100,n,2)}function formatFullYear(e,n){return pad(e.getFullYear()%1e4,n,4)}function formatFullYearISO(e,n){var i=e.getDay();return e=i>=4||i===0?timeThursday(e):timeThursday.ceil(e),pad(e.getFullYear()%1e4,n,4)}function formatZone(e){var n=e.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+pad(n/60|0,"0",2)+pad(n%60,"0",2)}function formatUTCDayOfMonth(e,n){return pad(e.getUTCDate(),n,2)}function formatUTCHour24(e,n){return pad(e.getUTCHours(),n,2)}function formatUTCHour12(e,n){return pad(e.getUTCHours()%12||12,n,2)}function formatUTCDayOfYear(e,n){return pad(1+utcDay.count(utcYear(e),e),n,3)}function formatUTCMilliseconds(e,n){return pad(e.getUTCMilliseconds(),n,3)}function formatUTCMicroseconds(e,n){return formatUTCMilliseconds(e,n)+"000"}function formatUTCMonthNumber(e,n){return pad(e.getUTCMonth()+1,n,2)}function formatUTCMinutes(e,n){return pad(e.getUTCMinutes(),n,2)}function formatUTCSeconds(e,n){return pad(e.getUTCSeconds(),n,2)}function formatUTCWeekdayNumberMonday(e){var n=e.getUTCDay();return n===0?7:n}function formatUTCWeekNumberSunday(e,n){return pad(utcSunday.count(utcYear(e)-1,e),n,2)}function UTCdISO(e){var n=e.getUTCDay();return n>=4||n===0?utcThursday(e):utcThursday.ceil(e)}function formatUTCWeekNumberISO(e,n){return e=UTCdISO(e),pad(utcThursday.count(utcYear(e),e)+(utcYear(e).getUTCDay()===4),n,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,n){return pad(utcMonday.count(utcYear(e)-1,e),n,2)}function formatUTCYear(e,n){return pad(e.getUTCFullYear()%100,n,2)}function formatUTCYearISO(e,n){return e=UTCdISO(e),pad(e.getUTCFullYear()%100,n,2)}function formatUTCFullYear(e,n){return pad(e.getUTCFullYear()%1e4,n,4)}function formatUTCFullYearISO(e,n){var i=e.getUTCDay();return e=i>=4||i===0?utcThursday(e):utcThursday.ceil(e),pad(e.getUTCFullYear()%1e4,n,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}var locale$1,timeFormat$2,timeParse$1,utcFormat$1,utcParse$1;defaultLocale$1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale$1(e){return locale$1=formatLocale(e),timeFormat$2=locale$1.format,timeParse$1=locale$1.parse,utcFormat$1=locale$1.utcFormat,utcParse$1=locale$1.utcParse,locale$1}function memoize(e){const n={};return i=>n[i]||(n[i]=e(i))}function trimZeroes(e,n){return i=>{const r=e(i),s=r.indexOf(n);if(s<0)return r;let o=rightmostDigit(r,s);const l=o<r.length?r.slice(o):"";for(;--o>s;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+l}}function rightmostDigit(e,n){let i=e.lastIndexOf("e"),r;if(i>0)return i;for(i=e.length;--i>n;)if(r=e.charCodeAt(i),r>=48&&r<=57)return i+1}function numberLocale(e){const n=memoize(e.format),i=e.formatPrefix;return{format:n,formatPrefix:i,formatFloat(r){const s=formatSpecifier(r||",");if(s.precision==null){switch(s.precision=12,s.type){case"%":s.precision-=2;break;case"e":s.precision-=1;break}return trimZeroes(n(s),n(".1f")(1)[1])}else return n(s)},formatSpan(r,s,o,l){l=formatSpecifier(l??",f");const f=tickStep(r,s,o),d=Math.max(Math.abs(r),Math.abs(s));let p;if(l.precision==null)switch(l.type){case"s":return isNaN(p=precisionPrefix(f,d))||(l.precision=p),i(l,d);case"":case"e":case"g":case"p":case"r":{isNaN(p=precisionRound(f,d))||(l.precision=p-(l.type==="e"));break}case"f":case"%":{isNaN(p=precisionFixed(f))||(l.precision=p-(l.type==="%")*2);break}}return n(l)}}}let defaultNumberLocale;resetNumberFormatDefaultLocale();function resetNumberFormatDefaultLocale(){return defaultNumberLocale=numberLocale({format:format$3,formatPrefix})}function numberFormatLocale(e){return numberLocale(formatLocale$1(e))}function numberFormatDefaultLocale(e){return arguments.length?defaultNumberLocale=numberFormatLocale(e):defaultNumberLocale}function timeMultiFormat(e,n,i){i=i||{},isObject(i)||error("Invalid time multi-format specifier: ".concat(i));const r=n(SECONDS),s=n(MINUTES),o=n(HOURS),l=n(DATE),f=n(WEEK),d=n(MONTH),p=n(QUARTER),g=n(YEAR),v=e(i[MILLISECONDS]||".%L"),S=e(i[SECONDS]||":%S"),T=e(i[MINUTES]||"%I:%M"),k=e(i[HOURS]||"%I %p"),O=e(i[DATE]||i[DAY]||"%a %d"),R=e(i[WEEK]||"%b %d"),P=e(i[MONTH]||"%B"),F=e(i[QUARTER]||"%B"),I=e(i[YEAR]||"%Y");return L=>(r(L)<L?v:s(L)<L?S:o(L)<L?T:l(L)<L?k:d(L)<L?f(L)<L?O:R:g(L)<L?p(L)<L?P:F:I)(L)}function timeLocale(e){const n=memoize(e.format),i=memoize(e.utcFormat);return{timeFormat:r=>isString(r)?n(r):timeMultiFormat(n,timeInterval,r),utcFormat:r=>isString(r)?i(r):timeMultiFormat(i,utcInterval,r),timeParse:memoize(e.parse),utcParse:memoize(e.utcParse)}}let defaultTimeLocale;resetTimeFormatDefaultLocale();function resetTimeFormatDefaultLocale(){return defaultTimeLocale=timeLocale({format:timeFormat$2,parse:timeParse$1,utcFormat:utcFormat$1,utcParse:utcParse$1})}function timeFormatLocale(e){return timeLocale(formatLocale(e))}function timeFormatDefaultLocale(e){return arguments.length?defaultTimeLocale=timeFormatLocale(e):defaultTimeLocale}const createLocale=(e,n)=>extend$1({},e,n);function locale(e,n){const i=e?numberFormatLocale(e):numberFormatDefaultLocale(),r=n?timeFormatLocale(n):timeFormatDefaultLocale();return createLocale(i,r)}function defaultLocale(e,n){const i=arguments.length;return i&&i!==2&&error("defaultLocale expects either zero or two arguments."),i?createLocale(numberFormatDefaultLocale(e),timeFormatDefaultLocale(n)):createLocale(numberFormatDefaultLocale(),timeFormatDefaultLocale())}function resetDefaultLocale(){return resetNumberFormatDefaultLocale(),resetTimeFormatDefaultLocale(),defaultLocale()}const protocol_re=/^(data:|([A-Za-z]+:)?\/\/)/,allowed_re=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,whitespace_re=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,fileProtocol="file://";function loaderFactory(e,n){return i=>({options:i||{},sanitize,load:load$1,fileAccess:!!n,file:fileLoader(n),http:httpLoader(e)})}async function load$1(e,n){const i=await this.sanitize(e,n),r=i.href;return i.localFile?this.file(r):this.http(r,n)}async function sanitize(e,n){n=extend$1({},this.options,n);const i=this.fileAccess,r={href:null};let s,o,l;const f=allowed_re.test(e.replace(whitespace_re,""));(e==null||typeof e!="string"||!f)&&error("Sanitize failure, invalid URI: "+$(e));const d=protocol_re.test(e);return(l=n.baseURL)&&!d&&(!e.startsWith("/")&&!l.endsWith("/")&&(e="/"+e),e=l+e),o=(s=e.startsWith(fileProtocol))||n.mode==="file"||n.mode!=="http"&&!d&&i,s?e=e.slice(fileProtocol.length):e.startsWith("//")&&(n.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(n.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,n.target&&(r.target=n.target+""),n.rel&&(r.rel=n.rel+""),n.context==="image"&&n.crossOrigin&&(r.crossOrigin=n.crossOrigin+""),r}function fileLoader(e){return e?n=>new Promise((i,r)=>{e.readFile(n,(s,o)=>{s?r(s):i(o)})}):fileReject}async function fileReject(){error("No file system access.")}function httpLoader(e){return e?async function(n,i){const r=extend$1({},this.options.http,i),s=i&&i.response,o=await e(n,r);return o.ok?isFunction(o[s])?o[s]():o.text():error(o.status+""+o.statusText)}:httpReject}async function httpReject(){error("No HTTP fetch method available.")}const isValid=e=>e!=null&&e===e,isBoolean$1=e=>e==="true"||e==="false"||e===!0||e===!1,isDate=e=>!Number.isNaN(Date.parse(e)),isNumber=e=>!Number.isNaN(+e)&&!(e instanceof Date),isInteger=e=>isNumber(e)&&Number.isInteger(+e),typeParsers={boolean:toBoolean,integer:toNumber,number:toNumber,date:toDate,string:toString,unknown:identity$6},typeTests=[isBoolean$1,isInteger,isNumber,isDate],typeList=["boolean","integer","number","date"];function inferType(e,n){if(!e||!e.length)return"unknown";const i=e.length,r=typeTests.length,s=typeTests.map((o,l)=>l+1);for(let o=0,l=0,f,d;o<i;++o)for(d=n?e[o][n]:e[o],f=0;f<r;++f)if(s[f]&&isValid(d)&&!typeTests[f](d)&&(s[f]=0,++l,l===typeTests.length))return"string";return typeList[s.reduce((o,l)=>o===0?l:o,0)-1]}function inferTypes(e,n){return n.reduce((i,r)=>(i[r]=inferType(e,r),i),{})}function delimitedFormat(e){const n=function(i,r){const s={delimiter:e};return dsv(i,r?extend$1(r,s):s)};return n.responseType="text",n}function dsv(e,n){return n.header&&(e=n.header.map($).join(n.delimiter)+`
`+e),dsvFormat(n.delimiter).parse(e+"")}dsv.responseType="text";function isBuffer(e){return typeof Buffer=="function"&&isFunction(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function json(e,n){const i=n&&n.property?field$1(n.property):identity$6;return isObject(e)&&!isBuffer(e)?parseJSON(i(e),n):i(JSON.parse(e))}json.responseType="json";function parseJSON(e,n){return!isArray(e)&&isIterable(e)&&(e=[...e]),n&&n.copy?JSON.parse(JSON.stringify(e)):e}const filters={interior:(e,n)=>e!==n,exterior:(e,n)=>e===n};function topojson(e,n){let i,r,s,o;return e=json(e,n),n&&n.feature?(i=feature,s=n.feature):n&&n.mesh?(i=mesh,s=n.mesh,o=filters[n.filter]):error("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[s])?i(e,r,o):error("Invalid TopoJSON object: "+s),r&&r.features||[r]}topojson.responseType="json";const format$2={dsv,csv:delimitedFormat(","),tsv:delimitedFormat("	"),json,topojson};function formats$1(e,n){return arguments.length>1?(format$2[e]=n,this):has$1(format$2,e)?format$2[e]:null}function responseType(e){const n=formats$1(e);return n&&n.responseType||"text"}function read(e,n,i,r){n=n||{};const s=formats$1(n.type||"json");return s||error("Unknown data format type: "+n.type),e=s(e,n),n.parse&&parse$6(e,n.parse,i,r),has$1(e,"columns")&&delete e.columns,e}function parse$6(e,n,i,r){if(!e.length)return;const s=timeFormatDefaultLocale();i=i||s.timeParse,r=r||s.utcParse;let o=e.columns||Object.keys(e[0]),l,f,d,p,g,v;n==="auto"&&(n=inferTypes(e,o)),o=Object.keys(n);const S=o.map(T=>{const k=n[T];let O,R;if(k&&(k.startsWith("date:")||k.startsWith("utc:")))return O=k.split(/:(.+)?/,2),R=O[1],(R[0]==="'"&&R[R.length-1]==="'"||R[0]==='"'&&R[R.length-1]==='"')&&(R=R.slice(1,-1)),(O[0]==="utc"?r:i)(R);if(!typeParsers[k])throw Error("Illegal format pattern: "+T+":"+k);return typeParsers[k]});for(d=0,g=e.length,v=o.length;d<g;++d)for(l=e[d],p=0;p<v;++p)f=o[p],l[f]=S[p](l[f])}const loader=loaderFactory(typeof fetch<"u"&&fetch,null);function UniqueList(e){const n=e||identity$6,i=[],r={};return i.add=s=>{const o=n(s);return r[o]||(r[o]=1,i.push(s)),i},i.remove=s=>{const o=n(s);if(r[o]){r[o]=0;const l=i.indexOf(s);l>=0&&i.splice(l,1)}return i},i}async function asyncCallback(e,n){try{await n(e)}catch(i){e.error(i)}}const TUPLE_ID_KEY=Symbol("vega_id");let TUPLE_ID=1;function isTuple(e){return!!(e&&tupleid(e))}function tupleid(e){return e[TUPLE_ID_KEY]}function setid(e,n){return e[TUPLE_ID_KEY]=n,e}function ingest$1(e){const n=e===Object(e)?e:{data:e};return tupleid(n)?n:setid(n,TUPLE_ID++)}function derive(e){return rederive(e,ingest$1({}))}function rederive(e,n){for(const i in e)n[i]=e[i];return n}function replace$1(e,n){return setid(n,tupleid(e))}function stableCompare(e,n){return e?n?(i,r)=>e(i,r)||tupleid(n(i))-tupleid(n(r)):(i,r)=>e(i,r)||tupleid(i)-tupleid(r):null}function isChangeSet(e){return e&&e.constructor===changeset}function changeset(){const e=[],n=[],i=[],r=[],s=[];let o=null,l=!1;return{constructor:changeset,insert(f){const d=array$5(f),p=d.length;for(let g=0;g<p;++g)e.push(d[g]);return this},remove(f){const d=isFunction(f)?r:n,p=array$5(f),g=p.length;for(let v=0;v<g;++v)d.push(p[v]);return this},modify(f,d,p){const g={field:d,value:constant$4(p)};return isFunction(f)?(g.filter=f,s.push(g)):(g.tuple=f,i.push(g)),this},encode(f,d){return isFunction(f)?s.push({filter:f,field:d}):i.push({tuple:f,field:d}),this},clean(f){return o=f,this},reflow(){return l=!0,this},pulse(f,d){const p={},g={};let v,S,T,k,O,R;for(v=0,S=d.length;v<S;++v)p[tupleid(d[v])]=1;for(v=0,S=n.length;v<S;++v)O=n[v],p[tupleid(O)]=-1;for(v=0,S=r.length;v<S;++v)k=r[v],d.forEach(F=>{k(F)&&(p[tupleid(F)]=-1)});for(v=0,S=e.length;v<S;++v)O=e[v],R=tupleid(O),p[R]?p[R]=1:f.add.push(ingest$1(e[v]));for(v=0,S=d.length;v<S;++v)O=d[v],p[tupleid(O)]<0&&f.rem.push(O);function P(F,I,L){L?F[I]=L(F):f.encode=I,l||(g[tupleid(F)]=F)}for(v=0,S=i.length;v<S;++v)T=i[v],O=T.tuple,k=T.field,R=p[tupleid(O)],R>0&&(P(O,k,T.value),f.modifies(k));for(v=0,S=s.length;v<S;++v)T=s[v],k=T.filter,d.forEach(F=>{k(F)&&p[tupleid(F)]>0&&P(F,T.field,T.value)}),f.modifies(T.field);if(l)f.mod=n.length||r.length?d.filter(F=>p[tupleid(F)]>0):d.slice();else for(R in g)f.mod.push(g[R]);return(o||o==null&&(n.length||r.length))&&f.clean(!0),f}}}const CACHE$1="_:mod:_";function Parameters(){Object.defineProperty(this,CACHE$1,{writable:!0,value:{}})}Parameters.prototype={set(e,n,i,r){const s=this,o=s[e],l=s[CACHE$1];return n!=null&&n>=0?(o[n]!==i||r)&&(o[n]=i,l[n+":"+e]=-1,l[e]=-1):(o!==i||r)&&(s[e]=i,l[e]=isArray(i)?1+i.length:-1),s},modified(e,n){const i=this[CACHE$1];if(arguments.length){if(isArray(e)){for(let r=0;r<e.length;++r)if(i[e[r]])return!0;return!1}}else{for(const r in i)if(i[r])return!0;return!1}return n!=null&&n>=0?n+1<i[e]||!!i[n+":"+e]:!!i[e]},clear(){return this[CACHE$1]={},this}};let OP_ID=0;const PULSE="pulse",NO_PARAMS=new Parameters,SKIP$1$1=1,MODIFIED=2;function Operator(e,n,i,r){this.id=++OP_ID,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,n&&(this._update=n),i&&this.parameters(i,r)}function flag(e){return function(n){const i=this.flags;return arguments.length===0?!!(i&e):(this.flags=n?i|e:i&~e,this)}}Operator.prototype={targets(){return this._targets||(this._targets=UniqueList(id))},set(e){return this.value!==e?(this.value=e,1):0},skip:flag(SKIP$1$1),modified:flag(MODIFIED),parameters(e,n,i){n=n!==!1;const r=this._argval=this._argval||new Parameters,s=this._argops=this._argops||[],o=[];let l,f,d,p;const g=(v,S,T)=>{T instanceof Operator?(T!==this&&(n&&T.targets().add(this),o.push(T)),s.push({op:T,name:v,index:S})):r.set(v,S,T)};for(l in e)if(f=e[l],l===PULSE)array$5(f).forEach(v=>{v instanceof Operator?v!==this&&(v.targets().add(this),o.push(v)):error("Pulse parameters must be operator instances.")}),this.source=f;else if(isArray(f))for(r.set(l,-1,Array(d=f.length)),p=0;p<d;++p)g(l,p,f[p]);else g(l,-1,f);return this.marshall().clear(),i&&(s.initonly=!0),o},marshall(e){const n=this._argval||NO_PARAMS,i=this._argops;let r,s,o,l;if(i){const f=i.length;for(s=0;s<f;++s)r=i[s],o=r.op,l=o.modified()&&o.stamp===e,n.set(r.name,r.index,o.value,l);if(i.initonly){for(s=0;s<f;++s)r=i[s],r.op.targets().remove(this);this._argops=null,this._update=null}}return n},detach(){const e=this._argops;let n,i,r,s;if(e)for(n=0,i=e.length;n<i;++n)r=e[n],s=r.op,s._targets&&s._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const n=this._update;if(n){const i=this.marshall(e.stamp),r=n.call(this,i,e);if(i.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let n;return this.skip()?(this.skip(!1),n=0):n=this.evaluate(e),this.pulse=n||e}};function add$4(e,n,i,r){let s=1,o;return e instanceof Operator?o=e:e&&e.prototype instanceof Operator?o=new e:isFunction(e)?o=new Operator(null,e):(s=0,o=new Operator(e,n)),this.rank(o),s&&(r=i,i=n),i&&this.connect(o,o.parameters(i,r)),this.touch(o),o}function connect(e,n){const i=e.rank,r=n.length;for(let s=0;s<r;++s)if(i<n[s].rank){this.rerank(e);return}}let STREAM_ID=0;function EventStream(e,n,i){this.id=++STREAM_ID,this.value=null,i&&(this.receive=i),e&&(this._filter=e),n&&(this._apply=n)}function stream(e,n,i){return new EventStream(e,n,i)}EventStream.prototype={_filter:truthy,_apply:identity$6,targets(){return this._targets||(this._targets=UniqueList(id))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const n=this.value=this._apply(e),i=this._targets,r=i?i.length:0;for(let s=0;s<r;++s)i[s].receive(n);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const n=stream(e);return this.targets().add(n),n},apply(e){const n=stream(null,e);return this.targets().add(n),n},merge(){const e=stream();this.targets().add(e);for(let n=0,i=arguments.length;n<i;++n)arguments[n].targets().add(e);return e},throttle(e){let n=-1;return this.filter(()=>{const i=Date.now();return i-n>e?(n=i,1):0})},debounce(e){const n=stream();return this.targets().add(stream(null,null,debounce(e,i=>{const r=i.dataflow;n.receive(i),r&&r.run&&r.run()}))),n},between(e,n){let i=!1;return e.targets().add(stream(null,null,()=>i=!0)),n.targets().add(stream(null,null,()=>i=!1)),this.filter(()=>i)},detach(){this._filter=truthy,this._targets=null}};function events$2(e,n,i,r){const s=this,o=stream(i,r),l=function(p){p.dataflow=s;try{o.receive(p)}catch(g){s.error(g)}finally{s.run()}};let f;typeof e=="string"&&typeof document<"u"?f=document.querySelectorAll(e):f=array$5(e);const d=f.length;for(let p=0;p<d;++p)f[p].addEventListener(n,l);return o}function parse$5(e,n){const i=this.locale();return read(e,n,i.timeParse,i.utcParse)}function ingest(e,n,i){return n=this.parse(n,i),this.pulse(e,this.changeset().insert(n))}async function request(e,n){const i=this;let r=0,s;try{s=await i.loader().load(e,{context:"dataflow",response:responseType(n&&n.type)});try{s=i.parse(s,n)}catch(o){r=-2,i.warn("Data ingestion failed",e,o)}}catch(o){r=-1,i.warn("Loading failed",e,o)}return{data:s,status:r}}async function preload(e,n,i){const r=this,s=r._pending||loadPending(r);s.requests+=1;const o=await r.request(n,i);return r.pulse(e,r.changeset().remove(truthy).insert(o.data||[])),s.done(),o}function loadPending(e){let n;const i=new Promise(r=>n=r);return i.requests=0,i.done=()=>{--i.requests===0&&(e._pending=null,n(e))},e._pending=i}const SKIP$2={skip:!0};function on(e,n,i,r,s){return(e instanceof Operator?onOperator:onStream)(this,e,n,i,r,s),this}function onStream(e,n,i,r,s,o){const l=extend$1({},o,SKIP$2);let f,d;isFunction(i)||(i=constant$4(i)),r===void 0?f=p=>e.touch(i(p)):isFunction(r)?(d=new Operator(null,r,s,!1),f=p=>{d.evaluate(p);const g=i(p),v=d.value;isChangeSet(v)?e.pulse(g,v,o):e.update(g,v,l)}):f=p=>e.update(i(p),r,l),n.apply(f)}function onOperator(e,n,i,r,s,o){if(r===void 0)n.targets().add(i);else{const l=o||{},f=new Operator(null,updater(i,r),s,!1);f.modified(l.force),f.rank=n.rank,n.targets().add(f),i&&(f.skip(!0),f.value=i.value,f.targets().add(i),e.connect(i,[f]))}}function updater(e,n){return n=isFunction(n)?n:constant$4(n),e?function(i,r){const s=n(i,r);return e.skip()||(e.skip(s!==this.value).value=s),s}:n}function rank(e){e.rank=++this._rank}function rerank(e){const n=[e];let i,r,s;for(;n.length;)if(this.rank(i=n.pop()),r=i._targets)for(s=r.length;--s>=0;)n.push(i=r[s]),i===e&&error("Cycle detected in dataflow graph.")}const StopPropagation={},ADD=1<<0,REM=1<<1,MOD$1=1<<2,ADD_REM=ADD|REM,ADD_MOD=ADD|MOD$1,ALL=ADD|REM|MOD$1,REFLOW=1<<3,SOURCE=1<<4,NO_SOURCE=1<<5,NO_FIELDS=1<<6;function Pulse(e,n,i){this.dataflow=e,this.stamp=n??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=i||null}function materialize(e,n){const i=[];return visitArray(e,n,r=>i.push(r)),i}function filter$1(e,n){const i={};return e.visit(n,r=>{i[tupleid(r)]=1}),r=>i[tupleid(r)]?null:r}function addFilter(e,n){return e?(i,r)=>e(i,r)&&n(i,r):n}Pulse.prototype={StopPropagation,ADD,REM,MOD:MOD$1,ADD_REM,ADD_MOD,ALL,REFLOW,SOURCE,NO_SOURCE,NO_FIELDS,fork(e){return new Pulse(this.dataflow).init(this,e)},clone(){const e=this.fork(ALL);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(ALL|SOURCE)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Pulse(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,n){const i=this;return i.stamp=e.stamp,i.encode=e.encode,e.fields&&!(n&NO_FIELDS)&&(i.fields=e.fields),n&ADD?(i.addF=e.addF,i.add=e.add):(i.addF=null,i.add=[]),n&REM?(i.remF=e.remF,i.rem=e.rem):(i.remF=null,i.rem=[]),n&MOD$1?(i.modF=e.modF,i.mod=e.mod):(i.modF=null,i.mod=[]),n&NO_SOURCE?(i.srcF=null,i.source=null):(i.srcF=e.srcF,i.source=e.source,e.cleans&&(i.cleans=e.cleans)),i},runAfter(e){this.dataflow.runAfter(e)},changed(e){const n=e||ALL;return n&ADD&&this.add.length||n&REM&&this.rem.length||n&MOD$1&&this.mod.length},reflow(e){if(e)return this.fork(ALL).reflow();const n=this.add.length,i=this.source&&this.source.length;return i&&i!==n&&(this.mod=this.source,n&&this.filter(MOD$1,filter$1(this,ADD))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const n=this.fields||(this.fields={});return isArray(e)?e.forEach(i=>n[i]=!0):n[e]=!0,this},modified(e,n){const i=this.fields;return(n||this.mod.length)&&i?arguments.length?isArray(e)?e.some(r=>i[r]):i[e]:!!i:!1},filter(e,n){const i=this;return e&ADD&&(i.addF=addFilter(i.addF,n)),e&REM&&(i.remF=addFilter(i.remF,n)),e&MOD$1&&(i.modF=addFilter(i.modF,n)),e&SOURCE&&(i.srcF=addFilter(i.srcF,n)),i},materialize(e){e=e||ALL;const n=this;return e&ADD&&n.addF&&(n.add=materialize(n.add,n.addF),n.addF=null),e&REM&&n.remF&&(n.rem=materialize(n.rem,n.remF),n.remF=null),e&MOD$1&&n.modF&&(n.mod=materialize(n.mod,n.modF),n.modF=null),e&SOURCE&&n.srcF&&(n.source=n.source.filter(n.srcF),n.srcF=null),n},visit(e,n){const i=this,r=n;if(e&SOURCE)return visitArray(i.source,i.srcF,r),i;e&ADD&&visitArray(i.add,i.addF,r),e&REM&&visitArray(i.rem,i.remF,r),e&MOD$1&&visitArray(i.mod,i.modF,r);const s=i.source;if(e&REFLOW&&s){const o=i.add.length+i.mod.length;o===s.length||(o?visitArray(s,filter$1(i,ADD_MOD),r):visitArray(s,i.srcF,r))}return i}};function MultiPulse(e,n,i,r){const s=this,o=i.length;let l=0;this.dataflow=e,this.stamp=n,this.fields=null,this.encode=r||null,this.pulses=i;for(let f=0;f<o;++f){const d=i[f];if(d.stamp===n){if(d.fields){const p=s.fields||(s.fields={});for(const g in d.fields)p[g]=1}d.changed(s.ADD)&&(l|=s.ADD),d.changed(s.REM)&&(l|=s.REM),d.changed(s.MOD)&&(l|=s.MOD)}}this.changes=l}inherits(MultiPulse,Pulse,{fork(e){const n=new Pulse(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&n.ADD&&this.visit(n.ADD,i=>n.add.push(i)),e&n.REM&&this.visit(n.REM,i=>n.rem.push(i)),e&n.MOD&&this.visit(n.MOD,i=>n.mod.push(i))),n},changed(e){return this.changes&e},modified(e){const n=this,i=n.fields;return i&&n.changes&n.MOD?isArray(e)?e.some(r=>i[r]):i[e]:0},filter(){error("MultiPulse does not support filtering.")},materialize(){error("MultiPulse does not support materialization.")},visit(e,n){const i=this,r=i.pulses,s=r.length;let o=0;if(e&i.SOURCE)for(;o<s;++o)r[o].visit(e,n);else for(;o<s;++o)r[o].stamp===i.stamp&&r[o].visit(e,n);return i}});async function evaluate(e,n,i){const r=this,s=[];if(r._pulse)return reentrant(r);if(r._pending&&await r._pending,n&&await asyncCallback(r,n),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Pulse(r,o,e),r._touched.forEach(g=>r._enqueue(g,!0)),r._touched=UniqueList(id);let l=0,f,d,p;try{for(;r._heap.size()>0;){if(f=r._heap.pop(),f.rank!==f.qrank){r._enqueue(f,!0);continue}d=f.run(r._getPulse(f,e)),d.then?d=await d:d.async&&(s.push(d.async),d=StopPropagation),d!==StopPropagation&&f._targets&&f._targets.forEach(g=>r._enqueue(g)),++l}}catch(g){r._heap.clear(),p=g}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${l} operators`),p&&(r._postrun=[],r.error(p)),r._postrun.length){const g=r._postrun.sort((v,S)=>S.priority-v.priority);r._postrun=[];for(let v=0;v<g.length;++v)await asyncCallback(r,g[v].callback)}return i&&await asyncCallback(r,i),s.length&&Promise.all(s).then(g=>r.runAsync(null,()=>{g.forEach(v=>{try{v(r)}catch(S){r.error(S)}})})),r}async function runAsync(e,n,i){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,n,i)).then(r,r),this._running}function run(e,n,i){return this._pulse?reentrant(this):(this.evaluate(e,n,i),this)}function runAfter(e,n,i){if(this._pulse||n)this._postrun.push({priority:i||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function reentrant(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function enqueue(e,n){const i=e.stamp<this._clock;i&&(e.stamp=this._clock),(i||n)&&(e.qrank=e.rank,this._heap.push(e))}function getPulse(e,n){const i=e.source,r=this._clock;return i&&isArray(i)?new MultiPulse(this,r,i.map(s=>s.pulse),n):this._input[e.id]||singlePulse(this._pulse,i&&i.pulse)}function singlePulse(e,n){return n&&n.stamp===e.stamp?n:(e=e.fork(),n&&n!==StopPropagation&&(e.source=n.source),e)}const NO_OPT={skip:!1,force:!1};function touch(e,n){const i=n||NO_OPT;return this._pulse?this._enqueue(e):this._touched.add(e),i.skip&&e.skip(!0),this}function update$6(e,n,i){const r=i||NO_OPT;return(e.set(n)||r.force)&&this.touch(e,r),this}function pulse(e,n,i){this.touch(e,i||NO_OPT);const r=new Pulse(this,this._clock+(this._pulse?0:1)),s=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=n.pulse(r,s),this}function Heap(e){let n=[];return{clear:()=>n=[],size:()=>n.length,peek:()=>n[0],push:i=>(n.push(i),siftdown(n,0,n.length-1,e)),pop:()=>{const i=n.pop();let r;return n.length?(r=n[0],n[0]=i,siftup(n,0,e)):r=i,r}}}function siftdown(e,n,i,r){let s,o;const l=e[i];for(;i>n;){if(o=i-1>>1,s=e[o],r(l,s)<0){e[i]=s,i=o;continue}break}return e[i]=l}function siftup(e,n,i){const r=n,s=e.length,o=e[n];let l=(n<<1)+1,f;for(;l<s;)f=l+1,f<s&&i(e[l],e[f])>=0&&(l=f),e[n]=e[l],n=l,l=(n<<1)+1;return e[n]=o,siftdown(e,r,n,i)}function Dataflow(){this.logger(logger()),this.logLevel(Error$1),this._clock=0,this._rank=0,this._locale=defaultLocale();try{this._loader=loader()}catch{}this._touched=UniqueList(id),this._input={},this._pulse=null,this._heap=Heap((e,n)=>e.qrank-n.qrank),this._postrun=[]}function logMethod(e){return function(){return this._log[e].apply(this,arguments)}}Dataflow.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:logMethod("error"),warn:logMethod("warn"),info:logMethod("info"),debug:logMethod("debug"),logLevel:logMethod("level"),cleanThreshold:1e4,add:add$4,connect,rank,rerank,pulse,touch,update:update$6,changeset,ingest,parse:parse$5,preload,request,events:events$2,on,evaluate,run,runAsync,runAfter,_enqueue:enqueue,_getPulse:getPulse};function Transform(e,n){Operator.call(this,e,null,n)}inherits(Transform,Operator,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let n;return this.skip()?this.skip(!1):n=this.evaluate(e),n=n||e,n.then?n=n.then(i=>this.pulse=i):n!==e.StopPropagation&&(this.pulse=n),n},evaluate(e){const n=this.marshall(e.stamp),i=this.transform(n,e);return n.clear(),i},transform(){}});const transforms={};function definition$1(e){const n=transform$2(e);return n&&n.Definition||null}function transform$2(e){return e=e&&e.toLowerCase(),has$1(transforms,e)?transforms[e]:null}function*numbers$1(e,n){if(n==null)for(let i of e)i!=null&&i!==""&&(i=+i)>=i&&(yield i);else{let i=-1;for(let r of e)r=n(r,++i,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function quantiles(e,n,i){const r=Float64Array.from(numbers$1(e,i));return r.sort(ascending$2),n.map(s=>quantileSorted(r,s))}function quartiles(e,n){return quantiles(e,[.25,.5,.75],n)}function estimateBandwidth(e,n){const i=e.length,r=deviation(e,n),s=quartiles(e,n),o=(s[2]-s[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(s[0])||1)*Math.pow(i,-.2)}function bin$1(e){const n=e.maxbins||20,i=e.base||10,r=Math.log(i),s=e.divide||[5,2];let o=e.extent[0],l=e.extent[1],f,d,p,g,v,S;const T=e.span||l-o||Math.abs(o)||1;if(e.step)f=e.step;else if(e.steps){for(g=T/n,v=0,S=e.steps.length;v<S&&e.steps[v]<g;++v);f=e.steps[Math.max(0,v-1)]}else{for(d=Math.ceil(Math.log(n)/r),p=e.minstep||0,f=Math.max(p,Math.pow(i,Math.round(Math.log(T)/r)-d));Math.ceil(T/f)>n;)f*=i;for(v=0,S=s.length;v<S;++v)g=f/s[v],g>=p&&T/g<=n&&(f=g)}g=Math.log(f);const k=g>=0?0:~~(-g/r)+1,O=Math.pow(i,-k-1);return(e.nice||e.nice===void 0)&&(g=Math.floor(o/f+O)*f,o=o<g?g-f:g,l=Math.ceil(l/f)*f),{start:o,stop:l===o?o+f:l,step:f}}var random=Math.random;function setRandom(e){random=e}function bootstrapCI(e,n,i,r){if(!e.length)return[void 0,void 0];const s=Float64Array.from(numbers$1(e,r)),o=s.length,l=n;let f,d,p,g;for(p=0,g=Array(l);p<l;++p){for(f=0,d=0;d<o;++d)f+=s[~~(random()*o)];g[p]=f/o}return g.sort(ascending$2),[quantile$1(g,i/2),quantile$1(g,1-i/2)]}function dotbin(e,n,i,r){r=r||(S=>S);const s=e.length,o=new Float64Array(s);let l=0,f=1,d=r(e[0]),p=d,g=d+n,v;for(;f<s;++f){if(v=r(e[f]),v>=g){for(p=(d+p)/2;l<f;++l)o[l]=p;g=v+n,d=v}p=v}for(p=(d+p)/2;l<f;++l)o[l]=p;return i?smoothing(o,n+n/4):o}function smoothing(e,n){const i=e.length;let r=0,s=1,o,l;for(;e[r]===e[s];)++s;for(;s<i;){for(o=s+1;e[s]===e[o];)++o;if(e[s]-e[s-1]<n){for(l=s+(r+o-s-s>>1);l<s;)e[l++]=e[s];for(;l>s;)e[l--]=e[r]}r=s,s=o}return e}function lcg$2(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function integer(e,n){n==null&&(n=e,e=0);let i,r,s;const o={min(l){return arguments.length?(i=l||0,s=r-i,o):i},max(l){return arguments.length?(r=l||0,s=r-i,o):r},sample(){return i+Math.floor(s*random())},pdf(l){return l===Math.floor(l)&&l>=i&&l<r?1/s:0},cdf(l){const f=Math.floor(l);return f<i?0:f>=r?1:(f-i+1)/s},icdf(l){return l>=0&&l<=1?i-1+Math.floor(l*s):NaN}};return o.min(e).max(n)}const SQRT2PI=Math.sqrt(2*Math.PI),SQRT2=Math.SQRT2;let nextSample=NaN;function sampleNormal(e,n){e=e||0,n=n??1;let i=0,r=0,s,o;if(nextSample===nextSample)i=nextSample,nextSample=NaN;else{do i=random()*2-1,r=random()*2-1,s=i*i+r*r;while(s===0||s>1);o=Math.sqrt(-2*Math.log(s)/s),i*=o,nextSample=r*o}return e+i*n}function densityNormal(e,n,i){i=i??1;const r=(e-(n||0))/i;return Math.exp(-.5*r*r)/(i*SQRT2PI)}function cumulativeNormal(e,n,i){n=n||0,i=i??1;const r=(e-n)/i,s=Math.abs(r);let o;if(s>37)o=0;else{const l=Math.exp(-s*s/2);let f;s<7.07106781186547?(f=.0352624965998911*s+.700383064443688,f=f*s+6.37396220353165,f=f*s+33.912866078383,f=f*s+112.079291497871,f=f*s+221.213596169931,f=f*s+220.206867912376,o=l*f,f=.0883883476483184*s+1.75566716318264,f=f*s+16.064177579207,f=f*s+86.7807322029461,f=f*s+296.564248779674,f=f*s+637.333633378831,f=f*s+793.826512519948,f=f*s+440.413735824752,o=o/f):(f=s+.65,f=s+4/f,f=s+3/f,f=s+2/f,f=s+1/f,o=l/f/2.506628274631)}return r>0?1-o:o}function quantileNormal(e,n,i){return e<0||e>1?NaN:(n||0)+(i??1)*SQRT2*erfinv(2*e-1)}function erfinv(e){let n=-Math.log((1-e)*(1+e)),i;return n<6.25?(n-=3.125,i=-364441206401782e-35,i=-16850591381820166e-35+i*n,i=128584807152564e-32+i*n,i=11157877678025181e-33+i*n,i=-1333171662854621e-31+i*n,i=20972767875968562e-33+i*n,i=6637638134358324e-30+i*n,i=-4054566272975207e-29+i*n,i=-8151934197605472e-29+i*n,i=26335093153082323e-28+i*n,i=-12975133253453532e-27+i*n,i=-5415412054294628e-26+i*n,i=10512122733215323e-25+i*n,i=-4112633980346984e-24+i*n,i=-29070369957882005e-24+i*n,i=42347877827932404e-23+i*n,i=-13654692000834679e-22+i*n,i=-13882523362786469e-21+i*n,i=.00018673420803405714+i*n,i=-.000740702534166267+i*n,i=-.006033670871430149+i*n,i=.24015818242558962+i*n,i=1.6536545626831027+i*n):n<16?(n=Math.sqrt(n)-3.25,i=22137376921775787e-25,i=9075656193888539e-23+i*n,i=-27517406297064545e-23+i*n,i=18239629214389228e-24+i*n,i=15027403968909828e-22+i*n,i=-4013867526981546e-21+i*n,i=29234449089955446e-22+i*n,i=12475304481671779e-21+i*n,i=-47318229009055734e-21+i*n,i=6828485145957318e-20+i*n,i=24031110387097894e-21+i*n,i=-.0003550375203628475+i*n,i=.0009532893797373805+i*n,i=-.0016882755560235047+i*n,i=.002491442096107851+i*n,i=-.003751208507569241+i*n,i=.005370914553590064+i*n,i=1.0052589676941592+i*n,i=3.0838856104922208+i*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,i=-27109920616438573e-27,i=-2555641816996525e-25+i*n,i=15076572693500548e-25+i*n,i=-3789465440126737e-24+i*n,i=761570120807834e-23+i*n,i=-1496002662714924e-23+i*n,i=2914795345090108e-23+i*n,i=-6771199775845234e-23+i*n,i=22900482228026655e-23+i*n,i=-99298272942317e-20+i*n,i=4526062597223154e-21+i*n,i=-1968177810553167e-20+i*n,i=7599527703001776e-20+i*n,i=-.00021503011930044477+i*n,i=-.00013871931833623122+i*n,i=1.0103004648645344+i*n,i=4.849906401408584+i*n):i=1/0,i*e}function gaussian(e,n){let i,r;const s={mean(o){return arguments.length?(i=o||0,s):i},stdev(o){return arguments.length?(r=o??1,s):r},sample:()=>sampleNormal(i,r),pdf:o=>densityNormal(o,i,r),cdf:o=>cumulativeNormal(o,i,r),icdf:o=>quantileNormal(o,i,r)};return s.mean(e).stdev(n)}function kde(e,n){const i=gaussian();let r=0;const s={data(o){return arguments.length?(e=o,r=o?o.length:0,s.bandwidth(n)):e},bandwidth(o){return arguments.length?(n=o,!n&&e&&(n=estimateBandwidth(e)),s):n},sample(){return e[~~(random()*r)]+n*i.sample()},pdf(o){let l=0,f=0;for(;f<r;++f)l+=i.pdf((o-e[f])/n);return l/n/r},cdf(o){let l=0,f=0;for(;f<r;++f)l+=i.cdf((o-e[f])/n);return l/r},icdf(){throw Error("KDE icdf not supported.")}};return s.data(e)}function sampleLogNormal(e,n){return e=e||0,n=n??1,Math.exp(e+sampleNormal()*n)}function densityLogNormal(e,n,i){if(e<=0)return 0;n=n||0,i=i??1;const r=(Math.log(e)-n)/i;return Math.exp(-.5*r*r)/(i*SQRT2PI*e)}function cumulativeLogNormal(e,n,i){return cumulativeNormal(Math.log(e),n,i)}function quantileLogNormal(e,n,i){return Math.exp(quantileNormal(e,n,i))}function lognormal(e,n){let i,r;const s={mean(o){return arguments.length?(i=o||0,s):i},stdev(o){return arguments.length?(r=o??1,s):r},sample:()=>sampleLogNormal(i,r),pdf:o=>densityLogNormal(o,i,r),cdf:o=>cumulativeLogNormal(o,i,r),icdf:o=>quantileLogNormal(o,i,r)};return s.mean(e).stdev(n)}function mixture$1(e,n){let i=0,r;function s(l){const f=[];let d=0,p;for(p=0;p<i;++p)d+=f[p]=l[p]==null?1:+l[p];for(p=0;p<i;++p)f[p]/=d;return f}const o={weights(l){return arguments.length?(r=s(n=l||[]),o):n},distributions(l){return arguments.length?(l?(i=l.length,e=l):(i=0,e=[]),o.weights(n)):e},sample(){const l=random();let f=e[i-1],d=r[0],p=0;for(;p<i-1;d+=r[++p])if(l<d){f=e[p];break}return f.sample()},pdf(l){let f=0,d=0;for(;d<i;++d)f+=r[d]*e[d].pdf(l);return f},cdf(l){let f=0,d=0;for(;d<i;++d)f+=r[d]*e[d].cdf(l);return f},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(n)}function sampleUniform(e,n){return n==null&&(n=e??1,e=0),e+(n-e)*random()}function densityUniform(e,n,i){return i==null&&(i=n??1,n=0),e>=n&&e<=i?1/(i-n):0}function cumulativeUniform(e,n,i){return i==null&&(i=n??1,n=0),e<n?0:e>i?1:(e-n)/(i-n)}function quantileUniform(e,n,i){return i==null&&(i=n??1,n=0),e>=0&&e<=1?n+e*(i-n):NaN}function uniform(e,n){let i,r;const s={min(o){return arguments.length?(i=o||0,s):i},max(o){return arguments.length?(r=o??1,s):r},sample:()=>sampleUniform(i,r),pdf:o=>densityUniform(o,i,r),cdf:o=>cumulativeUniform(o,i,r),icdf:o=>quantileUniform(o,i,r)};return n==null&&(n=e??1,e=0),s.min(e).max(n)}function ols(e,n,i,r){const s=r-e*e,o=Math.abs(s)<1e-24?0:(i-e*n)/s;return[n-o*e,o]}function points(e,n,i,r){e=e.filter(T=>{let k=n(T),O=i(T);return k!=null&&(k=+k)>=k&&O!=null&&(O=+O)>=O}),r&&e.sort((T,k)=>n(T)-n(k));const s=e.length,o=new Float64Array(s),l=new Float64Array(s);let f=0,d=0,p=0,g,v,S;for(S of e)o[f]=g=+n(S),l[f]=v=+i(S),++f,d+=(g-d)/f,p+=(v-p)/f;for(f=0;f<s;++f)o[f]-=d,l[f]-=p;return[o,l,d,p]}function visitPoints(e,n,i,r){let s=-1,o,l;for(const f of e)o=n(f),l=i(f),o!=null&&(o=+o)>=o&&l!=null&&(l=+l)>=l&&r(o,l,++s)}function rSquared(e,n,i,r,s){let o=0,l=0;return visitPoints(e,n,i,(f,d)=>{const p=d-s(f),g=d-r;o+=p*p,l+=g*g}),1-o/l}function linear$2(e,n,i){let r=0,s=0,o=0,l=0,f=0;visitPoints(e,n,i,(g,v)=>{++f,r+=(g-r)/f,s+=(v-s)/f,o+=(g*v-o)/f,l+=(g*g-l)/f});const d=ols(r,s,o,l),p=g=>d[0]+d[1]*g;return{coef:d,predict:p,rSquared:rSquared(e,n,i,s,p)}}function log$3(e,n,i){let r=0,s=0,o=0,l=0,f=0;visitPoints(e,n,i,(g,v)=>{++f,g=Math.log(g),r+=(g-r)/f,s+=(v-s)/f,o+=(g*v-o)/f,l+=(g*g-l)/f});const d=ols(r,s,o,l),p=g=>d[0]+d[1]*Math.log(g);return{coef:d,predict:p,rSquared:rSquared(e,n,i,s,p)}}function exp$1(e,n,i){const[r,s,o,l]=points(e,n,i);let f=0,d=0,p=0,g=0,v=0,S,T,k;visitPoints(e,n,i,(F,I)=>{S=r[v++],T=Math.log(I),k=S*I,f+=(I*T-f)/v,d+=(k-d)/v,p+=(k*T-p)/v,g+=(S*k-g)/v});const[O,R]=ols(d/l,f/l,p/l,g/l),P=F=>Math.exp(O+R*(F-o));return{coef:[Math.exp(O-R*o),R],predict:P,rSquared:rSquared(e,n,i,l,P)}}function pow$3(e,n,i){let r=0,s=0,o=0,l=0,f=0,d=0;visitPoints(e,n,i,(v,S)=>{const T=Math.log(v),k=Math.log(S);++d,r+=(T-r)/d,s+=(k-s)/d,o+=(T*k-o)/d,l+=(T*T-l)/d,f+=(S-f)/d});const p=ols(r,s,o,l),g=v=>p[0]*Math.pow(v,p[1]);return p[0]=Math.exp(p[0]),{coef:p,predict:g,rSquared:rSquared(e,n,i,f,g)}}function quad(e,n,i){const[r,s,o,l]=points(e,n,i),f=r.length;let d=0,p=0,g=0,v=0,S=0,T,k,O,R;for(T=0;T<f;)k=r[T],O=s[T++],R=k*k,d+=(R-d)/T,p+=(R*k-p)/T,g+=(R*R-g)/T,v+=(k*O-v)/T,S+=(R*O-S)/T;const P=g-d*d,F=d*P-p*p,I=(S*d-v*p)/F,L=(v*P-S*p)/F,N=-I*d,j=z=>(z=z-o,I*z*z+L*z+N+l);return{coef:[N-L*o+I*o*o+l,L-2*I*o,I],predict:j,rSquared:rSquared(e,n,i,l,j)}}function poly(e,n,i,r){if(r===1)return linear$2(e,n,i);if(r===2)return quad(e,n,i);const[s,o,l,f]=points(e,n,i),d=s.length,p=[],g=[],v=r+1;let S,T,k,O,R;for(S=0;S<v;++S){for(k=0,O=0;k<d;++k)O+=Math.pow(s[k],S)*o[k];for(p.push(O),R=new Float64Array(v),T=0;T<v;++T){for(k=0,O=0;k<d;++k)O+=Math.pow(s[k],S+T);R[T]=O}g.push(R)}g.push(p);const P=gaussianElimination(g),F=I=>{I-=l;let L=f+P[0]+P[1]*I+P[2]*I*I;for(S=3;S<v;++S)L+=P[S]*Math.pow(I,S);return L};return{coef:uncenter(v,P,-l,f),predict:F,rSquared:rSquared(e,n,i,f,F)}}function uncenter(e,n,i,r){const s=Array(e);let o,l,f,d;for(o=0;o<e;++o)s[o]=0;for(o=e-1;o>=0;--o)for(f=n[o],d=1,s[o]+=f,l=1;l<=o;++l)d*=(o+1-l)/l,s[o-l]+=f*Math.pow(i,l)*d;return s[0]+=r,s}function gaussianElimination(e){const n=e.length-1,i=[];let r,s,o,l,f;for(r=0;r<n;++r){for(l=r,s=r+1;s<n;++s)Math.abs(e[r][s])>Math.abs(e[r][l])&&(l=s);for(o=r;o<n+1;++o)f=e[o][r],e[o][r]=e[o][l],e[o][l]=f;for(s=r+1;s<n;++s)for(o=n;o>=r;o--)e[o][s]-=e[o][r]*e[r][s]/e[r][r]}for(s=n-1;s>=0;--s){for(f=0,o=s+1;o<n;++o)f+=e[o][s]*i[o];i[s]=(e[n][s]-f)/e[s][s]}return i}const maxiters=2,epsilon$6=1e-12;function loess(e,n,i,r){const[s,o,l,f]=points(e,n,i,!0),d=s.length,p=Math.max(2,~~(r*d)),g=new Float64Array(d),v=new Float64Array(d),S=new Float64Array(d).fill(1);for(let T=-1;++T<=maxiters;){const k=[0,p-1];for(let R=0;R<d;++R){const P=s[R],F=k[0],I=k[1],L=P-s[F]>s[I]-P?F:I;let N=0,j=0,z=0,q=0,H=0;const W=1/Math.abs(s[L]-P||1);for(let J=F;J<=I;++J){const ne=s[J],G=o[J],Z=tricube(Math.abs(P-ne)*W)*S[J],ae=ne*Z;N+=Z,j+=ae,z+=G*Z,q+=G*ae,H+=ne*ae}const[U,Q]=ols(j/N,z/N,q/N,H/N);g[R]=U+Q*P,v[R]=Math.abs(o[R]-g[R]),updateInterval(s,R+1,k)}if(T===maxiters)break;const O=median(v);if(Math.abs(O)<epsilon$6)break;for(let R=0,P,F;R<d;++R)P=v[R]/(6*O),S[R]=P>=1?epsilon$6:(F=1-P*P)*F}return output$1(s,g,l,f)}function tricube(e){return(e=1-e*e*e)*e*e}function updateInterval(e,n,i){const r=e[n];let s=i[0],o=i[1]+1;if(!(o>=e.length))for(;n>s&&e[o]-r<=r-e[s];)i[0]=++s,i[1]=o,++o}function output$1(e,n,i,r){const s=e.length,o=[];let l=0,f=0,d=[],p;for(;l<s;++l)p=e[l]+i,d[0]===p?d[1]+=(n[l]-d[1])/++f:(f=0,d[1]+=r,d=[p,n[l]],o.push(d));return d[1]+=r,o}const MIN_RADIANS=.5*Math.PI/180;function sampleCurve(e,n,i,r){i=i||25,r=Math.max(i,r||200);const s=O=>[O,e(O)],o=n[0],l=n[1],f=l-o,d=f/r,p=[s(o)],g=[];if(i===r){for(let O=1;O<r;++O)p.push(s(o+O/i*f));return p.push(s(l)),p}else{g.push(s(l));for(let O=i;--O>0;)g.push(s(o+O/i*f))}let v=p[0],S=g[g.length-1];const T=1/f,k=scaleY(v[1],g);for(;S;){const O=s((v[0]+S[0])/2);O[0]-v[0]>=d&&angleDelta(v,O,S,T,k)>MIN_RADIANS?g.push(O):(v=S,p.push(S),g.pop()),S=g[g.length-1]}return p}function scaleY(e,n){let i=e,r=e;const s=n.length;for(let o=0;o<s;++o){const l=n[o][1];l<i&&(i=l),l>r&&(r=l)}return 1/(r-i)}function angleDelta(e,n,i,r,s){const o=Math.atan2(s*(i[1]-e[1]),r*(i[0]-e[0])),l=Math.atan2(s*(n[1]-e[1]),r*(n[0]-e[0]));return Math.abs(o-l)}function multikey(e){return n=>{const i=e.length;let r=1,s=String(e[0](n));for(;r<i;++r)s+="|"+e[r](n);return s}}function groupkey(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:multikey(e)}function measureName(e,n,i){return i||e+(n?"_"+n:"")}const noop$4=()=>{},base_op={init:noop$4,add:noop$4,rem:noop$4,idx:0},AggregateOps={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,n)=>e.sum+=+n,rem:(e,n)=>e.sum-=n},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,n)=>e.product*=n,rem:(e,n)=>e.product/=n},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,n)=>(e.mean_d=n-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,n)=>(e.mean_d=n-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,n)=>e.dev+=e.mean_d*(n-e.mean),rem:(e,n)=>e.dev-=e.mean_d*(n-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,n)=>{(n<e.min||e.min===void 0)&&(e.min=n)},rem:(e,n)=>{n<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,n)=>{(n>e.max||e.max===void 0)&&(e.max=n)},rem:(e,n)=>{n>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,n,i)=>{n<e.min&&(e.argmin=i)},rem:(e,n)=>{n<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,n,i)=>{n>e.max&&(e.argmax=i)},rem:(e,n)=>{n>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},ValidAggregateOps=Object.keys(AggregateOps);function measure(e,n){return i=>extend$1({name:e,out:i||e},base_op,n)}ValidAggregateOps.forEach(e=>{AggregateOps[e]=measure(e,AggregateOps[e])});function createMeasure(e,n){return AggregateOps[e](n)}function compareIndex(e,n){return e.idx-n.idx}function resolve(e){const n={};e.forEach(r=>n[r.name]=r);const i=r=>{r.req&&r.req.forEach(s=>{n[s]||i(n[s]=AggregateOps[s]())})};return e.forEach(i),Object.values(n).sort(compareIndex)}function init(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function add$3(e,n){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(i=>i.add(this,e,n)))}function rem(e,n){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(i=>i.rem(this,e,n)))}function set$5(e){return this._out.forEach(n=>e[n.out]=n.value(this)),e}function compileMeasures(e,n){const i=n||identity$6,r=resolve(e),s=e.slice().sort(compareIndex);function o(l){this._ops=r,this._out=s,this.cell=l,this.init()}return o.prototype.init=init,o.prototype.add=add$3,o.prototype.rem=rem,o.prototype.set=set$5,o.prototype.get=i,o.fields=e.map(l=>l.out),o}function TupleStore(e){this._key=e?field$1(e):tupleid,this.reset()}const prototype$1=TupleStore.prototype;prototype$1.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};prototype$1.add=function(e){this._add.push(e)};prototype$1.rem=function(e){this._rem.push(e)};prototype$1.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,n=this._rem,i=this._key,r=e.length,s=n.length,o=Array(r-s),l={};let f,d,p;for(f=0;f<s;++f)l[i(n[f])]=1;for(f=0,d=0;f<r;++f)l[i(p=e[f])]?l[i(p)]=0:o[d++]=p;return this._rem=[],this._add=o};prototype$1.distinct=function(e){const n=this.values(),i={};let r=n.length,s=0,o;for(;--r>=0;)o=e(n[r])+"",has$1(i,o)||(i[o]=1,++s);return s};prototype$1.extent=function(e){if(this._get!==e||!this._ext){const n=this.values(),i=extentIndex(n,e);this._ext=[n[i[0]],n[i[1]]],this._get=e}return this._ext};prototype$1.argmin=function(e){return this.extent(e)[0]||{}};prototype$1.argmax=function(e){return this.extent(e)[1]||{}};prototype$1.min=function(e){const n=this.extent(e)[0];return n!=null?e(n):void 0};prototype$1.max=function(e){const n=this.extent(e)[1];return n!=null?e(n):void 0};prototype$1.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=quartiles(this.values(),e),this._get=e),this._q};prototype$1.q1=function(e){return this.quartile(e)[0]};prototype$1.q2=function(e){return this.quartile(e)[1]};prototype$1.q3=function(e){return this.quartile(e)[2]};prototype$1.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=bootstrapCI(this.values(),1e3,.05,e),this._get=e),this._ci};prototype$1.ci0=function(e){return this.ci(e)[0]};prototype$1.ci1=function(e){return this.ci(e)[1]};function Aggregate$1(e){Transform.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Aggregate$1.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ValidAggregateOps},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};inherits(Aggregate$1,Transform,{transform(e,n){const i=this,r=n.fork(n.NO_SOURCE|n.NO_FIELDS),s=e.modified();return i.stamp=r.stamp,i.value&&(s||n.modified(i._inputs,!0))?(i._prev=i.value,i.value=s?i.init(e):{},n.visit(n.SOURCE,o=>i.add(o))):(i.value=i.value||i.init(e),n.visit(n.REM,o=>i.rem(o)),n.visit(n.ADD,o=>i.add(o))),r.modifies(i._outputs),i._drop=e.drop!==!1,e.cross&&i._dims.length>1&&(i._drop=!1,i.cross()),n.clean()&&i._drop&&r.clean(!0).runAfter(()=>this.clean()),i.changes(r)},cross(){const e=this,n=e.value,i=e._dnames,r=i.map(()=>({})),s=i.length;function o(f){let d,p,g,v;for(d in f)for(g=f[d].tuple,p=0;p<s;++p)r[p][v=g[i[p]]]=v}o(e._prev),o(n);function l(f,d,p){const g=i[p],v=r[p++];for(const S in v){const T=f?f+"|"+S:S;d[g]=v[S],p<s?l(T,d,p):n[T]||e.cell(T,d)}}l("",{},0)},init(e){const n=this._inputs=[],i=this._outputs=[],r={};function s(R){const P=array$5(accessorFields(R)),F=P.length;let I=0,L;for(;I<F;++I)r[L=P[I]]||(r[L]=1,n.push(L))}this._dims=array$5(e.groupby),this._dnames=this._dims.map(R=>{const P=accessorName(R);return s(R),i.push(P),P}),this.cellkey=e.key?e.key:groupkey(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],l=e.ops||["count"],f=e.as||[],d=o.length,p={};let g,v,S,T,k,O;for(d!==l.length&&error("Unmatched number of fields and aggregate ops."),O=0;O<d;++O){if(g=o[O],v=l[O],g==null&&v!=="count"&&error("Null aggregate field specified."),T=accessorName(g),k=measureName(v,T,f[O]),i.push(k),v==="count"){this._counts.push(k);continue}S=p[T],S||(s(g),S=p[T]=[],S.field=g,this._measures.push(S)),v!=="count"&&(this._countOnly=!1),S.push(createMeasure(v,k))}return this._measures=this._measures.map(R=>compileMeasures(R,R.field)),{}},cellkey:groupkey(),cell(e,n){let i=this.value[e];return i?i.num===0&&this._drop&&i.stamp<this.stamp?(i.stamp=this.stamp,this._adds[this._alen++]=i):i.stamp<this.stamp&&(i.stamp=this.stamp,this._mods[this._mlen++]=i):(i=this.value[e]=this.newcell(e,n),this._adds[this._alen++]=i),i},newcell(e,n){const i={key:e,num:0,agg:null,tuple:this.newtuple(n,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,s=r.length;i.agg=Array(s);for(let o=0;o<s;++o)i.agg[o]=new r[o](i)}return i.store&&(i.data=new TupleStore),i},newtuple(e,n){const i=this._dnames,r=this._dims,s=r.length,o={};for(let l=0;l<s;++l)o[i[l]]=r[l](e);return n?replace$1(n.tuple,o):ingest$1(o)},clean(){const e=this.value;for(const n in e)e[n].num===0&&delete e[n]},add(e){const n=this.cellkey(e),i=this.cell(n,e);if(i.num+=1,this._countOnly)return;i.store&&i.data.add(e);const r=i.agg;for(let s=0,o=r.length;s<o;++s)r[s].add(r[s].get(e),e)},rem(e){const n=this.cellkey(e),i=this.cell(n,e);if(i.num-=1,this._countOnly)return;i.store&&i.data.rem(e);const r=i.agg;for(let s=0,o=r.length;s<o;++s)r[s].rem(r[s].get(e),e)},celltuple(e){const n=e.tuple,i=this._counts;e.store&&e.data.values();for(let r=0,s=i.length;r<s;++r)n[i[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let s=0,o=r.length;s<o;++s)r[s].set(n)}return n},changes(e){const n=this._adds,i=this._mods,r=this._prev,s=this._drop,o=e.add,l=e.rem,f=e.mod;let d,p,g,v;if(r)for(p in r)d=r[p],(!s||d.num)&&l.push(d.tuple);for(g=0,v=this._alen;g<v;++g)o.push(this.celltuple(n[g])),n[g]=null;for(g=0,v=this._mlen;g<v;++g)d=i[g],(d.num===0&&s?l:f).push(this.celltuple(d)),i[g]=null;return this._alen=this._mlen=0,this._prev=null,e}});const EPSILON$1=1e-14;function Bin(e){Transform.call(this,null,e)}Bin.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};inherits(Bin,Transform,{transform(e,n){const i=e.interval!==!1,r=this._bins(e),s=r.start,o=r.step,l=e.as||["bin0","bin1"],f=l[0],d=l[1];let p;return e.modified()?(n=n.reflow(!0),p=n.SOURCE):p=n.modified(accessorFields(e.field))?n.ADD_MOD:n.ADD,n.visit(p,i?g=>{const v=r(g);g[f]=v,g[d]=v==null?null:s+o*(1+(v-s)/o)}:g=>g[f]=r(g)),n.modifies(i?l:f)},_bins(e){if(this.value&&!e.modified())return this.value;const n=e.field,i=bin$1(e),r=i.step;let s=i.start,o=s+Math.ceil((i.stop-s)/r)*r,l,f;(l=e.anchor)!=null&&(f=l-(s+r*Math.floor((l-s)/r)),s+=f,o+=f);const d=function(p){let g=toNumber(n(p));return g==null?null:g<s?-1/0:g>o?1/0:(g=Math.max(s,Math.min(g,o-r)),s+r*Math.floor(EPSILON$1+(g-s)/r))};return d.start=s,d.stop=i.stop,d.step=r,this.value=accessor(d,accessorFields(n),e.name||"bin_"+accessorName(n))}});function SortedList(e,n,i){const r=e;let s=n||[],o=i||[],l={},f=0;return{add:d=>o.push(d),remove:d=>l[r(d)]=++f,size:()=>s.length,data:(d,p)=>(f&&(s=s.filter(g=>!l[r(g)]),l={},f=0),p&&d&&s.sort(d),o.length&&(s=d?merge$3(d,s,o.sort(d)):s.concat(o),o=[]),s)}}function Collect$1(e){Transform.call(this,[],e)}Collect$1.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};inherits(Collect$1,Transform,{transform(e,n){const i=n.fork(n.ALL),r=SortedList(tupleid,this.value,i.materialize(i.ADD).add),s=e.sort,o=n.changed()||s&&(e.modified("sort")||n.modified(s.fields));return i.visit(i.REM,r.remove),this.modified(o),this.value=i.source=r.data(stableCompare(s),o),n.source&&n.source.root&&(this.value.root=n.source.root),i}});function Compare$1(e){Operator.call(this,null,update$5,e)}inherits(Compare$1,Operator);function update$5(e){return this.value&&!e.modified()?this.value:compare$8(e.fields,e.orders)}function CountPattern(e){Transform.call(this,null,e)}CountPattern.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function tokenize(e,n,i){switch(n){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(i)}inherits(CountPattern,Transform,{transform(e,n){const i=v=>S=>{for(var T=tokenize(f(S),e.case,o)||[],k,O=0,R=T.length;O<R;++O)l.test(k=T[O])||v(k)},r=this._parameterCheck(e,n),s=this._counts,o=this._match,l=this._stop,f=e.field,d=e.as||["text","count"],p=i(v=>s[v]=1+(s[v]||0)),g=i(v=>s[v]-=1);return r?n.visit(n.SOURCE,p):(n.visit(n.ADD,p),n.visit(n.REM,g)),this._finish(n,d)},_parameterCheck(e,n){let i=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),i=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),i=!0),(e.modified("field")||n.modified(e.field.fields))&&(i=!0),i&&(this._counts={}),i},_finish(e,n){const i=this._counts,r=this._tuples||(this._tuples={}),s=n[0],o=n[1],l=e.fork(e.NO_SOURCE|e.NO_FIELDS);let f,d,p;for(f in i)d=r[f],p=i[f]||0,!d&&p?(r[f]=d=ingest$1({}),d[s]=f,d[o]=p,l.add.push(d)):p===0?(d&&l.rem.push(d),i[f]=null,r[f]=null):d[o]!==p&&(d[o]=p,l.mod.push(d));return l.modifies(n)}});function Cross(e){Transform.call(this,null,e)}Cross.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};inherits(Cross,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE),r=e.as||["a","b"],s=r[0],o=r[1],l=!this.value||n.changed(n.ADD_REM)||e.modified("as")||e.modified("filter");let f=this.value;return l?(f&&(i.rem=f),f=n.materialize(n.SOURCE).source,i.add=this.value=cross(f,s,o,e.filter||truthy)):i.mod=f,i.source=this.value,i.modifies(r)}});function cross(e,n,i,r){for(var s=[],o={},l=e.length,f=0,d,p;f<l;++f)for(o[n]=p=e[f],d=0;d<l;++d)o[i]=e[d],r(o)&&(s.push(ingest$1(o)),o={},o[n]=p);return s}const Distributions={kde,mixture:mixture$1,normal:gaussian,lognormal,uniform},DISTRIBUTIONS="distributions",FUNCTION="function",FIELD="field";function parse$4(e,n){const i=e[FUNCTION];has$1(Distributions,i)||error("Unknown distribution function: "+i);const r=Distributions[i]();for(const s in e)s===FIELD?r.data((e.from||n()).map(e[s])):s===DISTRIBUTIONS?r[s](e[s].map(o=>parse$4(o,n))):typeof r[s]===FUNCTION&&r[s](e[s]);return r}function Density(e){Transform.call(this,null,e)}const distributions=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],mixture={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:distributions},{name:"weights",type:"number",array:!0}]};Density.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:distributions.concat(mixture)},{name:"as",type:"string",array:!0,default:["value","density"]}]};inherits(Density,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE|n.NO_FIELDS);if(!this.value||n.changed()||e.modified()){const r=parse$4(e.distribution,source$1(n)),s=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let l=e.method||"pdf";l!=="pdf"&&l!=="cdf"&&error("Invalid density method: "+l),!e.extent&&!r.data&&error("Missing density extent parameter."),l=r[l];const f=e.as||["value","density"],d=e.extent||extent(r.data()),p=sampleCurve(l,d,s,o).map(g=>{const v={};return v[f[0]]=g[0],v[f[1]]=g[1],ingest$1(v)});this.value&&(i.rem=this.value),this.value=i.add=i.source=p}return i}});function source$1(e){return()=>e.materialize(e.SOURCE).source}function fieldNames(e,n){return e?e.map((i,r)=>n[r]||accessorName(i)):null}function partition$1$1(e,n,i){const r=[],s=v=>v(d);let o,l,f,d,p,g;if(n==null)r.push(e.map(i));else for(o={},l=0,f=e.length;l<f;++l)d=e[l],p=n.map(s),g=o[p],g||(o[p]=g=[],g.dims=p,r.push(g)),g.push(i(d));return r}const Output$5="bin";function DotBin(e){Transform.call(this,null,e)}DotBin.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Output$5}]};const autostep=(e,n)=>span(extent(e,n))/30;inherits(DotBin,Transform,{transform(e,n){if(this.value&&!(e.modified()||n.changed()))return n;const i=n.materialize(n.SOURCE).source,r=partition$1$1(n.source,e.groupby,identity$6),s=e.smooth||!1,o=e.field,l=e.step||autostep(i,o),f=stableCompare((k,O)=>o(k)-o(O)),d=e.as||Output$5,p=r.length;let g=1/0,v=-1/0,S=0,T;for(;S<p;++S){const k=r[S].sort(f);T=-1;for(const O of dotbin(k,l,s,o))O<g&&(g=O),O>v&&(v=O),k[++T][d]=O}return this.value={start:g,stop:v,step:l},n.reflow(!0).modifies(d)}});function Expression$1(e){Operator.call(this,null,update$4,e),this.modified(!0)}inherits(Expression$1,Operator);function update$4(e){const n=e.expr;return this.value&&!e.modified("expr")?this.value:accessor(i=>n(i,e),accessorFields(n),accessorName(n))}function Extent(e){Transform.call(this,[void 0,void 0],e)}Extent.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};inherits(Extent,Transform,{transform(e,n){const i=this.value,r=e.field,s=n.changed()||n.modified(r.fields)||e.modified("field");let o=i[0],l=i[1];if((s||o==null)&&(o=1/0,l=-1/0),n.visit(s?n.SOURCE:n.ADD,f=>{const d=toNumber(r(f));d!=null&&(d<o&&(o=d),d>l&&(l=d))}),!Number.isFinite(o)||!Number.isFinite(l)){let f=accessorName(r);f&&(f=' for field "'.concat(f,'"')),n.dataflow.warn("Infinite extent".concat(f,": [").concat(o,", ").concat(l,"]")),o=l=void 0}this.value=[o,l]}});function Subflow(e,n){Operator.call(this,e),this.parent=n,this.count=0}inherits(Subflow,Operator,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Facet$1(e){Transform.call(this,{},e),this._keys=fastmap();const n=this._targets=[];n.active=0,n.forEach=i=>{for(let r=0,s=n.active;r<s;++r)i(n[r],r,n)}}inherits(Facet$1,Transform,{activate(e){this._targets[this._targets.active++]=e},subflow(e,n,i,r){const s=this.value;let o=has$1(s,e)&&s[e],l,f;return o?o.value.stamp<i.stamp&&(o.init(i),this.activate(o)):(f=r||(f=this._group[e])&&f.tuple,l=i.dataflow,o=new Subflow(i.fork(i.NO_SOURCE),this),l.add(o).connect(n(l,e,f)),s[e]=o,this.activate(o)),o},clean(){const e=this.value;let n=0;for(const i in e)if(e[i].count===0){const r=e[i].detachSubflow;r&&r(),delete e[i],++n}if(n){const i=this._targets.filter(r=>r&&r.count>0);this.initTargets(i)}},initTargets(e){const n=this._targets,i=n.length,r=e?e.length:0;let s=0;for(;s<r;++s)n[s]=e[s];for(;s<i&&n[s]!=null;++s)n[s]=null;n.active=r},transform(e,n){const i=n.dataflow,r=e.key,s=e.subflow,o=this._keys,l=e.modified("key"),f=d=>this.subflow(d,s,n);return this._group=e.group||{},this.initTargets(),n.visit(n.REM,d=>{const p=tupleid(d),g=o.get(p);g!==void 0&&(o.delete(p),f(g).rem(d))}),n.visit(n.ADD,d=>{const p=r(d);o.set(tupleid(d),p),f(p).add(d)}),l||n.modified(r.fields)?n.visit(n.MOD,d=>{const p=tupleid(d),g=o.get(p),v=r(d);g===v?f(v).mod(d):(o.set(p,v),f(g).rem(d),f(v).add(d))}):n.changed(n.MOD)&&n.visit(n.MOD,d=>{f(o.get(tupleid(d))).mod(d)}),l&&n.visit(n.REFLOW,d=>{const p=tupleid(d),g=o.get(p),v=r(d);g!==v&&(o.set(p,v),f(g).rem(d),f(v).add(d))}),n.clean()?i.runAfter(()=>{this.clean(),o.clean()}):o.empty>i.cleanThreshold&&i.runAfter(o.clean),n}});function Field$1(e){Operator.call(this,null,update$3,e)}inherits(Field$1,Operator);function update$3(e){return this.value&&!e.modified()?this.value:isArray(e.name)?array$5(e.name).map(n=>field$1(n)):field$1(e.name,e.as)}function Filter(e){Transform.call(this,fastmap(),e)}Filter.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};inherits(Filter,Transform,{transform(e,n){const i=n.dataflow,r=this.value,s=n.fork(),o=s.add,l=s.rem,f=s.mod,d=e.expr;let p=!0;n.visit(n.REM,v=>{const S=tupleid(v);r.has(S)?r.delete(S):l.push(v)}),n.visit(n.ADD,v=>{d(v,e)?o.push(v):r.set(tupleid(v),1)});function g(v){const S=tupleid(v),T=d(v,e),k=r.get(S);T&&k?(r.delete(S),o.push(v)):!T&&!k?(r.set(S,1),l.push(v)):p&&T&&!k&&f.push(v)}return n.visit(n.MOD,g),e.modified()&&(p=!1,n.visit(n.REFLOW,g)),r.empty>i.cleanThreshold&&i.runAfter(r.clean),s}});function Flatten(e){Transform.call(this,[],e)}Flatten.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};inherits(Flatten,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE),r=e.fields,s=fieldNames(r,e.as||[]),o=e.index||null,l=s.length;return i.rem=this.value,n.visit(n.SOURCE,f=>{const d=r.map(k=>k(f)),p=d.reduce((k,O)=>Math.max(k,O.length),0);let g=0,v,S,T;for(;g<p;++g){for(S=derive(f),v=0;v<l;++v)S[s[v]]=(T=d[v][g])==null?null:T;o&&(S[o]=g),i.add.push(S)}}),this.value=i.source=i.add,o&&i.modifies(o),i.modifies(s)}});function Fold(e){Transform.call(this,[],e)}Fold.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};inherits(Fold,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE),r=e.fields,s=r.map(accessorName),o=e.as||["key","value"],l=o[0],f=o[1],d=r.length;return i.rem=this.value,n.visit(n.SOURCE,p=>{for(let g=0,v;g<d;++g)v=derive(p),v[l]=s[g],v[f]=r[g](p),i.add.push(v)}),this.value=i.source=i.add,i.modifies(o)}});function Formula(e){Transform.call(this,null,e)}Formula.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};inherits(Formula,Transform,{transform(e,n){const i=e.expr,r=e.as,s=e.modified(),o=e.initonly?n.ADD:s?n.SOURCE:n.modified(i.fields)||n.modified(r)?n.ADD_MOD:n.ADD;return s&&(n=n.materialize().reflow(!0)),e.initonly||n.modifies(r),n.visit(o,l=>l[r]=i(l,e))}});function Generate(e){Transform.call(this,[],e)}inherits(Generate,Transform,{transform(e,n){const i=n.fork(n.ALL),r=e.generator;let s=this.value,o=e.size-s.length,l,f,d;if(o>0){for(l=[];--o>=0;)l.push(d=ingest$1(r(e))),s.push(d);i.add=i.add.length?i.materialize(i.ADD).add.concat(l):l}else f=s.slice(0,-o),i.rem=i.rem.length?i.materialize(i.REM).rem.concat(f):f,s=s.slice(-o);return i.source=this.value=s,i}});const Methods$1={value:"value",median,mean,min:min$2,max:max$2},Empty$1=[];function Impute(e){Transform.call(this,[],e)}Impute.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function getValue(e){var n=e.method||Methods$1.value,i;if(Methods$1[n]==null)error("Unrecognized imputation method: "+n);else return n===Methods$1.value?(i=e.value!==void 0?e.value:0,()=>i):Methods$1[n]}function getField$1(e){const n=e.field;return i=>i?n(i):NaN}inherits(Impute,Transform,{transform(e,n){var i=n.fork(n.ALL),r=getValue(e),s=getField$1(e),o=accessorName(e.field),l=accessorName(e.key),f=(e.groupby||[]).map(accessorName),d=partition$4(n.source,e.groupby,e.key,e.keyvals),p=[],g=this.value,v=d.domain.length,S,T,k,O,R,P,F,I,L,N;for(R=0,I=d.length;R<I;++R)for(S=d[R],k=S.values,T=NaN,F=0;F<v;++F)if(S[F]==null){for(O=d.domain[F],N={_impute:!0},P=0,L=k.length;P<L;++P)N[f[P]]=k[P];N[l]=O,N[o]=Number.isNaN(T)?T=r(S,s):T,p.push(ingest$1(N))}return p.length&&(i.add=i.materialize(i.ADD).add.concat(p)),g.length&&(i.rem=i.materialize(i.REM).rem.concat(g)),this.value=p,i}});function partition$4(e,n,i,r){var s=P=>P(R),o=[],l=r?r.slice():[],f={},d={},p,g,v,S,T,k,O,R;for(l.forEach((P,F)=>f[P]=F+1),S=0,O=e.length;S<O;++S)R=e[S],k=i(R),T=f[k]||(f[k]=l.push(k)),g=(p=n?n.map(s):Empty$1)+"",(v=d[g])||(v=d[g]=[],o.push(v),v.values=p),v[T-1]=R;return o.domain=l,o}function JoinAggregate(e){Aggregate$1.call(this,e)}JoinAggregate.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ValidAggregateOps},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};inherits(JoinAggregate,Aggregate$1,{transform(e,n){const i=this,r=e.modified();let s;return i.value&&(r||n.modified(i._inputs,!0))?(s=i.value=r?i.init(e):{},n.visit(n.SOURCE,o=>i.add(o))):(s=i.value=i.value||this.init(e),n.visit(n.REM,o=>i.rem(o)),n.visit(n.ADD,o=>i.add(o))),i.changes(),n.visit(n.SOURCE,o=>{extend$1(o,s[i.cellkey(o)].tuple)}),n.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,n=this._mods;let i,r;for(i=0,r=this._alen;i<r;++i)this.celltuple(e[i]),e[i]=null;for(i=0,r=this._mlen;i<r;++i)this.celltuple(n[i]),n[i]=null;this._alen=this._mlen=0}});function KDE(e){Transform.call(this,null,e)}KDE.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};inherits(KDE,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE|n.NO_FIELDS);if(!this.value||n.changed()||e.modified()){const r=n.materialize(n.SOURCE).source,s=partition$1$1(r,e.groupby,e.field),o=(e.groupby||[]).map(accessorName),l=e.bandwidth,f=e.cumulative?"cdf":"pdf",d=e.as||["value","density"],p=[];let g=e.extent,v=e.steps||e.minsteps||25,S=e.steps||e.maxsteps||200;f!=="pdf"&&f!=="cdf"&&error("Invalid density method: "+f),e.resolve==="shared"&&(g||(g=extent(r,e.field)),v=S=e.steps||S),s.forEach(T=>{const k=kde(T,l)[f],O=e.counts?T.length:1,R=g||extent(T);sampleCurve(k,R,v,S).forEach(P=>{const F={};for(let I=0;I<o.length;++I)F[o[I]]=T.dims[I];F[d[0]]=P[0],F[d[1]]=P[1]*O,p.push(ingest$1(F))})}),this.value&&(i.rem=this.value),this.value=i.add=i.source=p}return i}});function Key$1(e){Operator.call(this,null,update$2,e)}inherits(Key$1,Operator);function update$2(e){return this.value&&!e.modified()?this.value:key(e.fields,e.flat)}function Load$1(e){Transform.call(this,[],e),this._pending=null}inherits(Load$1,Transform,{transform(e,n){const i=n.dataflow;return this._pending?output(this,n,this._pending):stop(e)?n.StopPropagation:e.values?output(this,n,i.parse(e.values,e.format)):e.async?{async:i.request(e.url,e.format).then(s=>(this._pending=array$5(s.data),o=>o.touch(this)))}:i.request(e.url,e.format).then(r=>output(this,n,array$5(r.data)))}});function stop(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function output(e,n,i){i.forEach(ingest$1);const r=n.fork(n.NO_FIELDS&n.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=i,e._pending=null,r.rem.length&&r.clean(!0),r}function Lookup(e){Transform.call(this,{},e)}Lookup.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};inherits(Lookup,Transform,{transform(e,n){const i=e.fields,r=e.index,s=e.values,o=e.default==null?null:e.default,l=e.modified(),f=i.length;let d=l?n.SOURCE:n.ADD,p=n,g=e.as,v,S,T;return s?(S=s.length,f>1&&!g&&error('Multi-field lookup requires explicit "as" parameter.'),g&&g.length!==f*S&&error('The "as" parameter has too few output field names.'),g=g||s.map(accessorName),v=function(k){for(var O=0,R=0,P,F;O<f;++O)if(F=r.get(i[O](k)),F==null)for(P=0;P<S;++P,++R)k[g[R]]=o;else for(P=0;P<S;++P,++R)k[g[R]]=s[P](F)}):(g||error("Missing output field names."),v=function(k){for(var O=0,R;O<f;++O)R=r.get(i[O](k)),k[g[O]]=R??o}),l?p=n.reflow(!0):(T=i.some(k=>n.modified(k.fields)),d|=T?n.MOD:0),n.visit(d,v),p.modifies(g)}});function MultiExtent$1(e){Operator.call(this,null,update$1,e)}inherits(MultiExtent$1,Operator);function update$1(e){if(this.value&&!e.modified())return this.value;const n=e.extents,i=n.length;let r=1/0,s=-1/0,o,l;for(o=0;o<i;++o)l=n[o],l[0]<r&&(r=l[0]),l[1]>s&&(s=l[1]);return[r,s]}function MultiValues$1(e){Operator.call(this,null,update,e)}inherits(MultiValues$1,Operator);function update(e){return this.value&&!e.modified()?this.value:e.values.reduce((n,i)=>n.concat(i),[])}function Params$2(e){Transform.call(this,null,e)}inherits(Params$2,Transform,{transform(e,n){return this.modified(e.modified()),this.value=e,n.fork(n.NO_SOURCE|n.NO_FIELDS)}});function Pivot(e){Aggregate$1.call(this,e)}Pivot.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ValidAggregateOps,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};inherits(Pivot,Aggregate$1,{_transform:Aggregate$1.prototype.transform,transform(e,n){return this._transform(aggregateParams(e,n),n)}});function aggregateParams(e,n){const i=e.field,r=e.value,s=(e.op==="count"?"__count__":e.op)||"sum",o=accessorFields(i).concat(accessorFields(r)),l=pivotKeys(i,e.limit||0,n);return n.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:l.map(()=>s),fields:l.map(f=>get$5(f,i,r,o)),as:l.map(f=>f+""),modified:e.modified.bind(e)}}function get$5(e,n,i,r){return accessor(s=>n(s)===e?i(s):NaN,r,e+"")}function pivotKeys(e,n,i){const r={},s=[];return i.visit(i.SOURCE,o=>{const l=e(o);r[l]||(r[l]=1,s.push(l))}),s.sort(ascending$3),n?s.slice(0,n):s}function PreFacet$1(e){Facet$1.call(this,e)}inherits(PreFacet$1,Facet$1,{transform(e,n){const i=e.subflow,r=e.field,s=o=>this.subflow(tupleid(o),i,n,o);return(e.modified("field")||r&&n.modified(accessorFields(r)))&&error("PreFacet does not support field modification."),this.initTargets(),r?(n.visit(n.MOD,o=>{const l=s(o);r(o).forEach(f=>l.mod(f))}),n.visit(n.ADD,o=>{const l=s(o);r(o).forEach(f=>l.add(ingest$1(f)))}),n.visit(n.REM,o=>{const l=s(o);r(o).forEach(f=>l.rem(f))})):(n.visit(n.MOD,o=>s(o).mod(o)),n.visit(n.ADD,o=>s(o).add(o)),n.visit(n.REM,o=>s(o).rem(o))),n.clean()&&n.runAfter(()=>this.clean()),n}});function Project(e){Transform.call(this,null,e)}Project.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};inherits(Project,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE),r=e.fields,s=fieldNames(e.fields,e.as||[]),o=r?(f,d)=>project$1(f,d,r,s):rederive;let l;return this.value?l=this.value:(n=n.addAll(),l=this.value={}),n.visit(n.REM,f=>{const d=tupleid(f);i.rem.push(l[d]),l[d]=null}),n.visit(n.ADD,f=>{const d=o(f,ingest$1({}));l[tupleid(f)]=d,i.add.push(d)}),n.visit(n.MOD,f=>{i.mod.push(o(f,l[tupleid(f)]))}),i}});function project$1(e,n,i,r){for(let s=0,o=i.length;s<o;++s)n[r[s]]=i[s](e);return n}function Proxy$2(e){Transform.call(this,null,e)}inherits(Proxy$2,Transform,{transform(e,n){return this.value=e.value,e.modified("value")?n.fork(n.NO_SOURCE|n.NO_FIELDS):n.StopPropagation}});function Quantile$1(e){Transform.call(this,null,e)}Quantile$1.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const EPSILON$2=1e-14;inherits(Quantile$1,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE|n.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!n.changed())return i.source=this.value,i;const s=n.materialize(n.SOURCE).source,o=partition$1$1(s,e.groupby,e.field),l=(e.groupby||[]).map(accessorName),f=[],d=e.step||.01,p=e.probs||range$4(d/2,1-EPSILON$2,d),g=p.length;return o.forEach(v=>{const S=quantiles(v,p);for(let T=0;T<g;++T){const k={};for(let O=0;O<l.length;++O)k[l[O]]=v.dims[O];k[r[0]]=p[T],k[r[1]]=S[T],f.push(ingest$1(k))}}),this.value&&(i.rem=this.value),this.value=i.add=i.source=f,i}});function Relay$1(e){Transform.call(this,null,e)}inherits(Relay$1,Transform,{transform(e,n){let i,r;return this.value?r=this.value:(i=n=n.addAll(),r=this.value={}),e.derive&&(i=n.fork(n.NO_SOURCE),n.visit(n.REM,s=>{const o=tupleid(s);i.rem.push(r[o]),r[o]=null}),n.visit(n.ADD,s=>{const o=derive(s);r[tupleid(s)]=o,i.add.push(o)}),n.visit(n.MOD,s=>{const o=r[tupleid(s)];for(const l in s)o[l]=s[l],i.modifies(l);i.mod.push(o)})),i}});function Sample(e){Transform.call(this,[],e),this.count=0}Sample.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};inherits(Sample,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE),r=e.modified("size"),s=e.size,o=this.value.reduce((g,v)=>(g[tupleid(v)]=1,g),{});let l=this.value,f=this.count,d=0;function p(g){let v,S;l.length<s?l.push(g):(S=~~((f+1)*random()),S<l.length&&S>=d&&(v=l[S],o[tupleid(v)]&&i.rem.push(v),l[S]=g)),++f}if(n.rem.length&&(n.visit(n.REM,g=>{const v=tupleid(g);o[v]&&(o[v]=-1,i.rem.push(g)),--f}),l=l.filter(g=>o[tupleid(g)]!==-1)),(n.rem.length||r)&&l.length<s&&n.source&&(d=f=l.length,n.visit(n.SOURCE,g=>{o[tupleid(g)]||p(g)}),d=-1),r&&l.length>s){const g=l.length-s;for(let v=0;v<g;++v)o[tupleid(l[v])]=-1,i.rem.push(l[v]);l=l.slice(g)}return n.mod.length&&n.visit(n.MOD,g=>{o[tupleid(g)]&&i.mod.push(g)}),n.add.length&&n.visit(n.ADD,p),(n.add.length||d<0)&&(i.add=l.filter(g=>!o[tupleid(g)])),this.count=f,this.value=i.source=l,i}});function Sequence(e){Transform.call(this,null,e)}Sequence.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};inherits(Sequence,Transform,{transform(e,n){if(this.value&&!e.modified())return;const i=n.materialize().fork(n.MOD),r=e.as||"data";return i.rem=this.value?n.rem.concat(this.value):n.rem,this.value=range$4(e.start,e.stop,e.step||1).map(s=>{const o={};return o[r]=s,ingest$1(o)}),i.add=n.add.concat(this.value),i}});function Sieve$1(e){Transform.call(this,null,e),this.modified(!0)}inherits(Sieve$1,Transform,{transform(e,n){return this.value=n.source,n.changed()?n.fork(n.NO_SOURCE|n.NO_FIELDS):n.StopPropagation}});function TimeUnit(e){Transform.call(this,null,e)}const OUTPUT=["unit0","unit1"];TimeUnit.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:TIME_UNITS,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:OUTPUT}]};inherits(TimeUnit,Transform,{transform(e,n){const i=e.field,r=e.interval!==!1,s=e.timezone==="utc",o=this._floor(e,n),l=(s?utcInterval:timeInterval)(o.unit).offset,f=e.as||OUTPUT,d=f[0],p=f[1],g=o.step;let v=o.start||1/0,S=o.stop||-1/0,T=n.ADD;return(e.modified()||n.changed(n.REM)||n.modified(accessorFields(i)))&&(n=n.reflow(!0),T=n.SOURCE,v=1/0,S=-1/0),n.visit(T,k=>{const O=i(k);let R,P;O==null?(k[d]=null,r&&(k[p]=null)):(k[d]=R=P=o(O),r&&(k[p]=P=l(R,g)),R<v&&(v=R),P>S&&(S=P))}),o.start=v,o.stop=S,n.modifies(r?f:d)},_floor(e,n){const i=e.timezone==="utc",{units:r,step:s}=e.units?{units:e.units,step:e.step||1}:bin$2({extent:e.extent||extent(n.materialize(n.SOURCE).source,e.field),maxbins:e.maxbins}),o=timeUnits(r),l=this.value||{},f=(i?utcFloor:timeFloor)(o,s);return f.unit=peek$1(o),f.units=o,f.step=s,f.start=l.start,f.stop=l.stop,this.value=f}});function TupleIndex(e){Transform.call(this,fastmap(),e)}inherits(TupleIndex,Transform,{transform(e,n){const i=n.dataflow,r=e.field,s=this.value,o=f=>s.set(r(f),f);let l=!0;return e.modified("field")||n.modified(r.fields)?(s.clear(),n.visit(n.SOURCE,o)):n.changed()?(n.visit(n.REM,f=>s.delete(r(f))),n.visit(n.ADD,o)):l=!1,this.modified(l),s.empty>i.cleanThreshold&&i.runAfter(s.clean),n.fork()}});function Values$1(e){Transform.call(this,null,e)}inherits(Values$1,Transform,{transform(e,n){(!this.value||e.modified("field")||e.modified("sort")||n.changed()||e.sort&&n.modified(e.sort.fields))&&(this.value=(e.sort?n.source.slice().sort(stableCompare(e.sort)):n.source).map(e.field))}});function WindowOp(e,n,i,r){const s=WindowOps[e](n,i);return{init:s.init||zero$4,update:function(o,l){l[r]=s.next(o)}}}const WindowOps={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:n=>{const i=n.index,r=n.data;return i&&n.compare(r[i-1],r[i])?e=i+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:n=>{const i=n.index,r=n.data;return i&&n.compare(r[i-1],r[i])?++e:e}}},percent_rank:function(){const e=WindowOps.rank(),n=e.next;return{init:e.init,next:i=>(n(i)-1)/(i.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:n=>{const i=n.data,r=n.compare;let s=n.index;if(e<s){for(;s+1<i.length&&!r(i[s],i[s+1]);)++s;e=s}return(1+e)/i.length}}},ntile:function(e,n){n=+n,n>0||error("ntile num must be greater than zero.");const i=WindowOps.cume_dist(),r=i.next;return{init:i.init,next:s=>Math.ceil(n*r(s))}},lag:function(e,n){return n=+n||1,{next:i=>{const r=i.index-n;return r>=0?e(i.data[r]):null}}},lead:function(e,n){return n=+n||1,{next:i=>{const r=i.index+n,s=i.data;return r<s.length?e(s[r]):null}}},first_value:function(e){return{next:n=>e(n.data[n.i0])}},last_value:function(e){return{next:n=>e(n.data[n.i1-1])}},nth_value:function(e,n){return n=+n,n>0||error("nth_value nth must be greater than zero."),{next:i=>{const r=i.i0+(n-1);return r<i.i1?e(i.data[r]):null}}},prev_value:function(e){let n;return{init:()=>n=null,next:i=>{const r=e(i.data[i.index]);return r!=null?n=r:n}}},next_value:function(e){let n,i;return{init:()=>(n=null,i=-1),next:r=>{const s=r.data;return r.index<=i?n:(i=find$2(e,s,r.index))<0?(i=s.length,n=null):n=e(s[i])}}}};function find$2(e,n,i){for(let r=n.length;i<r;++i)if(e(n[i])!=null)return i;return-1}const ValidWindowOps=Object.keys(WindowOps);function WindowState(e){const n=array$5(e.ops),i=array$5(e.fields),r=array$5(e.params),s=array$5(e.as),o=this.outputs=[],l=this.windows=[],f={},d={},p=[],g=[];let v=!0;function S(T){array$5(accessorFields(T)).forEach(k=>f[k]=1)}S(e.sort),n.forEach((T,k)=>{const O=i[k],R=accessorName(O),P=measureName(T,R,s[k]);if(S(O),o.push(P),has$1(WindowOps,T))l.push(WindowOp(T,i[k],r[k],P));else{if(O==null&&T!=="count"&&error("Null aggregate field specified."),T==="count"){p.push(P);return}v=!1;let F=d[R];F||(F=d[R]=[],F.field=O,g.push(F)),F.push(createMeasure(T,P))}}),(p.length||g.length)&&(this.cell=cell(g,p,v)),this.inputs=Object.keys(f)}const prototype=WindowState.prototype;prototype.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};prototype.update=function(e,n){const i=this.cell,r=this.windows,s=e.data,o=r&&r.length;let l;if(i){for(l=e.p0;l<e.i0;++l)i.rem(s[l]);for(l=e.p1;l<e.i1;++l)i.add(s[l]);i.set(n)}for(l=0;l<o;++l)r[l].update(e,n)};function cell(e,n,i){e=e.map(d=>compileMeasures(d,d.field));const r={num:0,agg:null,store:!1,count:n};if(!i)for(var s=e.length,o=r.agg=Array(s),l=0;l<s;++l)o[l]=new e[l](r);if(r.store)var f=r.data=new TupleStore;return r.add=function(d){if(r.num+=1,!i){f&&f.add(d);for(let p=0;p<s;++p)o[p].add(o[p].get(d),d)}},r.rem=function(d){if(r.num-=1,!i){f&&f.rem(d);for(let p=0;p<s;++p)o[p].rem(o[p].get(d),d)}},r.set=function(d){let p,g;for(f&&f.values(),p=0,g=n.length;p<g;++p)d[n[p]]=r.num;if(!i)for(p=0,g=o.length;p<g;++p)o[p].set(d)},r.init=function(){r.num=0,f&&f.reset();for(let d=0;d<s;++d)o[d].init()},r}function Window(e){Transform.call(this,{},e),this._mlen=0,this._mods=[]}Window.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ValidWindowOps.concat(ValidAggregateOps)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};inherits(Window,Transform,{transform(e,n){this.stamp=n.stamp;const i=e.modified(),r=stableCompare(e.sort),s=groupkey(e.groupby),o=f=>this.group(s(f));let l=this.state;(!l||i)&&(l=this.state=new WindowState(e)),i||n.modified(l.inputs)?(this.value={},n.visit(n.SOURCE,f=>o(f).add(f))):(n.visit(n.REM,f=>o(f).remove(f)),n.visit(n.ADD,f=>o(f).add(f)));for(let f=0,d=this._mlen;f<d;++f)processPartition(this._mods[f],l,r,e);return this._mlen=0,this._mods=[],n.reflow(i).modifies(l.outputs)},group(e){let n=this.value[e];return n||(n=this.value[e]=SortedList(tupleid),n.stamp=-1),n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n),n}});function processPartition(e,n,i,r){const s=r.sort,o=s&&!r.ignorePeers,l=r.frame||[null,0],f=e.data(i),d=f.length,p=o?bisector$1(s):null,g={i0:0,i1:0,p0:0,p1:0,index:0,data:f,compare:s||constant$4(-1)};n.init();for(let v=0;v<d;++v)setWindow(g,l,v,d),o&&adjustRange(g,p),n.update(g,f[v])}function setWindow(e,n,i,r){e.p0=e.i0,e.p1=e.i1,e.i0=n[0]==null?0:Math.max(0,i-Math.abs(n[0])),e.i1=n[1]==null?r:Math.min(r,i+Math.abs(n[1])+1),e.index=i}function adjustRange(e,n){const i=e.i0,r=e.i1-1,s=e.compare,o=e.data,l=o.length-1;i>0&&!s(o[i],o[i-1])&&(e.i0=n.left(o,o[i])),r<l&&!s(o[r],o[r+1])&&(e.i1=n.right(o,o[r]))}const tx=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Aggregate$1,bin:Bin,collect:Collect$1,compare:Compare$1,countpattern:CountPattern,cross:Cross,density:Density,dotbin:DotBin,expression:Expression$1,extent:Extent,facet:Facet$1,field:Field$1,filter:Filter,flatten:Flatten,fold:Fold,formula:Formula,generate:Generate,impute:Impute,joinaggregate:JoinAggregate,kde:KDE,key:Key$1,load:Load$1,lookup:Lookup,multiextent:MultiExtent$1,multivalues:MultiValues$1,params:Params$2,pivot:Pivot,prefacet:PreFacet$1,project:Project,proxy:Proxy$2,quantile:Quantile$1,relay:Relay$1,sample:Sample,sequence:Sequence,sieve:Sieve$1,subflow:Subflow,timeunit:TimeUnit,tupleindex:TupleIndex,values:Values$1,window:Window},Symbol.toStringTag,{value:"Module"}));function constant$3(e){return function(){return e}}const abs$2=Math.abs,atan2$1=Math.atan2,cos$2=Math.cos,max$1=Math.max,min$1=Math.min,sin$2=Math.sin,sqrt$3=Math.sqrt,epsilon$5=1e-12,pi$3=Math.PI,halfPi$2=pi$3/2,tau$3=2*pi$3;function acos$1(e){return e>1?0:e<-1?pi$3:Math.acos(e)}function asin$2(e){return e>=1?halfPi$2:e<=-1?-halfPi$2:Math.asin(e)}const pi$2=Math.PI,tau$2=2*pi$2,epsilon$4=1e-6,tauEpsilon=tau$2-epsilon$4;function append$1(e){this._+=e[0];for(let n=1,i=e.length;n<i;++n)this._+=arguments[n]+e[n]}function appendRound$1(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return append$1;const i=10**n;return function(r){this._+=r[0];for(let s=1,o=r.length;s<o;++s)this._+=Math.round(arguments[s]*i)/i+r[s]}}let Path$1=class{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?append$1:appendRound$1(n)}moveTo(n,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,i){this._append`L${this._x1=+n},${this._y1=+i}`}quadraticCurveTo(n,i,r,s){this._append`Q${+n},${+i},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(n,i,r,s,o,l){this._append`C${+n},${+i},${+r},${+s},${this._x1=+o},${this._y1=+l}`}arcTo(n,i,r,s,o){if(n=+n,i=+i,r=+r,s=+s,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,f=this._y1,d=r-n,p=s-i,g=l-n,v=f-i,S=g*g+v*v;if(this._x1===null)this._append`M${this._x1=n},${this._y1=i}`;else if(S>epsilon$4)if(!(Math.abs(v*d-p*g)>epsilon$4)||!o)this._append`L${this._x1=n},${this._y1=i}`;else{let T=r-l,k=s-f,O=d*d+p*p,R=T*T+k*k,P=Math.sqrt(O),F=Math.sqrt(S),I=o*Math.tan((pi$2-Math.acos((O+S-R)/(2*P*F)))/2),L=I/F,N=I/P;Math.abs(L-1)>epsilon$4&&this._append`L${n+L*g},${i+L*v}`,this._append`A${o},${o},0,0,${+(v*T>g*k)},${this._x1=n+N*d},${this._y1=i+N*p}`}}arc(n,i,r,s,o,l){if(n=+n,i=+i,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let f=r*Math.cos(s),d=r*Math.sin(s),p=n+f,g=i+d,v=1^l,S=l?s-o:o-s;this._x1===null?this._append`M${p},${g}`:(Math.abs(this._x1-p)>epsilon$4||Math.abs(this._y1-g)>epsilon$4)&&this._append`L${p},${g}`,r&&(S<0&&(S=S%tau$2+tau$2),S>tauEpsilon?this._append`A${r},${r},0,1,${v},${n-f},${i-d}A${r},${r},0,1,${v},${this._x1=p},${this._y1=g}`:S>epsilon$4&&this._append`A${r},${r},0,${+(S>=pi$2)},${v},${this._x1=n+r*Math.cos(o)},${this._y1=i+r*Math.sin(o)}`)}rect(n,i,r,s){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}};function path$3(){return new Path$1}path$3.prototype=Path$1.prototype;function withPath(e){let n=3;return e.digits=function(i){if(!arguments.length)return n;if(i==null)n=null;else{const r=Math.floor(i);if(!(r>=0))throw new RangeError(`invalid digits: ${i}`);n=r}return e},()=>new Path$1(n)}function arcInnerRadius(e){return e.innerRadius}function arcOuterRadius(e){return e.outerRadius}function arcStartAngle(e){return e.startAngle}function arcEndAngle(e){return e.endAngle}function arcPadAngle(e){return e&&e.padAngle}function intersect$3(e,n,i,r,s,o,l,f){var d=i-e,p=r-n,g=l-s,v=f-o,S=v*d-g*p;if(!(S*S<epsilon$5))return S=(g*(n-o)-v*(e-s))/S,[e+S*d,n+S*p]}function cornerTangents(e,n,i,r,s,o,l){var f=e-i,d=n-r,p=(l?o:-o)/sqrt$3(f*f+d*d),g=p*d,v=-p*f,S=e+g,T=n+v,k=i+g,O=r+v,R=(S+k)/2,P=(T+O)/2,F=k-S,I=O-T,L=F*F+I*I,N=s-o,j=S*O-k*T,z=(I<0?-1:1)*sqrt$3(max$1(0,N*N*L-j*j)),q=(j*I-F*z)/L,H=(-j*F-I*z)/L,W=(j*I+F*z)/L,U=(-j*F+I*z)/L,Q=q-R,J=H-P,ne=W-R,G=U-P;return Q*Q+J*J>ne*ne+G*G&&(q=W,H=U),{cx:q,cy:H,x01:-g,y01:-v,x11:q*(s/N-1),y11:H*(s/N-1)}}function arc$2$1(){var e=arcInnerRadius,n=arcOuterRadius,i=constant$3(0),r=null,s=arcStartAngle,o=arcEndAngle,l=arcPadAngle,f=null,d=withPath(p);function p(){var g,v,S=+e.apply(this,arguments),T=+n.apply(this,arguments),k=s.apply(this,arguments)-halfPi$2,O=o.apply(this,arguments)-halfPi$2,R=abs$2(O-k),P=O>k;if(f||(f=g=d()),T<S&&(v=T,T=S,S=v),!(T>epsilon$5))f.moveTo(0,0);else if(R>tau$3-epsilon$5)f.moveTo(T*cos$2(k),T*sin$2(k)),f.arc(0,0,T,k,O,!P),S>epsilon$5&&(f.moveTo(S*cos$2(O),S*sin$2(O)),f.arc(0,0,S,O,k,P));else{var F=k,I=O,L=k,N=O,j=R,z=R,q=l.apply(this,arguments)/2,H=q>epsilon$5&&(r?+r.apply(this,arguments):sqrt$3(S*S+T*T)),W=min$1(abs$2(T-S)/2,+i.apply(this,arguments)),U=W,Q=W,J,ne;if(H>epsilon$5){var G=asin$2(H/S*sin$2(q)),Z=asin$2(H/T*sin$2(q));(j-=G*2)>epsilon$5?(G*=P?1:-1,L+=G,N-=G):(j=0,L=N=(k+O)/2),(z-=Z*2)>epsilon$5?(Z*=P?1:-1,F+=Z,I-=Z):(z=0,F=I=(k+O)/2)}var ae=T*cos$2(F),oe=T*sin$2(F),pe=S*cos$2(N),Se=S*sin$2(N);if(W>epsilon$5){var ue=T*cos$2(I),ee=T*sin$2(I),V=S*cos$2(L),se=S*sin$2(L),fe;if(R<pi$3)if(fe=intersect$3(ae,oe,V,se,ue,ee,pe,Se)){var he=ae-fe[0],be=oe-fe[1],xe=ue-fe[0],ye=ee-fe[1],we=1/sin$2(acos$1((he*xe+be*ye)/(sqrt$3(he*he+be*be)*sqrt$3(xe*xe+ye*ye)))/2),$e=sqrt$3(fe[0]*fe[0]+fe[1]*fe[1]);U=min$1(W,(S-$e)/(we-1)),Q=min$1(W,(T-$e)/(we+1))}else U=Q=0}z>epsilon$5?Q>epsilon$5?(J=cornerTangents(V,se,ae,oe,T,Q,P),ne=cornerTangents(ue,ee,pe,Se,T,Q,P),f.moveTo(J.cx+J.x01,J.cy+J.y01),Q<W?f.arc(J.cx,J.cy,Q,atan2$1(J.y01,J.x01),atan2$1(ne.y01,ne.x01),!P):(f.arc(J.cx,J.cy,Q,atan2$1(J.y01,J.x01),atan2$1(J.y11,J.x11),!P),f.arc(0,0,T,atan2$1(J.cy+J.y11,J.cx+J.x11),atan2$1(ne.cy+ne.y11,ne.cx+ne.x11),!P),f.arc(ne.cx,ne.cy,Q,atan2$1(ne.y11,ne.x11),atan2$1(ne.y01,ne.x01),!P))):(f.moveTo(ae,oe),f.arc(0,0,T,F,I,!P)):f.moveTo(ae,oe),!(S>epsilon$5)||!(j>epsilon$5)?f.lineTo(pe,Se):U>epsilon$5?(J=cornerTangents(pe,Se,ue,ee,S,-U,P),ne=cornerTangents(ae,oe,V,se,S,-U,P),f.lineTo(J.cx+J.x01,J.cy+J.y01),U<W?f.arc(J.cx,J.cy,U,atan2$1(J.y01,J.x01),atan2$1(ne.y01,ne.x01),!P):(f.arc(J.cx,J.cy,U,atan2$1(J.y01,J.x01),atan2$1(J.y11,J.x11),!P),f.arc(0,0,S,atan2$1(J.cy+J.y11,J.cx+J.x11),atan2$1(ne.cy+ne.y11,ne.cx+ne.x11),P),f.arc(ne.cx,ne.cy,U,atan2$1(ne.y11,ne.x11),atan2$1(ne.y01,ne.x01),!P))):f.arc(0,0,S,N,L,P)}if(f.closePath(),g)return f=null,g+""||null}return p.centroid=function(){var g=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,v=(+s.apply(this,arguments)+ +o.apply(this,arguments))/2-pi$3/2;return[cos$2(v)*g,sin$2(v)*g]},p.innerRadius=function(g){return arguments.length?(e=typeof g=="function"?g:constant$3(+g),p):e},p.outerRadius=function(g){return arguments.length?(n=typeof g=="function"?g:constant$3(+g),p):n},p.cornerRadius=function(g){return arguments.length?(i=typeof g=="function"?g:constant$3(+g),p):i},p.padRadius=function(g){return arguments.length?(r=g==null?null:typeof g=="function"?g:constant$3(+g),p):r},p.startAngle=function(g){return arguments.length?(s=typeof g=="function"?g:constant$3(+g),p):s},p.endAngle=function(g){return arguments.length?(o=typeof g=="function"?g:constant$3(+g),p):o},p.padAngle=function(g){return arguments.length?(l=typeof g=="function"?g:constant$3(+g),p):l},p.context=function(g){return arguments.length?(f=g??null,p):f},p}function array$4(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Linear$1(e){this._context=e}Linear$1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function curveLinear(e){return new Linear$1(e)}function x$3(e){return e[0]}function y$3(e){return e[1]}function line$2$1(e,n){var i=constant$3(!0),r=null,s=curveLinear,o=null,l=withPath(f);e=typeof e=="function"?e:e===void 0?x$3:constant$3(e),n=typeof n=="function"?n:n===void 0?y$3:constant$3(n);function f(d){var p,g=(d=array$4(d)).length,v,S=!1,T;for(r==null&&(o=s(T=l())),p=0;p<=g;++p)!(p<g&&i(v=d[p],p,d))===S&&((S=!S)?o.lineStart():o.lineEnd()),S&&o.point(+e(v,p,d),+n(v,p,d));if(T)return o=null,T+""||null}return f.x=function(d){return arguments.length?(e=typeof d=="function"?d:constant$3(+d),f):e},f.y=function(d){return arguments.length?(n=typeof d=="function"?d:constant$3(+d),f):n},f.defined=function(d){return arguments.length?(i=typeof d=="function"?d:constant$3(!!d),f):i},f.curve=function(d){return arguments.length?(s=d,r!=null&&(o=s(r)),f):s},f.context=function(d){return arguments.length?(d==null?r=o=null:o=s(r=d),f):r},f}function area$2$1(e,n,i){var r=null,s=constant$3(!0),o=null,l=curveLinear,f=null,d=withPath(p);e=typeof e=="function"?e:e===void 0?x$3:constant$3(+e),n=typeof n=="function"?n:constant$3(n===void 0?0:+n),i=typeof i=="function"?i:i===void 0?y$3:constant$3(+i);function p(v){var S,T,k,O=(v=array$4(v)).length,R,P=!1,F,I=new Array(O),L=new Array(O);for(o==null&&(f=l(F=d())),S=0;S<=O;++S){if(!(S<O&&s(R=v[S],S,v))===P)if(P=!P)T=S,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),k=S-1;k>=T;--k)f.point(I[k],L[k]);f.lineEnd(),f.areaEnd()}P&&(I[S]=+e(R,S,v),L[S]=+n(R,S,v),f.point(r?+r(R,S,v):I[S],i?+i(R,S,v):L[S]))}if(F)return f=null,F+""||null}function g(){return line$2$1().defined(s).curve(l).context(o)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:constant$3(+v),r=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:constant$3(+v),p):e},p.x1=function(v){return arguments.length?(r=v==null?null:typeof v=="function"?v:constant$3(+v),p):r},p.y=function(v){return arguments.length?(n=typeof v=="function"?v:constant$3(+v),i=null,p):n},p.y0=function(v){return arguments.length?(n=typeof v=="function"?v:constant$3(+v),p):n},p.y1=function(v){return arguments.length?(i=v==null?null:typeof v=="function"?v:constant$3(+v),p):i},p.lineX0=p.lineY0=function(){return g().x(e).y(n)},p.lineY1=function(){return g().x(e).y(i)},p.lineX1=function(){return g().x(r).y(n)},p.defined=function(v){return arguments.length?(s=typeof v=="function"?v:constant$3(!!v),p):s},p.curve=function(v){return arguments.length?(l=v,o!=null&&(f=l(o)),p):l},p.context=function(v){return arguments.length?(v==null?o=f=null:f=l(o=v),p):o},p}const circle$1={draw(e,n){const i=sqrt$3(n/pi$3);e.moveTo(i,0),e.arc(0,0,i,0,tau$3)}};function Symbol$1(e,n){let i=null,r=withPath(s);e=typeof e=="function"?e:constant$3(e||circle$1),n=typeof n=="function"?n:constant$3(n===void 0?64:+n);function s(){let o;if(i||(i=o=r()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),o)return i=null,o+""||null}return s.type=function(o){return arguments.length?(e=typeof o=="function"?o:constant$3(o),s):e},s.size=function(o){return arguments.length?(n=typeof o=="function"?o:constant$3(+o),s):n},s.context=function(o){return arguments.length?(i=o??null,s):i},s}function noop$3(){}function point$7(e,n,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+n)/6,(e._y0+4*e._y1+i)/6)}function Basis(e){this._context=e}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$7(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$7(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function curveBasis(e){return new Basis(e)}function BasisClosed(e){this._context=e}BasisClosed.prototype={areaStart:noop$3,areaEnd:noop$3,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._x2=e,this._y2=n;break;case 1:this._point=2,this._x3=e,this._y3=n;break;case 2:this._point=3,this._x4=e,this._y4=n,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+n)/6);break;default:point$7(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function curveBasisClosed(e){return new BasisClosed(e)}function BasisOpen(e){this._context=e}BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(i,r):this._context.moveTo(i,r);break;case 3:this._point=4;default:point$7(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function curveBasisOpen(e){return new BasisOpen(e)}function Bundle(e,n){this._basis=new Basis(e),this._beta=n}Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,n=this._y,i=e.length-1;if(i>0)for(var r=e[0],s=n[0],o=e[i]-r,l=n[i]-s,f=-1,d;++f<=i;)d=f/i,this._basis.point(this._beta*e[f]+(1-this._beta)*(r+d*o),this._beta*n[f]+(1-this._beta)*(s+d*l));this._x=this._y=null,this._basis.lineEnd()},point:function(e,n){this._x.push(+e),this._y.push(+n)}};const curveBundle=function e(n){function i(r){return n===1?new Basis(r):new Bundle(r,n)}return i.beta=function(r){return e(+r)},i}(.85);function point$6(e,n,i){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-n),e._y2+e._k*(e._y1-i),e._x2,e._y2)}function Cardinal(e,n){this._context=e,this._k=(1-n)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$6(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2,this._x1=e,this._y1=n;break;case 2:this._point=3;default:point$6(this,e,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const curveCardinal=function e(n){function i(r){return new Cardinal(r,n)}return i.tension=function(r){return e(+r)},i}(0);function CardinalClosed(e,n){this._context=e,this._k=(1-n)/6}CardinalClosed.prototype={areaStart:noop$3,areaEnd:noop$3,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._x3=e,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=n);break;case 2:this._point=3,this._x5=e,this._y5=n;break;default:point$6(this,e,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const curveCardinalClosed=function e(n){function i(r){return new CardinalClosed(r,n)}return i.tension=function(r){return e(+r)},i}(0);function CardinalOpen(e,n){this._context=e,this._k=(1-n)/6}CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$6(this,e,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const curveCardinalOpen=function e(n){function i(r){return new CardinalOpen(r,n)}return i.tension=function(r){return e(+r)},i}(0);function point$5(e,n,i){var r=e._x1,s=e._y1,o=e._x2,l=e._y2;if(e._l01_a>epsilon$5){var f=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,d=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*f-e._x0*e._l12_2a+e._x2*e._l01_2a)/d,s=(s*f-e._y0*e._l12_2a+e._y2*e._l01_2a)/d}if(e._l23_a>epsilon$5){var p=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,g=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*p+e._x1*e._l23_2a-n*e._l12_2a)/g,l=(l*p+e._y1*e._l23_2a-i*e._l12_2a)/g}e._context.bezierCurveTo(r,s,o,l,e._x2,e._y2)}function CatmullRom(e,n){this._context=e,this._alpha=n}CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){if(e=+e,n=+n,this._point){var i=this._x2-e,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3;default:point$5(this,e,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const curveCatmullRom=function e(n){function i(r){return n?new CatmullRom(r,n):new Cardinal(r,0)}return i.alpha=function(r){return e(+r)},i}(.5);function CatmullRomClosed(e,n){this._context=e,this._alpha=n}CatmullRomClosed.prototype={areaStart:noop$3,areaEnd:noop$3,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,n){if(e=+e,n=+n,this._point){var i=this._x2-e,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=n);break;case 2:this._point=3,this._x5=e,this._y5=n;break;default:point$5(this,e,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const curveCatmullRomClosed=function e(n){function i(r){return n?new CatmullRomClosed(r,n):new CardinalClosed(r,0)}return i.alpha=function(r){return e(+r)},i}(.5);function CatmullRomOpen(e,n){this._context=e,this._alpha=n}CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){if(e=+e,n=+n,this._point){var i=this._x2-e,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$5(this,e,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const curveCatmullRomOpen=function e(n){function i(r){return n?new CatmullRomOpen(r,n):new CardinalOpen(r,0)}return i.alpha=function(r){return e(+r)},i}(.5);function LinearClosed(e){this._context=e}LinearClosed.prototype={areaStart:noop$3,areaEnd:noop$3,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function curveLinearClosed(e){return new LinearClosed(e)}function sign$1(e){return e<0?-1:1}function slope3(e,n,i){var r=e._x1-e._x0,s=n-e._x1,o=(e._y1-e._y0)/(r||s<0&&-0),l=(i-e._y1)/(s||r<0&&-0),f=(o*s+l*r)/(r+s);return(sign$1(o)+sign$1(l))*Math.min(Math.abs(o),Math.abs(l),.5*Math.abs(f))||0}function slope2(e,n){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-n)/2:n}function point$4(e,n,i){var r=e._x0,s=e._y0,o=e._x1,l=e._y1,f=(o-r)/3;e._context.bezierCurveTo(r+f,s+f*n,o-f,l-f*i,o,l)}function MonotoneX(e){this._context=e}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$4(this,this._t0,slope2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){var i=NaN;if(e=+e,n=+n,!(e===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,point$4(this,slope2(this,i=slope3(this,e,n)),i);break;default:point$4(this,this._t0,i=slope3(this,e,n));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n,this._t0=i}}};function MonotoneY(e){this._context=new ReflectContext(e)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(e,n){MonotoneX.prototype.point.call(this,n,e)};function ReflectContext(e){this._context=e}ReflectContext.prototype={moveTo:function(e,n){this._context.moveTo(n,e)},closePath:function(){this._context.closePath()},lineTo:function(e,n){this._context.lineTo(n,e)},bezierCurveTo:function(e,n,i,r,s,o){this._context.bezierCurveTo(n,e,r,i,o,s)}};function monotoneX(e){return new MonotoneX(e)}function monotoneY(e){return new MonotoneY(e)}function Natural(e){this._context=e}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,n=this._y,i=e.length;if(i)if(this._line?this._context.lineTo(e[0],n[0]):this._context.moveTo(e[0],n[0]),i===2)this._context.lineTo(e[1],n[1]);else for(var r=controlPoints(e),s=controlPoints(n),o=0,l=1;l<i;++o,++l)this._context.bezierCurveTo(r[0][o],s[0][o],r[1][o],s[1][o],e[l],n[l]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,n){this._x.push(+e),this._y.push(+n)}};function controlPoints(e){var n,i=e.length-1,r,s=new Array(i),o=new Array(i),l=new Array(i);for(s[0]=0,o[0]=2,l[0]=e[0]+2*e[1],n=1;n<i-1;++n)s[n]=1,o[n]=4,l[n]=4*e[n]+2*e[n+1];for(s[i-1]=2,o[i-1]=7,l[i-1]=8*e[i-1]+e[i],n=1;n<i;++n)r=s[n]/o[n-1],o[n]-=r,l[n]-=r*l[n-1];for(s[i-1]=l[i-1]/o[i-1],n=i-2;n>=0;--n)s[n]=(l[n]-s[n+1])/o[n];for(o[i-1]=(e[i]+s[i-1])/2,n=0;n<i-1;++n)o[n]=2*e[n+1]-s[n+1];return[s,o]}function curveNatural(e){return new Natural(e)}function Step(e,n){this._context=e,this._t=n}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(e,n);else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,n)}break}}this._x=e,this._y=n}};function curveStep(e){return new Step(e,.5)}function stepBefore(e){return new Step(e,0)}function stepAfter(e){return new Step(e,1)}function domCanvas(e,n){if(typeof document<"u"&&document.createElement){const i=document.createElement("canvas");if(i&&i.getContext)return i.width=e,i.height=n,i}return null}const domImage=()=>typeof Image<"u"?Image:null;function initRange(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}function initInterpolator(e,n){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const implicit=Symbol("implicit");function ordinal(){var e=new InternMap,n=[],i=[],r=implicit;function s(o){let l=e.get(o);if(l===void 0){if(r!==implicit)return r;e.set(o,l=n.push(o)-1)}return i[l%i.length]}return s.domain=function(o){if(!arguments.length)return n.slice();n=[],e=new InternMap;for(const l of o)e.has(l)||e.set(l,n.push(l)-1);return s},s.range=function(o){return arguments.length?(i=Array.from(o),s):i.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.copy=function(){return ordinal(n,i).unknown(r)},initRange.apply(s,arguments),s}function define(e,n,i){e.prototype=n.prototype=i,i.constructor=e}function extend(e,n){var i=Object.create(e.prototype);for(var r in n)i[r]=n[r];return i}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color$3,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color$3(e){var n,i;return e=(e+"").trim().toLowerCase(),(n=reHex.exec(e))?(i=n[1].length,n=parseInt(n[1],16),i===6?rgbn(n):i===3?new Rgb(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):i===8?rgba(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):i===4?rgba(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=reRgbInteger.exec(e))?new Rgb(n[1],n[2],n[3],1):(n=reRgbPercent.exec(e))?new Rgb(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=reRgbaInteger.exec(e))?rgba(n[1],n[2],n[3],n[4]):(n=reRgbaPercent.exec(e))?rgba(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=reHslPercent.exec(e))?hsla(n[1],n[2]/100,n[3]/100,1):(n=reHslaPercent.exec(e))?hsla(n[1],n[2]/100,n[3]/100,n[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,n,i,r){return r<=0&&(e=n=i=NaN),new Rgb(e,n,i,r)}function rgbConvert(e){return e instanceof Color||(e=color$3(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb$1(e,n,i,r){return arguments.length===1?rgbConvert(e):new Rgb(e,n,i,r??1)}function Rgb(e,n,i,r){this.r=+e,this.g=+n,this.b=+i,this.opacity=+r}define(Rgb,rgb$1,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,n,i,r){return r<=0?e=n=i=NaN:i<=0||i>=1?e=n=NaN:n<=0&&(e=NaN),new Hsl(e,n,i,r)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color$3(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var n=e.r/255,i=e.g/255,r=e.b/255,s=Math.min(n,i,r),o=Math.max(n,i,r),l=NaN,f=o-s,d=(o+s)/2;return f?(n===o?l=(i-r)/f+(i<r)*6:i===o?l=(r-n)/f+2:l=(n-i)/f+4,f/=d<.5?o+s:2-o-s,l*=60):f=d>0&&d<1?0:l,new Hsl(l,f,d,e.opacity)}function hsl$2(e,n,i,r){return arguments.length===1?hslConvert(e):new Hsl(e,n,i,r??1)}function Hsl(e,n,i,r){this.h=+e,this.s=+n,this.l=+i,this.opacity=+r}define(Hsl,hsl$2,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*n,s=2*i-r;return new Rgb(hsl2rgb(e>=240?e-240:e+120,s,r),hsl2rgb(e,s,r),hsl2rgb(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,n,i){return(e<60?n+(i-n)*e/60:e<180?i:e<240?n+(i-n)*(240-e)/60:n)*255}const radians$1=Math.PI/180,degrees$2=180/Math.PI,K=18,Xn=.96422,Yn=1,Zn=.82521,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;function labConvert(e){if(e instanceof Lab)return new Lab(e.l,e.a,e.b,e.opacity);if(e instanceof Hcl)return hcl2lab(e);e instanceof Rgb||(e=rgbConvert(e));var n=rgb2lrgb(e.r),i=rgb2lrgb(e.g),r=rgb2lrgb(e.b),s=xyz2lab((.2225045*n+.7168786*i+.0606169*r)/Yn),o,l;return n===i&&i===r?o=l=s:(o=xyz2lab((.4360747*n+.3850649*i+.1430804*r)/Xn),l=xyz2lab((.0139322*n+.0971045*i+.7141733*r)/Zn)),new Lab(116*s-16,500*(o-s),200*(s-l),e.opacity)}function lab$1(e,n,i,r){return arguments.length===1?labConvert(e):new Lab(e,n,i,r??1)}function Lab(e,n,i,r){this.l=+e,this.a=+n,this.b=+i,this.opacity=+r}define(Lab,lab$1,extend(Color,{brighter(e){return new Lab(this.l+K*(e??1),this.a,this.b,this.opacity)},darker(e){return new Lab(this.l-K*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,n=isNaN(this.a)?e:e+this.a/500,i=isNaN(this.b)?e:e-this.b/200;return n=Xn*lab2xyz(n),e=Yn*lab2xyz(e),i=Zn*lab2xyz(i),new Rgb(lrgb2rgb(3.1338561*n-1.6168667*e-.4906146*i),lrgb2rgb(-.9787684*n+1.9161415*e+.033454*i),lrgb2rgb(.0719453*n-.2289914*e+1.4052427*i),this.opacity)}}));function xyz2lab(e){return e>t3?Math.pow(e,1/3):e/t2+t0}function lab2xyz(e){return e>t1?e*e*e:t2*(e-t0)}function lrgb2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function rgb2lrgb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function hclConvert(e){if(e instanceof Hcl)return new Hcl(e.h,e.c,e.l,e.opacity);if(e instanceof Lab||(e=labConvert(e)),e.a===0&&e.b===0)return new Hcl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var n=Math.atan2(e.b,e.a)*degrees$2;return new Hcl(n<0?n+360:n,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hcl$2(e,n,i,r){return arguments.length===1?hclConvert(e):new Hcl(e,n,i,r??1)}function Hcl(e,n,i,r){this.h=+e,this.c=+n,this.l=+i,this.opacity=+r}function hcl2lab(e){if(isNaN(e.h))return new Lab(e.l,0,0,e.opacity);var n=e.h*radians$1;return new Lab(e.l,Math.cos(n)*e.c,Math.sin(n)*e.c,e.opacity)}define(Hcl,hcl$2,extend(Color,{brighter(e){return new Hcl(this.h,this.c,this.l+K*(e??1),this.opacity)},darker(e){return new Hcl(this.h,this.c,this.l-K*(e??1),this.opacity)},rgb(){return hcl2lab(this).rgb()}}));var A=-.14861,B$1=1.78277,C$1=-.29227,D$1=-.90649,E=1.97294,ED=E*D$1,EB=E*B$1,BC_DA=B$1*C$1-D$1*A;function cubehelixConvert(e){if(e instanceof Cubehelix)return new Cubehelix(e.h,e.s,e.l,e.opacity);e instanceof Rgb||(e=rgbConvert(e));var n=e.r/255,i=e.g/255,r=e.b/255,s=(BC_DA*r+ED*n-EB*i)/(BC_DA+ED-EB),o=r-s,l=(E*(i-s)-C$1*o)/D$1,f=Math.sqrt(l*l+o*o)/(E*s*(1-s)),d=f?Math.atan2(l,o)*degrees$2-120:NaN;return new Cubehelix(d<0?d+360:d,f,s,e.opacity)}function cubehelix$2(e,n,i,r){return arguments.length===1?cubehelixConvert(e):new Cubehelix(e,n,i,r??1)}function Cubehelix(e,n,i,r){this.h=+e,this.s=+n,this.l=+i,this.opacity=+r}define(Cubehelix,cubehelix$2,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*radians$1,n=+this.l,i=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(e),s=Math.sin(e);return new Rgb(255*(n+i*(A*r+B$1*s)),255*(n+i*(C$1*r+D$1*s)),255*(n+i*(E*r)),this.opacity)}}));function basis(e,n,i,r,s){var o=e*e,l=o*e;return((1-3*e+3*o-l)*n+(4-6*o+3*l)*i+(1+3*e+3*o-3*l)*r+l*s)/6}function basis$1(e){var n=e.length-1;return function(i){var r=i<=0?i=0:i>=1?(i=1,n-1):Math.floor(i*n),s=e[r],o=e[r+1],l=r>0?e[r-1]:2*s-o,f=r<n-1?e[r+2]:2*o-s;return basis((i-r/n)*n,l,s,o,f)}}function basisClosed(e){var n=e.length;return function(i){var r=Math.floor(((i%=1)<0?++i:i)*n),s=e[(r+n-1)%n],o=e[r%n],l=e[(r+1)%n],f=e[(r+2)%n];return basis((i-r/n)*n,s,o,l,f)}}const constant$2=e=>()=>e;function linear$1(e,n){return function(i){return e+i*n}}function exponential(e,n,i){return e=Math.pow(e,i),n=Math.pow(n,i)-e,i=1/i,function(r){return Math.pow(e+r*n,i)}}function hue$1(e,n){var i=n-e;return i?linear$1(e,i>180||i<-180?i-360*Math.round(i/360):i):constant$2(isNaN(e)?n:e)}function gamma(e){return(e=+e)==1?nogamma:function(n,i){return i-n?exponential(n,i,e):constant$2(isNaN(n)?i:n)}}function nogamma(e,n){var i=n-e;return i?linear$1(e,i):constant$2(isNaN(e)?n:e)}const rgb=function e(n){var i=gamma(n);function r(s,o){var l=i((s=rgb$1(s)).r,(o=rgb$1(o)).r),f=i(s.g,o.g),d=i(s.b,o.b),p=nogamma(s.opacity,o.opacity);return function(g){return s.r=l(g),s.g=f(g),s.b=d(g),s.opacity=p(g),s+""}}return r.gamma=e,r}(1);function rgbSpline(e){return function(n){var i=n.length,r=new Array(i),s=new Array(i),o=new Array(i),l,f;for(l=0;l<i;++l)f=rgb$1(n[l]),r[l]=f.r||0,s[l]=f.g||0,o[l]=f.b||0;return r=e(r),s=e(s),o=e(o),f.opacity=1,function(d){return f.r=r(d),f.g=s(d),f.b=o(d),f+""}}}var rgbBasis=rgbSpline(basis$1),rgbBasisClosed=rgbSpline(basisClosed);function numberArray(e,n){n||(n=[]);var i=e?Math.min(n.length,e.length):0,r=n.slice(),s;return function(o){for(s=0;s<i;++s)r[s]=e[s]*(1-o)+n[s]*o;return r}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function array$3(e,n){return(isNumberArray(n)?numberArray:genericArray)(e,n)}function genericArray(e,n){var i=n?n.length:0,r=e?Math.min(i,e.length):0,s=new Array(r),o=new Array(i),l;for(l=0;l<r;++l)s[l]=interpolate$1$1(e[l],n[l]);for(;l<i;++l)o[l]=n[l];return function(f){for(l=0;l<r;++l)o[l]=s[l](f);return o}}function date$1(e,n){var i=new Date;return e=+e,n=+n,function(r){return i.setTime(e*(1-r)+n*r),i}}function interpolateNumber(e,n){return e=+e,n=+n,function(i){return e*(1-i)+n*i}}function object(e,n){var i={},r={},s;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(s in n)s in e?i[s]=interpolate$1$1(e[s],n[s]):r[s]=n[s];return function(o){for(s in i)r[s]=i[s](o);return r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero$2(e){return function(){return e}}function one$1(e){return function(n){return e(n)+""}}function string(e,n){var i=reA.lastIndex=reB.lastIndex=0,r,s,o,l=-1,f=[],d=[];for(e=e+"",n=n+"";(r=reA.exec(e))&&(s=reB.exec(n));)(o=s.index)>i&&(o=n.slice(i,o),f[l]?f[l]+=o:f[++l]=o),(r=r[0])===(s=s[0])?f[l]?f[l]+=s:f[++l]=s:(f[++l]=null,d.push({i:l,x:interpolateNumber(r,s)})),i=reB.lastIndex;return i<n.length&&(o=n.slice(i),f[l]?f[l]+=o:f[++l]=o),f.length<2?d[0]?one$1(d[0].x):zero$2(n):(n=d.length,function(p){for(var g=0,v;g<n;++g)f[(v=d[g]).i]=v.x(p);return f.join("")})}function interpolate$1$1(e,n){var i=typeof n,r;return n==null||i==="boolean"?constant$2(n):(i==="number"?interpolateNumber:i==="string"?(r=color$3(n))?(n=r,rgb):string:n instanceof color$3?rgb:n instanceof Date?date$1:isNumberArray(n)?numberArray:Array.isArray(n)?genericArray:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?object:interpolateNumber)(e,n)}function discrete$1(e){var n=e.length;return function(i){return e[Math.max(0,Math.min(n-1,Math.floor(i*n)))]}}function hue(e,n){var i=hue$1(+e,+n);return function(r){var s=i(r);return s-360*Math.floor(s/360)}}function interpolateRound(e,n){return e=+e,n=+n,function(i){return Math.round(e*(1-i)+n*i)}}var degrees$1=180/Math.PI,identity$3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(e,n,i,r,s,o){var l,f,d;return(l=Math.sqrt(e*e+n*n))&&(e/=l,n/=l),(d=e*i+n*r)&&(i-=e*d,r-=n*d),(f=Math.sqrt(i*i+r*r))&&(i/=f,r/=f,d/=f),e*r<n*i&&(e=-e,n=-n,d=-d,l=-l),{translateX:s,translateY:o,rotate:Math.atan2(n,e)*degrees$1,skewX:Math.atan(d)*degrees$1,scaleX:l,scaleY:f}}var svgNode;function parseCss(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?identity$3:decompose(n.a,n.b,n.c,n.d,n.e,n.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$3:(e=e.matrix,decompose(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,n,i,r){function s(p){return p.length?p.pop()+" ":""}function o(p,g,v,S,T,k){if(p!==v||g!==S){var O=T.push("translate(",null,n,null,i);k.push({i:O-4,x:interpolateNumber(p,v)},{i:O-2,x:interpolateNumber(g,S)})}else(v||S)&&T.push("translate("+v+n+S+i)}function l(p,g,v,S){p!==g?(p-g>180?g+=360:g-p>180&&(p+=360),S.push({i:v.push(s(v)+"rotate(",null,r)-2,x:interpolateNumber(p,g)})):g&&v.push(s(v)+"rotate("+g+r)}function f(p,g,v,S){p!==g?S.push({i:v.push(s(v)+"skewX(",null,r)-2,x:interpolateNumber(p,g)}):g&&v.push(s(v)+"skewX("+g+r)}function d(p,g,v,S,T,k){if(p!==v||g!==S){var O=T.push(s(T)+"scale(",null,",",null,")");k.push({i:O-4,x:interpolateNumber(p,v)},{i:O-2,x:interpolateNumber(g,S)})}else(v!==1||S!==1)&&T.push(s(T)+"scale("+v+","+S+")")}return function(p,g){var v=[],S=[];return p=e(p),g=e(g),o(p.translateX,p.translateY,g.translateX,g.translateY,v,S),l(p.rotate,g.rotate,v,S),f(p.skewX,g.skewX,v,S),d(p.scaleX,p.scaleY,g.scaleX,g.scaleY,v,S),p=g=null,function(T){for(var k=-1,O=S.length,R;++k<O;)v[(R=S[k]).i]=R.x(T);return v.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2$1=1e-12;function cosh(e){return((e=Math.exp(e))+1/e)/2}function sinh(e){return((e=Math.exp(e))-1/e)/2}function tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}const zoom$1=function e(n,i,r){function s(o,l){var f=o[0],d=o[1],p=o[2],g=l[0],v=l[1],S=l[2],T=g-f,k=v-d,O=T*T+k*k,R,P;if(O<epsilon2$1)P=Math.log(S/p)/n,R=function(z){return[f+z*T,d+z*k,p*Math.exp(n*z*P)]};else{var F=Math.sqrt(O),I=(S*S-p*p+r*O)/(2*p*i*F),L=(S*S-p*p-r*O)/(2*S*i*F),N=Math.log(Math.sqrt(I*I+1)-I),j=Math.log(Math.sqrt(L*L+1)-L);P=(j-N)/n,R=function(z){var q=z*P,H=cosh(N),W=p/(i*F)*(H*tanh(n*q+N)-sinh(N));return[f+W*T,d+W*k,p*H/cosh(n*q+N)]}}return R.duration=P*1e3*n/Math.SQRT2,R}return s.rho=function(o){var l=Math.max(.001,+o),f=l*l,d=f*f;return e(l,f,d)},s}(Math.SQRT2,2,4);function hsl(e){return function(n,i){var r=e((n=hsl$2(n)).h,(i=hsl$2(i)).h),s=nogamma(n.s,i.s),o=nogamma(n.l,i.l),l=nogamma(n.opacity,i.opacity);return function(f){return n.h=r(f),n.s=s(f),n.l=o(f),n.opacity=l(f),n+""}}}const hsl$1=hsl(hue$1);var hslLong=hsl(nogamma);function lab(e,n){var i=nogamma((e=lab$1(e)).l,(n=lab$1(n)).l),r=nogamma(e.a,n.a),s=nogamma(e.b,n.b),o=nogamma(e.opacity,n.opacity);return function(l){return e.l=i(l),e.a=r(l),e.b=s(l),e.opacity=o(l),e+""}}function hcl(e){return function(n,i){var r=e((n=hcl$2(n)).h,(i=hcl$2(i)).h),s=nogamma(n.c,i.c),o=nogamma(n.l,i.l),l=nogamma(n.opacity,i.opacity);return function(f){return n.h=r(f),n.c=s(f),n.l=o(f),n.opacity=l(f),n+""}}}const hcl$1=hcl(hue$1);var hclLong=hcl(nogamma);function cubehelix(e){return function n(i){i=+i;function r(s,o){var l=e((s=cubehelix$2(s)).h,(o=cubehelix$2(o)).h),f=nogamma(s.s,o.s),d=nogamma(s.l,o.l),p=nogamma(s.opacity,o.opacity);return function(g){return s.h=l(g),s.s=f(g),s.l=d(Math.pow(g,i)),s.opacity=p(g),s+""}}return r.gamma=n,r}(1)}const cubehelix$1=cubehelix(hue$1);var cubehelixLong=cubehelix(nogamma);function piecewise(e,n){n===void 0&&(n=e,e=interpolate$1$1);for(var i=0,r=n.length-1,s=n[0],o=new Array(r<0?0:r);i<r;)o[i]=e(s,s=n[++i]);return function(l){var f=Math.max(0,Math.min(r-1,Math.floor(l*=r)));return o[f](l-f)}}function quantize$2(e,n){for(var i=new Array(n),r=0;r<n;++r)i[r]=e(r/(n-1));return i}const $$1=Object.freeze(Object.defineProperty({__proto__:null,interpolate:interpolate$1$1,interpolateArray:array$3,interpolateBasis:basis$1,interpolateBasisClosed:basisClosed,interpolateCubehelix:cubehelix$1,interpolateCubehelixLong:cubehelixLong,interpolateDate:date$1,interpolateDiscrete:discrete$1,interpolateHcl:hcl$1,interpolateHclLong:hclLong,interpolateHsl:hsl$1,interpolateHslLong:hslLong,interpolateHue:hue,interpolateLab:lab,interpolateNumber,interpolateNumberArray:numberArray,interpolateObject:object,interpolateRgb:rgb,interpolateRgbBasis:rgbBasis,interpolateRgbBasisClosed:rgbBasisClosed,interpolateRound,interpolateString:string,interpolateTransformCss,interpolateTransformSvg,interpolateZoom:zoom$1,piecewise,quantize:quantize$2},Symbol.toStringTag,{value:"Module"}));function constants$1(e){return function(){return e}}function number$5(e){return+e}var unit=[0,1];function identity$2(e){return e}function normalize$2(e,n){return(n-=e=+e)?function(i){return(i-e)/n}:constants$1(isNaN(n)?NaN:.5)}function clamper(e,n){var i;return e>n&&(i=e,e=n,n=i),function(r){return Math.max(e,Math.min(n,r))}}function bimap(e,n,i){var r=e[0],s=e[1],o=n[0],l=n[1];return s<r?(r=normalize$2(s,r),o=i(l,o)):(r=normalize$2(r,s),o=i(o,l)),function(f){return o(r(f))}}function polymap(e,n,i){var r=Math.min(e.length,n.length)-1,s=new Array(r),o=new Array(r),l=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++l<r;)s[l]=normalize$2(e[l],e[l+1]),o[l]=i(n[l],n[l+1]);return function(f){var d=bisect$1(e,f,1,r)-1;return o[d](s[d](f))}}function copy$2(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function transformer$3(){var e=unit,n=unit,i=interpolate$1$1,r,s,o,l=identity$2,f,d,p;function g(){var S=Math.min(e.length,n.length);return l!==identity$2&&(l=clamper(e[0],e[S-1])),f=S>2?polymap:bimap,d=p=null,v}function v(S){return S==null||isNaN(S=+S)?o:(d||(d=f(e.map(r),n,i)))(r(l(S)))}return v.invert=function(S){return l(s((p||(p=f(n,e.map(r),interpolateNumber)))(S)))},v.domain=function(S){return arguments.length?(e=Array.from(S,number$5),g()):e.slice()},v.range=function(S){return arguments.length?(n=Array.from(S),g()):n.slice()},v.rangeRound=function(S){return n=Array.from(S),i=interpolateRound,g()},v.clamp=function(S){return arguments.length?(l=S?!0:identity$2,g()):l!==identity$2},v.interpolate=function(S){return arguments.length?(i=S,g()):i},v.unknown=function(S){return arguments.length?(o=S,v):o},function(S,T){return r=S,s=T,g()}}function continuous$1(){return transformer$3()(identity$2,identity$2)}function tickFormat$1(e,n,i,r){var s=tickStep(e,n,i),o;switch(r=formatSpecifier(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(n));return r.precision==null&&!isNaN(o=precisionPrefix(s,l))&&(r.precision=o),formatPrefix(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=precisionRound(s,Math.max(Math.abs(e),Math.abs(n))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=precisionFixed(s))&&(r.precision=o-(r.type==="%")*2);break}}return format$3(r)}function linearish(e){var n=e.domain;return e.ticks=function(i){var r=n();return ticks(r[0],r[r.length-1],i??10)},e.tickFormat=function(i,r){var s=n();return tickFormat$1(s[0],s[s.length-1],i??10,r)},e.nice=function(i){i==null&&(i=10);var r=n(),s=0,o=r.length-1,l=r[s],f=r[o],d,p,g=10;for(f<l&&(p=l,l=f,f=p,p=s,s=o,o=p);g-- >0;){if(p=tickIncrement(l,f,i),p===d)return r[s]=l,r[o]=f,n(r);if(p>0)l=Math.floor(l/p)*p,f=Math.ceil(f/p)*p;else if(p<0)l=Math.ceil(l*p)/p,f=Math.floor(f*p)/p;else break;d=p}return e},e}function linear(){var e=continuous$1();return e.copy=function(){return copy$2(e,linear())},initRange.apply(e,arguments),linearish(e)}function identity$1(e){var n;function i(r){return r==null||isNaN(r=+r)?n:r}return i.invert=i,i.domain=i.range=function(r){return arguments.length?(e=Array.from(r,number$5),i):e.slice()},i.unknown=function(r){return arguments.length?(n=r,i):n},i.copy=function(){return identity$1(e).unknown(n)},e=arguments.length?Array.from(e,number$5):[0,1],linearish(i)}function nice$1(e,n){e=e.slice();var i=0,r=e.length-1,s=e[i],o=e[r],l;return o<s&&(l=i,i=r,r=l,l=s,s=o,o=l),e[i]=n.floor(s),e[r]=n.ceil(o),e}function transformLog(e){return Math.log(e)}function transformExp(e){return Math.exp(e)}function transformLogn(e){return-Math.log(-e)}function transformExpn(e){return-Math.exp(-e)}function pow10(e){return isFinite(e)?+("1e"+e):e<0?0:e}function powp(e){return e===10?pow10:e===Math.E?Math.exp:n=>Math.pow(e,n)}function logp(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),n=>Math.log(n)/e)}function reflect(e){return(n,i)=>-e(-n,i)}function loggish(e){const n=e(transformLog,transformExp),i=n.domain;let r=10,s,o;function l(){return s=logp(r),o=powp(r),i()[0]<0?(s=reflect(s),o=reflect(o),e(transformLogn,transformExpn)):e(transformLog,transformExp),n}return n.base=function(f){return arguments.length?(r=+f,l()):r},n.domain=function(f){return arguments.length?(i(f),l()):i()},n.ticks=f=>{const d=i();let p=d[0],g=d[d.length-1];const v=g<p;v&&([p,g]=[g,p]);let S=s(p),T=s(g),k,O;const R=f==null?10:+f;let P=[];if(!(r%1)&&T-S<R){if(S=Math.floor(S),T=Math.ceil(T),p>0){for(;S<=T;++S)for(k=1;k<r;++k)if(O=S<0?k/o(-S):k*o(S),!(O<p)){if(O>g)break;P.push(O)}}else for(;S<=T;++S)for(k=r-1;k>=1;--k)if(O=S>0?k/o(-S):k*o(S),!(O<p)){if(O>g)break;P.push(O)}P.length*2<R&&(P=ticks(p,g,R))}else P=ticks(S,T,Math.min(T-S,R)).map(o);return v?P.reverse():P},n.tickFormat=(f,d)=>{if(f==null&&(f=10),d==null&&(d=r===10?"s":","),typeof d!="function"&&(!(r%1)&&(d=formatSpecifier(d)).precision==null&&(d.trim=!0),d=format$3(d)),f===1/0)return d;const p=Math.max(1,r*f/n.ticks().length);return g=>{let v=g/o(Math.round(s(g)));return v*r<r-.5&&(v*=r),v<=p?d(g):""}},n.nice=()=>i(nice$1(i(),{floor:f=>o(Math.floor(s(f))),ceil:f=>o(Math.ceil(s(f)))})),n}function log$2(){const e=loggish(transformer$3()).domain([1,10]);return e.copy=()=>copy$2(e,log$2()).base(e.base()),initRange.apply(e,arguments),e}function transformSymlog(e){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/e))}}function transformSymexp(e){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*e}}function symlogish(e){var n=1,i=e(transformSymlog(n),transformSymexp(n));return i.constant=function(r){return arguments.length?e(transformSymlog(n=+r),transformSymexp(n)):n},linearish(i)}function symlog(){var e=symlogish(transformer$3());return e.copy=function(){return copy$2(e,symlog()).constant(e.constant())},initRange.apply(e,arguments)}function transformPow(e){return function(n){return n<0?-Math.pow(-n,e):Math.pow(n,e)}}function transformSqrt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function transformSquare(e){return e<0?-e*e:e*e}function powish(e){var n=e(identity$2,identity$2),i=1;function r(){return i===1?e(identity$2,identity$2):i===.5?e(transformSqrt,transformSquare):e(transformPow(i),transformPow(1/i))}return n.exponent=function(s){return arguments.length?(i=+s,r()):i},linearish(n)}function pow$2(){var e=powish(transformer$3());return e.copy=function(){return copy$2(e,pow$2()).exponent(e.exponent())},initRange.apply(e,arguments),e}function sqrt$2(){return pow$2.apply(null,arguments).exponent(.5)}function quantile(){var e=[],n=[],i=[],r;function s(){var l=0,f=Math.max(1,n.length);for(i=new Array(f-1);++l<f;)i[l-1]=quantileSorted(e,l/f);return o}function o(l){return l==null||isNaN(l=+l)?r:n[bisect$1(i,l)]}return o.invertExtent=function(l){var f=n.indexOf(l);return f<0?[NaN,NaN]:[f>0?i[f-1]:e[0],f<i.length?i[f]:e[e.length-1]]},o.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let f of l)f!=null&&!isNaN(f=+f)&&e.push(f);return e.sort(ascending$2),s()},o.range=function(l){return arguments.length?(n=Array.from(l),s()):n.slice()},o.unknown=function(l){return arguments.length?(r=l,o):r},o.quantiles=function(){return i.slice()},o.copy=function(){return quantile().domain(e).range(n).unknown(r)},initRange.apply(o,arguments)}function quantize$1(){var e=0,n=1,i=1,r=[.5],s=[0,1],o;function l(d){return d!=null&&d<=d?s[bisect$1(r,d,0,i)]:o}function f(){var d=-1;for(r=new Array(i);++d<i;)r[d]=((d+1)*n-(d-i)*e)/(i+1);return l}return l.domain=function(d){return arguments.length?([e,n]=d,e=+e,n=+n,f()):[e,n]},l.range=function(d){return arguments.length?(i=(s=Array.from(d)).length-1,f()):s.slice()},l.invertExtent=function(d){var p=s.indexOf(d);return p<0?[NaN,NaN]:p<1?[e,r[0]]:p>=i?[r[i-1],n]:[r[p-1],r[p]]},l.unknown=function(d){return arguments.length&&(o=d),l},l.thresholds=function(){return r.slice()},l.copy=function(){return quantize$1().domain([e,n]).range(s).unknown(o)},initRange.apply(linearish(l),arguments)}function threshold(){var e=[.5],n=[0,1],i,r=1;function s(o){return o!=null&&o<=o?n[bisect$1(e,o,0,r)]:i}return s.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,n.length-1),s):e.slice()},s.range=function(o){return arguments.length?(n=Array.from(o),r=Math.min(e.length,n.length-1),s):n.slice()},s.invertExtent=function(o){var l=n.indexOf(o);return[e[l-1],e[l]]},s.unknown=function(o){return arguments.length?(i=o,s):i},s.copy=function(){return threshold().domain(e).range(n).unknown(i)},initRange.apply(s,arguments)}function date(e){return new Date(e)}function number$4(e){return e instanceof Date?+e:+new Date(+e)}function calendar(e,n,i,r,s,o,l,f,d,p){var g=continuous$1(),v=g.invert,S=g.domain,T=p(".%L"),k=p(":%S"),O=p("%I:%M"),R=p("%I %p"),P=p("%a %d"),F=p("%b %d"),I=p("%B"),L=p("%Y");function N(j){return(d(j)<j?T:f(j)<j?k:l(j)<j?O:o(j)<j?R:r(j)<j?s(j)<j?P:F:i(j)<j?I:L)(j)}return g.invert=function(j){return new Date(v(j))},g.domain=function(j){return arguments.length?S(Array.from(j,number$4)):S().map(date)},g.ticks=function(j){var z=S();return e(z[0],z[z.length-1],j??10)},g.tickFormat=function(j,z){return z==null?N:p(z)},g.nice=function(j){var z=S();return(!j||typeof j.range!="function")&&(j=n(z[0],z[z.length-1],j??10)),j?S(nice$1(z,j)):g},g.copy=function(){return copy$2(g,calendar(e,n,i,r,s,o,l,f,d,p))},g}function time$1(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat$2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat$1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer$2(){var e=0,n=1,i,r,s,o,l=identity$2,f=!1,d;function p(v){return v==null||isNaN(v=+v)?d:l(s===0?.5:(v=(o(v)-i)*s,f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,n]=v,i=o(e=+e),r=o(n=+n),s=i===r?0:1/(r-i),p):[e,n]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(l=v,p):l};function g(v){return function(S){var T,k;return arguments.length?([T,k]=S,l=v(T,k),p):[l(0),l(1)]}}return p.range=g(interpolate$1$1),p.rangeRound=g(interpolateRound),p.unknown=function(v){return arguments.length?(d=v,p):d},function(v){return o=v,i=v(e),r=v(n),s=i===r?0:1/(r-i),p}}function copy$1(e,n){return n.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sequential(){var e=linearish(transformer$2()(identity$2));return e.copy=function(){return copy$1(e,sequential())},initInterpolator.apply(e,arguments)}function sequentialLog(){var e=loggish(transformer$2()).domain([1,10]);return e.copy=function(){return copy$1(e,sequentialLog()).base(e.base())},initInterpolator.apply(e,arguments)}function sequentialSymlog(){var e=symlogish(transformer$2());return e.copy=function(){return copy$1(e,sequentialSymlog()).constant(e.constant())},initInterpolator.apply(e,arguments)}function sequentialPow(){var e=powish(transformer$2());return e.copy=function(){return copy$1(e,sequentialPow()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function transformer$1(){var e=0,n=.5,i=1,r=1,s,o,l,f,d,p=identity$2,g,v=!1,S;function T(O){return isNaN(O=+O)?S:(O=.5+((O=+g(O))-o)*(r*O<r*o?f:d),p(v?Math.max(0,Math.min(1,O)):O))}T.domain=function(O){return arguments.length?([e,n,i]=O,s=g(e=+e),o=g(n=+n),l=g(i=+i),f=s===o?0:.5/(o-s),d=o===l?0:.5/(l-o),r=o<s?-1:1,T):[e,n,i]},T.clamp=function(O){return arguments.length?(v=!!O,T):v},T.interpolator=function(O){return arguments.length?(p=O,T):p};function k(O){return function(R){var P,F,I;return arguments.length?([P,F,I]=R,p=piecewise(O,[P,F,I]),T):[p(0),p(.5),p(1)]}}return T.range=k(interpolate$1$1),T.rangeRound=k(interpolateRound),T.unknown=function(O){return arguments.length?(S=O,T):S},function(O){return g=O,s=O(e),o=O(n),l=O(i),f=s===o?0:.5/(o-s),d=o===l?0:.5/(l-o),r=o<s?-1:1,T}}function diverging(){var e=linearish(transformer$1()(identity$2));return e.copy=function(){return copy$1(e,diverging())},initInterpolator.apply(e,arguments)}function divergingLog(){var e=loggish(transformer$1()).domain([.1,1,10]);return e.copy=function(){return copy$1(e,divergingLog()).base(e.base())},initInterpolator.apply(e,arguments)}function divergingSymlog(){var e=symlogish(transformer$1());return e.copy=function(){return copy$1(e,divergingSymlog()).constant(e.constant())},initInterpolator.apply(e,arguments)}function divergingPow(){var e=powish(transformer$1());return e.copy=function(){return copy$1(e,divergingPow()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}function bandSpace(e,n,i){const r=e-n+i*2;return e?r>0?r:1:0}const Identity="identity",Linear="linear",Log="log",Pow="pow",Sqrt="sqrt",Symlog="symlog",Time="time",UTC="utc",Sequential="sequential",Diverging="diverging",Quantile="quantile",Quantize="quantize",Threshold="threshold",Ordinal="ordinal",Point="point",Band="band",BinOrdinal="bin-ordinal",Continuous="continuous",Discrete$1="discrete",Discretizing="discretizing",Interpolating="interpolating",Temporal="temporal";function invertRange(e){return function(n){let i=n[0],r=n[1],s;return r<i&&(s=i,i=r,r=s),[e.invert(i),e.invert(r)]}}function invertRangeExtent(e){return function(n){const i=e.range();let r=n[0],s=n[1],o=-1,l,f,d,p;for(s<r&&(f=r,r=s,s=f),d=0,p=i.length;d<p;++d)i[d]>=r&&i[d]<=s&&(o<0&&(o=d),l=d);if(!(o<0))return r=e.invertExtent(i[o]),s=e.invertExtent(i[l]),[r[0]===void 0?r[1]:r[0],s[1]===void 0?s[0]:s[1]]}}function band(){const e=ordinal().unknown(void 0),n=e.domain,i=e.range;let r=[0,1],s,o,l=!1,f=0,d=0,p=.5;delete e.unknown;function g(){const v=n().length,S=r[1]<r[0],T=r[1-S],k=bandSpace(v,f,d);let O=r[S-0];s=(T-O)/(k||1),l&&(s=Math.floor(s)),O+=(T-O-s*(v-f))*p,o=s*(1-f),l&&(O=Math.round(O),o=Math.round(o));const R=range$4(v).map(P=>O+s*P);return i(S?R.reverse():R)}return e.domain=function(v){return arguments.length?(n(v),g()):n()},e.range=function(v){return arguments.length?(r=[+v[0],+v[1]],g()):r.slice()},e.rangeRound=function(v){return r=[+v[0],+v[1]],l=!0,g()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(v){return arguments.length?(l=!!v,g()):l},e.padding=function(v){return arguments.length?(d=Math.max(0,Math.min(1,v)),f=d,g()):f},e.paddingInner=function(v){return arguments.length?(f=Math.max(0,Math.min(1,v)),g()):f},e.paddingOuter=function(v){return arguments.length?(d=Math.max(0,Math.min(1,v)),g()):d},e.align=function(v){return arguments.length?(p=Math.max(0,Math.min(1,v)),g()):p},e.invertRange=function(v){if(v[0]==null||v[1]==null)return;const S=r[1]<r[0],T=S?i().reverse():i(),k=T.length-1;let O=+v[0],R=+v[1],P,F,I;if(!(O!==O||R!==R)&&(R<O&&(I=O,O=R,R=I),!(R<T[0]||O>r[1-S])))return P=Math.max(0,bisectRight$1(T,O)-1),F=O===R?P:bisectRight$1(T,R)-1,O-T[P]>o+1e-10&&++P,S&&(I=P,P=k-F,F=k-I),P>F?void 0:n().slice(P,F+1)},e.invert=function(v){const S=e.invertRange([v,v]);return S&&S[0]},e.copy=function(){return band().domain(n()).range(r).round(l).paddingInner(f).paddingOuter(d).align(p)},g()}function pointish(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return pointish(n())},e}function point$3(){return pointish(band().paddingInner(1))}var map=Array.prototype.map;function numbers(e){return map.call(e,toNumber)}const slice$1=Array.prototype.slice;function scaleBinOrdinal(){let e=[],n=[];function i(r){return r==null||r!==r?void 0:n[(bisect$1(e,r)-1)%n.length]}return i.domain=function(r){return arguments.length?(e=numbers(r),i):e.slice()},i.range=function(r){return arguments.length?(n=slice$1.call(r),i):n.slice()},i.tickFormat=function(r,s){return tickFormat$1(e[0],peek$1(e),r??10,s)},i.copy=function(){return scaleBinOrdinal().domain(i.domain()).range(i.range())},i}const scales={};function create$2(e,n,i){const r=function(){const o=n();return o.invertRange||(o.invertRange=o.invert?invertRange(o):o.invertExtent?invertRangeExtent(o):void 0),o.type=e,o};return r.metadata=toSet(array$5(i)),r}function scale$4(e,n,i){return arguments.length>1?(scales[e]=create$2(e,n,i),this):isValidScaleType(e)?scales[e]:void 0}scale$4(Identity,identity$1);scale$4(Linear,linear,Continuous);scale$4(Log,log$2,[Continuous,Log]);scale$4(Pow,pow$2,Continuous);scale$4(Sqrt,sqrt$2,Continuous);scale$4(Symlog,symlog,Continuous);scale$4(Time,time$1,[Continuous,Temporal]);scale$4(UTC,utcTime,[Continuous,Temporal]);scale$4(Sequential,sequential,[Continuous,Interpolating]);scale$4("".concat(Sequential,"-").concat(Linear),sequential,[Continuous,Interpolating]);scale$4("".concat(Sequential,"-").concat(Log),sequentialLog,[Continuous,Interpolating,Log]);scale$4("".concat(Sequential,"-").concat(Pow),sequentialPow,[Continuous,Interpolating]);scale$4("".concat(Sequential,"-").concat(Sqrt),sequentialSqrt,[Continuous,Interpolating]);scale$4("".concat(Sequential,"-").concat(Symlog),sequentialSymlog,[Continuous,Interpolating]);scale$4("".concat(Diverging,"-").concat(Linear),diverging,[Continuous,Interpolating]);scale$4("".concat(Diverging,"-").concat(Log),divergingLog,[Continuous,Interpolating,Log]);scale$4("".concat(Diverging,"-").concat(Pow),divergingPow,[Continuous,Interpolating]);scale$4("".concat(Diverging,"-").concat(Sqrt),divergingSqrt,[Continuous,Interpolating]);scale$4("".concat(Diverging,"-").concat(Symlog),divergingSymlog,[Continuous,Interpolating]);scale$4(Quantile,quantile,[Discretizing,Quantile]);scale$4(Quantize,quantize$1,Discretizing);scale$4(Threshold,threshold,Discretizing);scale$4(BinOrdinal,scaleBinOrdinal,[Discrete$1,Discretizing]);scale$4(Ordinal,ordinal,Discrete$1);scale$4(Band,band,Discrete$1);scale$4(Point,point$3,Discrete$1);function isValidScaleType(e){return has$1(scales,e)}function hasType(e,n){const i=scales[e];return i&&i.metadata[n]}function isContinuous$1(e){return hasType(e,Continuous)}function isDiscrete$2(e){return hasType(e,Discrete$1)}function isDiscretizing$1(e){return hasType(e,Discretizing)}function isLogarithmic(e){return hasType(e,Log)}function isTemporal(e){return hasType(e,Temporal)}function isInterpolating(e){return hasType(e,Interpolating)}function isQuantile$1(e){return hasType(e,Quantile)}const scaleProps=["clamp","base","constant","exponent"];function interpolateRange$1(e,n){const i=n[0],r=peek$1(n)-i;return function(s){return e(i+s*r)}}function interpolateColors(e,n,i){return piecewise(interpolate$1(n||"rgb",i),e)}function quantizeInterpolator(e,n){const i=new Array(n),r=n+1;for(let s=0;s<n;)i[s]=e(++s/r);return i}function scaleFraction(e,n,i){const r=i-n;let s,o,l;return!r||!Number.isFinite(r)?constant$4(.5):(s=(o=e.type).indexOf("-"),o=s<0?o:o.slice(s+1),l=scale$4(o)().domain([n,i]).range([0,1]),scaleProps.forEach(f=>e[f]?l[f](e[f]()):0),l)}function interpolate$1(e,n){const i=$$1[method(e)];return n!=null&&i&&i.gamma?i.gamma(n):i}function method(e){return"interpolate"+e.toLowerCase().split("-").map(n=>n[0].toUpperCase()+n.slice(1)).join("")}const continuous={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},discrete={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function colors(e){const n=e.length/6|0,i=new Array(n);for(let r=0;r<n;)i[r]="#"+e.slice(r*6,++r*6);return i}function apply(e,n){for(const i in e)scheme(i,n(e[i]))}const schemes={};apply(discrete,colors);apply(continuous,e=>interpolateColors(colors(e)));function scheme(e,n){return e=e&&e.toLowerCase(),arguments.length>1?(schemes[e]=n,this):schemes[e]}const SymbolLegend="symbol",DiscreteLegend="discrete",GradientLegend="gradient",defaultFormatter=e=>isArray(e)?e.map(n=>String(n)):String(e),ascending$1=(e,n)=>e[1]-n[1],descending=(e,n)=>n[1]-e[1];function tickCount(e,n,i){let r;return isNumber$1(n)&&(e.bins&&(n=Math.max(n,e.bins.length)),i!=null&&(n=Math.min(n,Math.floor(span(e.domain())/i||1)))),isObject(n)&&(r=n.step,n=n.interval),isString(n)&&(n=e.type===Time?timeInterval(n):e.type==UTC?utcInterval(n):error("Only time and utc scales accept interval strings."),r&&(n=n.every(r))),n}function validTicks(e,n,i){let r=e.range(),s=r[0],o=peek$1(r),l=ascending$1;if(s>o&&(r=o,o=s,s=r,l=descending),s=Math.floor(s),o=Math.ceil(o),n=n.map(f=>[f,e(f)]).filter(f=>s<=f[1]&&f[1]<=o).sort(l).map(f=>f[0]),i>0&&n.length>1){const f=[n[0],peek$1(n)];for(;n.length>i&&n.length>=3;)n=n.filter((d,p)=>!(p%2));n.length<3&&(n=f)}return n}function tickValues(e,n){return e.bins?validTicks(e,e.bins):e.ticks?e.ticks(n):e.domain()}function tickFormat(e,n,i,r,s,o){const l=n.type;let f=defaultFormatter;if(l===Time||s===Time)f=e.timeFormat(r);else if(l===UTC||s===UTC)f=e.utcFormat(r);else if(isLogarithmic(l)){const d=e.formatFloat(r);if(o||n.bins)f=d;else{const p=tickLog(n,i,!1);f=g=>p(g)?d(g):""}}else if(n.tickFormat){const d=n.domain();f=e.formatSpan(d[0],d[d.length-1],i,r)}else r&&(f=e.format(r));return f}function tickLog(e,n,i){const r=tickValues(e,n),s=e.base(),o=Math.log(s),l=Math.max(1,s*n/r.length),f=d=>{let p=d/Math.pow(s,Math.round(Math.log(d)/o));return p*s<s-.5&&(p*=s),p<=l};return i?r.filter(f):f}const symbols$2={[Quantile]:"quantiles",[Quantize]:"thresholds",[Threshold]:"domain"},formats={[Quantile]:"quantiles",[Quantize]:"domain"};function labelValues(e,n){return e.bins?binValues(e.bins):e.type===Log?tickLog(e,n,!0):symbols$2[e.type]?thresholdValues(e[symbols$2[e.type]]()):tickValues(e,n)}function thresholdFormat(e,n,i){const r=n[formats[n.type]](),s=r.length;let o=s>1?r[1]-r[0]:r[0],l;for(l=1;l<s;++l)o=Math.min(o,r[l]-r[l-1]);return e.formatSpan(0,o,3*10,i)}function thresholdValues(e){const n=[-1/0].concat(e);return n.max=1/0,n}function binValues(e){const n=e.slice(0,-1);return n.max=peek$1(e),n}const isDiscreteRange=e=>symbols$2[e.type]||e.bins;function labelFormat(e,n,i,r,s,o,l){const f=formats[n.type]&&o!==Time&&o!==UTC?thresholdFormat(e,n,s):tickFormat(e,n,i,s,o,l);return r===SymbolLegend&&isDiscreteRange(n)?formatRange(f):r===DiscreteLegend?formatDiscrete(f):formatPoint(f)}const formatRange=e=>(n,i,r)=>{const s=get$4(r[i+1],get$4(r.max,1/0)),o=formatValue$1(n,e),l=formatValue$1(s,e);return o&&l?o+"  "+l:l?"< "+l:" "+o},get$4=(e,n)=>e??n,formatDiscrete=e=>(n,i)=>i?e(n):null,formatPoint=e=>n=>e(n),formatValue$1=(e,n)=>Number.isFinite(e)?n(e):null;function labelFraction(e){const n=e.domain(),i=n.length-1;let r=+n[0],s=+peek$1(n),o=s-r;if(e.type===Threshold){const l=i?o/i:.1;r-=l,s+=l,o=s-r}return l=>(l-r)/o}function format$1(e,n,i,r){const s=r||n.type;return isString(i)&&isTemporal(s)&&(i=i.replace(/%a/g,"%A").replace(/%b/g,"%B")),!i&&s===Time?e.timeFormat("%A, %d %B %Y, %X"):!i&&s===UTC?e.utcFormat("%A, %d %B %Y, %X UTC"):labelFormat(e,n,5,null,i,r,!0)}function domainCaption(e,n,i){i=i||{};const r=Math.max(3,i.maxlen||7),s=format$1(e,n,i.format,i.formatType);if(isDiscretizing$1(n.type)){const o=labelValues(n).slice(1).map(s),l=o.length;return"".concat(l," boundar").concat(l===1?"y":"ies",": ").concat(o.join(", "))}else if(isDiscrete$2(n.type)){const o=n.domain(),l=o.length,f=l>r?o.slice(0,r-2).map(s).join(", ")+", ending with "+o.slice(-1).map(s):o.map(s).join(", ");return"".concat(l," value").concat(l===1?"":"s",": ").concat(f)}else{const o=n.domain();return"values from ".concat(s(o[0])," to ").concat(s(peek$1(o)))}}let gradient_id=0;function resetSVGGradientId(){gradient_id=0}const patternPrefix="p_";function isGradient(e){return e&&e.gradient}function gradientRef(e,n,i){const r=e.gradient;let s=e.id,o=r==="radial"?patternPrefix:"";return s||(s=e.id="gradient_"+gradient_id++,r==="radial"?(e.x1=get$3(e.x1,.5),e.y1=get$3(e.y1,.5),e.r1=get$3(e.r1,0),e.x2=get$3(e.x2,.5),e.y2=get$3(e.y2,.5),e.r2=get$3(e.r2,.5),o=patternPrefix):(e.x1=get$3(e.x1,0),e.y1=get$3(e.y1,0),e.x2=get$3(e.x2,1),e.y2=get$3(e.y2,0))),n[s]=e,"url("+(i||"")+"#"+o+s+")"}function get$3(e,n){return e??n}function Gradient$1(e,n){var i=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:n?n[0]:1,y2:n?n[1]:0,stops:i,stop:function(s,o){return i.push({offset:s,color:o}),r}}}const lookup$4={basis:{curve:curveBasis},"basis-closed":{curve:curveBasisClosed},"basis-open":{curve:curveBasisOpen},bundle:{curve:curveBundle,tension:"beta",value:.85},cardinal:{curve:curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:curveLinear},"linear-closed":{curve:curveLinearClosed},monotone:{horizontal:monotoneY,vertical:monotoneX},natural:{curve:curveNatural},step:{curve:curveStep},"step-after":{curve:stepAfter},"step-before":{curve:stepBefore}};function curves(e,n,i){var r=has$1(lookup$4,e)&&lookup$4[e],s=null;return r&&(s=r.curve||r[n||"vertical"],r.tension&&i!=null&&(s=s[r.tension](i))),s}const paramCounts={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},commandPattern=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,numberPattern=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,spacePattern=/^((\s+,?\s*)|(,\s*))/,flagPattern=/^[01]/;function parse$3(e){const n=[];return(e.match(commandPattern)||[]).forEach(r=>{let s=r[0];const o=s.toLowerCase(),l=paramCounts[o],f=parseParams(o,l,r.slice(1).trim()),d=f.length;if(d<l||d&&d%l!==0)throw Error("Invalid SVG path, incorrect parameter count");if(n.push([s,...f.slice(0,l)]),d!==l){o==="m"&&(s=s==="M"?"L":"l");for(let p=l;p<d;p+=l)n.push([s,...f.slice(p,p+l)])}}),n}function parseParams(e,n,i){const r=[];for(let s=0;n&&s<i.length;)for(let o=0;o<n;++o){const l=e==="a"&&(o===3||o===4)?flagPattern:numberPattern,f=i.slice(s).match(l);if(f===null)throw Error("Invalid SVG path, incorrect parameter type");s+=f[0].length,r.push(+f[0]);const d=i.slice(s).match(spacePattern);d!==null&&(s+=d[0].length)}return r}const DegToRad=Math.PI/180,Epsilon=1e-14,HalfPi=Math.PI/2,Tau=Math.PI*2,HalfSqrt3=Math.sqrt(3)/2;var segmentCache={},bezierCache={},join$1=[].join;function segments(e,n,i,r,s,o,l,f,d){const p=join$1.call(arguments);if(segmentCache[p])return segmentCache[p];const g=l*DegToRad,v=Math.sin(g),S=Math.cos(g);i=Math.abs(i),r=Math.abs(r);const T=S*(f-e)*.5+v*(d-n)*.5,k=S*(d-n)*.5-v*(f-e)*.5;let O=T*T/(i*i)+k*k/(r*r);O>1&&(O=Math.sqrt(O),i*=O,r*=O);const R=S/i,P=v/i,F=-v/r,I=S/r,L=R*f+P*d,N=F*f+I*d,j=R*e+P*n,z=F*e+I*n;let H=1/((j-L)*(j-L)+(z-N)*(z-N))-.25;H<0&&(H=0);let W=Math.sqrt(H);o==s&&(W=-W);const U=.5*(L+j)-W*(z-N),Q=.5*(N+z)+W*(j-L),J=Math.atan2(N-Q,L-U);let G=Math.atan2(z-Q,j-U)-J;G<0&&o===1?G+=Tau:G>0&&o===0&&(G-=Tau);const Z=Math.ceil(Math.abs(G/(HalfPi+.001))),ae=[];for(let oe=0;oe<Z;++oe){const pe=J+oe*G/Z,Se=J+(oe+1)*G/Z;ae[oe]=[U,Q,pe,Se,i,r,v,S]}return segmentCache[p]=ae}function bezier(e){const n=join$1.call(e);if(bezierCache[n])return bezierCache[n];var i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],f=e[5],d=e[6],p=e[7];const g=p*l,v=-d*f,S=d*l,T=p*f,k=Math.cos(s),O=Math.sin(s),R=Math.cos(o),P=Math.sin(o),F=.5*(o-s),I=Math.sin(F*.5),L=8/3*I*I/Math.sin(F),N=i+k-L*O,j=r+O+L*k,z=i+R,q=r+P,H=z+L*P,W=q-L*R;return bezierCache[n]=[g*N+v*j,S*N+T*j,g*H+v*W,S*H+T*W,g*z+v*q,S*z+T*q]}const temp=["l",0,0,0,0,0,0,0];function scale$1$1(e,n,i){const r=temp[0]=e[0];if(r==="a"||r==="A")temp[1]=n*e[1],temp[2]=i*e[2],temp[3]=e[3],temp[4]=e[4],temp[5]=e[5],temp[6]=n*e[6],temp[7]=i*e[7];else if(r==="h"||r==="H")temp[1]=n*e[1];else if(r==="v"||r==="V")temp[1]=i*e[1];else for(var s=1,o=e.length;s<o;++s)temp[s]=(s%2==1?n:i)*e[s];return temp}function pathRender(e,n,i,r,s,o){var l,f=null,d=0,p=0,g=0,v=0,S,T,k,O,R=0,P=0;i==null&&(i=0),r==null&&(r=0),s==null&&(s=1),o==null&&(o=s),e.beginPath&&e.beginPath();for(var F=0,I=n.length;F<I;++F){switch(l=n[F],(s!==1||o!==1)&&(l=scale$1$1(l,s,o)),l[0]){case"l":d+=l[1],p+=l[2],e.lineTo(d+i,p+r);break;case"L":d=l[1],p=l[2],e.lineTo(d+i,p+r);break;case"h":d+=l[1],e.lineTo(d+i,p+r);break;case"H":d=l[1],e.lineTo(d+i,p+r);break;case"v":p+=l[1],e.lineTo(d+i,p+r);break;case"V":p=l[1],e.lineTo(d+i,p+r);break;case"m":d+=l[1],p+=l[2],R=d,P=p,e.moveTo(d+i,p+r);break;case"M":d=l[1],p=l[2],R=d,P=p,e.moveTo(d+i,p+r);break;case"c":S=d+l[5],T=p+l[6],g=d+l[3],v=p+l[4],e.bezierCurveTo(d+l[1]+i,p+l[2]+r,g+i,v+r,S+i,T+r),d=S,p=T;break;case"C":d=l[5],p=l[6],g=l[3],v=l[4],e.bezierCurveTo(l[1]+i,l[2]+r,g+i,v+r,d+i,p+r);break;case"s":S=d+l[3],T=p+l[4],g=2*d-g,v=2*p-v,e.bezierCurveTo(g+i,v+r,d+l[1]+i,p+l[2]+r,S+i,T+r),g=d+l[1],v=p+l[2],d=S,p=T;break;case"S":S=l[3],T=l[4],g=2*d-g,v=2*p-v,e.bezierCurveTo(g+i,v+r,l[1]+i,l[2]+r,S+i,T+r),d=S,p=T,g=l[1],v=l[2];break;case"q":S=d+l[3],T=p+l[4],g=d+l[1],v=p+l[2],e.quadraticCurveTo(g+i,v+r,S+i,T+r),d=S,p=T;break;case"Q":S=l[3],T=l[4],e.quadraticCurveTo(l[1]+i,l[2]+r,S+i,T+r),d=S,p=T,g=l[1],v=l[2];break;case"t":S=d+l[1],T=p+l[2],f[0].match(/[QqTt]/)===null?(g=d,v=p):f[0]==="t"?(g=2*d-k,v=2*p-O):f[0]==="q"&&(g=2*d-g,v=2*p-v),k=g,O=v,e.quadraticCurveTo(g+i,v+r,S+i,T+r),d=S,p=T,g=d+l[1],v=p+l[2];break;case"T":S=l[1],T=l[2],g=2*d-g,v=2*p-v,e.quadraticCurveTo(g+i,v+r,S+i,T+r),d=S,p=T;break;case"a":drawArc(e,d+i,p+r,[l[1],l[2],l[3],l[4],l[5],l[6]+d+i,l[7]+p+r]),d+=l[6],p+=l[7];break;case"A":drawArc(e,d+i,p+r,[l[1],l[2],l[3],l[4],l[5],l[6]+i,l[7]+r]),d=l[6],p=l[7];break;case"z":case"Z":d=R,p=P,e.closePath();break}f=l}}function drawArc(e,n,i,r){const s=segments(r[5],r[6],r[0],r[1],r[3],r[4],r[2],n,i);for(let o=0;o<s.length;++o){const l=bezier(s[o]);e.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5])}}const Tan30=.5773502691896257,builtins={circle:{draw:function(e,n){const i=Math.sqrt(n)/2;e.moveTo(i,0),e.arc(0,0,i,0,Tau)}},cross:{draw:function(e,n){var i=Math.sqrt(n)/2,r=i/2.5;e.moveTo(-i,-r),e.lineTo(-i,r),e.lineTo(-r,r),e.lineTo(-r,i),e.lineTo(r,i),e.lineTo(r,r),e.lineTo(i,r),e.lineTo(i,-r),e.lineTo(r,-r),e.lineTo(r,-i),e.lineTo(-r,-i),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,n){const i=Math.sqrt(n)/2;e.moveTo(-i,0),e.lineTo(0,-i),e.lineTo(i,0),e.lineTo(0,i),e.closePath()}},square:{draw:function(e,n){var i=Math.sqrt(n),r=-i/2;e.rect(r,r,i,i)}},arrow:{draw:function(e,n){var i=Math.sqrt(n)/2,r=i/7,s=i/2.5,o=i/8;e.moveTo(-r,i),e.lineTo(r,i),e.lineTo(r,-o),e.lineTo(s,-o),e.lineTo(0,-i),e.lineTo(-s,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,n){var i=Math.sqrt(n)/2,r=HalfSqrt3*i,s=r-i*Tan30,o=i/4;e.moveTo(0,-r-s),e.lineTo(-o,r-s),e.lineTo(o,r-s),e.closePath()}},triangle:{draw:function(e,n){var i=Math.sqrt(n)/2,r=HalfSqrt3*i,s=r-i*Tan30;e.moveTo(0,-r-s),e.lineTo(-i,r-s),e.lineTo(i,r-s),e.closePath()}},"triangle-up":{draw:function(e,n){var i=Math.sqrt(n)/2,r=HalfSqrt3*i;e.moveTo(0,-r),e.lineTo(-i,r),e.lineTo(i,r),e.closePath()}},"triangle-down":{draw:function(e,n){var i=Math.sqrt(n)/2,r=HalfSqrt3*i;e.moveTo(0,r),e.lineTo(-i,-r),e.lineTo(i,-r),e.closePath()}},"triangle-right":{draw:function(e,n){var i=Math.sqrt(n)/2,r=HalfSqrt3*i;e.moveTo(r,0),e.lineTo(-r,-i),e.lineTo(-r,i),e.closePath()}},"triangle-left":{draw:function(e,n){var i=Math.sqrt(n)/2,r=HalfSqrt3*i;e.moveTo(-r,0),e.lineTo(r,-i),e.lineTo(r,i),e.closePath()}},stroke:{draw:function(e,n){const i=Math.sqrt(n)/2;e.moveTo(-i,0),e.lineTo(i,0)}}};function symbols$1(e){return has$1(builtins,e)?builtins[e]:customSymbol(e)}var custom={};function customSymbol(e){if(!has$1(custom,e)){const n=parse$3(e);custom[e]={draw:function(i,r){pathRender(i,n,0,0,Math.sqrt(r)/2)}}}return custom[e]}const C=.448084975506;function rectangleX(e){return e.x}function rectangleY(e){return e.y}function rectangleWidth(e){return e.width}function rectangleHeight(e){return e.height}function number$3(e){return typeof e=="function"?e:()=>+e}function clamp(e,n,i){return Math.max(n,Math.min(e,i))}function vg_rect(){var e=rectangleX,n=rectangleY,i=rectangleWidth,r=rectangleHeight,s=number$3(0),o=s,l=s,f=s,d=null;function p(g,v,S){var T,k=v??+e.call(this,g),O=S??+n.call(this,g),R=+i.call(this,g),P=+r.call(this,g),F=Math.min(R,P)/2,I=clamp(+s.call(this,g),0,F),L=clamp(+o.call(this,g),0,F),N=clamp(+l.call(this,g),0,F),j=clamp(+f.call(this,g),0,F);if(d||(d=T=path$3()),I<=0&&L<=0&&N<=0&&j<=0)d.rect(k,O,R,P);else{var z=k+R,q=O+P;d.moveTo(k+I,O),d.lineTo(z-L,O),d.bezierCurveTo(z-C*L,O,z,O+C*L,z,O+L),d.lineTo(z,q-j),d.bezierCurveTo(z,q-C*j,z-C*j,q,z-j,q),d.lineTo(k+N,q),d.bezierCurveTo(k+C*N,q,k,q-C*N,k,q-N),d.lineTo(k,O+I),d.bezierCurveTo(k,O+C*I,k+C*I,O,k+I,O),d.closePath()}if(T)return d=null,T+""||null}return p.x=function(g){return arguments.length?(e=number$3(g),p):e},p.y=function(g){return arguments.length?(n=number$3(g),p):n},p.width=function(g){return arguments.length?(i=number$3(g),p):i},p.height=function(g){return arguments.length?(r=number$3(g),p):r},p.cornerRadius=function(g,v,S,T){return arguments.length?(s=number$3(g),o=v!=null?number$3(v):s,f=S!=null?number$3(S):s,l=T!=null?number$3(T):o,p):s},p.context=function(g){return arguments.length?(d=g??null,p):d},p}function vg_trail(){var e,n,i,r,s=null,o,l,f,d;function p(v,S,T){const k=T/2;if(o){var O=f-S,R=v-l;if(O||R){var P=Math.sqrt(O*O+R*R),F=(O/=P)*d,I=(R/=P)*d,L=Math.atan2(R,O);s.moveTo(l-F,f-I),s.lineTo(v-O*k,S-R*k),s.arc(v,S,k,L-Math.PI,L),s.lineTo(l+F,f+I),s.arc(l,f,d,L,L+Math.PI)}else s.arc(v,S,k,0,Tau);s.closePath()}else o=1;l=v,f=S,d=k}function g(v){var S,T=v.length,k,O=!1,R;for(s==null&&(s=R=path$3()),S=0;S<=T;++S)!(S<T&&r(k=v[S],S,v))===O&&(O=!O)&&(o=0),O&&p(+e(k,S,v),+n(k,S,v),+i(k,S,v));if(R)return s=null,R+""||null}return g.x=function(v){return arguments.length?(e=v,g):e},g.y=function(v){return arguments.length?(n=v,g):n},g.size=function(v){return arguments.length?(i=v,g):i},g.defined=function(v){return arguments.length?(r=v,g):r},g.context=function(v){return arguments.length?(v==null?s=null:s=v,g):s},g}function value$1(e,n){return e??n}const x$2=e=>e.x||0,y$2=e=>e.y||0,w$1=e=>e.width||0,h=e=>e.height||0,xw=e=>(e.x||0)+(e.width||0),yh=e=>(e.y||0)+(e.height||0),sa=e=>e.startAngle||0,ea=e=>e.endAngle||0,pa=e=>e.padAngle||0,ir=e=>e.innerRadius||0,or=e=>e.outerRadius||0,cr=e=>e.cornerRadius||0,tl=e=>value$1(e.cornerRadiusTopLeft,e.cornerRadius)||0,tr=e=>value$1(e.cornerRadiusTopRight,e.cornerRadius)||0,br=e=>value$1(e.cornerRadiusBottomRight,e.cornerRadius)||0,bl=e=>value$1(e.cornerRadiusBottomLeft,e.cornerRadius)||0,sz=e=>value$1(e.size,64),ts=e=>e.size||1,def=e=>e.defined!==!1,type=e=>symbols$1(e.shape||"circle"),arcShape=arc$2$1().startAngle(sa).endAngle(ea).padAngle(pa).innerRadius(ir).outerRadius(or).cornerRadius(cr),areavShape=area$2$1().x(x$2).y1(y$2).y0(yh).defined(def),areahShape=area$2$1().y(y$2).x1(x$2).x0(xw).defined(def),lineShape=line$2$1().x(x$2).y(y$2).defined(def),rectShape=vg_rect().x(x$2).y(y$2).width(w$1).height(h).cornerRadius(tl,tr,br,bl),symbolShape=Symbol$1().type(type).size(sz),trailShape=vg_trail().x(x$2).y(y$2).defined(def).size(ts);function hasCornerRadius(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function arc$1$1(e,n){return arcShape.context(e)(n)}function area$1$1(e,n){const i=n[0],r=i.interpolate||"linear";return(i.orient==="horizontal"?areahShape:areavShape).curve(curves(r,i.orient,i.tension)).context(e)(n)}function line$1$1(e,n){const i=n[0],r=i.interpolate||"linear";return lineShape.curve(curves(r,i.orient,i.tension)).context(e)(n)}function rectangle(e,n,i,r){return rectShape.context(e)(n,i,r)}function shape$1(e,n){return(n.mark.shape||n.shape).context(e)(n)}function symbol$1(e,n){return symbolShape.context(e)(n)}function trail$1(e,n){return trailShape.context(e)(n)}var clip_id=1;function resetSVGClipId(){clip_id=1}function clip$1$1(e,n,i){var r=n.clip,s=e._defs,o=n.clip_id||(n.clip_id="clip"+clip_id++),l=s.clipping[o]||(s.clipping[o]={id:o});return isFunction(r)?l.path=r(null):hasCornerRadius(i)?l.path=rectangle(null,i,0,0):(l.width=i.width||0,l.height=i.height||0),"url(#"+o+")"}function Bounds(e){this.clear(),e&&this.union(e)}Bounds.prototype={clone(){return new Bounds(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,n,i,r){return i<e?(this.x2=e,this.x1=i):(this.x1=e,this.x2=i),r<n?(this.y2=n,this.y1=r):(this.y1=n,this.y2=r),this},add(e,n){return e<this.x1&&(this.x1=e),n<this.y1&&(this.y1=n),e>this.x2&&(this.x2=e),n>this.y2&&(this.y2=n),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,n){return this.x1+=e,this.x2+=e,this.y1+=n,this.y2+=n,this},rotate(e,n,i){const r=this.rotatedPoints(e,n,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,n,i){var{x1:r,y1:s,x2:o,y2:l}=this,f=Math.cos(e),d=Math.sin(e),p=n-n*f+i*d,g=i-n*d-i*f;return[f*r-d*s+p,d*r+f*s+g,f*r-d*l+p,d*r+f*l+g,f*o-d*s+p,d*o+f*s+g,f*o-d*l+p,d*o+f*l+g]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,n){return!(e<this.x1||e>this.x2||n<this.y1||n>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Item(e){this.mark=e,this.bounds=this.bounds||new Bounds}function GroupItem(e){Item.call(this,e),this.items=this.items||[]}inherits(GroupItem,Item);function ResourceLoader(e){this._pending=0,this._loader=e||loader()}function increment(e){e._pending+=1}function decrement(e){e._pending-=1}ResourceLoader.prototype={pending(){return this._pending},sanitizeURL(e){const n=this;return increment(n),n._loader.sanitize(e,{context:"href"}).then(i=>(decrement(n),i)).catch(()=>(decrement(n),null))},loadImage(e){const n=this,i=domImage();return increment(n),n._loader.sanitize(e,{context:"image"}).then(r=>{const s=r.href;if(!s||!i)throw{url:s};const o=new i,l=has$1(r,"crossOrigin")?r.crossOrigin:"anonymous";return l!=null&&(o.crossOrigin=l),o.onload=()=>decrement(n),o.onerror=()=>decrement(n),o.src=s,o}).catch(r=>(decrement(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(n=>{function i(r){e.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}};function boundStroke(e,n,i){if(n.stroke&&n.opacity!==0&&n.strokeOpacity!==0){const r=n.strokeWidth!=null?+n.strokeWidth:1;e.expand(r+(i?miterAdjustment(n,r):0))}return e}function miterAdjustment(e,n){return e.strokeJoin&&e.strokeJoin!=="miter"?0:n}const circleThreshold=Tau-1e-8;let bounds,lx,ly,rot,ma,mb,mc,md;const add$2=(e,n)=>bounds.add(e,n),addL=(e,n)=>add$2(lx=e,ly=n),addX=e=>add$2(e,bounds.y1),addY=e=>add$2(bounds.x1,e),px=(e,n)=>ma*e+mc*n,py=(e,n)=>mb*e+md*n,addp=(e,n)=>add$2(px(e,n),py(e,n)),addpL=(e,n)=>addL(px(e,n),py(e,n));function boundContext(e,n){return bounds=e,n?(rot=n*DegToRad,ma=md=Math.cos(rot),mb=Math.sin(rot),mc=-mb):(ma=md=1,rot=mb=mc=0),context$1}const context$1={beginPath(){},closePath(){},moveTo:addpL,lineTo:addpL,rect(e,n,i,r){rot?(addp(e+i,n),addp(e+i,n+r),addp(e,n+r),addpL(e,n)):(add$2(e+i,n+r),addL(e,n))},quadraticCurveTo(e,n,i,r){const s=px(e,n),o=py(e,n),l=px(i,r),f=py(i,r);quadExtrema(lx,s,l,addX),quadExtrema(ly,o,f,addY),addL(l,f)},bezierCurveTo(e,n,i,r,s,o){const l=px(e,n),f=py(e,n),d=px(i,r),p=py(i,r),g=px(s,o),v=py(s,o);cubicExtrema(lx,l,d,g,addX),cubicExtrema(ly,f,p,v,addY),addL(g,v)},arc(e,n,i,r,s,o){if(r+=rot,s+=rot,lx=i*Math.cos(s)+e,ly=i*Math.sin(s)+n,Math.abs(s-r)>circleThreshold)add$2(e-i,n-i),add$2(e+i,n+i);else{const l=p=>add$2(i*Math.cos(p)+e,i*Math.sin(p)+n);let f,d;if(l(r),l(s),s!==r)if(r=r%Tau,r<0&&(r+=Tau),s=s%Tau,s<0&&(s+=Tau),s<r&&(o=!o,f=r,r=s,s=f),o)for(s-=Tau,f=r-r%HalfPi,d=0;d<4&&f>s;++d,f-=HalfPi)l(f);else for(f=r-r%HalfPi+HalfPi,d=0;d<4&&f<s;++d,f=f+HalfPi)l(f)}}};function quadExtrema(e,n,i,r){const s=(e-n)/(e+i-2*n);0<s&&s<1&&r(e+(n-e)*s)}function cubicExtrema(e,n,i,r,s){const o=r-e+3*n-3*i,l=e+i-2*n,f=e-n;let d=0,p=0,g;Math.abs(o)>Epsilon?(g=l*l+f*o,g>=0&&(g=Math.sqrt(g),d=(-l+g)/o,p=(-l-g)/o)):d=.5*f/l,0<d&&d<1&&s(cubic(d,e,n,i,r)),0<p&&p<1&&s(cubic(p,e,n,i,r))}function cubic(e,n,i,r,s){const o=1-e,l=o*o,f=e*e;return l*o*n+3*l*e*i+3*o*f*r+f*e*s}var context$2=(context$2=domCanvas(1,1))?context$2.getContext("2d"):null;const b=new Bounds;function intersectPath(e){return function(n,i){if(!context$2)return!0;e(context$2,n),b.clear().union(n.bounds).intersect(i).round();const{x1:r,y1:s,x2:o,y2:l}=b;for(let f=s;f<=l;++f)for(let d=r;d<=o;++d)if(context$2.isPointInPath(d,f))return!0;return!1}}function intersectPoint(e,n){return n.contains(e.x||0,e.y||0)}function intersectRect(e,n){const i=e.x||0,r=e.y||0,s=e.width||0,o=e.height||0;return n.intersects(b.set(i,r,i+s,r+o))}function intersectRule(e,n){const i=e.x||0,r=e.y||0,s=e.x2!=null?e.x2:i,o=e.y2!=null?e.y2:r;return intersectBoxLine(n,i,r,s,o)}function intersectBoxLine(e,n,i,r,s){const{x1:o,y1:l,x2:f,y2:d}=e,p=r-n,g=s-i;let v=0,S=1,T,k,O,R;for(R=0;R<4;++R){if(R===0&&(T=-p,k=-(o-n)),R===1&&(T=p,k=f-n),R===2&&(T=-g,k=-(l-i)),R===3&&(T=g,k=d-i),Math.abs(T)<1e-10&&k<0)return!1;if(O=k/T,T<0){if(O>S)return!1;O>v&&(v=O)}else if(T>0){if(O<v)return!1;O<S&&(S=O)}}return!0}function blend(e,n){e.globalCompositeOperation=n.blend||"source-over"}function value$2(e,n){return e??n}function addStops(e,n){const i=n.length;for(let r=0;r<i;++r)e.addColorStop(n[r].offset,n[r].color);return e}function gradient$2(e,n,i){const r=i.width(),s=i.height();let o;if(n.gradient==="radial")o=e.createRadialGradient(i.x1+value$2(n.x1,.5)*r,i.y1+value$2(n.y1,.5)*s,Math.max(r,s)*value$2(n.r1,0),i.x1+value$2(n.x2,.5)*r,i.y1+value$2(n.y2,.5)*s,Math.max(r,s)*value$2(n.r2,.5));else{const l=value$2(n.x1,0),f=value$2(n.y1,0),d=value$2(n.x2,1),p=value$2(n.y2,0);if(l===d||f===p||r===s)o=e.createLinearGradient(i.x1+l*r,i.y1+f*s,i.x1+d*r,i.y1+p*s);else{const g=domCanvas(Math.ceil(r),Math.ceil(s)),v=g.getContext("2d");return v.scale(r,s),v.fillStyle=addStops(v.createLinearGradient(l,f,d,p),n.stops),v.fillRect(0,0,r,s),e.createPattern(g,"no-repeat")}}return addStops(o,n.stops)}function color$2(e,n,i){return isGradient(i)?gradient$2(e,i,n.bounds):i}function fill(e,n,i){return i*=n.fillOpacity==null?1:n.fillOpacity,i>0?(e.globalAlpha=i,e.fillStyle=color$2(e,n,n.fill),!0):!1}var Empty=[];function stroke(e,n,i){var r=(r=n.strokeWidth)!=null?r:1;return r<=0?!1:(i*=n.strokeOpacity==null?1:n.strokeOpacity,i>0?(e.globalAlpha=i,e.strokeStyle=color$2(e,n,n.stroke),e.lineWidth=r,e.lineCap=n.strokeCap||"butt",e.lineJoin=n.strokeJoin||"miter",e.miterLimit=n.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(n.strokeDash||Empty),e.lineDashOffset=n.strokeDashOffset||0),!0):!1)}function compare$7(e,n){return e.zindex-n.zindex||e.index-n.index}function zorder(e){if(!e.zdirty)return e.zitems;var n=e.items,i=[],r,s,o;for(s=0,o=n.length;s<o;++s)r=n[s],r.index=s,r.zindex&&i.push(r);return e.zdirty=!1,e.zitems=i.sort(compare$7)}function visit(e,n){var i=e.items,r,s;if(!i||!i.length)return;const o=zorder(e);if(o&&o.length){for(r=0,s=i.length;r<s;++r)i[r].zindex||n(i[r]);i=o}for(r=0,s=i.length;r<s;++r)n(i[r])}function pickVisit(e,n){var i=e.items,r,s;if(!i||!i.length)return null;const o=zorder(e);for(o&&o.length&&(i=o),s=i.length;--s>=0;)if(r=n(i[s]))return r;if(i===o){for(i=e.items,s=i.length;--s>=0;)if(!i[s].zindex&&(r=n(i[s])))return r}return null}function drawAll(e){return function(n,i,r){visit(i,s=>{(!r||r.intersects(s.bounds))&&drawPath(e,n,s,s)})}}function drawOne(e){return function(n,i,r){i.items.length&&(!r||r.intersects(i.bounds))&&drawPath(e,n,i.items[0],i.items)}}function drawPath(e,n,i,r){var s=i.opacity==null?1:i.opacity;s!==0&&(e(n,r)||(blend(n,i),i.fill&&fill(n,i,s)&&n.fill(),i.stroke&&stroke(n,i,s)&&n.stroke()))}function pick$1(e){return e=e||truthy,function(n,i,r,s,o,l){return r*=n.pixelRatio,s*=n.pixelRatio,pickVisit(i,f=>{const d=f.bounds;if(!(d&&!d.contains(o,l)||!d)&&e(n,f,r,s,o,l))return f})}}function hitPath(e,n){return function(i,r,s,o){var l=Array.isArray(r)?r[0]:r,f=n??l.fill,d=l.stroke&&i.isPointInStroke,p,g;return d&&(p=l.strokeWidth,g=l.strokeCap,i.lineWidth=p??1,i.lineCap=g??"butt"),e(i,r)?!1:f&&i.isPointInPath(s,o)||d&&i.isPointInStroke(s,o)}}function pickPath(e){return pick$1(hitPath(e))}function translate$2(e,n){return"translate("+e+","+n+")"}function rotate(e){return"rotate("+e+")"}function scale$3(e,n){return"scale("+e+","+n+")"}function translateItem(e){return translate$2(e.x||0,e.y||0)}function rotateItem(e){return translate$2(e.x||0,e.y||0)+(e.angle?" "+rotate(e.angle):"")}function transformItem(e){return translate$2(e.x||0,e.y||0)+(e.angle?" "+rotate(e.angle):"")+(e.scaleX||e.scaleY?" "+scale$3(e.scaleX||1,e.scaleY||1):"")}function markItemPath(e,n,i){function r(l,f){l("transform",rotateItem(f)),l("d",n(null,f))}function s(l,f){return n(boundContext(l,f.angle),f),boundStroke(l,f).translate(f.x||0,f.y||0)}function o(l,f){var d=f.x||0,p=f.y||0,g=f.angle||0;l.translate(d,p),g&&l.rotate(g*=DegToRad),l.beginPath(),n(l,f),g&&l.rotate(-g),l.translate(-d,-p)}return{type:e,tag:"path",nested:!1,attr:r,bound:s,draw:drawAll(o),pick:pickPath(o),isect:i||intersectPath(o)}}var arc$2=markItemPath("arc",arc$1$1);function pickArea(e,n){for(var i=e[0].orient==="horizontal"?n[1]:n[0],r=e[0].orient==="horizontal"?"y":"x",s=e.length,o=1/0,l,f;--s>=0;)e[s].defined!==!1&&(f=Math.abs(e[s][r]-i),f<o&&(o=f,l=e[s]));return l}function pickLine(e,n){for(var i=Math.pow(e[0].strokeWidth||1,2),r=e.length,s,o,l;--r>=0;)if(e[r].defined!==!1&&(s=e[r].x-n[0],o=e[r].y-n[1],l=s*s+o*o,l<i))return e[r];return null}function pickTrail(e,n){for(var i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-n[0],s=e[i].y-n[1],o=r*r+s*s,r=e[i].size||1,o<r*r))return e[i];return null}function markMultiItemPath(e,n,i){function r(d,p){var g=p.mark.items;g.length&&d("d",n(null,g))}function s(d,p){var g=p.items;return g.length===0?d:(n(boundContext(d),g),boundStroke(d,g[0]))}function o(d,p){d.beginPath(),n(d,p)}const l=hitPath(o);function f(d,p,g,v,S,T){var k=p.items,O=p.bounds;return!k||!k.length||O&&!O.contains(S,T)?null:(g*=d.pixelRatio,v*=d.pixelRatio,l(d,k,g,v)?k[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:s,draw:drawOne(o),pick:f,isect:intersectPoint,tip:i}}var area$2=markMultiItemPath("area",area$1$1,pickArea);function clip$2(e,n){var i=n.clip;e.save(),isFunction(i)?(e.beginPath(),i(e),e.clip()):clipGroup(e,n.group)}function clipGroup(e,n){e.beginPath(),hasCornerRadius(n)?rectangle(e,n,0,0):e.rect(0,0,n.width||0,n.height||0),e.clip()}function offset$1(e){const n=value$2(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&n>.5&&n<1.5?.5-Math.abs(n-1):0}function attr$5(e,n){e("transform",translateItem(n))}function emitRectangle(e,n){const i=offset$1(n);e("d",rectangle(null,n,i,i))}function background$1(e,n){e("class","background"),e("aria-hidden",!0),emitRectangle(e,n)}function foreground(e,n){e("class","foreground"),e("aria-hidden",!0),n.strokeForeground?emitRectangle(e,n):e("d","")}function content(e,n,i){const r=n.clip?clip$1$1(i,n,n):null;e("clip-path",r)}function bound$5(e,n){if(!n.clip&&n.items){const i=n.items,r=i.length;for(let s=0;s<r;++s)e.union(i[s].bounds)}return(n.clip||n.width||n.height)&&!n.noBound&&e.add(0,0).add(n.width||0,n.height||0),boundStroke(e,n),e.translate(n.x||0,n.y||0)}function rectanglePath(e,n,i,r){const s=offset$1(n);e.beginPath(),rectangle(e,n,(i||0)+s,(r||0)+s)}const hitBackground=hitPath(rectanglePath),hitForeground=hitPath(rectanglePath,!1),hitCorner=hitPath(rectanglePath,!0);function draw$4(e,n,i){visit(n,r=>{const s=r.x||0,o=r.y||0,l=r.strokeForeground,f=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&f&&(rectanglePath(e,r,s,o),blend(e,r),r.fill&&fill(e,r,f)&&e.fill(),r.stroke&&!l&&stroke(e,r,f)&&e.stroke()),e.save(),e.translate(s,o),r.clip&&clipGroup(e,r),i&&i.translate(-s,-o),visit(r,d=>{this.draw(e,d,i)}),i&&i.translate(s,o),e.restore(),l&&r.stroke&&f&&(rectanglePath(e,r,s,o),blend(e,r),stroke(e,r,f)&&e.stroke())})}function pick$2(e,n,i,r,s,o){if(n.bounds&&!n.bounds.contains(s,o)||!n.items)return null;const l=i*e.pixelRatio,f=r*e.pixelRatio;return pickVisit(n,d=>{let p,g,v;const S=d.bounds;if(S&&!S.contains(s,o))return;g=d.x||0,v=d.y||0;const T=g+(d.width||0),k=v+(d.height||0),O=d.clip;if(O&&(s<g||s>T||o<v||o>k))return;if(e.save(),e.translate(g,v),g=s-g,v=o-v,O&&hasCornerRadius(d)&&!hitCorner(e,d,l,f))return e.restore(),null;const R=d.strokeForeground,P=n.interactive!==!1;return P&&R&&d.stroke&&hitForeground(e,d,l,f)?(e.restore(),d):(p=pickVisit(d,F=>pickMark(F,g,v)?this.pick(F,i,r,g,v):null),!p&&P&&(d.fill||!R&&d.stroke)&&hitBackground(e,d,l,f)&&(p=d),e.restore(),p||null)})}function pickMark(e,n,i){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(n,i)}var group={type:"group",tag:"g",nested:!1,attr:attr$5,bound:bound$5,draw:draw$4,pick:pick$2,isect:intersectRect,content,background:background$1,foreground},metadata={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function getImage(e,n){var i=e.image;return(!i||e.url&&e.url!==i.url)&&(i={complete:!1,width:0,height:0},n.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),i}function imageWidth(e,n){return e.width!=null?e.width:!n||!n.width?0:e.aspect!==!1&&e.height?e.height*n.width/n.height:n.width}function imageHeight(e,n){return e.height!=null?e.height:!n||!n.height?0:e.aspect!==!1&&e.width?e.width*n.height/n.width:n.height}function imageXOffset(e,n){return e==="center"?n/2:e==="right"?n:0}function imageYOffset(e,n){return e==="middle"?n/2:e==="bottom"?n:0}function attr$4(e,n,i){const r=getImage(n,i),s=imageWidth(n,r),o=imageHeight(n,r),l=(n.x||0)-imageXOffset(n.align,s),f=(n.y||0)-imageYOffset(n.baseline,o),d=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",d,metadata["xmlns:xlink"],"xlink:href"),e("transform",translate$2(l,f)),e("width",s),e("height",o),e("preserveAspectRatio",n.aspect===!1?"none":"xMidYMid")}function bound$4(e,n){const i=n.image,r=imageWidth(n,i),s=imageHeight(n,i),o=(n.x||0)-imageXOffset(n.align,r),l=(n.y||0)-imageYOffset(n.baseline,s);return e.set(o,l,o+r,l+s)}function draw$3(e,n,i){visit(n,r=>{if(i&&!i.intersects(r.bounds))return;const s=getImage(r,this);let o=imageWidth(r,s),l=imageHeight(r,s);if(o===0||l===0)return;let f=(r.x||0)-imageXOffset(r.align,o),d=(r.y||0)-imageYOffset(r.baseline,l),p,g,v,S;r.aspect!==!1&&(g=s.width/s.height,v=r.width/r.height,g===g&&v===v&&g!==v&&(v<g?(S=o/g,d+=(l-S)/2,l=S):(S=l*g,f+=(o-S)/2,o=S))),(s.complete||s.toDataURL)&&(blend(e,r),e.globalAlpha=(p=r.opacity)!=null?p:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(s,f,d,o,l))})}var image$1={type:"image",tag:"image",nested:!1,attr:attr$4,bound:bound$4,draw:draw$3,pick:pick$1(),isect:truthy,get:getImage,xOffset:imageXOffset,yOffset:imageYOffset},line$2=markMultiItemPath("line",line$1$1,pickLine);function attr$3(e,n){var i=n.scaleX||1,r=n.scaleY||1;(i!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",transformItem(n)),e("d",n.path)}function path$1(e,n){var i=n.path;if(i==null)return!0;var r=n.x||0,s=n.y||0,o=n.scaleX||1,l=n.scaleY||1,f=(n.angle||0)*DegToRad,d=n.pathCache;(!d||d.path!==i)&&((n.pathCache=d=parse$3(i)).path=i),f&&e.rotate&&e.translate?(e.translate(r,s),e.rotate(f),pathRender(e,d,0,0,o,l),e.rotate(-f),e.translate(-r,-s)):pathRender(e,d,r,s,o,l)}function bound$3(e,n){return path$1(boundContext(e,n.angle),n)?e.set(0,0,0,0):boundStroke(e,n,!0)}var path$2={type:"path",tag:"path",nested:!1,attr:attr$3,bound:bound$3,draw:drawAll(path$1),pick:pickPath(path$1),isect:intersectPath(path$1)};function attr$2(e,n){e("d",rectangle(null,n))}function bound$2(e,n){var i,r;return boundStroke(e.set(i=n.x||0,r=n.y||0,i+n.width||0,r+n.height||0),n)}function draw$2(e,n){e.beginPath(),rectangle(e,n)}var rect$1={type:"rect",tag:"path",nested:!1,attr:attr$2,bound:bound$2,draw:drawAll(draw$2),pick:pickPath(draw$2),isect:intersectRect};function attr$1(e,n){e("transform",translateItem(n)),e("x2",n.x2!=null?n.x2-(n.x||0):0),e("y2",n.y2!=null?n.y2-(n.y||0):0)}function bound$1(e,n){var i,r;return boundStroke(e.set(i=n.x||0,r=n.y||0,n.x2!=null?n.x2:i,n.y2!=null?n.y2:r),n)}function path(e,n,i){var r,s,o,l;return n.stroke&&stroke(e,n,i)?(r=n.x||0,s=n.y||0,o=n.x2!=null?n.x2:r,l=n.y2!=null?n.y2:s,e.beginPath(),e.moveTo(r,s),e.lineTo(o,l),!0):!1}function draw$1(e,n,i){visit(n,r=>{if(!(i&&!i.intersects(r.bounds))){var s=r.opacity==null?1:r.opacity;s&&path(e,r,s)&&(blend(e,r),e.stroke())}})}function hit$1(e,n,i,r){return e.isPointInStroke?path(e,n,1)&&e.isPointInStroke(i,r):!1}var rule$2={type:"rule",tag:"line",nested:!1,attr:attr$1,bound:bound$1,draw:draw$1,pick:pick$1(hit$1),isect:intersectRule},shape=markItemPath("shape",shape$1),symbol=markItemPath("symbol",symbol$1,intersectPoint);const widthCache=lruCache$1();var textMetrics={height:fontSize,measureWidth,estimateWidth,width:estimateWidth,canvas:useCanvas};useCanvas(!0);function useCanvas(e){textMetrics.width=e&&context$2?measureWidth:estimateWidth}function estimateWidth(e,n){return _estimateWidth(textValue(e,n),fontSize(e))}function _estimateWidth(e,n){return~~(.8*e.length*n)}function measureWidth(e,n){return fontSize(e)<=0||!(n=textValue(e,n))?0:_measureWidth(n,font(e))}function _measureWidth(e,n){const i="(".concat(n,") ").concat(e);let r=widthCache.get(i);return r===void 0&&(context$2.font=n,r=context$2.measureText(e).width,widthCache.set(i,r)),r}function fontSize(e){return e.fontSize!=null?+e.fontSize||0:11}function lineHeight(e){return e.lineHeight!=null?e.lineHeight:fontSize(e)+2}function lineArray(e){return isArray(e)?e.length>1?e:e[0]:e}function textLines(e){return lineArray(e.lineBreak&&e.text&&!isArray(e.text)?e.text.split(e.lineBreak):e.text)}function multiLineOffset(e){const n=textLines(e);return(isArray(n)?n.length-1:0)*lineHeight(e)}function textValue(e,n){const i=n==null?"":(n+"").trim();return e.limit>0&&i.length?truncate(e,i):i}function widthGetter(e){if(textMetrics.width===measureWidth){const n=font(e);return i=>_measureWidth(i,n)}else{const n=fontSize(e);return i=>_estimateWidth(i,n)}}function truncate(e,n){var i=+e.limit,r=widthGetter(e);if(r(n)<i)return n;var s=e.ellipsis||"",o=e.dir==="rtl",l=0,f=n.length,d;if(i-=r(s),o){for(;l<f;)d=l+f>>>1,r(n.slice(d))>i?l=d+1:f=d;return s+n.slice(l)}else{for(;l<f;)d=1+(l+f>>>1),r(n.slice(0,d))<i?l=d:f=d-1;return n.slice(0,l)+s}}function fontFamily(e,n){var i=e.font;return(n&&i?String(i).replace(/"/g,"'"):i)||"sans-serif"}function font(e,n){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+fontSize(e)+"px "+fontFamily(e,n)}function offset$2(e){var n=e.baseline,i=fontSize(e);return Math.round(n==="top"?.79*i:n==="middle"?.3*i:n==="bottom"?-.21*i:n==="line-top"?.29*i+.5*lineHeight(e):n==="line-bottom"?.29*i-.5*lineHeight(e):0)}const textAlign={left:"start",center:"middle",right:"end"},tempBounds$1=new Bounds;function anchorPoint(e){var n=e.x||0,i=e.y||0,r=e.radius||0,s;return r&&(s=(e.theta||0)-HalfPi,n+=r*Math.cos(s),i+=r*Math.sin(s)),tempBounds$1.x1=n,tempBounds$1.y1=i,tempBounds$1}function attr(e,n){var i=n.dx||0,r=(n.dy||0)+offset$2(n),s=anchorPoint(n),o=s.x1,l=s.y1,f=n.angle||0,d;e("text-anchor",textAlign[n.align]||"start"),f?(d=translate$2(o,l)+" "+rotate(f),(i||r)&&(d+=" "+translate$2(i,r))):d=translate$2(o+i,l+r),e("transform",d)}function bound(e,n,i){var r=textMetrics.height(n),s=n.align,o=anchorPoint(n),l=o.x1,f=o.y1,d=n.dx||0,p=(n.dy||0)+offset$2(n)-Math.round(.8*r),g=textLines(n),v;if(isArray(g)?(r+=lineHeight(n)*(g.length-1),v=g.reduce((S,T)=>Math.max(S,textMetrics.width(n,T)),0)):v=textMetrics.width(n,g),s==="center"?d-=v/2:s==="right"&&(d-=v),e.set(d+=l,p+=f,d+v,p+r),n.angle&&!i)e.rotate(n.angle*DegToRad,l,f);else if(i===2)return e.rotatedPoints(n.angle*DegToRad,l,f);return e}function draw$5(e,n,i){visit(n,r=>{var s=r.opacity==null?1:r.opacity,o,l,f,d,p,g,v;if(!(i&&!i.intersects(r.bounds)||s===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=font(r),e.textAlign=r.align||"left",o=anchorPoint(r),l=o.x1,f=o.y1,r.angle&&(e.save(),e.translate(l,f),e.rotate(r.angle*DegToRad),l=f=0),l+=r.dx||0,f+=(r.dy||0)+offset$2(r),g=textLines(r),blend(e,r),isArray(g))for(p=lineHeight(r),d=0;d<g.length;++d)v=textValue(r,g[d]),r.fill&&fill(e,r,s)&&e.fillText(v,l,f),r.stroke&&stroke(e,r,s)&&e.strokeText(v,l,f),f+=p;else v=textValue(r,g),r.fill&&fill(e,r,s)&&e.fillText(v,l,f),r.stroke&&stroke(e,r,s)&&e.strokeText(v,l,f);r.angle&&e.restore()}})}function hit(e,n,i,r,s,o){if(n.fontSize<=0)return!1;if(!n.angle)return!0;var l=anchorPoint(n),f=l.x1,d=l.y1,p=bound(tempBounds$1,n,1),g=-n.angle*DegToRad,v=Math.cos(g),S=Math.sin(g),T=v*s-S*o+(f-v*f+S*d),k=S*s+v*o+(d-S*f-v*d);return p.contains(T,k)}function intersectText(e,n){const i=bound(tempBounds$1,e,2);return intersectBoxLine(n,i[0],i[1],i[2],i[3])||intersectBoxLine(n,i[0],i[1],i[4],i[5])||intersectBoxLine(n,i[4],i[5],i[6],i[7])||intersectBoxLine(n,i[2],i[3],i[6],i[7])}var text$2={type:"text",tag:"text",nested:!1,attr,bound,draw:draw$5,pick:pick$1(hit),isect:intersectText},trail$2=markMultiItemPath("trail",trail$1,pickTrail),Marks={arc:arc$2,area:area$2,group,image:image$1,line:line$2,path:path$2,rect:rect$1,rule:rule$2,shape,symbol,text:text$2,trail:trail$2};function boundItem$1(e,n,i){var r=Marks[e.mark.marktype],s=n||r.bound;return r.nested&&(e=e.mark),s(e.bounds||(e.bounds=new Bounds),e,i)}var DUMMY={mark:null};function boundMark(e,n,i){var r=Marks[e.marktype],s=r.bound,o=e.items,l=o&&o.length,f,d,p,g;if(r.nested)return l?p=o[0]:(DUMMY.mark=e,p=DUMMY),g=boundItem$1(p,s,i),n=n&&n.union(g)||g,n;if(n=n||e.bounds&&e.bounds.clear()||new Bounds,l)for(f=0,d=o.length;f<d;++f)n.union(boundItem$1(o[f],s,i));return e.bounds=n}const keys$3=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function sceneToJSON(e,n){return JSON.stringify(e,keys$3,n)}function sceneFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return initialize$1(n)}function initialize$1(e){var n=e.marktype,i=e.items,r,s,o;if(i)for(s=0,o=i.length;s<o;++s)r=n?"mark":"group",i[s][r]=e,i[s].zindex&&(i[s][r].zdirty=!0),(n||r)==="group"&&initialize$1(i[s]);return n&&boundMark(e),e}function Scenegraph(e){arguments.length?this.root=sceneFromJSON(e):(this.root=createMark({marktype:"group",name:"root",role:"frame"}),this.root.items=[new GroupItem(this.root)])}Scenegraph.prototype={toJSON(e){return sceneToJSON(this.root,e||0)},mark(e,n,i){n=n||this.root.items[0];const r=createMark(e,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}};function createMark(e,n){const i={bounds:new Bounds,clip:!!e.clip,group:n,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(i.aria=e.aria),e.description&&(i.description=e.description),i}function domCreate(e,n,i){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?i?e.createElementNS(i,n):e.createElement(n):null}function domFind(e,n){n=n.toLowerCase();for(var i=e.childNodes,r=0,s=i.length;r<s;++r)if(i[r].tagName.toLowerCase()===n)return i[r]}function domChild(e,n,i,r){var s=e.childNodes[n],o;return(!s||s.tagName.toLowerCase()!==i.toLowerCase())&&(o=s||null,s=domCreate(e.ownerDocument,i,r),e.insertBefore(s,o)),s}function domClear(e,n){for(var i=e.childNodes,r=i.length;r>n;)e.removeChild(i[--r]);return e}function cssClass(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function point$2(e,n){const i=n.getBoundingClientRect();return[e.clientX-i.left-(n.clientLeft||0),e.clientY-i.top-(n.clientTop||0)]}function resolveItem(e,n,i,r){var s=e&&e.mark,o,l;if(s&&(o=Marks[s.marktype]).tip){for(l=point$2(n,i),l[0]-=r[0],l[1]-=r[1];e=e.mark.group;)l[0]-=e.x||0,l[1]-=e.y||0;e=o.tip(s.items,l)}return e}function Handler(e,n){this._active=null,this._handlers={},this._loader=e||loader(),this._tooltip=n||defaultTooltip$1}function defaultTooltip$1(e,n,i,r){e.element().setAttribute("title",r||"")}Handler.prototype={initialize(e,n,i){return this._el=e,this._obj=i||null,this.origin(n)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,n,i){for(let r=e?e.length:0;--r>=0;)if(e[r].type===n&&(!i||e[r].handler===i))return r;return-1},handlers(e){const n=this._handlers,i=[];if(e)i.push(...n[this.eventName(e)]);else for(const r in n)i.push(...n[r]);return i},eventName(e){const n=e.indexOf(".");return n<0?e:e.slice(0,n)},handleHref(e,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const s=new MouseEvent(e.type,e),o=domCreate(null,"a");for(const l in r)o.setAttribute(l,r[l]);o.dispatchEvent(s)}).catch(()=>{})},handleTooltip(e,n,i){if(n&&n.tooltip!=null){n=resolveItem(n,e,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,e,n,r)}},getItemBoundingClientRect(e){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,s=e.bounds,o=s.width(),l=s.height();let f=s.x1+r[0]+i.left,d=s.y1+r[1]+i.top;for(;e.mark&&(e=e.mark.group);)f+=e.x||0,d+=e.y||0;return{x:f,y:d,width:o,height:l,left:f,top:d,right:f+o,bottom:d+l}}};function Renderer(e){this._el=null,this._bgcolor=null,this._loader=new ResourceLoader(e)}Renderer.prototype={initialize(e,n,i,r,s){return this._el=e,this.resize(n,i,r,s)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,n,i,r){return this._width=e,this._height=n,this._origin=i||[0,0],this._scale=r||1,this},dirty(){},render(e){const n=this;return n._call=function(){n._render(e)},n._call(),n._call=null,n},_render(){},renderAsync(e){const n=this.render(e);return this._ready?this._ready.then(()=>n):Promise.resolve(n)},_load(e,n){var i=this,r=i._loader[e](n);if(!i._ready){const s=i._call;i._ready=i._loader.ready().then(o=>{o&&s(),i._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const KeyDownEvent="keydown",KeyPressEvent="keypress",KeyUpEvent="keyup",DragEnterEvent="dragenter",DragLeaveEvent="dragleave",DragOverEvent="dragover",MouseDownEvent="mousedown",MouseUpEvent="mouseup",MouseMoveEvent="mousemove",MouseOutEvent="mouseout",MouseOverEvent="mouseover",ClickEvent="click",DoubleClickEvent="dblclick",WheelEvent="wheel",MouseWheelEvent="mousewheel",TouchStartEvent="touchstart",TouchMoveEvent="touchmove",TouchEndEvent="touchend",Events=[KeyDownEvent,KeyPressEvent,KeyUpEvent,DragEnterEvent,DragLeaveEvent,DragOverEvent,MouseDownEvent,MouseUpEvent,MouseMoveEvent,MouseOutEvent,MouseOverEvent,ClickEvent,DoubleClickEvent,WheelEvent,MouseWheelEvent,TouchStartEvent,TouchMoveEvent,TouchEndEvent],TooltipShowEvent=MouseMoveEvent,TooltipHideEvent=MouseOutEvent,HrefEvent=ClickEvent;function CanvasHandler(e,n){Handler.call(this,e,n),this._down=null,this._touch=null,this._first=!0,this._events={}}const eventBundle=e=>e===TouchStartEvent||e===TouchMoveEvent||e===TouchEndEvent?[TouchStartEvent,TouchMoveEvent,TouchEndEvent]:[e];function eventListenerCheck(e,n){eventBundle(n).forEach(i=>addEventListener(e,i))}function addEventListener(e,n){const i=e.canvas();i&&!e._events[n]&&(e._events[n]=1,i.addEventListener(n,e[n]?r=>e[n](r):r=>e.fire(n,r)))}function move(e,n,i){return function(r){const s=this._active,o=this.pickEvent(r);o===s?this.fire(e,r):((!s||!s.exit)&&this.fire(i,r),this._active=o,this.fire(n,r),this.fire(e,r))}}function inactive(e){return function(n){this.fire(e,n),this._active=null}}inherits(CanvasHandler,Handler,{initialize(e,n,i){return this._canvas=e&&domFind(e,"canvas"),[ClickEvent,MouseDownEvent,MouseMoveEvent,MouseOutEvent,DragLeaveEvent].forEach(r=>eventListenerCheck(this,r)),Handler.prototype.initialize.call(this,e,n,i)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Events,DOMMouseScroll(e){this.fire(MouseWheelEvent,e)},mousemove:move(MouseMoveEvent,MouseOverEvent,MouseOutEvent),dragover:move(DragOverEvent,DragEnterEvent,DragLeaveEvent),mouseout:inactive(MouseOutEvent),dragleave:inactive(DragLeaveEvent),mousedown(e){this._down=this._active,this.fire(MouseDownEvent,e)},click(e){this._down===this._active&&(this.fire(ClickEvent,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(TouchStartEvent,e,!0)},touchmove(e){this.fire(TouchMoveEvent,e,!0)},touchend(e){this.fire(TouchEndEvent,e,!0),this._touch=null},fire(e,n,i){const r=i?this._touch:this._active,s=this._handlers[e];if(n.vegaType=e,e===HrefEvent&&r&&r.href?this.handleHref(n,r,r.href):(e===TooltipShowEvent||e===TooltipHideEvent)&&this.handleTooltip(n,r,e!==TooltipHideEvent),s)for(let o=0,l=s.length;o<l;++o)s[o].handler.call(this._obj,n,r)},on(e,n){const i=this.eventName(e),r=this._handlers;return this._handlerIndex(r[i],e,n)<0&&(eventListenerCheck(this,e),(r[i]||(r[i]=[])).push({type:e,handler:n})),this},off(e,n){const i=this.eventName(e),r=this._handlers[i],s=this._handlerIndex(r,e,n);return s>=0&&r.splice(s,1),this},pickEvent(e){const n=point$2(e,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])},pick(e,n,i,r,s){const o=this.context();return Marks[e.marktype].pick.call(this,o,e,n,i,r,s)}});function devicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}var pixelRatio=devicePixelRatio();function resize(e,n,i,r,s,o){const l=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,f=e.getContext("2d"),d=l?pixelRatio:s;e.width=n*d,e.height=i*d;for(const p in o)f[p]=o[p];return l&&d!==1&&(e.style.width=n+"px",e.style.height=i+"px"),f.pixelRatio=d,f.setTransform(d,0,0,d,d*r[0],d*r[1]),e}function CanvasRenderer(e){Renderer.call(this,e),this._options={},this._redraw=!1,this._dirty=new Bounds,this._tempb=new Bounds}const base$1=Renderer.prototype,viewBounds=(e,n,i)=>new Bounds().set(0,0,n,i).translate(-e[0],-e[1]);function clipToBounds(e,n,i){return n.expand(1).round(),e.pixelRatio%1&&n.scale(e.pixelRatio).round().scale(1/e.pixelRatio),n.translate(-(i[0]%1),-(i[1]%1)),e.beginPath(),e.rect(n.x1,n.y1,n.width(),n.height()),e.clip(),n}inherits(CanvasRenderer,Renderer,{initialize(e,n,i,r,s,o){return this._options=o||{},this._canvas=this._options.externalContext?null:domCanvas(1,1,this._options.type),e&&this._canvas&&(domClear(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),base$1.initialize.call(this,e,n,i,r,s)},resize(e,n,i,r){if(base$1.resize.call(this,e,n,i,r),this._canvas)resize(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const s=this._options.externalContext;s||error("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const n=this._tempb.clear().union(e.bounds);let i=e.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)},_render(e){const n=this.context(),i=this._origin,r=this._width,s=this._height,o=this._dirty,l=viewBounds(i,r,s);n.save();const f=this._redraw||o.empty()?(this._redraw=!1,l.expand(1)):clipToBounds(n,l.intersect(o),i);return this.clear(-i[0],-i[1],r,s),this.draw(n,e,f),n.restore(),o.clear(),this},draw(e,n,i){const r=Marks[n.marktype];n.clip&&clip$2(e,n),r.draw.call(this,e,n,i),n.clip&&e.restore()},clear(e,n,i,r){const s=this._options,o=this.context();s.type!=="pdf"&&!s.externalContext&&o.clearRect(e,n,i,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,n,i,r))}});function SVGHandler(e,n){Handler.call(this,e,n);const i=this;i._hrefHandler=listener(i,(r,s)=>{s&&s.href&&i.handleHref(r,s,s.href)}),i._tooltipHandler=listener(i,(r,s)=>{i.handleTooltip(r,s,r.type!==TooltipHideEvent)})}const listener=(e,n)=>i=>{let r=i.target.__data__;r=Array.isArray(r)?r[0]:r,i.vegaType=i.type,n.call(e._obj,i,r)};inherits(SVGHandler,Handler,{initialize(e,n,i){let r=this._svg;return r&&(r.removeEventListener(HrefEvent,this._hrefHandler),r.removeEventListener(TooltipShowEvent,this._tooltipHandler),r.removeEventListener(TooltipHideEvent,this._tooltipHandler)),this._svg=r=e&&domFind(e,"svg"),r&&(r.addEventListener(HrefEvent,this._hrefHandler),r.addEventListener(TooltipShowEvent,this._tooltipHandler),r.addEventListener(TooltipHideEvent,this._tooltipHandler)),Handler.prototype.initialize.call(this,e,n,i)},canvas(){return this._svg},on(e,n){const i=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[i],e,n)<0){const o={type:e,handler:n,listener:listener(this,n)};(r[i]||(r[i]=[])).push(o),this._svg&&this._svg.addEventListener(i,o.listener)}return this},off(e,n){const i=this.eventName(e),r=this._handlers[i],s=this._handlerIndex(r,e,n);return s>=0&&(this._svg&&this._svg.removeEventListener(i,r[s].listener),r.splice(s,1)),this}});const ARIA_HIDDEN="aria-hidden",ARIA_LABEL="aria-label",ARIA_ROLE="role",ARIA_ROLEDESCRIPTION="aria-roledescription",GRAPHICS_OBJECT="graphics-object",GRAPHICS_SYMBOL="graphics-symbol",bundle=(e,n,i)=>({[ARIA_ROLE]:e,[ARIA_ROLEDESCRIPTION]:n,[ARIA_LABEL]:i||void 0}),AriaIgnore=toSet(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),AriaGuides={axis:{desc:"axis",caption:axisCaption},legend:{desc:"legend",caption:legendCaption},"title-text":{desc:"title",caption:e=>"Title text '".concat(titleCaption(e),"'")},"title-subtitle":{desc:"subtitle",caption:e=>"Subtitle text '".concat(titleCaption(e),"'")}},AriaEncode={ariaRole:ARIA_ROLE,ariaRoleDescription:ARIA_ROLEDESCRIPTION,description:ARIA_LABEL};function ariaItemAttributes(e,n){const i=n.aria===!1;if(e(ARIA_HIDDEN,i||void 0),i||n.description==null)for(const r in AriaEncode)e(AriaEncode[r],void 0);else{const r=n.mark.marktype;e(ARIA_LABEL,n.description),e(ARIA_ROLE,n.ariaRole||(r==="group"?GRAPHICS_OBJECT:GRAPHICS_SYMBOL)),e(ARIA_ROLEDESCRIPTION,n.ariaRoleDescription||"".concat(r," mark"))}}function ariaMarkAttributes(e){return e.aria===!1?{[ARIA_HIDDEN]:!0}:AriaIgnore[e.role]?null:AriaGuides[e.role]?ariaGuide(e,AriaGuides[e.role]):ariaMark(e)}function ariaMark(e){const n=e.marktype,i=n==="group"||n==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return bundle(i?GRAPHICS_OBJECT:GRAPHICS_SYMBOL,"".concat(n," mark container"),e.description)}function ariaGuide(e,n){try{const i=e.items[0],r=n.caption||(()=>"");return bundle(n.role||GRAPHICS_SYMBOL,n.desc,i.description||r(i))}catch{return null}}function titleCaption(e){return array$5(e.text).join(" ")}function axisCaption(e){const n=e.datum,i=e.orient,r=n.title?extractTitle(e):null,s=e.context,o=s.scales[n.scale].value,l=s.dataflow.locale(),f=o.type,d=i==="left"||i==="right"?"Y":"X";return"".concat(d,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(isDiscrete$2(f)?"discrete":f," scale")+" with ".concat(domainCaption(l,o,e))}function legendCaption(e){const n=e.datum,i=n.title?extractTitle(e):null,r="".concat(n.type||""," legend").trim(),s=n.scales,o=Object.keys(s),l=e.context,f=l.scales[s[o[0]]].value,d=l.dataflow.locale();return capitalize(r)+(i?" titled '".concat(i,"'"):"")+" for ".concat(channelCaption(o))+" with ".concat(domainCaption(d,f,e))}function extractTitle(e){try{return array$5(peek$1(e.items).items[0].text).join(" ")}catch{return null}}function channelCaption(e){return e=e.map(n=>n+(n==="fill"||n==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+peek$1(e)}function capitalize(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const innerText=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),attrText=e=>innerText(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function markup(){let e="",n="",i="";const r=[],s=()=>n=i="",o=d=>{n&&(e+="".concat(n,">").concat(i),s()),r.push(d)},l=(d,p)=>(p!=null&&(n+=" ".concat(d,'="').concat(attrText(p),'"')),f),f={open(d){o(d),n="<"+d;for(var p=arguments.length,g=new Array(p>1?p-1:0),v=1;v<p;v++)g[v-1]=arguments[v];for(const S of g)for(const T in S)l(T,S[T]);return f},close(){const d=r.pop();return n?e+=n+(i?">".concat(i,"</").concat(d,">"):"/>"):e+="</".concat(d,">"),s(),f},attr:l,text:d=>(i+=innerText(d),f),toString:()=>e};return f}const serializeXML=e=>_serialize(markup(),e)+"";function _serialize(e,n){if(e.open(n.tagName),n.hasAttributes()){const i=n.attributes,r=i.length;for(let s=0;s<r;++s)e.attr(i[s].name,i[s].value)}if(n.hasChildNodes()){const i=n.childNodes;for(const r of i)r.nodeType===3?e.text(r.nodeValue):_serialize(e,r)}return e.close()}const stylesAttr={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},stylesCss={blend:"mix-blend-mode"},rootAttributes={fill:"none","stroke-miterlimit":10},RootIndex=0,xmlns="http://www.w3.org/2000/xmlns/",svgns=metadata.xmlns;function SVGRenderer(e){Renderer.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const base=Renderer.prototype;inherits(SVGRenderer,Renderer,{initialize(e,n,i,r,s){return this._defs={},this._clearDefs(),e&&(this._svg=domChild(e,0,"svg",svgns),this._svg.setAttributeNS(xmlns,"xmlns",svgns),this._svg.setAttributeNS(xmlns,"xmlns:xlink",metadata["xmlns:xlink"]),this._svg.setAttribute("version",metadata.version),this._svg.setAttribute("class","marks"),domClear(e,1),this._root=domChild(this._svg,RootIndex,"g",svgns),setAttributes(this._root,rootAttributes),domClear(this._svg,RootIndex+1)),this.background(this._bgcolor),base.initialize.call(this,e,n,i,r,s)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),base.background.apply(this,arguments)},resize(e,n,i,r){return base.resize.call(this,e,n,i,r),this._svg&&(setAttributes(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,n=this._bgcolor;if(!e)return null;let i;n&&(e.removeAttribute("style"),i=domChild(e,RootIndex,"rect",svgns),setAttributes(i,{width:this._width,height:this._height,fill:n}));const r=serializeXML(e);return n&&(e.removeChild(i),this._svg.style.setProperty("background-color",n)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),domClear(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,s,o,l,f,d;for(l=0,f=e.length;l<f;++l)if(i=e[l],r=i.mark,r.marktype!==s&&(s=r.marktype,o=Marks[s]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,dirtyParents(i,n),r.items.forEach(p=>{p.dirty=n})),!r.zdirty){if(i.exit){o.nested&&r.items.length?(d=r.items[0],d._svg&&this._update(o,d._svg,d)):i._svg&&(d=i._svg.parentNode,d&&d.removeChild(i._svg)),i._svg=null;continue}i=o.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,dirtyParents(i,n)):this._update(o,i._svg,i),i._update=n)}return!this._dirtyAll},mark(e,n,i){if(!this.isDirty(n))return n._svg;const r=this._svg,s=Marks[n.marktype],o=n.interactive===!1?"none":null,l=s.tag==="g",f=bind$1(n,e,i,"g",r);f.setAttribute("class",cssClass(n));const d=ariaMarkAttributes(n);for(const S in d)setAttribute(f,S,d[S]);l||setAttribute(f,"pointer-events",o),setAttribute(f,"clip-path",n.clip?clip$1$1(this,n,n.group):null);let p=null,g=0;const v=S=>{const T=this.isDirty(S),k=bind$1(S,f,p,s.tag,r);T&&(this._update(s,k,S),l&&recurse(this,k,S)),p=k,++g};return s.nested?n.items.length&&v(n.items[0]):visit(n,v),domClear(f,g),f},_update(e,n,i){element$1=n,values$3=n.__values__,ariaItemAttributes(emit,i),e.attr(emit,i,this);const r=mark_extras[e.type];r&&r.call(this,e,n,i),element$1&&this.style(element$1,i)},style(e,n){if(n!=null){for(const i in stylesAttr){let r=i==="font"?fontFamily(n):n[i];if(r===values$3[i])continue;const s=stylesAttr[i];r==null?e.removeAttribute(s):(isGradient(r)&&(r=gradientRef(r,this._defs.gradient,href())),e.setAttribute(s,r+"")),values$3[i]=r}for(const i in stylesCss)setStyle(e,stylesCss[i],n[i])}},defs(){const e=this._svg,n=this._defs;let i=n.el,r=0;for(const s in n.gradient)i||(n.el=i=domChild(e,RootIndex+1,"defs",svgns)),r=updateGradient(i,n.gradient[s],r);for(const s in n.clipping)i||(n.el=i=domChild(e,RootIndex+1,"defs",svgns)),r=updateClipping(i,n.clipping[s],r);i&&(r===0?(e.removeChild(i),n.el=null):domClear(i,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function dirtyParents(e,n){for(;e&&e.dirty!==n;e=e.mark.group)if(e.dirty=n,e.mark&&e.mark.dirty!==n)e.mark.dirty=n;else return}function updateGradient(e,n,i){let r,s,o;if(n.gradient==="radial"){let l=domChild(e,i++,"pattern",svgns);setAttributes(l,{id:patternPrefix+n.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),l=domChild(l,0,"rect",svgns),setAttributes(l,{width:1,height:1,fill:"url(".concat(href(),"#").concat(n.id,")")}),e=domChild(e,i++,"radialGradient",svgns),setAttributes(e,{id:n.id,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})}else e=domChild(e,i++,"linearGradient",svgns),setAttributes(e,{id:n.id,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2});for(r=0,s=n.stops.length;r<s;++r)o=domChild(e,r,"stop",svgns),o.setAttribute("offset",n.stops[r].offset),o.setAttribute("stop-color",n.stops[r].color);return domClear(e,r),i}function updateClipping(e,n,i){let r;return e=domChild(e,i,"clipPath",svgns),e.setAttribute("id",n.id),n.path?(r=domChild(e,0,"path",svgns),r.setAttribute("d",n.path)):(r=domChild(e,0,"rect",svgns),setAttributes(r,{x:0,y:0,width:n.width,height:n.height})),domClear(e,1),i+1}function recurse(e,n,i){n=n.lastChild.previousSibling;let r,s=0;visit(i,o=>{r=e.mark(n,o,r),++s}),domClear(n,1+s)}function bind$1(e,n,i,r,s){let o=e._svg,l;if(!o&&(l=n.ownerDocument,o=domCreate(l,r,svgns),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const f=domCreate(l,"path",svgns);o.appendChild(f),f.__data__=e;const d=domCreate(l,"g",svgns);o.appendChild(d),d.__data__=e;const p=domCreate(l,"path",svgns);o.appendChild(p),p.__data__=e,p.__values__={fill:"default"}}return(o.ownerSVGElement!==s||siblingCheck(o,i))&&n.insertBefore(o,i?i.nextSibling:n.firstChild),o}function siblingCheck(e,n){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=n}let element$1=null,values$3=null;const mark_extras={group(e,n,i){const r=element$1=n.childNodes[2];values$3=r.__values__,e.foreground(emit,i,this),values$3=n.__values__,element$1=n.childNodes[1],e.content(emit,i,this);const s=element$1=n.childNodes[0];e.background(emit,i,this);const o=i.mark.interactive===!1?"none":null;if(o!==values$3.events&&(setAttribute(r,"pointer-events",o),setAttribute(s,"pointer-events",o),values$3.events=o),i.strokeForeground&&i.stroke){const l=i.fill;setAttribute(r,"display",null),this.style(s,i),setAttribute(s,"stroke",null),l&&(i.fill=null),values$3=r.__values__,this.style(r,i),l&&(i.fill=l),element$1=null}else setAttribute(r,"display","none")},image(e,n,i){i.smooth===!1?(setStyle(n,"image-rendering","optimizeSpeed"),setStyle(n,"image-rendering","pixelated")):setStyle(n,"image-rendering",null)},text(e,n,i){const r=textLines(i);let s,o,l,f;isArray(r)?(o=r.map(d=>textValue(i,d)),s=o.join(`
`),s!==values$3.text&&(domClear(n,0),l=n.ownerDocument,f=lineHeight(i),o.forEach((d,p)=>{const g=domCreate(l,"tspan",svgns);g.__data__=i,g.textContent=d,p&&(g.setAttribute("x",0),g.setAttribute("dy",f)),n.appendChild(g)}),values$3.text=s)):(o=textValue(i,r),o!==values$3.text&&(n.textContent=o,values$3.text=o)),setAttribute(n,"font-family",fontFamily(i)),setAttribute(n,"font-size",fontSize(i)+"px"),setAttribute(n,"font-style",i.fontStyle),setAttribute(n,"font-variant",i.fontVariant),setAttribute(n,"font-weight",i.fontWeight)}};function emit(e,n,i){n!==values$3[e]&&(i?setAttributeNS(element$1,e,n,i):setAttribute(element$1,e,n),values$3[e]=n)}function setStyle(e,n,i){i!==values$3[n]&&(i==null?e.style.removeProperty(n):e.style.setProperty(n,i+""),values$3[n]=i)}function setAttributes(e,n){for(const i in n)setAttribute(e,i,n[i])}function setAttribute(e,n,i){i!=null?e.setAttribute(n,i):e.removeAttribute(n)}function setAttributeNS(e,n,i,r){i!=null?e.setAttributeNS(r,n,i):e.removeAttributeNS(r,n)}function href(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function SVGStringRenderer(e){Renderer.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}inherits(SVGStringRenderer,Renderer,{svg(){return this._text},_render(e){const n=markup();n.open("svg",extend$1({},metadata,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",rootAttributes,{transform:"translate("+this._origin+")"}),this.mark(n,e),n.close(),this.defs(n),this._text=n.close()+"",this},mark(e,n){const i=Marks[n.marktype],r=i.tag,s=[ariaItemAttributes,i.attr];e.open("g",{class:cssClass(n),"clip-path":n.clip?clip$1$1(this,n,n.group):null},ariaMarkAttributes(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const o=l=>{const f=this.href(l);if(f&&e.open("a",f),e.open(r,this.attr(n,l,s,r!=="g"?r:null)),r==="text"){const d=textLines(l);if(isArray(d)){const p={x:0,dy:lineHeight(l)};for(let g=0;g<d.length;++g)e.open("tspan",g?p:null).text(textValue(l,d[g])).close()}else e.text(textValue(l,d))}else if(r==="g"){const d=l.strokeForeground,p=l.fill,g=l.stroke;d&&g&&(l.stroke=null),e.open("path",this.attr(n,l,i.background,"bgrect")).close(),e.open("g",this.attr(n,l,i.content)),visit(l,v=>this.mark(e,v)),e.close(),d&&g?(p&&(l.fill=null),l.stroke=g,e.open("path",this.attr(n,l,i.foreground,"bgrect")).close(),p&&(l.fill=p)):e.open("path",this.attr(n,l,i.foreground,"bgfore")).close()}e.close(),f&&e.close()};return i.nested?n.items&&n.items.length&&o(n.items[0]):visit(n,o),e.close()},href(e){const n=e.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null},attr(e,n,i,r){const s={},o=(l,f,d,p)=>{s[p||l]=f};return Array.isArray(i)?i.forEach(l=>l(o,n,this)):i(o,n,this),r&&style(s,n,e,r,this._defs),s},defs(e){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){e.open("defs");for(const s in n){const o=n[s],l=o.stops;o.gradient==="radial"?(e.open("pattern",{id:patternPrefix+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),e.close(),e.open("radialGradient",{id:s,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:s,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let f=0;f<l.length;++f)e.open("stop",{offset:l[f].offset,"stop-color":l[f].color}).close();e.close()}for(const s in i){const o=i[s];e.open("clipPath",{id:s}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function style(e,n,i,r,s){let o;if(n==null||(r==="bgrect"&&i.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(i.interactive===!1&&(e["pointer-events"]="none"),e.display="none",n.fill!==null)))return e;r==="image"&&n.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=fontFamily(n),e["font-size"]=fontSize(n)+"px",e["font-style"]=n.fontStyle,e["font-variant"]=n.fontVariant,e["font-weight"]=n.fontWeight);for(const l in stylesAttr){let f=n[l];const d=stylesAttr[l];f==="transparent"&&(d==="fill"||d==="stroke")||f!=null&&(isGradient(f)&&(f=gradientRef(f,s.gradient,"")),e[d]=f)}for(const l in stylesCss){const f=n[l];f!=null&&(o=o||[],o.push("".concat(stylesCss[l],": ").concat(f,";")))}return o&&(e.style=o.join(" ")),e}const Canvas="canvas",PNG="png",SVG="svg",None$1="none",RenderType={Canvas,PNG,SVG,None:None$1},modules={};modules[Canvas]=modules[PNG]={renderer:CanvasRenderer,headless:CanvasRenderer,handler:CanvasHandler};modules[SVG]={renderer:SVGRenderer,headless:SVGStringRenderer,handler:SVGHandler};modules[None$1]={};function renderModule(e,n){return e=String(e||"").toLowerCase(),arguments.length>1?(modules[e]=n,this):modules[e]}function intersect$2(e,n,i){const r=[],s=new Bounds().union(n),o=e.marktype;return o?intersectMark(e,s,i,r):o==="group"?intersectGroup(e,s,i,r):error("Intersect scene must be mark node or group item.")}function intersectMark(e,n,i,r){if(visitMark(e,n,i)){const s=e.items,o=e.marktype,l=s.length;let f=0;if(o==="group")for(;f<l;++f)intersectGroup(s[f],n,i,r);else for(const d=Marks[o].isect;f<l;++f){const p=s[f];intersectItem(p,n,d)&&r.push(p)}}return r}function visitMark(e,n,i){return e.bounds&&n.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!i||i(e)))}function intersectGroup(e,n,i,r){i&&i(e.mark)&&intersectItem(e,n,Marks.group.isect)&&r.push(e);const s=e.items,o=s&&s.length;if(o){const l=e.x||0,f=e.y||0;n.translate(-l,-f);for(let d=0;d<o;++d)intersectMark(s[d],n,i,r);n.translate(l,f)}return r}function intersectItem(e,n,i){const r=e.bounds;return n.encloses(r)||n.intersects(r)&&i(e,n)}const clipBounds=new Bounds;function boundClip(e){const n=e.clip;if(isFunction(n))n(boundContext(clipBounds.clear()));else if(n)clipBounds.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(clipBounds)}const TOLERANCE=1e-9;function sceneEqual(e,n,i){return e===n?!0:i==="path"?pathEqual(e,n):e instanceof Date&&n instanceof Date?+e==+n:isNumber$1(e)&&isNumber$1(n)?Math.abs(e-n)<=TOLERANCE:!e||!n||!isObject(e)&&!isObject(n)?e==n:objectEqual(e,n)}function pathEqual(e,n){return sceneEqual(parse$3(e),parse$3(n))}function objectEqual(e,n){var i=Object.keys(e),r=Object.keys(n),s,o;if(i.length!==r.length)return!1;for(i.sort(),r.sort(),o=i.length-1;o>=0;o--)if(i[o]!=r[o])return!1;for(o=i.length-1;o>=0;o--)if(s=i[o],!sceneEqual(e[s],n[s],s))return!1;return typeof e==typeof n}function resetSVGDefIds(){resetSVGClipId(),resetSVGGradientId()}const Top$1="top",Left$1="left",Right$1="right",Bottom$1="bottom",TopLeft="top-left",TopRight="top-right",BottomLeft="bottom-left",BottomRight="bottom-right",Start$1="start",Middle$1="middle",End$1="end",X$1="x",Y$1="y",Group="group",AxisRole$1="axis",TitleRole$1="title",FrameRole$1="frame",ScopeRole$1="scope",LegendRole$1="legend",RowHeader="row-header",RowFooter="row-footer",RowTitle="row-title",ColHeader="column-header",ColFooter="column-footer",ColTitle="column-title",Padding$1="padding",Symbols$1="symbol",Fit="fit",FitX="fit-x",FitY="fit-y",Pad="pad",None="none",All="all",Each="each",Flush="flush",Column="column",Row="row";function Bound$1(e){Transform.call(this,null,e)}inherits(Bound$1,Transform,{transform(e,n){const i=n.dataflow,r=e.mark,s=r.marktype,o=Marks[s],l=o.bound;let f=r.bounds,d;if(o.nested)r.items.length&&i.dirty(r.items[0]),f=boundItem(r,l),r.items.forEach(p=>{p.bounds.clear().union(f)});else if(s===Group||e.modified())switch(n.visit(n.MOD,p=>i.dirty(p)),f.clear(),r.items.forEach(p=>f.union(boundItem(p,l))),r.role){case AxisRole$1:case LegendRole$1:case TitleRole$1:n.reflow()}else d=n.changed(n.REM),n.visit(n.ADD,p=>{f.union(boundItem(p,l))}),n.visit(n.MOD,p=>{d=d||f.alignsWith(p.bounds),i.dirty(p),f.union(boundItem(p,l))}),d&&(f.clear(),r.items.forEach(p=>f.union(p.bounds)));return boundClip(r),n.modifies("bounds")}});function boundItem(e,n,i){return n(e.bounds.clear(),e,i)}const COUNTER_NAME=":vega_identifier:";function Identifier$1(e){Transform.call(this,0,e)}Identifier$1.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};inherits(Identifier$1,Transform,{transform(e,n){const i=getCounter(n.dataflow),r=e.as;let s=i.value;return n.visit(n.ADD,o=>o[r]=o[r]||++s),i.set(this.value=s),n}});function getCounter(e){return e._signals[COUNTER_NAME]||(e._signals[COUNTER_NAME]=e.add(0))}function Mark$2(e){Transform.call(this,null,e)}inherits(Mark$2,Transform,{transform(e,n){let i=this.value;i||(i=n.dataflow.scenegraph().mark(e.markdef,lookup$3(e),e.index),i.group.context=e.context,e.context.group||(e.context.group=i.group),i.source=this.source,i.clip=e.clip,i.interactive=e.interactive,this.value=i);const r=i.marktype===Group?GroupItem:Item;return n.visit(n.ADD,s=>r.call(s,i)),(e.modified("clip")||e.modified("interactive"))&&(i.clip=e.clip,i.interactive=!!e.interactive,i.zdirty=!0,n.reflow()),i.items=n.source,n}});function lookup$3(e){const n=e.groups,i=e.parent;return n&&n.size===1?n.get(Object.keys(n.object)[0]):n&&i?n.lookup(i):null}function Overlap$1(e){Transform.call(this,null,e)}const methods={parity:e=>e.filter((n,i)=>i%2?n.opacity=0:1),greedy:(e,n)=>{let i;return e.filter((r,s)=>!s||!intersect$1(i.bounds,r.bounds,n)?(i=r,1):r.opacity=0)}},intersect$1=(e,n,i)=>i>Math.max(n.x1-e.x2,e.x1-n.x2,n.y1-e.y2,e.y1-n.y2),hasOverlap=(e,n)=>{for(var i=1,r=e.length,s=e[0].bounds,o;i<r;s=o,++i)if(intersect$1(s,o=e[i].bounds,n))return!0},hasBounds=e=>{const n=e.bounds;return n.width()>1&&n.height()>1},boundTest=(e,n,i)=>{var r=e.range(),s=new Bounds;return n===Top$1||n===Bottom$1?s.set(r[0],-1/0,r[1],1/0):s.set(-1/0,r[0],1/0,r[1]),s.expand(i||1),o=>s.encloses(o.bounds)},reset$1=e=>(e.forEach(n=>n.opacity=1),e),reflow=(e,n)=>e.reflow(n.modified()).modifies("opacity");inherits(Overlap$1,Transform,{transform(e,n){const i=methods[e.method]||methods.parity,r=e.separation||0;let s=n.materialize(n.SOURCE).source,o,l;if(!s||!s.length)return;if(!e.method)return e.modified("method")&&(reset$1(s),n=reflow(n,e)),n;if(s=s.filter(hasBounds),!s.length)return;if(e.sort&&(s=s.slice().sort(e.sort)),o=reset$1(s),n=reflow(n,e),o.length>=3&&hasOverlap(o,r)){do o=i(o,r);while(o.length>=3&&hasOverlap(o,r));o.length<3&&!peek$1(s).opacity&&(o.length>1&&(peek$1(o).opacity=0),peek$1(s).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(l=boundTest(e.boundScale,e.boundOrient,+e.boundTolerance),s.forEach(d=>{l(d)||(d.opacity=0)}));const f=o[0].mark.bounds.clear();return s.forEach(d=>{d.opacity&&f.union(d.bounds)}),n}});function Render$1(e){Transform.call(this,null,e)}inherits(Render$1,Transform,{transform(e,n){const i=n.dataflow;if(n.visit(n.ALL,r=>i.dirty(r)),n.fields&&n.fields.zindex){const r=n.source&&n.source[0];r&&(r.mark.zdirty=!0)}}});const tempBounds=new Bounds;function set$4(e,n,i){return e[n]===i?0:(e[n]=i,1)}function isYAxis(e){var n=e.items[0].orient;return n===Left$1||n===Right$1}function axisIndices(e){let n=+e.grid;return[e.ticks?n++:-1,e.labels?n++:-1,n+ +e.domain]}function axisLayout(e,n,i,r){var s=n.items[0],o=s.datum,l=s.translate!=null?s.translate:.5,f=s.orient,d=axisIndices(o),p=s.range,g=s.offset,v=s.position,S=s.minExtent,T=s.maxExtent,k=o.title&&s.items[d[2]].items[0],O=s.titlePadding,R=s.bounds,P=k&&multiLineOffset(k),F=0,I=0,L,N;switch(tempBounds.clear().union(R),R.clear(),(L=d[0])>-1&&R.union(s.items[L].bounds),(L=d[1])>-1&&R.union(s.items[L].bounds),f){case Top$1:F=v||0,I=-g,N=Math.max(S,Math.min(T,-R.y1)),R.add(0,-N).add(p,0),k&&axisTitleLayout(e,k,N,O,P,0,-1,R);break;case Left$1:F=-g,I=v||0,N=Math.max(S,Math.min(T,-R.x1)),R.add(-N,0).add(0,p),k&&axisTitleLayout(e,k,N,O,P,1,-1,R);break;case Right$1:F=i+g,I=v||0,N=Math.max(S,Math.min(T,R.x2)),R.add(0,0).add(N,p),k&&axisTitleLayout(e,k,N,O,P,1,1,R);break;case Bottom$1:F=v||0,I=r+g,N=Math.max(S,Math.min(T,R.y2)),R.add(0,0).add(p,N),k&&axisTitleLayout(e,k,N,O,0,0,1,R);break;default:F=s.x,I=s.y}return boundStroke(R.translate(F,I),s),set$4(s,"x",F+l)|set$4(s,"y",I+l)&&(s.bounds=tempBounds,e.dirty(s),s.bounds=R,e.dirty(s)),s.mark.bounds.clear().union(R)}function axisTitleLayout(e,n,i,r,s,o,l,f){const d=n.bounds;if(n.auto){const p=l*(i+s+r);let g=0,v=0;e.dirty(n),o?g=(n.x||0)-(n.x=p):v=(n.y||0)-(n.y=p),n.mark.bounds.clear().union(d.translate(-g,-v)),e.dirty(n)}f.union(d)}const min=(e,n)=>Math.floor(Math.min(e,n)),max=(e,n)=>Math.ceil(Math.max(e,n));function gridLayoutGroups(e){var n=e.items,i=n.length,r=0,s,o;const l={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<i;++r)if(s=n[r],o=s.items,s.marktype===Group)switch(s.role){case AxisRole$1:case LegendRole$1:case TitleRole$1:break;case RowHeader:l.rowheaders.push(...o);break;case RowFooter:l.rowfooters.push(...o);break;case ColHeader:l.colheaders.push(...o);break;case ColFooter:l.colfooters.push(...o);break;case RowTitle:l.rowtitle=o[0];break;case ColTitle:l.coltitle=o[0];break;default:l.marks.push(...o)}return l}function bboxFlush(e){return new Bounds().set(0,0,e.width||0,e.height||0)}function bboxFull(e){const n=e.bounds.clone();return n.empty()?n.set(0,0,0,0):n.translate(-(e.x||0),-(e.y||0))}function get$2(e,n,i){const r=isObject(e)?e[n]:e;return r??(i!==void 0?i:0)}function offsetValue$1(e){return e<0?Math.ceil(-e):0}function gridLayout(e,n,i){var r=!i.nodirty,s=i.bounds===Flush?bboxFlush:bboxFull,o=tempBounds.set(0,0,0,0),l=get$2(i.align,Column),f=get$2(i.align,Row),d=get$2(i.padding,Column),p=get$2(i.padding,Row),g=i.columns||n.length,v=g<=0?1:Math.ceil(n.length/g),S=n.length,T=Array(S),k=Array(g),O=0,R=Array(S),P=Array(v),F=0,I=Array(S),L=Array(S),N=Array(S),j,z,q,H,W,U,Q,J,ne,G,Z;for(z=0;z<g;++z)k[z]=0;for(z=0;z<v;++z)P[z]=0;for(z=0;z<S;++z)U=n[z],W=N[z]=s(U),U.x=U.x||0,I[z]=0,U.y=U.y||0,L[z]=0,q=z%g,H=~~(z/g),O=Math.max(O,Q=Math.ceil(W.x2)),F=Math.max(F,J=Math.ceil(W.y2)),k[q]=Math.max(k[q],Q),P[H]=Math.max(P[H],J),T[z]=d+offsetValue$1(W.x1),R[z]=p+offsetValue$1(W.y1),r&&e.dirty(n[z]);for(z=0;z<S;++z)z%g===0&&(T[z]=0),z<g&&(R[z]=0);if(l===Each)for(q=1;q<g;++q){for(Z=0,z=q;z<S;z+=g)Z<T[z]&&(Z=T[z]);for(z=q;z<S;z+=g)T[z]=Z+k[q-1]}else if(l===All){for(Z=0,z=0;z<S;++z)z%g&&Z<T[z]&&(Z=T[z]);for(z=0;z<S;++z)z%g&&(T[z]=Z+O)}else for(l=!1,q=1;q<g;++q)for(z=q;z<S;z+=g)T[z]+=k[q-1];if(f===Each)for(H=1;H<v;++H){for(Z=0,z=H*g,j=z+g;z<j;++z)Z<R[z]&&(Z=R[z]);for(z=H*g;z<j;++z)R[z]=Z+P[H-1]}else if(f===All){for(Z=0,z=g;z<S;++z)Z<R[z]&&(Z=R[z]);for(z=g;z<S;++z)R[z]=Z+F}else for(f=!1,H=1;H<v;++H)for(z=H*g,j=z+g;z<j;++z)R[z]+=P[H-1];for(ne=0,z=0;z<S;++z)ne=T[z]+(z%g?ne:0),I[z]+=ne-n[z].x;for(q=0;q<g;++q)for(G=0,z=q;z<S;z+=g)G+=R[z],L[z]+=G-n[z].y;if(l&&get$2(i.center,Column)&&v>1)for(z=0;z<S;++z)W=l===All?O:k[z%g],ne=W-N[z].x2-n[z].x-I[z],ne>0&&(I[z]+=ne/2);if(f&&get$2(i.center,Row)&&g!==1)for(z=0;z<S;++z)W=f===All?F:P[~~(z/g)],G=W-N[z].y2-n[z].y-L[z],G>0&&(L[z]+=G/2);for(z=0;z<S;++z)o.union(N[z].translate(I[z],L[z]));switch(ne=get$2(i.anchor,X$1),G=get$2(i.anchor,Y$1),get$2(i.anchor,Column)){case End$1:ne-=o.width();break;case Middle$1:ne-=o.width()/2}switch(get$2(i.anchor,Row)){case End$1:G-=o.height();break;case Middle$1:G-=o.height()/2}for(ne=Math.round(ne),G=Math.round(G),o.clear(),z=0;z<S;++z)n[z].mark.bounds.clear();for(z=0;z<S;++z)U=n[z],U.x+=I[z]+=ne,U.y+=L[z]+=G,o.union(U.mark.bounds.union(U.bounds.translate(I[z],L[z]))),r&&e.dirty(U);return o}function trellisLayout(e,n,i){var r=gridLayoutGroups(n),s=r.marks,o=i.bounds===Flush?boundFlush:boundFull,l=i.offset,f=i.columns||s.length,d=f<=0?1:Math.ceil(s.length/f),p=d*f,g,v,S,T,k,O,R;const P=gridLayout(e,s,i);P.empty()&&P.set(0,0,0,0),r.rowheaders&&(O=get$2(i.headerBand,Row,null),g=layoutHeaders(e,r.rowheaders,s,f,d,-get$2(l,"rowHeader"),min,0,o,"x1",0,f,1,O)),r.colheaders&&(O=get$2(i.headerBand,Column,null),v=layoutHeaders(e,r.colheaders,s,f,f,-get$2(l,"columnHeader"),min,1,o,"y1",0,1,f,O)),r.rowfooters&&(O=get$2(i.footerBand,Row,null),S=layoutHeaders(e,r.rowfooters,s,f,d,get$2(l,"rowFooter"),max,0,o,"x2",f-1,f,1,O)),r.colfooters&&(O=get$2(i.footerBand,Column,null),T=layoutHeaders(e,r.colfooters,s,f,f,get$2(l,"columnFooter"),max,1,o,"y2",p-f,1,f,O)),r.rowtitle&&(k=get$2(i.titleAnchor,Row),R=get$2(l,"rowTitle"),R=k===End$1?S+R:g-R,O=get$2(i.titleBand,Row,.5),layoutTitle(e,r.rowtitle,R,0,P,O)),r.coltitle&&(k=get$2(i.titleAnchor,Column),R=get$2(l,"columnTitle"),R=k===End$1?T+R:v-R,O=get$2(i.titleBand,Column,.5),layoutTitle(e,r.coltitle,R,1,P,O))}function boundFlush(e,n){return n==="x1"?e.x||0:n==="y1"?e.y||0:n==="x2"?(e.x||0)+(e.width||0):n==="y2"?(e.y||0)+(e.height||0):void 0}function boundFull(e,n){return e.bounds[n]}function layoutHeaders(e,n,i,r,s,o,l,f,d,p,g,v,S,T){var k=i.length,O=0,R=0,P,F,I,L,N,j,z,q,H;if(!k)return O;for(P=g;P<k;P+=v)i[P]&&(O=l(O,d(i[P],p)));if(!n.length)return O;for(n.length>s&&(e.warn("Grid headers exceed limit: "+s),n=n.slice(0,s)),O+=o,F=0,L=n.length;F<L;++F)e.dirty(n[F]),n[F].mark.bounds.clear();for(P=g,F=0,L=n.length;F<L;++F,P+=v){for(j=n[F],N=j.mark.bounds,I=P;I>=0&&(z=i[I])==null;I-=S);f?(q=T==null?z.x:Math.round(z.bounds.x1+T*z.bounds.width()),H=O):(q=O,H=T==null?z.y:Math.round(z.bounds.y1+T*z.bounds.height())),N.union(j.bounds.translate(q-(j.x||0),H-(j.y||0))),j.x=q,j.y=H,e.dirty(j),R=l(R,N[p])}return R}function layoutTitle(e,n,i,r,s,o){if(n){e.dirty(n);var l=i,f=i;r?l=Math.round(s.x1+o*s.width()):f=Math.round(s.y1+o*s.height()),n.bounds.translate(l-(n.x||0),f-(n.y||0)),n.mark.bounds.clear().union(n.bounds),n.x=l,n.y=f,e.dirty(n)}}function lookup$1$1(e,n){const i=e[n]||{};return(r,s)=>i[r]!=null?i[r]:e[r]!=null?e[r]:s}function offsets(e,n){let i=-1/0;return e.forEach(r=>{r.offset!=null&&(i=Math.max(i,r.offset))}),i>-1/0?i:n}function legendParams(e,n,i,r,s,o,l){const f=lookup$1$1(i,n),d=offsets(e,f("offset",0)),p=f("anchor",Start$1),g=p===End$1?1:p===Middle$1?.5:0,v={align:Each,bounds:f("bounds",Flush),columns:f("direction")==="vertical"?1:e.length,padding:f("margin",8),center:f("center"),nodirty:!0};switch(n){case Left$1:v.anchor={x:Math.floor(r.x1)-d,column:End$1,y:g*(l||r.height()+2*r.y1),row:p};break;case Right$1:v.anchor={x:Math.ceil(r.x2)+d,y:g*(l||r.height()+2*r.y1),row:p};break;case Top$1:v.anchor={y:Math.floor(s.y1)-d,row:End$1,x:g*(o||s.width()+2*s.x1),column:p};break;case Bottom$1:v.anchor={y:Math.ceil(s.y2)+d,x:g*(o||s.width()+2*s.x1),column:p};break;case TopLeft:v.anchor={x:d,y:d};break;case TopRight:v.anchor={x:o-d,y:d,column:End$1};break;case BottomLeft:v.anchor={x:d,y:l-d,row:End$1};break;case BottomRight:v.anchor={x:o-d,y:l-d,column:End$1,row:End$1};break}return v}function legendLayout(e,n){var i=n.items[0],r=i.datum,s=i.orient,o=i.bounds,l=i.x,f=i.y,d,p;return i._bounds?i._bounds.clear().union(o):i._bounds=o.clone(),o.clear(),legendGroupLayout(e,i,i.items[0].items[0]),o=legendBounds(i,o),d=2*i.padding,p=2*i.padding,o.empty()||(d=Math.ceil(o.width()+d),p=Math.ceil(o.height()+p)),r.type===Symbols$1&&legendEntryLayout(i.items[0].items[0].items[0].items),s!==None&&(i.x=l=0,i.y=f=0),i.width=d,i.height=p,boundStroke(o.set(l,f,l+d,f+p),i),i.mark.bounds.clear().union(o),i}function legendBounds(e,n){return e.items.forEach(i=>n.union(i.bounds)),n.x1=e.padding,n.y1=e.padding,n}function legendGroupLayout(e,n,i){var r=n.padding,s=r-i.x,o=r-i.y;if(!n.datum.title)(s||o)&&translate$1(e,i,s,o);else{var l=n.items[1].items[0],f=l.anchor,d=n.titlePadding||0,p=r-l.x,g=r-l.y;switch(l.orient){case Left$1:s+=Math.ceil(l.bounds.width())+d;break;case Right$1:case Bottom$1:break;default:o+=l.bounds.height()+d}switch((s||o)&&translate$1(e,i,s,o),l.orient){case Left$1:g+=legendTitleOffset(n,i,l,f,1,1);break;case Right$1:p+=legendTitleOffset(n,i,l,End$1,0,0)+d,g+=legendTitleOffset(n,i,l,f,1,1);break;case Bottom$1:p+=legendTitleOffset(n,i,l,f,0,0),g+=legendTitleOffset(n,i,l,End$1,-1,0,1)+d;break;default:p+=legendTitleOffset(n,i,l,f,0,0)}(p||g)&&translate$1(e,l,p,g),(p=Math.round(l.bounds.x1-r))<0&&(translate$1(e,i,-p,0),translate$1(e,l,-p,0))}}function legendTitleOffset(e,n,i,r,s,o,l){const f=e.datum.type!=="symbol",d=i.datum.vgrad,p=f&&(o||!d)&&!l?n.items[0]:n,g=p.bounds[s?"y2":"x2"]-e.padding,v=d&&o?g:0,S=d&&o?0:g,T=s<=0?0:multiLineOffset(i);return Math.round(r===Start$1?v:r===End$1?S-T:.5*(g-T))}function translate$1(e,n,i,r){n.x+=i,n.y+=r,n.bounds.translate(i,r),n.mark.bounds.translate(i,r),e.dirty(n)}function legendEntryLayout(e){const n=e.reduce((i,r)=>(i[r.column]=Math.max(r.bounds.x2-r.x,i[r.column]||0),i),{});e.forEach(i=>{i.width=n[i.column],i.height=i.bounds.y2-i.y})}function titleLayout(e,n,i,r,s){var o=n.items[0],l=o.frame,f=o.orient,d=o.anchor,p=o.offset,g=o.padding,v=o.items[0].items[0],S=o.items[1]&&o.items[1].items[0],T=f===Left$1||f===Right$1?r:i,k=0,O=0,R=0,P=0,F=0,I;if(l!==Group?f===Left$1?(k=s.y2,T=s.y1):f===Right$1?(k=s.y1,T=s.y2):(k=s.x1,T=s.x2):f===Left$1&&(k=r,T=0),I=d===Start$1?k:d===End$1?T:(k+T)/2,S&&S.text){switch(f){case Top$1:case Bottom$1:F=v.bounds.height()+g;break;case Left$1:P=v.bounds.width()+g;break;case Right$1:P=-v.bounds.width()-g;break}tempBounds.clear().union(S.bounds),tempBounds.translate(P-(S.x||0),F-(S.y||0)),set$4(S,"x",P)|set$4(S,"y",F)&&(e.dirty(S),S.bounds.clear().union(tempBounds),S.mark.bounds.clear().union(tempBounds),e.dirty(S)),tempBounds.clear().union(S.bounds)}else tempBounds.clear();switch(tempBounds.union(v.bounds),f){case Top$1:O=I,R=s.y1-tempBounds.height()-p;break;case Left$1:O=s.x1-tempBounds.width()-p,R=I;break;case Right$1:O=s.x2+tempBounds.width()+p,R=I;break;case Bottom$1:O=I,R=s.y2+p;break;default:O=o.x,R=o.y}return set$4(o,"x",O)|set$4(o,"y",R)&&(tempBounds.translate(O,R),e.dirty(o),o.bounds.clear().union(tempBounds),n.bounds.clear().union(tempBounds),e.dirty(o)),o.bounds}function ViewLayout$1(e){Transform.call(this,null,e)}inherits(ViewLayout$1,Transform,{transform(e,n){const i=n.dataflow;return e.mark.items.forEach(r=>{e.layout&&trellisLayout(i,r,e.layout),layoutGroup(i,r,e)}),shouldReflow(e.mark.group)?n.reflow():n}});function shouldReflow(e){return e&&e.mark.role!=="legend-entry"}function layoutGroup(e,n,i){var r=n.items,s=Math.max(0,n.width||0),o=Math.max(0,n.height||0),l=new Bounds().set(0,0,s,o),f=l.clone(),d=l.clone(),p=[],g,v,S,T,k,O;for(k=0,O=r.length;k<O;++k)switch(v=r[k],v.role){case AxisRole$1:T=isYAxis(v)?f:d,T.union(axisLayout(e,v,s,o));break;case TitleRole$1:g=v;break;case LegendRole$1:p.push(legendLayout(e,v));break;case FrameRole$1:case ScopeRole$1:case RowHeader:case RowFooter:case RowTitle:case ColHeader:case ColFooter:case ColTitle:f.union(v.bounds),d.union(v.bounds);break;default:l.union(v.bounds)}if(p.length){const R={};p.forEach(P=>{S=P.orient||Right$1,S!==None&&(R[S]||(R[S]=[])).push(P)});for(const P in R){const F=R[P];gridLayout(e,F,legendParams(F,P,i.legends,f,d,s,o))}p.forEach(P=>{const F=P.bounds;if(F.equals(P._bounds)||(P.bounds=P._bounds,e.dirty(P),P.bounds=F,e.dirty(P)),i.autosize&&i.autosize.type===Fit)switch(P.orient){case Left$1:case Right$1:l.add(F.x1,0).add(F.x2,0);break;case Top$1:case Bottom$1:l.add(0,F.y1).add(0,F.y2)}else l.union(F)})}l.union(f).union(d),g&&l.union(titleLayout(e,g,s,o,l)),n.clip&&l.set(0,0,n.width||0,n.height||0),viewSizeLayout(e,n,l,i)}function viewSizeLayout(e,n,i,r){const s=r.autosize||{},o=s.type;if(e._autosize<1||!o)return;let l=e._width,f=e._height,d=Math.max(0,n.width||0),p=Math.max(0,Math.ceil(-i.x1)),g=Math.max(0,n.height||0),v=Math.max(0,Math.ceil(-i.y1));const S=Math.max(0,Math.ceil(i.x2-d)),T=Math.max(0,Math.ceil(i.y2-g));if(s.contains===Padding$1){const k=e.padding();l-=k.left+k.right,f-=k.top+k.bottom}o===None?(p=0,v=0,d=l,g=f):o===Fit?(d=Math.max(0,l-p-S),g=Math.max(0,f-v-T)):o===FitX?(d=Math.max(0,l-p-S),f=g+v+T):o===FitY?(l=d+p+S,g=Math.max(0,f-v-T)):o===Pad&&(l=d+p+S,f=g+v+T),e._resizeView(l,f,d,g,[p,v],s.resize)}const vtx=Object.freeze(Object.defineProperty({__proto__:null,bound:Bound$1,identifier:Identifier$1,mark:Mark$2,overlap:Overlap$1,render:Render$1,viewlayout:ViewLayout$1},Symbol.toStringTag,{value:"Module"}));function AxisTicks$1(e){Transform.call(this,null,e)}inherits(AxisTicks$1,Transform,{transform(e,n){if(this.value&&!e.modified())return n.StopPropagation;var i=n.dataflow.locale(),r=n.fork(n.NO_SOURCE|n.NO_FIELDS),s=this.value,o=e.scale,l=e.count==null?e.values?e.values.length:10:e.count,f=tickCount(o,l,e.minstep),d=e.format||tickFormat(i,o,f,e.formatSpecifier,e.formatType,!!e.values),p=e.values?validTicks(o,e.values,f):tickValues(o,f);return s&&(r.rem=s),s=p.map((g,v)=>ingest$1({index:v/(p.length-1||1),value:g,label:d(g)})),e.extra&&s.length&&s.push(ingest$1({index:-1,extra:{value:s[0].value},label:""})),r.source=s,r.add=s,this.value=s,r}});function DataJoin$1(e){Transform.call(this,null,e)}function defaultItemCreate(){return ingest$1({})}function newMap(e){const n=fastmap().test(i=>i.exit);return n.lookup=i=>n.get(e(i)),n}inherits(DataJoin$1,Transform,{transform(e,n){var i=n.dataflow,r=n.fork(n.NO_SOURCE|n.NO_FIELDS),s=e.item||defaultItemCreate,o=e.key||tupleid,l=this.value;return isArray(r.encode)&&(r.encode=null),l&&(e.modified("key")||n.modified(o))&&error("DataJoin does not support modified key function or fields."),l||(n=n.addAll(),this.value=l=newMap(o)),n.visit(n.ADD,f=>{const d=o(f);let p=l.get(d);p?p.exit?(l.empty--,r.add.push(p)):r.mod.push(p):(p=s(f),l.set(d,p),r.add.push(p)),p.datum=f,p.exit=!1}),n.visit(n.MOD,f=>{const d=o(f),p=l.get(d);p&&(p.datum=f,r.mod.push(p))}),n.visit(n.REM,f=>{const d=o(f),p=l.get(d);f===p.datum&&!p.exit&&(r.rem.push(p),p.exit=!0,++l.empty)}),n.changed(n.ADD_MOD)&&r.modifies("datum"),(n.clean()||e.clean&&l.empty>i.cleanThreshold)&&i.runAfter(l.clean),r}});function Encode$1(e){Transform.call(this,null,e)}inherits(Encode$1,Transform,{transform(e,n){var i=n.fork(n.ADD_REM),r=e.mod||!1,s=e.encoders,o=n.encode;if(isArray(o))if(i.changed()||o.every(v=>s[v]))o=o[0],i.encode=null;else return n.StopPropagation;var l=o==="enter",f=s.update||falsy,d=s.enter||falsy,p=s.exit||falsy,g=(o&&!l?s[o]:f)||falsy;if(n.changed(n.ADD)&&(n.visit(n.ADD,v=>{d(v,e),f(v,e)}),i.modifies(d.output),i.modifies(f.output),g!==falsy&&g!==f&&(n.visit(n.ADD,v=>{g(v,e)}),i.modifies(g.output))),n.changed(n.REM)&&p!==falsy&&(n.visit(n.REM,v=>{p(v,e)}),i.modifies(p.output)),l||g!==falsy){const v=n.MOD|(e.modified()?n.REFLOW:0);l?(n.visit(v,S=>{const T=d(S,e)||r;(g(S,e)||T)&&i.mod.push(S)}),i.mod.length&&i.modifies(d.output)):n.visit(v,S=>{(g(S,e)||r)&&i.mod.push(S)}),i.mod.length&&i.modifies(g.output)}return i.changed()?i:n.StopPropagation}});function LegendEntries$1(e){Transform.call(this,[],e)}inherits(LegendEntries$1,Transform,{transform(e,n){if(this.value!=null&&!e.modified())return n.StopPropagation;var i=n.dataflow.locale(),r=n.fork(n.NO_SOURCE|n.NO_FIELDS),s=this.value,o=e.type||SymbolLegend,l=e.scale,f=+e.limit,d=tickCount(l,e.count==null?5:e.count,e.minstep),p=!!e.values||o===SymbolLegend,g=e.format||labelFormat(i,l,d,o,e.formatSpecifier,e.formatType,p),v=e.values||labelValues(l,d),S,T,k,O,R;return s&&(r.rem=s),o===SymbolLegend?(f&&v.length>f?(n.dataflow.warn("Symbol legend count exceeds limit, filtering items."),s=v.slice(0,f-1),R=!0):s=v,isFunction(k=e.size)?(!e.values&&l(s[0])===0&&(s=s.slice(1)),O=s.reduce((P,F)=>Math.max(P,k(F,e)),0)):k=constant$4(O=k||8),s=s.map((P,F)=>ingest$1({index:F,label:g(P,F,s),value:P,offset:O,size:k(P,e)})),R&&(R=v[s.length],s.push(ingest$1({index:s.length,label:"".concat(v.length-s.length," entries"),value:R,offset:O,size:k(R,e)})))):o===GradientLegend?(S=l.domain(),T=scaleFraction(l,S[0],peek$1(S)),v.length<3&&!e.values&&S[0]!==peek$1(S)&&(v=[S[0],peek$1(S)]),s=v.map((P,F)=>ingest$1({index:F,label:g(P,F,v),value:P,perc:T(P)}))):(k=v.length-1,T=labelFraction(l),s=v.map((P,F)=>ingest$1({index:F,label:g(P,F,v),value:P,perc:F?T(P):0,perc2:F===k?1:T(v[F+1])}))),r.source=s,r.add=s,this.value=s,r}});const sourceX=e=>e.source.x,sourceY=e=>e.source.y,targetX=e=>e.target.x,targetY=e=>e.target.y;function LinkPath(e){Transform.call(this,{},e)}LinkPath.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};inherits(LinkPath,Transform,{transform(e,n){var i=e.sourceX||sourceX,r=e.sourceY||sourceY,s=e.targetX||targetX,o=e.targetY||targetY,l=e.as||"path",f=e.orient||"vertical",d=e.shape||"line",p=Paths.get(d+"-"+f)||Paths.get(d);return p||error("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),n.visit(n.SOURCE,g=>{g[l]=p(i(g),r(g),s(g),o(g))}),n.reflow(e.modified()).modifies(l)}});const line$1=(e,n,i,r)=>"M"+e+","+n+"L"+i+","+r,lineR=(e,n,i,r)=>line$1(n*Math.cos(e),n*Math.sin(e),r*Math.cos(i),r*Math.sin(i)),arc$1=(e,n,i,r)=>{var s=i-e,o=r-n,l=Math.sqrt(s*s+o*o)/2,f=180*Math.atan2(o,s)/Math.PI;return"M"+e+","+n+"A"+l+","+l+" "+f+" 0 1 "+i+","+r},arcR=(e,n,i,r)=>arc$1(n*Math.cos(e),n*Math.sin(e),r*Math.cos(i),r*Math.sin(i)),curve=(e,n,i,r)=>{const s=i-e,o=r-n,l=.2*(s+o),f=.2*(o-s);return"M"+e+","+n+"C"+(e+l)+","+(n+f)+" "+(i+f)+","+(r-l)+" "+i+","+r},curveR=(e,n,i,r)=>curve(n*Math.cos(e),n*Math.sin(e),r*Math.cos(i),r*Math.sin(i)),orthoX=(e,n,i,r)=>"M"+e+","+n+"V"+r+"H"+i,orthoY=(e,n,i,r)=>"M"+e+","+n+"H"+i+"V"+r,orthoR=(e,n,i,r)=>{const s=Math.cos(e),o=Math.sin(e),l=Math.cos(i),f=Math.sin(i),d=Math.abs(i-e)>Math.PI?i<=e:i>e;return"M"+n*s+","+n*o+"A"+n+","+n+" 0 0,"+(d?1:0)+" "+n*l+","+n*f+"L"+r*l+","+r*f},diagonalX=(e,n,i,r)=>{const s=(e+i)/2;return"M"+e+","+n+"C"+s+","+n+" "+s+","+r+" "+i+","+r},diagonalY=(e,n,i,r)=>{const s=(n+r)/2;return"M"+e+","+n+"C"+e+","+s+" "+i+","+s+" "+i+","+r},diagonalR=(e,n,i,r)=>{const s=Math.cos(e),o=Math.sin(e),l=Math.cos(i),f=Math.sin(i),d=(n+r)/2;return"M"+n*s+","+n*o+"C"+d*s+","+d*o+" "+d*l+","+d*f+" "+r*l+","+r*f},Paths=fastmap({line:line$1,"line-radial":lineR,arc:arc$1,"arc-radial":arcR,curve,"curve-radial":curveR,"orthogonal-horizontal":orthoX,"orthogonal-vertical":orthoY,"orthogonal-radial":orthoR,"diagonal-horizontal":diagonalX,"diagonal-vertical":diagonalY,"diagonal-radial":diagonalR});function Pie(e){Transform.call(this,null,e)}Pie.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};inherits(Pie,Transform,{transform(e,n){var i=e.as||["startAngle","endAngle"],r=i[0],s=i[1],o=e.field||one$2,l=e.startAngle||0,f=e.endAngle!=null?e.endAngle:2*Math.PI,d=n.source,p=d.map(o),g=p.length,v=l,S=(f-l)/sum$1(p),T=range$4(g),k,O,R;for(e.sort&&T.sort((P,F)=>p[P]-p[F]),k=0;k<g;++k)R=p[T[k]],O=d[T[k]],O[r]=v,O[s]=v+=R*S;return this.value=p,n.reflow(e.modified()).modifies(i)}});const DEFAULT_COUNT=5;function includeZero(e){const n=e.type;return!e.bins&&(n===Linear||n===Pow||n===Sqrt)}function includePad(e){return isContinuous$1(e)&&e!==Sequential}const SKIP$1=toSet(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Scale$1(e){Transform.call(this,null,e),this.modified(!0)}inherits(Scale$1,Transform,{transform(e,n){var i=n.dataflow,r=this.value,s=scaleKey(e);(!r||s!==r.type)&&(this.value=r=scale$4(s)());for(s in e)if(!SKIP$1[s]){if(s==="padding"&&includePad(r.type))continue;isFunction(r[s])?r[s](e[s]):i.warn("Unsupported scale property: "+s)}return configureRange(r,e,configureBins(r,e,configureDomain(r,e,i))),n.fork(n.NO_SOURCE|n.NO_FIELDS)}});function scaleKey(e){var n=e.type,i="",r;return n===Sequential?Sequential+"-"+Linear:(isContinuousColor(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,i=r===2?Sequential+"-":r===3?Diverging+"-":""),(i+n||Linear).toLowerCase())}function isContinuousColor(e){const n=e.type;return isContinuous$1(n)&&n!==Time&&n!==UTC&&(e.scheme||e.range&&e.range.length&&e.range.every(isString))}function configureDomain(e,n,i){const r=rawDomain(e,n.domainRaw,i);if(r>-1)return r;var s=n.domain,o=e.type,l=n.zero||n.zero===void 0&&includeZero(e),f,d;if(!s)return 0;if(includePad(o)&&n.padding&&s[0]!==peek$1(s)&&(s=padDomain(o,s,n.range,n.padding,n.exponent,n.constant)),(l||n.domainMin!=null||n.domainMax!=null||n.domainMid!=null)&&(f=(s=s.slice()).length-1||1,l&&(s[0]>0&&(s[0]=0),s[f]<0&&(s[f]=0)),n.domainMin!=null&&(s[0]=n.domainMin),n.domainMax!=null&&(s[f]=n.domainMax),n.domainMid!=null)){d=n.domainMid;const p=d>s[f]?f+1:d<s[0]?0:f;p!==f&&i.warn("Scale domainMid exceeds domain min or max.",d),s.splice(p,0,d)}return e.domain(domainCheck(o,s,i)),o===Ordinal&&e.unknown(n.domainImplicit?implicit:void 0),n.nice&&e.nice&&e.nice(n.nice!==!0&&tickCount(e,n.nice)||null),s.length}function rawDomain(e,n,i){return n?(e.domain(domainCheck(e.type,n,i)),n.length):-1}function padDomain(e,n,i,r,s,o){var l=Math.abs(peek$1(i)-i[0]),f=l/(l-2*r),d=e===Log?zoomLog(n,null,f):e===Sqrt?zoomPow(n,null,f,.5):e===Pow?zoomPow(n,null,f,s||1):e===Symlog?zoomSymlog(n,null,f,o||1):zoomLinear(n,null,f);return n=n.slice(),n[0]=d[0],n[n.length-1]=d[1],n}function domainCheck(e,n,i){if(isLogarithmic(e)){var r=Math.abs(n.reduce((s,o)=>s+(o<0?-1:o>0?1:0),0));r!==n.length&&i.warn("Log scale domain includes zero: "+$(n))}return n}function configureBins(e,n,i){let r=n.bins;if(r&&!isArray(r)){const s=e.domain(),o=s[0],l=peek$1(s),f=r.step;let d=r.start==null?o:r.start,p=r.stop==null?l:r.stop;f||error("Scale bins parameter missing step property."),d<o&&(d=f*Math.ceil(o/f)),p>l&&(p=f*Math.floor(l/f)),r=range$4(d,p+f/2,f)}return r?e.bins=r:e.bins&&delete e.bins,e.type===BinOrdinal&&(r?!n.domain&&!n.domainRaw&&(e.domain(r),i=r.length):e.bins=e.domain()),i}function configureRange(e,n,i){var r=e.type,s=n.round||!1,o=n.range;if(n.rangeStep!=null)o=configureRangeStep(r,n,i);else if(n.scheme&&(o=configureScheme(r,n,i),isFunction(o))){if(e.interpolator)return e.interpolator(o);error("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&isInterpolating(r))return e.interpolator(interpolateColors(flip(o,n.reverse),n.interpolate,n.interpolateGamma));o&&n.interpolate&&e.interpolate?e.interpolate(interpolate$1(n.interpolate,n.interpolateGamma)):isFunction(e.round)?e.round(s):isFunction(e.rangeRound)&&e.interpolate(s?interpolateRound:interpolate$1$1),o&&e.range(flip(o,n.reverse))}function configureRangeStep(e,n,i){e!==Band&&e!==Point&&error("Only band and point scales support rangeStep.");var r=(n.paddingOuter!=null?n.paddingOuter:n.padding)||0,s=e===Point?1:(n.paddingInner!=null?n.paddingInner:n.padding)||0;return[0,n.rangeStep*bandSpace(i,s,r)]}function configureScheme(e,n,i){var r=n.schemeExtent,s,o;return isArray(n.scheme)?o=interpolateColors(n.scheme,n.interpolate,n.interpolateGamma):(s=n.scheme.toLowerCase(),o=scheme(s),o||error("Unrecognized scheme name: ".concat(n.scheme))),i=e===Threshold?i+1:e===BinOrdinal?i-1:e===Quantile||e===Quantize?+n.schemeCount||DEFAULT_COUNT:i,isInterpolating(e)?adjustScheme(o,r,n.reverse):isFunction(o)?quantizeInterpolator(adjustScheme(o,r),i):e===Ordinal?o:o.slice(0,i)}function adjustScheme(e,n,i){return isFunction(e)&&(n||i)?interpolateRange$1(e,flip(n||[0,1],i)):e}function flip(e,n){return n?e.slice().reverse():e}function SortItems$1(e){Transform.call(this,null,e)}inherits(SortItems$1,Transform,{transform(e,n){const i=e.modified("sort")||n.changed(n.ADD)||n.modified(e.sort.fields)||n.modified("datum");return i&&n.source.sort(stableCompare(e.sort)),this.modified(i),n}});const Zero="zero",Center$1="center",Normalize="normalize",DefOutput=["y0","y1"];function Stack(e){Transform.call(this,null,e)}Stack.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Zero,values:[Zero,Center$1,Normalize]},{name:"as",type:"string",array:!0,length:2,default:DefOutput}]};inherits(Stack,Transform,{transform(e,n){var i=e.as||DefOutput,r=i[0],s=i[1],o=stableCompare(e.sort),l=e.field||one$2,f=e.offset===Center$1?stackCenter:e.offset===Normalize?stackNormalize:stackZero,d,p,g,v;for(d=partition$3(n.source,e.groupby,o,l),p=0,g=d.length,v=d.max;p<g;++p)f(d[p],v,l,r,s);return n.reflow(e.modified()).modifies(i)}});function stackCenter(e,n,i,r,s){for(var o=(n-e.sum)/2,l=e.length,f=0,d;f<l;++f)d=e[f],d[r]=o,d[s]=o+=Math.abs(i(d))}function stackNormalize(e,n,i,r,s){for(var o=1/e.sum,l=0,f=e.length,d=0,p=0,g;d<f;++d)g=e[d],g[r]=l,g[s]=l=o*(p+=Math.abs(i(g)))}function stackZero(e,n,i,r,s){for(var o=0,l=0,f=e.length,d=0,p,g;d<f;++d)g=e[d],p=+i(g),p<0?(g[r]=l,g[s]=l+=p):(g[r]=o,g[s]=o+=p)}function partition$3(e,n,i,r){var s=[],o=O=>O(g),l,f,d,p,g,v,S,T,k;if(n==null)s.push(e.slice());else for(l={},f=0,d=e.length;f<d;++f)g=e[f],v=n.map(o),S=l[v],S||(l[v]=S=[],s.push(S)),S.push(g);for(v=0,k=0,p=s.length;v<p;++v){for(S=s[v],f=0,T=0,d=S.length;f<d;++f)T+=Math.abs(r(S[f]));S.sum=T,T>k&&(k=T),i&&S.sort(i)}return s.max=k,s}const encode$1=Object.freeze(Object.defineProperty({__proto__:null,axisticks:AxisTicks$1,datajoin:DataJoin$1,encode:Encode$1,legendentries:LegendEntries$1,linkpath:LinkPath,pie:Pie,scale:Scale$1,sortitems:SortItems$1,stack:Stack},Symbol.toStringTag,{value:"Module"}));var epsilon$3=1e-6,epsilon2=1e-12,pi$1=Math.PI,halfPi$1=pi$1/2,quarterPi=pi$1/4,tau$1=pi$1*2,degrees=180/pi$1,radians=pi$1/180,abs$1=Math.abs,atan=Math.atan,atan2=Math.atan2,cos$1=Math.cos,ceil=Math.ceil,exp=Math.exp,hypot=Math.hypot,log$1=Math.log,pow$1=Math.pow,sin$1=Math.sin,sign=Math.sign||function(e){return e>0?1:e<0?-1:0},sqrt$1=Math.sqrt,tan=Math.tan;function acos(e){return e>1?0:e<-1?pi$1:Math.acos(e)}function asin$1(e){return e>1?halfPi$1:e<-1?-halfPi$1:Math.asin(e)}function noop$2(){}function streamGeometry(e,n){e&&streamGeometryType.hasOwnProperty(e.type)&&streamGeometryType[e.type](e,n)}var streamObjectType={Feature:function(e,n){streamGeometry(e.geometry,n)},FeatureCollection:function(e,n){for(var i=e.features,r=-1,s=i.length;++r<s;)streamGeometry(i[r].geometry,n)}},streamGeometryType={Sphere:function(e,n){n.sphere()},Point:function(e,n){e=e.coordinates,n.point(e[0],e[1],e[2])},MultiPoint:function(e,n){for(var i=e.coordinates,r=-1,s=i.length;++r<s;)e=i[r],n.point(e[0],e[1],e[2])},LineString:function(e,n){streamLine(e.coordinates,n,0)},MultiLineString:function(e,n){for(var i=e.coordinates,r=-1,s=i.length;++r<s;)streamLine(i[r],n,0)},Polygon:function(e,n){streamPolygon(e.coordinates,n)},MultiPolygon:function(e,n){for(var i=e.coordinates,r=-1,s=i.length;++r<s;)streamPolygon(i[r],n)},GeometryCollection:function(e,n){for(var i=e.geometries,r=-1,s=i.length;++r<s;)streamGeometry(i[r],n)}};function streamLine(e,n,i){var r=-1,s=e.length-i,o;for(n.lineStart();++r<s;)o=e[r],n.point(o[0],o[1],o[2]);n.lineEnd()}function streamPolygon(e,n){var i=-1,r=e.length;for(n.polygonStart();++i<r;)streamLine(e[i],n,1);n.polygonEnd()}function geoStream(e,n){e&&streamObjectType.hasOwnProperty(e.type)?streamObjectType[e.type](e,n):streamGeometry(e,n)}var areaRingSum$1=new Adder,areaSum$1=new Adder,lambda00$2,phi00$2,lambda0$1,cosPhi0,sinPhi0,areaStream$1={point:noop$2,lineStart:noop$2,lineEnd:noop$2,polygonStart:function(){areaRingSum$1=new Adder,areaStream$1.lineStart=areaRingStart$1,areaStream$1.lineEnd=areaRingEnd$1},polygonEnd:function(){var e=+areaRingSum$1;areaSum$1.add(e<0?tau$1+e:e),this.lineStart=this.lineEnd=this.point=noop$2},sphere:function(){areaSum$1.add(tau$1)}};function areaRingStart$1(){areaStream$1.point=areaPointFirst$1}function areaRingEnd$1(){areaPoint$1(lambda00$2,phi00$2)}function areaPointFirst$1(e,n){areaStream$1.point=areaPoint$1,lambda00$2=e,phi00$2=n,e*=radians,n*=radians,lambda0$1=e,cosPhi0=cos$1(n=n/2+quarterPi),sinPhi0=sin$1(n)}function areaPoint$1(e,n){e*=radians,n*=radians,n=n/2+quarterPi;var i=e-lambda0$1,r=i>=0?1:-1,s=r*i,o=cos$1(n),l=sin$1(n),f=sinPhi0*l,d=cosPhi0*o+f*cos$1(s),p=f*r*sin$1(s);areaRingSum$1.add(atan2(p,d)),lambda0$1=e,cosPhi0=o,sinPhi0=l}function geoArea$1(e){return areaSum$1=new Adder,geoStream(e,areaStream$1),areaSum$1*2}function spherical(e){return[atan2(e[1],e[0]),asin$1(e[2])]}function cartesian(e){var n=e[0],i=e[1],r=cos$1(i);return[r*cos$1(n),r*sin$1(n),sin$1(i)]}function cartesianDot(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function cartesianCross(e,n){return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}function cartesianAddInPlace(e,n){e[0]+=n[0],e[1]+=n[1],e[2]+=n[2]}function cartesianScale(e,n){return[e[0]*n,e[1]*n,e[2]*n]}function cartesianNormalizeInPlace(e){var n=sqrt$1(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=n,e[1]/=n,e[2]/=n}var lambda0,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,deltaSum,ranges,range$3,boundsStream$2={point:boundsPoint$1,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream$2.point=boundsRingPoint,boundsStream$2.lineStart=boundsRingStart,boundsStream$2.lineEnd=boundsRingEnd,deltaSum=new Adder,areaStream$1.polygonStart()},polygonEnd:function(){areaStream$1.polygonEnd(),boundsStream$2.point=boundsPoint$1,boundsStream$2.lineStart=boundsLineStart,boundsStream$2.lineEnd=boundsLineEnd,areaRingSum$1<0?(lambda0=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon$3?phi1=90:deltaSum<-epsilon$3&&(phi0=-90),range$3[0]=lambda0,range$3[1]=lambda1},sphere:function(){lambda0=-(lambda1=180),phi0=-(phi1=90)}};function boundsPoint$1(e,n){ranges.push(range$3=[lambda0=e,lambda1=e]),n<phi0&&(phi0=n),n>phi1&&(phi1=n)}function linePoint(e,n){var i=cartesian([e*radians,n*radians]);if(p0){var r=cartesianCross(p0,i),s=[r[1],-r[0],0],o=cartesianCross(s,r);cartesianNormalizeInPlace(o),o=spherical(o);var l=e-lambda2,f=l>0?1:-1,d=o[0]*degrees*f,p,g=abs$1(l)>180;g^(f*lambda2<d&&d<f*e)?(p=o[1]*degrees,p>phi1&&(phi1=p)):(d=(d+360)%360-180,g^(f*lambda2<d&&d<f*e)?(p=-o[1]*degrees,p<phi0&&(phi0=p)):(n<phi0&&(phi0=n),n>phi1&&(phi1=n))),g?e<lambda2?angle(lambda0,e)>angle(lambda0,lambda1)&&(lambda1=e):angle(e,lambda1)>angle(lambda0,lambda1)&&(lambda0=e):lambda1>=lambda0?(e<lambda0&&(lambda0=e),e>lambda1&&(lambda1=e)):e>lambda2?angle(lambda0,e)>angle(lambda0,lambda1)&&(lambda1=e):angle(e,lambda1)>angle(lambda0,lambda1)&&(lambda0=e)}else ranges.push(range$3=[lambda0=e,lambda1=e]);n<phi0&&(phi0=n),n>phi1&&(phi1=n),p0=i,lambda2=e}function boundsLineStart(){boundsStream$2.point=linePoint}function boundsLineEnd(){range$3[0]=lambda0,range$3[1]=lambda1,boundsStream$2.point=boundsPoint$1,p0=null}function boundsRingPoint(e,n){if(p0){var i=e-lambda2;deltaSum.add(abs$1(i)>180?i+(i>0?360:-360):i)}else lambda00$1=e,phi00$1=n;areaStream$1.point(e,n),linePoint(e,n)}function boundsRingStart(){areaStream$1.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream$1.lineEnd(),abs$1(deltaSum)>epsilon$3&&(lambda0=-(lambda1=180)),range$3[0]=lambda0,range$3[1]=lambda1,p0=null}function angle(e,n){return(n-=e)<0?n+360:n}function rangeCompare(e,n){return e[0]-n[0]}function rangeContains(e,n){return e[0]<=e[1]?e[0]<=n&&n<=e[1]:n<e[0]||e[1]<n}function geoBounds$1(e){var n,i,r,s,o,l,f;if(phi1=lambda1=-(lambda0=phi0=1/0),ranges=[],geoStream(e,boundsStream$2),i=ranges.length){for(ranges.sort(rangeCompare),n=1,r=ranges[0],o=[r];n<i;++n)s=ranges[n],rangeContains(r,s[0])||rangeContains(r,s[1])?(angle(r[0],s[1])>angle(r[0],r[1])&&(r[1]=s[1]),angle(s[0],r[1])>angle(r[0],r[1])&&(r[0]=s[0])):o.push(r=s);for(l=-1/0,i=o.length-1,n=0,r=o[i];n<=i;r=s,++n)s=o[n],(f=angle(r[1],s[0]))>l&&(l=f,lambda0=s[0],lambda1=r[1])}return ranges=range$3=null,lambda0===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0,phi0],[lambda1,phi1]]}var W0,W1,X0$1,Y0$1,Z0$1,X1$1,Y1$1,Z1$1,X2$2,Y2$2,Z2$1,lambda00,phi00,x0$4,y0$4,z0,centroidStream$1={sphere:noop$2,point:centroidPoint$1,lineStart:centroidLineStart$1,lineEnd:centroidLineEnd$1,polygonStart:function(){centroidStream$1.lineStart=centroidRingStart$1,centroidStream$1.lineEnd=centroidRingEnd$1},polygonEnd:function(){centroidStream$1.lineStart=centroidLineStart$1,centroidStream$1.lineEnd=centroidLineEnd$1}};function centroidPoint$1(e,n){e*=radians,n*=radians;var i=cos$1(n);centroidPointCartesian(i*cos$1(e),i*sin$1(e),sin$1(n))}function centroidPointCartesian(e,n,i){++W0,X0$1+=(e-X0$1)/W0,Y0$1+=(n-Y0$1)/W0,Z0$1+=(i-Z0$1)/W0}function centroidLineStart$1(){centroidStream$1.point=centroidLinePointFirst}function centroidLinePointFirst(e,n){e*=radians,n*=radians;var i=cos$1(n);x0$4=i*cos$1(e),y0$4=i*sin$1(e),z0=sin$1(n),centroidStream$1.point=centroidLinePoint,centroidPointCartesian(x0$4,y0$4,z0)}function centroidLinePoint(e,n){e*=radians,n*=radians;var i=cos$1(n),r=i*cos$1(e),s=i*sin$1(e),o=sin$1(n),l=atan2(sqrt$1((l=y0$4*o-z0*s)*l+(l=z0*r-x0$4*o)*l+(l=x0$4*s-y0$4*r)*l),x0$4*r+y0$4*s+z0*o);W1+=l,X1$1+=l*(x0$4+(x0$4=r)),Y1$1+=l*(y0$4+(y0$4=s)),Z1$1+=l*(z0+(z0=o)),centroidPointCartesian(x0$4,y0$4,z0)}function centroidLineEnd$1(){centroidStream$1.point=centroidPoint$1}function centroidRingStart$1(){centroidStream$1.point=centroidRingPointFirst}function centroidRingEnd$1(){centroidRingPoint(lambda00,phi00),centroidStream$1.point=centroidPoint$1}function centroidRingPointFirst(e,n){lambda00=e,phi00=n,e*=radians,n*=radians,centroidStream$1.point=centroidRingPoint;var i=cos$1(n);x0$4=i*cos$1(e),y0$4=i*sin$1(e),z0=sin$1(n),centroidPointCartesian(x0$4,y0$4,z0)}function centroidRingPoint(e,n){e*=radians,n*=radians;var i=cos$1(n),r=i*cos$1(e),s=i*sin$1(e),o=sin$1(n),l=y0$4*o-z0*s,f=z0*r-x0$4*o,d=x0$4*s-y0$4*r,p=hypot(l,f,d),g=asin$1(p),v=p&&-g/p;X2$2.add(v*l),Y2$2.add(v*f),Z2$1.add(v*d),W1+=g,X1$1+=g*(x0$4+(x0$4=r)),Y1$1+=g*(y0$4+(y0$4=s)),Z1$1+=g*(z0+(z0=o)),centroidPointCartesian(x0$4,y0$4,z0)}function geoCentroid$1(e){W0=W1=X0$1=Y0$1=Z0$1=X1$1=Y1$1=Z1$1=0,X2$2=new Adder,Y2$2=new Adder,Z2$1=new Adder,geoStream(e,centroidStream$1);var n=+X2$2,i=+Y2$2,r=+Z2$1,s=hypot(n,i,r);return s<epsilon2&&(n=X1$1,i=Y1$1,r=Z1$1,W1<epsilon$3&&(n=X0$1,i=Y0$1,r=Z0$1),s=hypot(n,i,r),s<epsilon2)?[NaN,NaN]:[atan2(i,n)*degrees,asin$1(r/s)*degrees]}function compose(e,n){function i(r,s){return r=e(r,s),n(r[0],r[1])}return e.invert&&n.invert&&(i.invert=function(r,s){return r=n.invert(r,s),r&&e.invert(r[0],r[1])}),i}function rotationIdentity(e,n){return abs$1(e)>pi$1&&(e-=Math.round(e/tau$1)*tau$1),[e,n]}rotationIdentity.invert=rotationIdentity;function rotateRadians(e,n,i){return(e%=tau$1)?n||i?compose(rotationLambda(e),rotationPhiGamma(n,i)):rotationLambda(e):n||i?rotationPhiGamma(n,i):rotationIdentity}function forwardRotationLambda(e){return function(n,i){return n+=e,abs$1(n)>pi$1&&(n-=Math.round(n/tau$1)*tau$1),[n,i]}}function rotationLambda(e){var n=forwardRotationLambda(e);return n.invert=forwardRotationLambda(-e),n}function rotationPhiGamma(e,n){var i=cos$1(e),r=sin$1(e),s=cos$1(n),o=sin$1(n);function l(f,d){var p=cos$1(d),g=cos$1(f)*p,v=sin$1(f)*p,S=sin$1(d),T=S*i+g*r;return[atan2(v*s-T*o,g*i-S*r),asin$1(T*s+v*o)]}return l.invert=function(f,d){var p=cos$1(d),g=cos$1(f)*p,v=sin$1(f)*p,S=sin$1(d),T=S*s-v*o;return[atan2(v*s+S*o,g*i+T*r),asin$1(T*i-g*r)]},l}function rotation(e){e=rotateRadians(e[0]*radians,e[1]*radians,e.length>2?e[2]*radians:0);function n(i){return i=e(i[0]*radians,i[1]*radians),i[0]*=degrees,i[1]*=degrees,i}return n.invert=function(i){return i=e.invert(i[0]*radians,i[1]*radians),i[0]*=degrees,i[1]*=degrees,i},n}function circleStream(e,n,i,r,s,o){if(i){var l=cos$1(n),f=sin$1(n),d=r*i;s==null?(s=n+r*tau$1,o=n-d/2):(s=circleRadius(l,s),o=circleRadius(l,o),(r>0?s<o:s>o)&&(s+=r*tau$1));for(var p,g=s;r>0?g>o:g<o;g-=d)p=spherical([l,-f*cos$1(g),-f*sin$1(g)]),e.point(p[0],p[1])}}function circleRadius(e,n){n=cartesian(n),n[0]-=e,cartesianNormalizeInPlace(n);var i=acos(-n[1]);return((-n[2]<0?-i:i)+tau$1-epsilon$3)%tau$1}function clipBuffer(){var e=[],n;return{point:function(i,r,s){n.push([i,r,s])},lineStart:function(){e.push(n=[])},lineEnd:noop$2,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],n=null,i}}}function pointEqual(e,n){return abs$1(e[0]-n[0])<epsilon$3&&abs$1(e[1]-n[1])<epsilon$3}function Intersection(e,n,i,r){this.x=e,this.z=n,this.o=i,this.e=r,this.v=!1,this.n=this.p=null}function clipRejoin(e,n,i,r,s){var o=[],l=[],f,d;if(e.forEach(function(k){if(!((O=k.length-1)<=0)){var O,R=k[0],P=k[O],F;if(pointEqual(R,P)){if(!R[2]&&!P[2]){for(s.lineStart(),f=0;f<O;++f)s.point((R=k[f])[0],R[1]);s.lineEnd();return}P[0]+=2*epsilon$3}o.push(F=new Intersection(R,k,null,!0)),l.push(F.o=new Intersection(R,null,F,!1)),o.push(F=new Intersection(P,k,null,!1)),l.push(F.o=new Intersection(P,null,F,!0))}}),!!o.length){for(l.sort(n),link(o),link(l),f=0,d=l.length;f<d;++f)l[f].e=i=!i;for(var p=o[0],g,v;;){for(var S=p,T=!0;S.v;)if((S=S.n)===p)return;g=S.z,s.lineStart();do{if(S.v=S.o.v=!0,S.e){if(T)for(f=0,d=g.length;f<d;++f)s.point((v=g[f])[0],v[1]);else r(S.x,S.n.x,1,s);S=S.n}else{if(T)for(g=S.p.z,f=g.length-1;f>=0;--f)s.point((v=g[f])[0],v[1]);else r(S.x,S.p.x,-1,s);S=S.p}S=S.o,g=S.z,T=!T}while(!S.v);s.lineEnd()}}}function link(e){if(n=e.length){for(var n,i=0,r=e[0],s;++i<n;)r.n=s=e[i],s.p=r,r=s;r.n=s=e[0],s.p=r}}function longitude(e){return abs$1(e[0])<=pi$1?e[0]:sign(e[0])*((abs$1(e[0])+pi$1)%tau$1-pi$1)}function polygonContains(e,n){var i=longitude(n),r=n[1],s=sin$1(r),o=[sin$1(i),-cos$1(i),0],l=0,f=0,d=new Adder;s===1?r=halfPi$1+epsilon$3:s===-1&&(r=-halfPi$1-epsilon$3);for(var p=0,g=e.length;p<g;++p)if(S=(v=e[p]).length)for(var v,S,T=v[S-1],k=longitude(T),O=T[1]/2+quarterPi,R=sin$1(O),P=cos$1(O),F=0;F<S;++F,k=L,R=j,P=z,T=I){var I=v[F],L=longitude(I),N=I[1]/2+quarterPi,j=sin$1(N),z=cos$1(N),q=L-k,H=q>=0?1:-1,W=H*q,U=W>pi$1,Q=R*j;if(d.add(atan2(Q*H*sin$1(W),P*z+Q*cos$1(W))),l+=U?q+H*tau$1:q,U^k>=i^L>=i){var J=cartesianCross(cartesian(T),cartesian(I));cartesianNormalizeInPlace(J);var ne=cartesianCross(o,J);cartesianNormalizeInPlace(ne);var G=(U^q>=0?-1:1)*asin$1(ne[2]);(r>G||r===G&&(J[0]||J[1]))&&(f+=U^q>=0?1:-1)}}return(l<-epsilon$3||l<epsilon$3&&d<-epsilon2)^f&1}function clip$1(e,n,i,r){return function(s){var o=n(s),l=clipBuffer(),f=n(l),d=!1,p,g,v,S={point:T,lineStart:O,lineEnd:R,polygonStart:function(){S.point=P,S.lineStart=F,S.lineEnd=I,g=[],p=[]},polygonEnd:function(){S.point=T,S.lineStart=O,S.lineEnd=R,g=merge$2(g);var L=polygonContains(p,r);g.length?(d||(s.polygonStart(),d=!0),clipRejoin(g,compareIntersection,L,i,s)):L&&(d||(s.polygonStart(),d=!0),s.lineStart(),i(null,null,1,s),s.lineEnd()),d&&(s.polygonEnd(),d=!1),g=p=null},sphere:function(){s.polygonStart(),s.lineStart(),i(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function T(L,N){e(L,N)&&s.point(L,N)}function k(L,N){o.point(L,N)}function O(){S.point=k,o.lineStart()}function R(){S.point=T,o.lineEnd()}function P(L,N){v.push([L,N]),f.point(L,N)}function F(){f.lineStart(),v=[]}function I(){P(v[0][0],v[0][1]),f.lineEnd();var L=f.clean(),N=l.result(),j,z=N.length,q,H,W;if(v.pop(),p.push(v),v=null,!!z){if(L&1){if(H=N[0],(q=H.length-1)>0){for(d||(s.polygonStart(),d=!0),s.lineStart(),j=0;j<q;++j)s.point((W=H[j])[0],W[1]);s.lineEnd()}return}z>1&&L&2&&N.push(N.pop().concat(N.shift())),g.push(N.filter(validSegment))}}return S}}function validSegment(e){return e.length>1}function compareIntersection(e,n){return((e=e.x)[0]<0?e[1]-halfPi$1-epsilon$3:halfPi$1-e[1])-((n=n.x)[0]<0?n[1]-halfPi$1-epsilon$3:halfPi$1-n[1])}const clipAntimeridian=clip$1(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi$1,-halfPi$1]);function clipAntimeridianLine(e){var n=NaN,i=NaN,r=NaN,s;return{lineStart:function(){e.lineStart(),s=1},point:function(o,l){var f=o>0?pi$1:-pi$1,d=abs$1(o-n);abs$1(d-pi$1)<epsilon$3?(e.point(n,i=(i+l)/2>0?halfPi$1:-halfPi$1),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(f,i),e.point(o,i),s=0):r!==f&&d>=pi$1&&(abs$1(n-r)<epsilon$3&&(n-=r*epsilon$3),abs$1(o-f)<epsilon$3&&(o-=f*epsilon$3),i=clipAntimeridianIntersect(n,i,o,l),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(f,i),s=0),e.point(n=o,i=l),r=f},lineEnd:function(){e.lineEnd(),n=i=NaN},clean:function(){return 2-s}}}function clipAntimeridianIntersect(e,n,i,r){var s,o,l=sin$1(e-i);return abs$1(l)>epsilon$3?atan((sin$1(n)*(o=cos$1(r))*sin$1(i)-sin$1(r)*(s=cos$1(n))*sin$1(e))/(s*o*l)):(n+r)/2}function clipAntimeridianInterpolate(e,n,i,r){var s;if(e==null)s=i*halfPi$1,r.point(-pi$1,s),r.point(0,s),r.point(pi$1,s),r.point(pi$1,0),r.point(pi$1,-s),r.point(0,-s),r.point(-pi$1,-s),r.point(-pi$1,0),r.point(-pi$1,s);else if(abs$1(e[0]-n[0])>epsilon$3){var o=e[0]<n[0]?pi$1:-pi$1;s=i*o/2,r.point(-o,s),r.point(0,s),r.point(o,s)}else r.point(n[0],n[1])}function clipCircle(e){var n=cos$1(e),i=6*radians,r=n>0,s=abs$1(n)>epsilon$3;function o(g,v,S,T){circleStream(T,e,i,S,g,v)}function l(g,v){return cos$1(g)*cos$1(v)>n}function f(g){var v,S,T,k,O;return{lineStart:function(){k=T=!1,O=1},point:function(R,P){var F=[R,P],I,L=l(R,P),N=r?L?0:p(R,P):L?p(R+(R<0?pi$1:-pi$1),P):0;if(!v&&(k=T=L)&&g.lineStart(),L!==T&&(I=d(v,F),(!I||pointEqual(v,I)||pointEqual(F,I))&&(F[2]=1)),L!==T)O=0,L?(g.lineStart(),I=d(F,v),g.point(I[0],I[1])):(I=d(v,F),g.point(I[0],I[1],2),g.lineEnd()),v=I;else if(s&&v&&r^L){var j;!(N&S)&&(j=d(F,v,!0))&&(O=0,r?(g.lineStart(),g.point(j[0][0],j[0][1]),g.point(j[1][0],j[1][1]),g.lineEnd()):(g.point(j[1][0],j[1][1]),g.lineEnd(),g.lineStart(),g.point(j[0][0],j[0][1],3)))}L&&(!v||!pointEqual(v,F))&&g.point(F[0],F[1]),v=F,T=L,S=N},lineEnd:function(){T&&g.lineEnd(),v=null},clean:function(){return O|(k&&T)<<1}}}function d(g,v,S){var T=cartesian(g),k=cartesian(v),O=[1,0,0],R=cartesianCross(T,k),P=cartesianDot(R,R),F=R[0],I=P-F*F;if(!I)return!S&&g;var L=n*P/I,N=-n*F/I,j=cartesianCross(O,R),z=cartesianScale(O,L),q=cartesianScale(R,N);cartesianAddInPlace(z,q);var H=j,W=cartesianDot(z,H),U=cartesianDot(H,H),Q=W*W-U*(cartesianDot(z,z)-1);if(!(Q<0)){var J=sqrt$1(Q),ne=cartesianScale(H,(-W-J)/U);if(cartesianAddInPlace(ne,z),ne=spherical(ne),!S)return ne;var G=g[0],Z=v[0],ae=g[1],oe=v[1],pe;Z<G&&(pe=G,G=Z,Z=pe);var Se=Z-G,ue=abs$1(Se-pi$1)<epsilon$3,ee=ue||Se<epsilon$3;if(!ue&&oe<ae&&(pe=ae,ae=oe,oe=pe),ee?ue?ae+oe>0^ne[1]<(abs$1(ne[0]-G)<epsilon$3?ae:oe):ae<=ne[1]&&ne[1]<=oe:Se>pi$1^(G<=ne[0]&&ne[0]<=Z)){var V=cartesianScale(H,(-W+J)/U);return cartesianAddInPlace(V,z),[ne,spherical(V)]}}}function p(g,v){var S=r?e:pi$1-e,T=0;return g<-S?T|=1:g>S&&(T|=2),v<-S?T|=4:v>S&&(T|=8),T}return clip$1(l,f,o,r?[0,-e]:[-pi$1,e-pi$1])}function clipLine(e,n,i,r,s,o){var l=e[0],f=e[1],d=n[0],p=n[1],g=0,v=1,S=d-l,T=p-f,k;if(k=i-l,!(!S&&k>0)){if(k/=S,S<0){if(k<g)return;k<v&&(v=k)}else if(S>0){if(k>v)return;k>g&&(g=k)}if(k=s-l,!(!S&&k<0)){if(k/=S,S<0){if(k>v)return;k>g&&(g=k)}else if(S>0){if(k<g)return;k<v&&(v=k)}if(k=r-f,!(!T&&k>0)){if(k/=T,T<0){if(k<g)return;k<v&&(v=k)}else if(T>0){if(k>v)return;k>g&&(g=k)}if(k=o-f,!(!T&&k<0)){if(k/=T,T<0){if(k>v)return;k>g&&(g=k)}else if(T>0){if(k<g)return;k<v&&(v=k)}return g>0&&(e[0]=l+g*S,e[1]=f+g*T),v<1&&(n[0]=l+v*S,n[1]=f+v*T),!0}}}}}var clipMax=1e9,clipMin=-clipMax;function clipRectangle(e,n,i,r){function s(p,g){return e<=p&&p<=i&&n<=g&&g<=r}function o(p,g,v,S){var T=0,k=0;if(p==null||(T=l(p,v))!==(k=l(g,v))||d(p,g)<0^v>0)do S.point(T===0||T===3?e:i,T>1?r:n);while((T=(T+v+4)%4)!==k);else S.point(g[0],g[1])}function l(p,g){return abs$1(p[0]-e)<epsilon$3?g>0?0:3:abs$1(p[0]-i)<epsilon$3?g>0?2:1:abs$1(p[1]-n)<epsilon$3?g>0?1:0:g>0?3:2}function f(p,g){return d(p.x,g.x)}function d(p,g){var v=l(p,1),S=l(g,1);return v!==S?v-S:v===0?g[1]-p[1]:v===1?p[0]-g[0]:v===2?p[1]-g[1]:g[0]-p[0]}return function(p){var g=p,v=clipBuffer(),S,T,k,O,R,P,F,I,L,N,j,z={point:q,lineStart:Q,lineEnd:J,polygonStart:W,polygonEnd:U};function q(G,Z){s(G,Z)&&g.point(G,Z)}function H(){for(var G=0,Z=0,ae=T.length;Z<ae;++Z)for(var oe=T[Z],pe=1,Se=oe.length,ue=oe[0],ee,V,se=ue[0],fe=ue[1];pe<Se;++pe)ee=se,V=fe,ue=oe[pe],se=ue[0],fe=ue[1],V<=r?fe>r&&(se-ee)*(r-V)>(fe-V)*(e-ee)&&++G:fe<=r&&(se-ee)*(r-V)<(fe-V)*(e-ee)&&--G;return G}function W(){g=v,S=[],T=[],j=!0}function U(){var G=H(),Z=j&&G,ae=(S=merge$2(S)).length;(Z||ae)&&(p.polygonStart(),Z&&(p.lineStart(),o(null,null,1,p),p.lineEnd()),ae&&clipRejoin(S,f,G,o,p),p.polygonEnd()),g=p,S=T=k=null}function Q(){z.point=ne,T&&T.push(k=[]),N=!0,L=!1,F=I=NaN}function J(){S&&(ne(O,R),P&&L&&v.rejoin(),S.push(v.result())),z.point=q,L&&g.lineEnd()}function ne(G,Z){var ae=s(G,Z);if(T&&k.push([G,Z]),N)O=G,R=Z,P=ae,N=!1,ae&&(g.lineStart(),g.point(G,Z));else if(ae&&L)g.point(G,Z);else{var oe=[F=Math.max(clipMin,Math.min(clipMax,F)),I=Math.max(clipMin,Math.min(clipMax,I))],pe=[G=Math.max(clipMin,Math.min(clipMax,G)),Z=Math.max(clipMin,Math.min(clipMax,Z))];clipLine(oe,pe,e,n,i,r)?(L||(g.lineStart(),g.point(oe[0],oe[1])),g.point(pe[0],pe[1]),ae||g.lineEnd(),j=!1):ae&&(g.lineStart(),g.point(G,Z),j=!1)}F=G,I=Z,L=ae}return z}}function graticuleX(e,n,i){var r=range$4(e,n-epsilon$3,i).concat(n);return function(s){return r.map(function(o){return[s,o]})}}function graticuleY(e,n,i){var r=range$4(e,n-epsilon$3,i).concat(n);return function(s){return r.map(function(o){return[o,s]})}}function graticule(){var e,n,i,r,s,o,l,f,d=10,p=d,g=90,v=360,S,T,k,O,R=2.5;function P(){return{type:"MultiLineString",coordinates:F()}}function F(){return range$4(ceil(r/g)*g,i,g).map(k).concat(range$4(ceil(f/v)*v,l,v).map(O)).concat(range$4(ceil(n/d)*d,e,d).filter(function(I){return abs$1(I%g)>epsilon$3}).map(S)).concat(range$4(ceil(o/p)*p,s,p).filter(function(I){return abs$1(I%v)>epsilon$3}).map(T))}return P.lines=function(){return F().map(function(I){return{type:"LineString",coordinates:I}})},P.outline=function(){return{type:"Polygon",coordinates:[k(r).concat(O(l).slice(1),k(i).reverse().slice(1),O(f).reverse().slice(1))]}},P.extent=function(I){return arguments.length?P.extentMajor(I).extentMinor(I):P.extentMinor()},P.extentMajor=function(I){return arguments.length?(r=+I[0][0],i=+I[1][0],f=+I[0][1],l=+I[1][1],r>i&&(I=r,r=i,i=I),f>l&&(I=f,f=l,l=I),P.precision(R)):[[r,f],[i,l]]},P.extentMinor=function(I){return arguments.length?(n=+I[0][0],e=+I[1][0],o=+I[0][1],s=+I[1][1],n>e&&(I=n,n=e,e=I),o>s&&(I=o,o=s,s=I),P.precision(R)):[[n,o],[e,s]]},P.step=function(I){return arguments.length?P.stepMajor(I).stepMinor(I):P.stepMinor()},P.stepMajor=function(I){return arguments.length?(g=+I[0],v=+I[1],P):[g,v]},P.stepMinor=function(I){return arguments.length?(d=+I[0],p=+I[1],P):[d,p]},P.precision=function(I){return arguments.length?(R=+I,S=graticuleX(o,s,90),T=graticuleY(n,e,R),k=graticuleX(f,l,90),O=graticuleY(r,i,R),P):R},P.extentMajor([[-180,-90+epsilon$3],[180,90-epsilon$3]]).extentMinor([[-180,-80-epsilon$3],[180,80+epsilon$3]])}const identity=e=>e;var areaSum=new Adder,areaRingSum=new Adder,x00$2,y00$2,x0$3,y0$3,areaStream={point:noop$2,lineStart:noop$2,lineEnd:noop$2,polygonStart:function(){areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){areaStream.lineStart=areaStream.lineEnd=areaStream.point=noop$2,areaSum.add(abs$1(areaRingSum)),areaRingSum=new Adder},result:function(){var e=areaSum/2;return areaSum=new Adder,e}};function areaRingStart(){areaStream.point=areaPointFirst}function areaPointFirst(e,n){areaStream.point=areaPoint,x00$2=x0$3=e,y00$2=y0$3=n}function areaPoint(e,n){areaRingSum.add(y0$3*e-x0$3*n),x0$3=e,y0$3=n}function areaRingEnd(){areaPoint(x00$2,y00$2)}const pathArea=areaStream;var x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream={point:boundsPoint,lineStart:noop$2,lineEnd:noop$2,polygonStart:noop$2,polygonEnd:noop$2,result:function(){var e=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),e}};function boundsPoint(e,n){e<x0$2&&(x0$2=e),e>x1&&(x1=e),n<y0$2&&(y0$2=n),n>y1&&(y1=n)}const boundsStream$1=boundsStream;var X0=0,Y0=0,Z0=0,X1=0,Y1=0,Z1=0,X2$1=0,Y2$1=0,Z2=0,x00$1,y00$1,x0$1,y0$1,centroidStream={point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.point=centroidPoint,centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd},result:function(){var e=Z2?[X2$1/Z2,Y2$1/Z2]:Z1?[X1/Z1,Y1/Z1]:Z0?[X0/Z0,Y0/Z0]:[NaN,NaN];return X0=Y0=Z0=X1=Y1=Z1=X2$1=Y2$1=Z2=0,e}};function centroidPoint(e,n){X0+=e,Y0+=n,++Z0}function centroidLineStart(){centroidStream.point=centroidPointFirstLine}function centroidPointFirstLine(e,n){centroidStream.point=centroidPointLine,centroidPoint(x0$1=e,y0$1=n)}function centroidPointLine(e,n){var i=e-x0$1,r=n-y0$1,s=sqrt$1(i*i+r*r);X1+=s*(x0$1+e)/2,Y1+=s*(y0$1+n)/2,Z1+=s,centroidPoint(x0$1=e,y0$1=n)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidPointFirstRing}function centroidRingEnd(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(e,n){centroidStream.point=centroidPointRing,centroidPoint(x00$1=x0$1=e,y00$1=y0$1=n)}function centroidPointRing(e,n){var i=e-x0$1,r=n-y0$1,s=sqrt$1(i*i+r*r);X1+=s*(x0$1+e)/2,Y1+=s*(y0$1+n)/2,Z1+=s,s=y0$1*e-x0$1*n,X2$1+=s*(x0$1+e),Y2$1+=s*(y0$1+n),Z2+=s*3,centroidPoint(x0$1=e,y0$1=n)}const pathCentroid=centroidStream;function PathContext(e){this._context=e}PathContext.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,n){switch(this._point){case 0:{this._context.moveTo(e,n),this._point=1;break}case 1:{this._context.lineTo(e,n);break}default:{this._context.moveTo(e+this._radius,n),this._context.arc(e,n,this._radius,0,tau$1);break}}},result:noop$2};var lengthSum=new Adder,lengthRing,x00,y00,x0,y0,lengthStream={point:noop$2,lineStart:function(){lengthStream.point=lengthPointFirst},lineEnd:function(){lengthRing&&lengthPoint(x00,y00),lengthStream.point=noop$2},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var e=+lengthSum;return lengthSum=new Adder,e}};function lengthPointFirst(e,n){lengthStream.point=lengthPoint,x00=x0=e,y00=y0=n}function lengthPoint(e,n){x0-=e,y0-=n,lengthSum.add(sqrt$1(x0*x0+y0*y0)),x0=e,y0=n}const pathMeasure=lengthStream;let cacheDigits,cacheAppend,cacheRadius,cacheCircle;class PathString{constructor(n){this._append=n==null?append:appendRound(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(n,i){switch(this._point){case 0:{this._append`M${n},${i}`,this._point=1;break}case 1:{this._append`L${n},${i}`;break}default:{if(this._append`M${n},${i}`,this._radius!==cacheRadius||this._append!==cacheAppend){const r=this._radius,s=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,cacheRadius=r,cacheAppend=this._append,cacheCircle=this._,this._=s}this._+=cacheCircle;break}}}result(){const n=this._;return this._="",n.length?n:null}}function append(e){let n=1;this._+=e[0];for(const i=e.length;n<i;++n)this._+=arguments[n]+e[n]}function appendRound(e){const n=Math.floor(e);if(!(n>=0))throw new RangeError(`invalid digits: ${e}`);if(n>15)return append;if(n!==cacheDigits){const i=10**n;cacheDigits=n,cacheAppend=function(s){let o=1;this._+=s[0];for(const l=s.length;o<l;++o)this._+=Math.round(arguments[o]*i)/i+s[o]}}return cacheAppend}function geoPath(e,n){let i=3,r=4.5,s,o;function l(f){return f&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),geoStream(f,s(o))),o.result()}return l.area=function(f){return geoStream(f,s(pathArea)),pathArea.result()},l.measure=function(f){return geoStream(f,s(pathMeasure)),pathMeasure.result()},l.bounds=function(f){return geoStream(f,s(boundsStream$1)),boundsStream$1.result()},l.centroid=function(f){return geoStream(f,s(pathCentroid)),pathCentroid.result()},l.projection=function(f){return arguments.length?(s=f==null?(e=null,identity):(e=f).stream,l):e},l.context=function(f){return arguments.length?(o=f==null?(n=null,new PathString(i)):new PathContext(n=f),typeof r!="function"&&o.pointRadius(r),l):n},l.pointRadius=function(f){return arguments.length?(r=typeof f=="function"?f:(o.pointRadius(+f),+f),l):r},l.digits=function(f){if(!arguments.length)return i;if(f==null)i=null;else{const d=Math.floor(f);if(!(d>=0))throw new RangeError(`invalid digits: ${f}`);i=d}return n===null&&(o=new PathString(i)),l},l.projection(e).digits(i).context(n)}function transformer(e){return function(n){var i=new TransformStream;for(var r in e)i[r]=e[r];return i.stream=n,i}}function TransformStream(){}TransformStream.prototype={constructor:TransformStream,point:function(e,n){this.stream.point(e,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fit$1(e,n,i){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),geoStream(i,e.stream(boundsStream$1)),n(boundsStream$1.result()),r!=null&&e.clipExtent(r),e}function fitExtent(e,n,i){return fit$1(e,function(r){var s=n[1][0]-n[0][0],o=n[1][1]-n[0][1],l=Math.min(s/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),f=+n[0][0]+(s-l*(r[1][0]+r[0][0]))/2,d=+n[0][1]+(o-l*(r[1][1]+r[0][1]))/2;e.scale(150*l).translate([f,d])},i)}function fitSize(e,n,i){return fitExtent(e,[[0,0],n],i)}function fitWidth(e,n,i){return fit$1(e,function(r){var s=+n,o=s/(r[1][0]-r[0][0]),l=(s-o*(r[1][0]+r[0][0]))/2,f=-o*r[0][1];e.scale(150*o).translate([l,f])},i)}function fitHeight(e,n,i){return fit$1(e,function(r){var s=+n,o=s/(r[1][1]-r[0][1]),l=-o*r[0][0],f=(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([l,f])},i)}var maxDepth=16,cosMinDistance=cos$1(30*radians);function resample(e,n){return+n?resample$1(e,n):resampleNone(e)}function resampleNone(e){return transformer({point:function(n,i){n=e(n,i),this.stream.point(n[0],n[1])}})}function resample$1(e,n){function i(r,s,o,l,f,d,p,g,v,S,T,k,O,R){var P=p-r,F=g-s,I=P*P+F*F;if(I>4*n&&O--){var L=l+S,N=f+T,j=d+k,z=sqrt$1(L*L+N*N+j*j),q=asin$1(j/=z),H=abs$1(abs$1(j)-1)<epsilon$3||abs$1(o-v)<epsilon$3?(o+v)/2:atan2(N,L),W=e(H,q),U=W[0],Q=W[1],J=U-r,ne=Q-s,G=F*J-P*ne;(G*G/I>n||abs$1((P*J+F*ne)/I-.5)>.3||l*S+f*T+d*k<cosMinDistance)&&(i(r,s,o,l,f,d,U,Q,H,L/=z,N/=z,j,O,R),R.point(U,Q),i(U,Q,H,L,N,j,p,g,v,S,T,k,O,R))}}return function(r){var s,o,l,f,d,p,g,v,S,T,k,O,R={point:P,lineStart:F,lineEnd:L,polygonStart:function(){r.polygonStart(),R.lineStart=N},polygonEnd:function(){r.polygonEnd(),R.lineStart=F}};function P(q,H){q=e(q,H),r.point(q[0],q[1])}function F(){v=NaN,R.point=I,r.lineStart()}function I(q,H){var W=cartesian([q,H]),U=e(q,H);i(v,S,g,T,k,O,v=U[0],S=U[1],g=q,T=W[0],k=W[1],O=W[2],maxDepth,r),r.point(v,S)}function L(){R.point=P,r.lineEnd()}function N(){F(),R.point=j,R.lineEnd=z}function j(q,H){I(s=q,H),o=v,l=S,f=T,d=k,p=O,R.point=I}function z(){i(v,S,g,T,k,O,o,l,s,f,d,p,maxDepth,r),R.lineEnd=L,L()}return R}}var transformRadians=transformer({point:function(e,n){this.stream.point(e*radians,n*radians)}});function transformRotate(e){return transformer({point:function(n,i){var r=e(n,i);return this.stream.point(r[0],r[1])}})}function scaleTranslate(e,n,i,r,s){function o(l,f){return l*=r,f*=s,[n+e*l,i-e*f]}return o.invert=function(l,f){return[(l-n)/e*r,(i-f)/e*s]},o}function scaleTranslateRotate(e,n,i,r,s,o){if(!o)return scaleTranslate(e,n,i,r,s);var l=cos$1(o),f=sin$1(o),d=l*e,p=f*e,g=l/e,v=f/e,S=(f*i-l*n)/e,T=(f*n+l*i)/e;function k(O,R){return O*=r,R*=s,[d*O-p*R+n,i-p*O-d*R]}return k.invert=function(O,R){return[r*(g*O-v*R+S),s*(T-v*O-g*R)]},k}function projection$1(e){return projectionMutator(function(){return e})()}function projectionMutator(e){var n,i=150,r=480,s=250,o=0,l=0,f=0,d=0,p=0,g,v=0,S=1,T=1,k=null,O=clipAntimeridian,R=null,P,F,I,L=identity,N=.5,j,z,q,H,W;function U(G){return q(G[0]*radians,G[1]*radians)}function Q(G){return G=q.invert(G[0],G[1]),G&&[G[0]*degrees,G[1]*degrees]}U.stream=function(G){return H&&W===G?H:H=transformRadians(transformRotate(g)(O(j(L(W=G)))))},U.preclip=function(G){return arguments.length?(O=G,k=void 0,ne()):O},U.postclip=function(G){return arguments.length?(L=G,R=P=F=I=null,ne()):L},U.clipAngle=function(G){return arguments.length?(O=+G?clipCircle(k=G*radians):(k=null,clipAntimeridian),ne()):k*degrees},U.clipExtent=function(G){return arguments.length?(L=G==null?(R=P=F=I=null,identity):clipRectangle(R=+G[0][0],P=+G[0][1],F=+G[1][0],I=+G[1][1]),ne()):R==null?null:[[R,P],[F,I]]},U.scale=function(G){return arguments.length?(i=+G,J()):i},U.translate=function(G){return arguments.length?(r=+G[0],s=+G[1],J()):[r,s]},U.center=function(G){return arguments.length?(o=G[0]%360*radians,l=G[1]%360*radians,J()):[o*degrees,l*degrees]},U.rotate=function(G){return arguments.length?(f=G[0]%360*radians,d=G[1]%360*radians,p=G.length>2?G[2]%360*radians:0,J()):[f*degrees,d*degrees,p*degrees]},U.angle=function(G){return arguments.length?(v=G%360*radians,J()):v*degrees},U.reflectX=function(G){return arguments.length?(S=G?-1:1,J()):S<0},U.reflectY=function(G){return arguments.length?(T=G?-1:1,J()):T<0},U.precision=function(G){return arguments.length?(j=resample(z,N=G*G),ne()):sqrt$1(N)},U.fitExtent=function(G,Z){return fitExtent(U,G,Z)},U.fitSize=function(G,Z){return fitSize(U,G,Z)},U.fitWidth=function(G,Z){return fitWidth(U,G,Z)},U.fitHeight=function(G,Z){return fitHeight(U,G,Z)};function J(){var G=scaleTranslateRotate(i,0,0,S,T,v).apply(null,n(o,l)),Z=scaleTranslateRotate(i,r-G[0],s-G[1],S,T,v);return g=rotateRadians(f,d,p),z=compose(n,Z),q=compose(g,z),j=resample(z,N),ne()}function ne(){return H=W=null,U}return function(){return n=e.apply(this,arguments),U.invert=n.invert&&Q,J()}}function conicProjection(e){var n=0,i=pi$1/3,r=projectionMutator(e),s=r(n,i);return s.parallels=function(o){return arguments.length?r(n=o[0]*radians,i=o[1]*radians):[n*degrees,i*degrees]},s}function cylindricalEqualAreaRaw(e){var n=cos$1(e);function i(r,s){return[r*n,sin$1(s)/n]}return i.invert=function(r,s){return[r/n,asin$1(s*n)]},i}function conicEqualAreaRaw(e,n){var i=sin$1(e),r=(i+sin$1(n))/2;if(abs$1(r)<epsilon$3)return cylindricalEqualAreaRaw(e);var s=1+i*(2*r-i),o=sqrt$1(s)/r;function l(f,d){var p=sqrt$1(s-2*r*sin$1(d))/r;return[p*sin$1(f*=r),o-p*cos$1(f)]}return l.invert=function(f,d){var p=o-d,g=atan2(f,abs$1(p))*sign(p);return p*r<0&&(g-=pi$1*sign(f)*sign(p)),[g/r,asin$1((s-(f*f+p*p)*r*r)/(2*r))]},l}function geoConicEqualArea(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])}function geoAlbers(){return geoConicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function multiplex(e){var n=e.length;return{point:function(i,r){for(var s=-1;++s<n;)e[s].point(i,r)},sphere:function(){for(var i=-1;++i<n;)e[i].sphere()},lineStart:function(){for(var i=-1;++i<n;)e[i].lineStart()},lineEnd:function(){for(var i=-1;++i<n;)e[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<n;)e[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<n;)e[i].polygonEnd()}}}function geoAlbersUsa(){var e,n,i=geoAlbers(),r,s=geoConicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,l=geoConicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f,d,p={point:function(S,T){d=[S,T]}};function g(S){var T=S[0],k=S[1];return d=null,r.point(T,k),d||(o.point(T,k),d)||(f.point(T,k),d)}g.invert=function(S){var T=i.scale(),k=i.translate(),O=(S[0]-k[0])/T,R=(S[1]-k[1])/T;return(R>=.12&&R<.234&&O>=-.425&&O<-.214?s:R>=.166&&R<.234&&O>=-.214&&O<-.115?l:i).invert(S)},g.stream=function(S){return e&&n===S?e:e=multiplex([i.stream(n=S),s.stream(S),l.stream(S)])},g.precision=function(S){return arguments.length?(i.precision(S),s.precision(S),l.precision(S),v()):i.precision()},g.scale=function(S){return arguments.length?(i.scale(S),s.scale(S*.35),l.scale(S),g.translate(i.translate())):i.scale()},g.translate=function(S){if(!arguments.length)return i.translate();var T=i.scale(),k=+S[0],O=+S[1];return r=i.translate(S).clipExtent([[k-.455*T,O-.238*T],[k+.455*T,O+.238*T]]).stream(p),o=s.translate([k-.307*T,O+.201*T]).clipExtent([[k-.425*T+epsilon$3,O+.12*T+epsilon$3],[k-.214*T-epsilon$3,O+.234*T-epsilon$3]]).stream(p),f=l.translate([k-.205*T,O+.212*T]).clipExtent([[k-.214*T+epsilon$3,O+.166*T+epsilon$3],[k-.115*T-epsilon$3,O+.234*T-epsilon$3]]).stream(p),v()},g.fitExtent=function(S,T){return fitExtent(g,S,T)},g.fitSize=function(S,T){return fitSize(g,S,T)},g.fitWidth=function(S,T){return fitWidth(g,S,T)},g.fitHeight=function(S,T){return fitHeight(g,S,T)};function v(){return e=n=null,g}return g.scale(1070)}function azimuthalRaw(e){return function(n,i){var r=cos$1(n),s=cos$1(i),o=e(r*s);return o===1/0?[2,0]:[o*s*sin$1(n),o*sin$1(i)]}}function azimuthalInvert(e){return function(n,i){var r=sqrt$1(n*n+i*i),s=e(r),o=sin$1(s),l=cos$1(s);return[atan2(n*o,r*l),asin$1(r&&i*o/r)]}}var azimuthalEqualAreaRaw=azimuthalRaw(function(e){return sqrt$1(2/(1+e))});azimuthalEqualAreaRaw.invert=azimuthalInvert(function(e){return 2*asin$1(e/2)});function geoAzimuthalEqualArea(){return projection$1(azimuthalEqualAreaRaw).scale(124.75).clipAngle(180-.001)}var azimuthalEquidistantRaw=azimuthalRaw(function(e){return(e=acos(e))&&e/sin$1(e)});azimuthalEquidistantRaw.invert=azimuthalInvert(function(e){return e});function geoAzimuthalEquidistant(){return projection$1(azimuthalEquidistantRaw).scale(79.4188).clipAngle(180-.001)}function mercatorRaw(e,n){return[e,log$1(tan((halfPi$1+n)/2))]}mercatorRaw.invert=function(e,n){return[e,2*atan(exp(n))-halfPi$1]};function geoMercator(){return mercatorProjection(mercatorRaw).scale(961/tau$1)}function mercatorProjection(e){var n=projection$1(e),i=n.center,r=n.scale,s=n.translate,o=n.clipExtent,l=null,f,d,p;n.scale=function(v){return arguments.length?(r(v),g()):r()},n.translate=function(v){return arguments.length?(s(v),g()):s()},n.center=function(v){return arguments.length?(i(v),g()):i()},n.clipExtent=function(v){return arguments.length?(v==null?l=f=d=p=null:(l=+v[0][0],f=+v[0][1],d=+v[1][0],p=+v[1][1]),g()):l==null?null:[[l,f],[d,p]]};function g(){var v=pi$1*r(),S=n(rotation(n.rotate()).invert([0,0]));return o(l==null?[[S[0]-v,S[1]-v],[S[0]+v,S[1]+v]]:e===mercatorRaw?[[Math.max(S[0]-v,l),f],[Math.min(S[0]+v,d),p]]:[[l,Math.max(S[1]-v,f)],[d,Math.min(S[1]+v,p)]])}return g()}function tany(e){return tan((halfPi$1+e)/2)}function conicConformalRaw(e,n){var i=cos$1(e),r=e===n?sin$1(e):log$1(i/cos$1(n))/log$1(tany(n)/tany(e)),s=i*pow$1(tany(e),r)/r;if(!r)return mercatorRaw;function o(l,f){s>0?f<-halfPi$1+epsilon$3&&(f=-halfPi$1+epsilon$3):f>halfPi$1-epsilon$3&&(f=halfPi$1-epsilon$3);var d=s/pow$1(tany(f),r);return[d*sin$1(r*l),s-d*cos$1(r*l)]}return o.invert=function(l,f){var d=s-f,p=sign(r)*sqrt$1(l*l+d*d),g=atan2(l,abs$1(d))*sign(d);return d*r<0&&(g-=pi$1*sign(l)*sign(d)),[g/r,2*atan(pow$1(s/p,1/r))-halfPi$1]},o}function geoConicConformal(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])}function equirectangularRaw(e,n){return[e,n]}equirectangularRaw.invert=equirectangularRaw;function geoEquirectangular(){return projection$1(equirectangularRaw).scale(152.63)}function conicEquidistantRaw(e,n){var i=cos$1(e),r=e===n?sin$1(e):(i-cos$1(n))/(n-e),s=i/r+e;if(abs$1(r)<epsilon$3)return equirectangularRaw;function o(l,f){var d=s-f,p=r*l;return[d*sin$1(p),s-d*cos$1(p)]}return o.invert=function(l,f){var d=s-f,p=atan2(l,abs$1(d))*sign(d);return d*r<0&&(p-=pi$1*sign(l)*sign(d)),[p/r,s-sign(r)*sqrt$1(l*l+d*d)]},o}function geoConicEquidistant(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])}var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M=sqrt$1(3)/2,iterations=12;function equalEarthRaw(e,n){var i=asin$1(M*sin$1(n)),r=i*i,s=r*r*r;return[e*cos$1(i)/(M*(A1+3*A2*r+s*(7*A3+9*A4*r))),i*(A1+A2*r+s*(A3+A4*r))]}equalEarthRaw.invert=function(e,n){for(var i=n,r=i*i,s=r*r*r,o=0,l,f,d;o<iterations&&(f=i*(A1+A2*r+s*(A3+A4*r))-n,d=A1+3*A2*r+s*(7*A3+9*A4*r),i-=l=f/d,r=i*i,s=r*r*r,!(abs$1(l)<epsilon2));++o);return[M*e*(A1+3*A2*r+s*(7*A3+9*A4*r))/cos$1(i),asin$1(sin$1(i)/M)]};function geoEqualEarth(){return projection$1(equalEarthRaw).scale(177.158)}function gnomonicRaw(e,n){var i=cos$1(n),r=cos$1(e)*i;return[i*sin$1(e)/r,sin$1(n)/r]}gnomonicRaw.invert=azimuthalInvert(atan);function geoGnomonic(){return projection$1(gnomonicRaw).scale(144.049).clipAngle(60)}function geoIdentity(){var e=1,n=0,i=0,r=1,s=1,o=0,l,f,d=null,p,g,v,S=1,T=1,k=transformer({point:function(L,N){var j=I([L,N]);this.stream.point(j[0],j[1])}}),O=identity,R,P;function F(){return S=e*r,T=e*s,R=P=null,I}function I(L){var N=L[0]*S,j=L[1]*T;if(o){var z=j*l-N*f;N=N*l+j*f,j=z}return[N+n,j+i]}return I.invert=function(L){var N=L[0]-n,j=L[1]-i;if(o){var z=j*l+N*f;N=N*l-j*f,j=z}return[N/S,j/T]},I.stream=function(L){return R&&P===L?R:R=k(O(P=L))},I.postclip=function(L){return arguments.length?(O=L,d=p=g=v=null,F()):O},I.clipExtent=function(L){return arguments.length?(O=L==null?(d=p=g=v=null,identity):clipRectangle(d=+L[0][0],p=+L[0][1],g=+L[1][0],v=+L[1][1]),F()):d==null?null:[[d,p],[g,v]]},I.scale=function(L){return arguments.length?(e=+L,F()):e},I.translate=function(L){return arguments.length?(n=+L[0],i=+L[1],F()):[n,i]},I.angle=function(L){return arguments.length?(o=L%360*radians,f=sin$1(o),l=cos$1(o),F()):o*degrees},I.reflectX=function(L){return arguments.length?(r=L?-1:1,F()):r<0},I.reflectY=function(L){return arguments.length?(s=L?-1:1,F()):s<0},I.fitExtent=function(L,N){return fitExtent(I,L,N)},I.fitSize=function(L,N){return fitSize(I,L,N)},I.fitWidth=function(L,N){return fitWidth(I,L,N)},I.fitHeight=function(L,N){return fitHeight(I,L,N)},I}function naturalEarth1Raw(e,n){var i=n*n,r=i*i;return[e*(.8707-.131979*i+r*(-.013791+r*(.003971*i-.001529*r))),n*(1.007226+i*(.015085+r*(-.044475+.028874*i-.005916*r)))]}naturalEarth1Raw.invert=function(e,n){var i=n,r=25,s;do{var o=i*i,l=o*o;i-=s=(i*(1.007226+o*(.015085+l*(-.044475+.028874*o-.005916*l)))-n)/(1.007226+o*(.015085*3+l*(-.044475*7+.028874*9*o-.005916*11*l)))}while(abs$1(s)>epsilon$3&&--r>0);return[e/(.8707+(o=i*i)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),i]};function geoNaturalEarth1(){return projection$1(naturalEarth1Raw).scale(175.295)}function orthographicRaw(e,n){return[cos$1(n)*sin$1(e),sin$1(n)]}orthographicRaw.invert=azimuthalInvert(asin$1);function geoOrthographic(){return projection$1(orthographicRaw).scale(249.5).clipAngle(90+epsilon$3)}function stereographicRaw(e,n){var i=cos$1(n),r=1+cos$1(e)*i;return[i*sin$1(e)/r,sin$1(n)/r]}stereographicRaw.invert=azimuthalInvert(function(e){return 2*atan(e)});function geoStereographic(){return projection$1(stereographicRaw).scale(250).clipAngle(142)}function transverseMercatorRaw(e,n){return[log$1(tan((halfPi$1+n)/2)),-e]}transverseMercatorRaw.invert=function(e,n){return[-n,2*atan(exp(e))-halfPi$1]};function geoTransverseMercator(){var e=mercatorProjection(transverseMercatorRaw),n=e.center,i=e.rotate;return e.center=function(r){return arguments.length?n([-r[1],r[0]]):(r=n(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?i([r[0],r[1],r.length>2?r[2]+90:90]):(r=i(),[r[0],r[1],r[2]-90])},i([0,0,90]).scale(159.155)}var abs=Math.abs,cos=Math.cos,sin=Math.sin,epsilon$2=1e-6,pi=Math.PI,halfPi=pi/2,sqrt2=sqrt(2);function asin(e){return e>1?halfPi:e<-1?-halfPi:Math.asin(e)}function sqrt(e){return e>0?Math.sqrt(e):0}function mollweideBromleyTheta(e,n){var i=e*sin(n),r=30,s;do n-=s=(n+sin(n)-i)/(1+cos(n));while(abs(s)>epsilon$2&&--r>0);return n/2}function mollweideBromleyRaw(e,n,i){function r(s,o){return[e*s*cos(o=mollweideBromleyTheta(i,o)),n*sin(o)]}return r.invert=function(s,o){return o=asin(o/n),[s/(e*cos(o)),asin((2*o+sin(2*o))/i)]},r}var mollweideRaw=mollweideBromleyRaw(sqrt2/halfPi,sqrt2,pi);function geoMollweide(){return projection$1(mollweideRaw).scale(169.529)}const defaultPath=geoPath(),projectionProperties=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function create$1(e,n){return function i(){const r=n();return r.type=e,r.path=geoPath().projection(r),r.copy=r.copy||function(){const s=i();return projectionProperties.forEach(o=>{r[o]&&s[o](r[o]())}),s.path.pointRadius(r.path.pointRadius()),s},r}}function projection(e,n){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(projections[e]=create$1(e,n),this):projections[e]||null}function getProjectionPath(e){return e&&e.path||defaultPath}const projections={albers:geoAlbers,albersusa:geoAlbersUsa,azimuthalequalarea:geoAzimuthalEqualArea,azimuthalequidistant:geoAzimuthalEquidistant,conicconformal:geoConicConformal,conicequalarea:geoConicEqualArea,conicequidistant:geoConicEquidistant,equalEarth:geoEqualEarth,equirectangular:geoEquirectangular,gnomonic:geoGnomonic,identity:geoIdentity,mercator:geoMercator,mollweide:geoMollweide,naturalEarth1:geoNaturalEarth1,orthographic:geoOrthographic,stereographic:geoStereographic,transversemercator:geoTransverseMercator};for(const e in projections)projection(e,projections[e]);function noop$1(){}const cases=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function contours(){var e=1,n=1,i=f;function r(d,p){return p.map(g=>s(d,g))}function s(d,p){var g=[],v=[];return o(d,p,S=>{i(S,d,p),area$1(S)>0?g.push([S]):v.push(S)}),v.forEach(S=>{for(var T=0,k=g.length,O;T<k;++T)if(contains$1((O=g[T])[0],S)!==-1){O.push(S);return}}),{type:"MultiPolygon",value:p,coordinates:g}}function o(d,p,g){var v=new Array,S=new Array,T,k,O,R,P,F;for(T=k=-1,R=d[0]>=p,cases[R<<1].forEach(I);++T<e-1;)O=R,R=d[T+1]>=p,cases[O|R<<1].forEach(I);for(cases[R<<0].forEach(I);++k<n-1;){for(T=-1,R=d[k*e+e]>=p,P=d[k*e]>=p,cases[R<<1|P<<2].forEach(I);++T<e-1;)O=R,R=d[k*e+e+T+1]>=p,F=P,P=d[k*e+T+1]>=p,cases[O|R<<1|P<<2|F<<3].forEach(I);cases[R|P<<3].forEach(I)}for(T=-1,P=d[k*e]>=p,cases[P<<2].forEach(I);++T<e-1;)F=P,P=d[k*e+T+1]>=p,cases[P<<2|F<<3].forEach(I);cases[P<<3].forEach(I);function I(L){var N=[L[0][0]+T,L[0][1]+k],j=[L[1][0]+T,L[1][1]+k],z=l(N),q=l(j),H,W;(H=S[z])?(W=v[q])?(delete S[H.end],delete v[W.start],H===W?(H.ring.push(j),g(H.ring)):v[H.start]=S[W.end]={start:H.start,end:W.end,ring:H.ring.concat(W.ring)}):(delete S[H.end],H.ring.push(j),S[H.end=q]=H):(H=v[q])?(W=S[z])?(delete v[H.start],delete S[W.end],H===W?(H.ring.push(j),g(H.ring)):v[W.start]=S[H.end]={start:W.start,end:H.end,ring:W.ring.concat(H.ring)}):(delete v[H.start],H.ring.unshift(N),v[H.start=z]=H):v[z]=S[q]={start:z,end:q,ring:[N,j]}}}function l(d){return d[0]*2+d[1]*(e+1)*4}function f(d,p,g){d.forEach(v=>{var S=v[0],T=v[1],k=S|0,O=T|0,R,P=p[O*e+k];S>0&&S<e&&k===S&&(R=p[O*e+k-1],v[0]=S+(g-R)/(P-R)-.5),T>0&&T<n&&O===T&&(R=p[(O-1)*e+k],v[1]=T+(g-R)/(P-R)-.5)})}return r.contour=s,r.size=function(d){if(!arguments.length)return[e,n];var p=Math.floor(d[0]),g=Math.floor(d[1]);return p>=0&&g>=0||error("invalid size"),e=p,n=g,r},r.smooth=function(d){return arguments.length?(i=d?f:noop$1,r):i===f},r}function area$1(e){for(var n=0,i=e.length,r=e[i-1][1]*e[0][0]-e[i-1][0]*e[0][1];++n<i;)r+=e[n-1][1]*e[n][0]-e[n-1][0]*e[n][1];return r}function contains$1(e,n){for(var i=-1,r=n.length,s;++i<r;)if(s=ringContains(e,n[i]))return s;return 0}function ringContains(e,n){for(var i=n[0],r=n[1],s=-1,o=0,l=e.length,f=l-1;o<l;f=o++){var d=e[o],p=d[0],g=d[1],v=e[f],S=v[0],T=v[1];if(segmentContains(d,v,n))return 0;g>r!=T>r&&i<(S-p)*(r-g)/(T-g)+p&&(s=-s)}return s}function segmentContains(e,n,i){var r;return collinear$1(e,n,i)&&within(e[r=+(e[0]===n[0])],i[r],n[r])}function collinear$1(e,n,i){return(n[0]-e[0])*(i[1]-e[1])===(i[0]-e[0])*(n[1]-e[1])}function within(e,n,i){return e<=n&&n<=i||i<=n&&n<=e}function quantize(e,n,i){return function(r){var s=extent(r),o=i?Math.min(s[0],0):s[0],l=s[1],f=l-o,d=n?tickStep(o,l,e):f/(e+1);return range$4(o+d,l,d)}}function Isocontour(e){Transform.call(this,null,e)}Isocontour.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};inherits(Isocontour,Transform,{transform(e,n){if(this.value&&!n.changed()&&!e.modified())return n.StopPropagation;var i=n.fork(n.NO_SOURCE|n.NO_FIELDS),r=n.materialize(n.SOURCE).source,s=e.field||identity$6,o=contours().smooth(e.smooth!==!1),l=e.thresholds||levels(r,s,e),f=e.as===null?null:e.as||"contour",d=[];return r.forEach(p=>{const g=s(p),v=o.size([g.width,g.height])(g.values,isArray(l)?l:l(g.values));transformPaths(v,g,p,e),v.forEach(S=>{d.push(rederive(p,ingest$1(f!=null?{[f]:S}:S)))})}),this.value&&(i.rem=this.value),this.value=i.source=i.add=d,i}});function levels(e,n,i){const r=quantize(i.levels||10,i.nice,i.zero!==!1);return i.resolve!=="shared"?r:r(e.map(s=>max$2(n(s).values)))}function transformPaths(e,n,i,r){let s=r.scale||n.scale,o=r.translate||n.translate;if(isFunction(s)&&(s=s(i,r)),isFunction(o)&&(o=o(i,r)),(s===1||s==null)&&!o)return;const l=(isNumber$1(s)?s:s[0])||1,f=(isNumber$1(s)?s:s[1])||1,d=o&&o[0]||0,p=o&&o[1]||0;e.forEach(transform$1(n,l,f,d,p))}function transform$1(e,n,i,r,s){const o=e.x1||0,l=e.y1||0,f=n*i<0;function d(v){v.forEach(p)}function p(v){f&&v.reverse(),v.forEach(g)}function g(v){v[0]=(v[0]-o)*n+r,v[1]=(v[1]-l)*i+s}return function(v){return v.coordinates.forEach(d),v}}function radius(e,n,i){const r=e>=0?e:estimateBandwidth(n,i);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function number$2(e){return isFunction(e)?e:constant$4(+e)}function density2D(){var e=d=>d[0],n=d=>d[1],i=one$2,r=[-1,-1],s=960,o=500,l=2;function f(d,p){const g=radius(r[0],d,e)>>l,v=radius(r[1],d,n)>>l,S=g?g+2:0,T=v?v+2:0,k=2*S+(s>>l),O=2*T+(o>>l),R=new Float32Array(k*O),P=new Float32Array(k*O);let F=R;d.forEach(L=>{const N=S+(+e(L)>>l),j=T+(+n(L)>>l);N>=0&&N<k&&j>=0&&j<O&&(R[N+j*k]+=+i(L))}),g>0&&v>0?(blurX(k,O,R,P,g),blurY(k,O,P,R,v),blurX(k,O,R,P,g),blurY(k,O,P,R,v),blurX(k,O,R,P,g),blurY(k,O,P,R,v)):g>0?(blurX(k,O,R,P,g),blurX(k,O,P,R,g),blurX(k,O,R,P,g),F=P):v>0&&(blurY(k,O,R,P,v),blurY(k,O,P,R,v),blurY(k,O,R,P,v),F=P);const I=p?Math.pow(2,-2*l):1/sum$1(F);for(let L=0,N=k*O;L<N;++L)F[L]*=I;return{values:F,scale:1<<l,width:k,height:O,x1:S,y1:T,x2:S+(s>>l),y2:T+(o>>l)}}return f.x=function(d){return arguments.length?(e=number$2(d),f):e},f.y=function(d){return arguments.length?(n=number$2(d),f):n},f.weight=function(d){return arguments.length?(i=number$2(d),f):i},f.size=function(d){if(!arguments.length)return[s,o];var p=+d[0],g=+d[1];return p>=0&&g>=0||error("invalid size"),s=p,o=g,f},f.cellSize=function(d){return arguments.length?((d=+d)>=1||error("invalid cell size"),l=Math.floor(Math.log(d)/Math.LN2),f):1<<l},f.bandwidth=function(d){return arguments.length?(d=array$5(d),d.length===1&&(d=[+d[0],+d[0]]),d.length!==2&&error("invalid bandwidth"),r=d,f):r},f}function blurX(e,n,i,r,s){const o=(s<<1)+1;for(let l=0;l<n;++l)for(let f=0,d=0;f<e+s;++f)f<e&&(d+=i[f+l*e]),f>=s&&(f>=o&&(d-=i[f-o+l*e]),r[f-s+l*e]=d/Math.min(f+1,e-1+o-f,o))}function blurY(e,n,i,r,s){const o=(s<<1)+1;for(let l=0;l<e;++l)for(let f=0,d=0;f<n+s;++f)f<n&&(d+=i[l+f*e]),f>=s&&(f>=o&&(d-=i[l+(f-o)*e]),r[l+(f-s)*e]=d/Math.min(f+1,n-1+o-f,o))}function KDE2D(e){Transform.call(this,null,e)}KDE2D.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const PARAMS=["x","y","weight","size","cellSize","bandwidth"];function params(e,n){return PARAMS.forEach(i=>n[i]!=null?e[i](n[i]):0),e}inherits(KDE2D,Transform,{transform(e,n){if(this.value&&!n.changed()&&!e.modified())return n.StopPropagation;var i=n.fork(n.NO_SOURCE|n.NO_FIELDS),r=n.materialize(n.SOURCE).source,s=partition$2(r,e.groupby),o=(e.groupby||[]).map(accessorName),l=params(density2D(),e),f=e.as||"grid",d=[];function p(g,v){for(let S=0;S<o.length;++S)g[o[S]]=v[S];return g}return d=s.map(g=>ingest$1(p({[f]:l(g,e.counts)},g.dims))),this.value&&(i.rem=this.value),this.value=i.source=i.add=d,i}});function partition$2(e,n){var i=[],r=g=>g(f),s,o,l,f,d,p;if(n==null)i.push(e);else for(s={},o=0,l=e.length;o<l;++o)f=e[o],d=n.map(r),p=s[d],p||(s[d]=p=[],p.dims=d,i.push(p)),p.push(f);return i}function Contour(e){Transform.call(this,null,e)}Contour.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};inherits(Contour,Transform,{transform(e,n){if(this.value&&!n.changed()&&!e.modified())return n.StopPropagation;var i=n.fork(n.NO_SOURCE|n.NO_FIELDS),r=contours().smooth(e.smooth!==!1),s=e.values,o=e.thresholds||quantize(e.count||10,e.nice,!!s),l=e.size,f,d;return s||(s=n.materialize(n.SOURCE).source,f=params(density2D(),e)(s,!0),d=transform$1(f,f.scale||1,f.scale||1,0,0),l=[f.width,f.height],s=f.values),o=isArray(o)?o:o(s),s=r.size(l)(s,o),d&&s.forEach(d),this.value&&(i.rem=this.value),this.value=i.source=i.add=(s||[]).map(ingest$1),i}});const Feature="Feature",FeatureCollection="FeatureCollection",MultiPoint="MultiPoint";function GeoJSON(e){Transform.call(this,null,e)}GeoJSON.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};inherits(GeoJSON,Transform,{transform(e,n){var i=this._features,r=this._points,s=e.fields,o=s&&s[0],l=s&&s[1],f=e.geojson||!s&&identity$6,d=n.ADD,p;p=e.modified()||n.changed(n.REM)||n.modified(accessorFields(f))||o&&n.modified(accessorFields(o))||l&&n.modified(accessorFields(l)),(!this.value||p)&&(d=n.SOURCE,this._features=i=[],this._points=r=[]),f&&n.visit(d,g=>i.push(f(g))),o&&l&&(n.visit(d,g=>{var v=o(g),S=l(g);v!=null&&S!=null&&(v=+v)===v&&(S=+S)===S&&r.push([v,S])}),i=i.concat({type:Feature,geometry:{type:MultiPoint,coordinates:r}})),this.value={type:FeatureCollection,features:i}}});function GeoPath(e){Transform.call(this,null,e)}GeoPath.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};inherits(GeoPath,Transform,{transform(e,n){var i=n.fork(n.ALL),r=this.value,s=e.field||identity$6,o=e.as||"path",l=i.SOURCE;!r||e.modified()?(this.value=r=getProjectionPath(e.projection),i.materialize().reflow()):l=s===identity$6||n.modified(s.fields)?i.ADD_MOD:i.ADD;const f=initPath(r,e.pointRadius);return i.visit(l,d=>d[o]=r(s(d))),r.pointRadius(f),i.modifies(o)}});function initPath(e,n){const i=e.pointRadius();return e.context(null),n!=null&&e.pointRadius(n),i}function GeoPoint(e){Transform.call(this,null,e)}GeoPoint.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};inherits(GeoPoint,Transform,{transform(e,n){var i=e.projection,r=e.fields[0],s=e.fields[1],o=e.as||["x","y"],l=o[0],f=o[1],d;function p(g){const v=i([r(g),s(g)]);v?(g[l]=v[0],g[f]=v[1]):(g[l]=void 0,g[f]=void 0)}return e.modified()?n=n.materialize().reflow(!0).visit(n.SOURCE,p):(d=n.modified(r.fields)||n.modified(s.fields),n.visit(d?n.ADD_MOD:n.ADD,p)),n.modifies(o)}});function GeoShape(e){Transform.call(this,null,e)}GeoShape.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};inherits(GeoShape,Transform,{transform(e,n){var i=n.fork(n.ALL),r=this.value,s=e.as||"shape",o=i.ADD;return(!r||e.modified())&&(this.value=r=shapeGenerator(getProjectionPath(e.projection),e.field||field$1("datum"),e.pointRadius),i.materialize().reflow(),o=i.SOURCE),i.visit(o,l=>l[s]=r),i.modifies(s)}});function shapeGenerator(e,n,i){const r=i==null?s=>e(n(s)):s=>{var o=e.pointRadius(),l=e.pointRadius(i)(n(s));return e.pointRadius(o),l};return r.context=s=>(e.context(s),r),r}function Graticule(e){Transform.call(this,[],e),this.generator=graticule()}Graticule.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};inherits(Graticule,Transform,{transform(e,n){var i=this.value,r=this.generator,s;if(!i.length||e.modified())for(const o in e)isFunction(r[o])&&r[o](e[o]);return s=r(),i.length?n.mod.push(replace$1(i[0],s)):n.add.push(ingest$1(s)),i[0]=s,n}});function Heatmap(e){Transform.call(this,null,e)}Heatmap.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};inherits(Heatmap,Transform,{transform(e,n){if(!n.changed()&&!e.modified())return n.StopPropagation;var i=n.materialize(n.SOURCE).source,r=e.resolve==="shared",s=e.field||identity$6,o=opacity_(e.opacity,e),l=color_(e.color,e),f=e.as||"image",d={$x:0,$y:0,$value:0,$max:r?max$2(i.map(p=>max$2(s(p).values))):0};return i.forEach(p=>{const g=s(p),v=extend$1({},p,d);r||(v.$max=max$2(g.values||[])),p[f]=toCanvas(g,v,l.dep?l:constant$4(l(v)),o.dep?o:constant$4(o(v)))}),n.reflow(!0).modifies(f)}});function color_(e,n){let i;return isFunction(e)?(i=r=>rgb$1(e(r,n)),i.dep=dependency(e)):i=constant$4(rgb$1(e||"#888")),i}function opacity_(e,n){let i;return isFunction(e)?(i=r=>e(r,n),i.dep=dependency(e)):e?i=constant$4(e):(i=r=>r.$value/r.$max||0,i.dep=!0),i}function dependency(e){if(!isFunction(e))return!1;const n=toSet(accessorFields(e));return n.$x||n.$y||n.$value||n.$max}function toCanvas(e,n,i,r){const s=e.width,o=e.height,l=e.x1||0,f=e.y1||0,d=e.x2||s,p=e.y2||o,g=e.values,v=g?R=>g[R]:zero$4,S=domCanvas(d-l,p-f),T=S.getContext("2d"),k=T.getImageData(0,0,d-l,p-f),O=k.data;for(let R=f,P=0;R<p;++R){n.$y=R-f;for(let F=l,I=R*s;F<d;++F,P+=4){n.$x=F-l,n.$value=v(F+I);const L=i(n);O[P+0]=L.r,O[P+1]=L.g,O[P+2]=L.b,O[P+3]=~~(255*r(n))}}return T.putImageData(k,0,0),S}function Projection$1(e){Transform.call(this,null,e),this.modified(!0)}inherits(Projection$1,Transform,{transform(e,n){let i=this.value;return!i||e.modified("type")?(this.value=i=create(e.type),projectionProperties.forEach(r=>{e[r]!=null&&set$3(i,r,e[r])})):projectionProperties.forEach(r=>{e.modified(r)&&set$3(i,r,e[r])}),e.pointRadius!=null&&i.path.pointRadius(e.pointRadius),e.fit&&fit(i,e),n.fork(n.NO_SOURCE|n.NO_FIELDS)}});function fit(e,n){const i=collectGeoJSON(n.fit);n.extent?e.fitExtent(n.extent,i):n.size&&e.fitSize(n.size,i)}function create(e){const n=projection((e||"mercator").toLowerCase());return n||error("Unrecognized projection type: "+e),n()}function set$3(e,n,i){isFunction(e[n])&&e[n](i)}function collectGeoJSON(e){return e=array$5(e),e.length===1?e[0]:{type:FeatureCollection,features:e.reduce((n,i)=>n.concat(featurize(i)),[])}}function featurize(e){return e.type===FeatureCollection?e.features:array$5(e).filter(n=>n!=null).map(n=>n.type===Feature?n:{type:Feature,geometry:n})}const geo=Object.freeze(Object.defineProperty({__proto__:null,contour:Contour,geojson:GeoJSON,geopath:GeoPath,geopoint:GeoPoint,geoshape:GeoShape,graticule:Graticule,heatmap:Heatmap,isocontour:Isocontour,kde2d:KDE2D,projection:Projection$1},Symbol.toStringTag,{value:"Module"}));function forceCenter(e,n){var i,r=1;e==null&&(e=0),n==null&&(n=0);function s(){var o,l=i.length,f,d=0,p=0;for(o=0;o<l;++o)f=i[o],d+=f.x,p+=f.y;for(d=(d/l-e)*r,p=(p/l-n)*r,o=0;o<l;++o)f=i[o],f.x-=d,f.y-=p}return s.initialize=function(o){i=o},s.x=function(o){return arguments.length?(e=+o,s):e},s.y=function(o){return arguments.length?(n=+o,s):n},s.strength=function(o){return arguments.length?(r=+o,s):r},s}function tree_add(e){const n=+this._x.call(null,e),i=+this._y.call(null,e);return add$1(this.cover(n,i),n,i,e)}function add$1(e,n,i,r){if(isNaN(n)||isNaN(i))return e;var s,o=e._root,l={data:r},f=e._x0,d=e._y0,p=e._x1,g=e._y1,v,S,T,k,O,R,P,F;if(!o)return e._root=l,e;for(;o.length;)if((O=n>=(v=(f+p)/2))?f=v:p=v,(R=i>=(S=(d+g)/2))?d=S:g=S,s=o,!(o=o[P=R<<1|O]))return s[P]=l,e;if(T=+e._x.call(null,o.data),k=+e._y.call(null,o.data),n===T&&i===k)return l.next=o,s?s[P]=l:e._root=l,e;do s=s?s[P]=new Array(4):e._root=new Array(4),(O=n>=(v=(f+p)/2))?f=v:p=v,(R=i>=(S=(d+g)/2))?d=S:g=S;while((P=R<<1|O)===(F=(k>=S)<<1|T>=v));return s[F]=o,s[P]=l,e}function addAll(e){var n,i,r=e.length,s,o,l=new Array(r),f=new Array(r),d=1/0,p=1/0,g=-1/0,v=-1/0;for(i=0;i<r;++i)isNaN(s=+this._x.call(null,n=e[i]))||isNaN(o=+this._y.call(null,n))||(l[i]=s,f[i]=o,s<d&&(d=s),s>g&&(g=s),o<p&&(p=o),o>v&&(v=o));if(d>g||p>v)return this;for(this.cover(d,p).cover(g,v),i=0;i<r;++i)add$1(this,l[i],f[i],e[i]);return this}function tree_cover(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,r=this._y0,s=this._x1,o=this._y1;if(isNaN(i))s=(i=Math.floor(e))+1,o=(r=Math.floor(n))+1;else{for(var l=s-i||1,f=this._root,d,p;i>e||e>=s||r>n||n>=o;)switch(p=(n<r)<<1|e<i,d=new Array(4),d[p]=f,f=d,l*=2,p){case 0:s=i+l,o=r+l;break;case 1:i=s-l,o=r+l;break;case 2:s=i+l,r=o-l;break;case 3:i=s-l,r=o-l;break}this._root&&this._root.length&&(this._root=f)}return this._x0=i,this._y0=r,this._x1=s,this._y1=o,this}function tree_data(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function tree_extent(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(e,n,i,r,s){this.node=e,this.x0=n,this.y0=i,this.x1=r,this.y1=s}function tree_find(e,n,i){var r,s=this._x0,o=this._y0,l,f,d,p,g=this._x1,v=this._y1,S=[],T=this._root,k,O;for(T&&S.push(new Quad(T,s,o,g,v)),i==null?i=1/0:(s=e-i,o=n-i,g=e+i,v=n+i,i*=i);k=S.pop();)if(!(!(T=k.node)||(l=k.x0)>g||(f=k.y0)>v||(d=k.x1)<s||(p=k.y1)<o))if(T.length){var R=(l+d)/2,P=(f+p)/2;S.push(new Quad(T[3],R,P,d,p),new Quad(T[2],l,P,R,p),new Quad(T[1],R,f,d,P),new Quad(T[0],l,f,R,P)),(O=(n>=P)<<1|e>=R)&&(k=S[S.length-1],S[S.length-1]=S[S.length-1-O],S[S.length-1-O]=k)}else{var F=e-+this._x.call(null,T.data),I=n-+this._y.call(null,T.data),L=F*F+I*I;if(L<i){var N=Math.sqrt(i=L);s=e-N,o=n-N,g=e+N,v=n+N,r=T.data}}return r}function tree_remove(e){if(isNaN(g=+this._x.call(null,e))||isNaN(v=+this._y.call(null,e)))return this;var n,i=this._root,r,s,o,l=this._x0,f=this._y0,d=this._x1,p=this._y1,g,v,S,T,k,O,R,P;if(!i)return this;if(i.length)for(;;){if((k=g>=(S=(l+d)/2))?l=S:d=S,(O=v>=(T=(f+p)/2))?f=T:p=T,n=i,!(i=i[R=O<<1|k]))return this;if(!i.length)break;(n[R+1&3]||n[R+2&3]||n[R+3&3])&&(r=n,P=R)}for(;i.data!==e;)if(s=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,s?(o?s.next=o:delete s.next,this):n?(o?n[R]=o:delete n[R],(i=n[0]||n[1]||n[2]||n[3])&&i===(n[3]||n[2]||n[1]||n[0])&&!i.length&&(r?r[P]=i:this._root=i),this):(this._root=o,this)}function removeAll(e){for(var n=0,i=e.length;n<i;++n)this.remove(e[n]);return this}function tree_root(){return this._root}function tree_size(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function tree_visit(e){var n=[],i,r=this._root,s,o,l,f,d;for(r&&n.push(new Quad(r,this._x0,this._y0,this._x1,this._y1));i=n.pop();)if(!e(r=i.node,o=i.x0,l=i.y0,f=i.x1,d=i.y1)&&r.length){var p=(o+f)/2,g=(l+d)/2;(s=r[3])&&n.push(new Quad(s,p,g,f,d)),(s=r[2])&&n.push(new Quad(s,o,g,p,d)),(s=r[1])&&n.push(new Quad(s,p,l,f,g)),(s=r[0])&&n.push(new Quad(s,o,l,p,g))}return this}function tree_visitAfter(e){var n=[],i=[],r;for(this._root&&n.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var s=r.node;if(s.length){var o,l=r.x0,f=r.y0,d=r.x1,p=r.y1,g=(l+d)/2,v=(f+p)/2;(o=s[0])&&n.push(new Quad(o,l,f,g,v)),(o=s[1])&&n.push(new Quad(o,g,f,d,v)),(o=s[2])&&n.push(new Quad(o,l,v,g,p)),(o=s[3])&&n.push(new Quad(o,g,v,d,p))}i.push(r)}for(;r=i.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function defaultX(e){return e[0]}function tree_x(e){return arguments.length?(this._x=e,this):this._x}function defaultY(e){return e[1]}function tree_y(e){return arguments.length?(this._y=e,this):this._y}function quadtree(e,n,i){var r=new Quadtree(n??defaultX,i??defaultY,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Quadtree(e,n,i,r,s,o){this._x=e,this._y=n,this._x0=i,this._y0=r,this._x1=s,this._y1=o,this._root=void 0}function leaf_copy(e){for(var n={data:e.data},i=n;e=e.next;)i=i.next={data:e.data};return n}var treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var e=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,i,r;if(!n)return e;if(!n.length)return e._root=leaf_copy(n),e;for(i=[{source:n,target:e._root=new Array(4)}];n=i.pop();)for(var s=0;s<4;++s)(r=n.source[s])&&(r.length?i.push({source:r,target:n.target[s]=new Array(4)}):n.target[s]=leaf_copy(r));return e};treeProto.add=tree_add;treeProto.addAll=addAll;treeProto.cover=tree_cover;treeProto.data=tree_data;treeProto.extent=tree_extent;treeProto.find=tree_find;treeProto.remove=tree_remove;treeProto.removeAll=removeAll;treeProto.root=tree_root;treeProto.size=tree_size;treeProto.visit=tree_visit;treeProto.visitAfter=tree_visitAfter;treeProto.x=tree_x;treeProto.y=tree_y;function constant$1(e){return function(){return e}}function jiggle(e){return(e()-.5)*1e-6}function x$1(e){return e.x+e.vx}function y$1(e){return e.y+e.vy}function forceCollide(e){var n,i,r,s=1,o=1;typeof e!="function"&&(e=constant$1(e==null?1:+e));function l(){for(var p,g=n.length,v,S,T,k,O,R,P=0;P<o;++P)for(v=quadtree(n,x$1,y$1).visitAfter(f),p=0;p<g;++p)S=n[p],O=i[S.index],R=O*O,T=S.x+S.vx,k=S.y+S.vy,v.visit(F);function F(I,L,N,j,z){var q=I.data,H=I.r,W=O+H;if(q){if(q.index>S.index){var U=T-q.x-q.vx,Q=k-q.y-q.vy,J=U*U+Q*Q;J<W*W&&(U===0&&(U=jiggle(r),J+=U*U),Q===0&&(Q=jiggle(r),J+=Q*Q),J=(W-(J=Math.sqrt(J)))/J*s,S.vx+=(U*=J)*(W=(H*=H)/(R+H)),S.vy+=(Q*=J)*W,q.vx-=U*(W=1-W),q.vy-=Q*W)}return}return L>T+W||j<T-W||N>k+W||z<k-W}}function f(p){if(p.data)return p.r=i[p.data.index];for(var g=p.r=0;g<4;++g)p[g]&&p[g].r>p.r&&(p.r=p[g].r)}function d(){if(n){var p,g=n.length,v;for(i=new Array(g),p=0;p<g;++p)v=n[p],i[v.index]=+e(v,p,n)}}return l.initialize=function(p,g){n=p,r=g,d()},l.iterations=function(p){return arguments.length?(o=+p,l):o},l.strength=function(p){return arguments.length?(s=+p,l):s},l.radius=function(p){return arguments.length?(e=typeof p=="function"?p:constant$1(+p),d(),l):e},l}function index$1(e){return e.index}function find$1(e,n){var i=e.get(n);if(!i)throw new Error("node not found: "+n);return i}function forceLink(e){var n=index$1,i=v,r,s=constant$1(30),o,l,f,d,p,g=1;e==null&&(e=[]);function v(R){return 1/Math.min(f[R.source.index],f[R.target.index])}function S(R){for(var P=0,F=e.length;P<g;++P)for(var I=0,L,N,j,z,q,H,W;I<F;++I)L=e[I],N=L.source,j=L.target,z=j.x+j.vx-N.x-N.vx||jiggle(p),q=j.y+j.vy-N.y-N.vy||jiggle(p),H=Math.sqrt(z*z+q*q),H=(H-o[I])/H*R*r[I],z*=H,q*=H,j.vx-=z*(W=d[I]),j.vy-=q*W,N.vx+=z*(W=1-W),N.vy+=q*W}function T(){if(l){var R,P=l.length,F=e.length,I=new Map(l.map((N,j)=>[n(N,j,l),N])),L;for(R=0,f=new Array(P);R<F;++R)L=e[R],L.index=R,typeof L.source!="object"&&(L.source=find$1(I,L.source)),typeof L.target!="object"&&(L.target=find$1(I,L.target)),f[L.source.index]=(f[L.source.index]||0)+1,f[L.target.index]=(f[L.target.index]||0)+1;for(R=0,d=new Array(F);R<F;++R)L=e[R],d[R]=f[L.source.index]/(f[L.source.index]+f[L.target.index]);r=new Array(F),k(),o=new Array(F),O()}}function k(){if(l)for(var R=0,P=e.length;R<P;++R)r[R]=+i(e[R],R,e)}function O(){if(l)for(var R=0,P=e.length;R<P;++R)o[R]=+s(e[R],R,e)}return S.initialize=function(R,P){l=R,p=P,T()},S.links=function(R){return arguments.length?(e=R,T(),S):e},S.id=function(R){return arguments.length?(n=R,S):n},S.iterations=function(R){return arguments.length?(g=+R,S):g},S.strength=function(R){return arguments.length?(i=typeof R=="function"?R:constant$1(+R),k(),S):i},S.distance=function(R){return arguments.length?(s=typeof R=="function"?R:constant$1(+R),O(),S):s},S}var noop={value:()=>{}};function dispatch(){for(var e=0,n=arguments.length,i={},r;e<n;++e){if(!(r=arguments[e]+"")||r in i||/[\s.]/.test(r))throw new Error("illegal type: "+r);i[r]=[]}return new Dispatch(i)}function Dispatch(e){this._=e}function parseTypenames(e,n){return e.trim().split(/^|\s+/).map(function(i){var r="",s=i.indexOf(".");if(s>=0&&(r=i.slice(s+1),i=i.slice(0,s)),i&&!n.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:r}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,n){var i=this._,r=parseTypenames(e+"",i),s,o=-1,l=r.length;if(arguments.length<2){for(;++o<l;)if((s=(e=r[o]).type)&&(s=get$1(i[s],e.name)))return s;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<l;)if(s=(e=r[o]).type)i[s]=set$2(i[s],e.name,n);else if(n==null)for(s in i)i[s]=set$2(i[s],e.name,null);return this},copy:function(){var e={},n=this._;for(var i in n)e[i]=n[i].slice();return new Dispatch(e)},call:function(e,n){if((s=arguments.length-2)>0)for(var i=new Array(s),r=0,s,o;r<s;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,s=o.length;r<s;++r)o[r].value.apply(n,i)},apply:function(e,n,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,o=r.length;s<o;++s)r[s].value.apply(n,i)}};function get$1(e,n){for(var i=0,r=e.length,s;i<r;++i)if((s=e[i]).name===n)return s.value}function set$2(e,n,i){for(var r=0,s=e.length;r<s;++r)if(e[r].name===n){e[r]=noop,e=e.slice(0,r).concat(e.slice(r+1));break}return i!=null&&e.push({name:n,value:i}),e}var frame=0,timeout=0,interval$2=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer$1(){this._call=this._time=this._next=null}Timer$1.prototype=timer$1.prototype={constructor:Timer$1,restart:function(e,n,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?now():+i)+(n==null?0:+n),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=i,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer$1(e,n,i){var r=new Timer$1;return r.restart(e,n,i),r}function timerFlush(){now(),++frame;for(var e=taskHead,n;e;)(n=clockNow-e._time)>=0&&e._call.call(void 0,n),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),n=e-clockLast;n>pokeDelay&&(clockSkew-=n,clockLast=e)}function nap(){for(var e,n=taskHead,i,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(i=n._next,n._next=null,n=e?e._next=i:taskHead=i);taskTail=e,sleep(r)}function sleep(e){if(!frame){timeout&&(timeout=clearTimeout(timeout));var n=e-clockNow;n>24?(e<1/0&&(timeout=setTimeout(wake,e-clock.now()-clockSkew)),interval$2&&(interval$2=clearInterval(interval$2))):(interval$2||(clockLast=clock.now(),interval$2=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function interval$1(e,n,i){var r=new Timer$1,s=n;return n==null?(r.restart(e,n,i),r):(r._restart=r.restart,r.restart=function(o,l,f){l=+l,f=f==null?now():+f,r._restart(function d(p){p+=s,r._restart(d,s+=l,f),o(p)},l,f)},r.restart(e,n,i),r)}const a$1=1664525,c$1=1013904223,m$1=4294967296;function lcg$1(){let e=1;return()=>(e=(a$1*e+c$1)%m$1)/m$1}function x(e){return e.x}function y(e){return e.y}var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));function forceSimulation(e){var n,i=1,r=.001,s=1-Math.pow(r,1/300),o=0,l=.6,f=new Map,d=timer$1(v),p=dispatch("tick","end"),g=lcg$1();e==null&&(e=[]);function v(){S(),p.call("tick",n),i<r&&(d.stop(),p.call("end",n))}function S(O){var R,P=e.length,F;O===void 0&&(O=1);for(var I=0;I<O;++I)for(i+=(o-i)*s,f.forEach(function(L){L(i)}),R=0;R<P;++R)F=e[R],F.fx==null?F.x+=F.vx*=l:(F.x=F.fx,F.vx=0),F.fy==null?F.y+=F.vy*=l:(F.y=F.fy,F.vy=0);return n}function T(){for(var O=0,R=e.length,P;O<R;++O){if(P=e[O],P.index=O,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var F=initialRadius*Math.sqrt(.5+O),I=O*initialAngle;P.x=F*Math.cos(I),P.y=F*Math.sin(I)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function k(O){return O.initialize&&O.initialize(e,g),O}return T(),n={tick:S,restart:function(){return d.restart(v),n},stop:function(){return d.stop(),n},nodes:function(O){return arguments.length?(e=O,T(),f.forEach(k),n):e},alpha:function(O){return arguments.length?(i=+O,n):i},alphaMin:function(O){return arguments.length?(r=+O,n):r},alphaDecay:function(O){return arguments.length?(s=+O,n):+s},alphaTarget:function(O){return arguments.length?(o=+O,n):o},velocityDecay:function(O){return arguments.length?(l=1-O,n):1-l},randomSource:function(O){return arguments.length?(g=O,f.forEach(k),n):g},force:function(O,R){return arguments.length>1?(R==null?f.delete(O):f.set(O,k(R)),n):f.get(O)},find:function(O,R,P){var F=0,I=e.length,L,N,j,z,q;for(P==null?P=1/0:P*=P,F=0;F<I;++F)z=e[F],L=O-z.x,N=R-z.y,j=L*L+N*N,j<P&&(q=z,P=j);return q},on:function(O,R){return arguments.length>1?(p.on(O,R),n):p.on(O)}}}function forceManyBody(){var e,n,i,r,s=constant$1(-30),o,l=1,f=1/0,d=.81;function p(T){var k,O=e.length,R=quadtree(e,x,y).visitAfter(v);for(r=T,k=0;k<O;++k)n=e[k],R.visit(S)}function g(){if(e){var T,k=e.length,O;for(o=new Array(k),T=0;T<k;++T)O=e[T],o[O.index]=+s(O,T,e)}}function v(T){var k=0,O,R,P=0,F,I,L;if(T.length){for(F=I=L=0;L<4;++L)(O=T[L])&&(R=Math.abs(O.value))&&(k+=O.value,P+=R,F+=R*O.x,I+=R*O.y);T.x=F/P,T.y=I/P}else{O=T,O.x=O.data.x,O.y=O.data.y;do k+=o[O.data.index];while(O=O.next)}T.value=k}function S(T,k,O,R){if(!T.value)return!0;var P=T.x-n.x,F=T.y-n.y,I=R-k,L=P*P+F*F;if(I*I/d<L)return L<f&&(P===0&&(P=jiggle(i),L+=P*P),F===0&&(F=jiggle(i),L+=F*F),L<l&&(L=Math.sqrt(l*L)),n.vx+=P*T.value*r/L,n.vy+=F*T.value*r/L),!0;if(T.length||L>=f)return;(T.data!==n||T.next)&&(P===0&&(P=jiggle(i),L+=P*P),F===0&&(F=jiggle(i),L+=F*F),L<l&&(L=Math.sqrt(l*L)));do T.data!==n&&(I=o[T.data.index]*r/L,n.vx+=P*I,n.vy+=F*I);while(T=T.next)}return p.initialize=function(T,k){e=T,i=k,g()},p.strength=function(T){return arguments.length?(s=typeof T=="function"?T:constant$1(+T),g(),p):s},p.distanceMin=function(T){return arguments.length?(l=T*T,p):Math.sqrt(l)},p.distanceMax=function(T){return arguments.length?(f=T*T,p):Math.sqrt(f)},p.theta=function(T){return arguments.length?(d=T*T,p):Math.sqrt(d)},p}function forceX(e){var n=constant$1(.1),i,r,s;typeof e!="function"&&(e=constant$1(e==null?0:+e));function o(f){for(var d=0,p=i.length,g;d<p;++d)g=i[d],g.vx+=(s[d]-g.x)*r[d]*f}function l(){if(i){var f,d=i.length;for(r=new Array(d),s=new Array(d),f=0;f<d;++f)r[f]=isNaN(s[f]=+e(i[f],f,i))?0:+n(i[f],f,i)}}return o.initialize=function(f){i=f,l()},o.strength=function(f){return arguments.length?(n=typeof f=="function"?f:constant$1(+f),l(),o):n},o.x=function(f){return arguments.length?(e=typeof f=="function"?f:constant$1(+f),l(),o):e},o}function forceY(e){var n=constant$1(.1),i,r,s;typeof e!="function"&&(e=constant$1(e==null?0:+e));function o(f){for(var d=0,p=i.length,g;d<p;++d)g=i[d],g.vy+=(s[d]-g.y)*r[d]*f}function l(){if(i){var f,d=i.length;for(r=new Array(d),s=new Array(d),f=0;f<d;++f)r[f]=isNaN(s[f]=+e(i[f],f,i))?0:+n(i[f],f,i)}}return o.initialize=function(f){i=f,l()},o.strength=function(f){return arguments.length?(n=typeof f=="function"?f:constant$1(+f),l(),o):n},o.y=function(f){return arguments.length?(e=typeof f=="function"?f:constant$1(+f),l(),o):e},o}const ForceMap={center:forceCenter,collide:forceCollide,nbody:forceManyBody,link:forceLink,x:forceX,y:forceY},Forces="forces",ForceParams=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],ForceConfig=["static","iterations"],ForceOutput=["x","y","vx","vy"];function Force(e){Transform.call(this,null,e)}Force.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:ForceOutput}]};inherits(Force,Transform,{transform(e,n){var i=this.value,r=n.changed(n.ADD_REM),s=e.modified(ForceParams),o=e.iterations||300;if(i?(r&&(n.modifies("index"),i.nodes(n.source)),(s||n.changed(n.MOD))&&setup(i,e,0,n)):(this.value=i=simulation(n.source,e),i.on("tick",rerun(n.dataflow,this)),e.static||(r=!0,i.tick()),n.modifies("index")),s||r||e.modified(ForceConfig)||n.changed()&&e.restart){if(i.alpha(Math.max(i.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/o)),e.static)for(i.stop();--o>=0;)i.tick();else if(i.stopped()&&i.restart(),!r)return n.StopPropagation}return this.finish(e,n)},finish(e,n){const i=n.dataflow;for(let f=this._argops,d=0,p=f.length,g;d<p;++d)if(g=f[d],!(g.name!==Forces||g.op._argval.force!=="link")){for(var r=g.op._argops,s=0,o=r.length,l;s<o;++s)if(r[s].name==="links"&&(l=r[s].op.source)){i.pulse(l,i.changeset().reflow());break}}return n.reflow(e.modified()).modifies(ForceOutput)}});function rerun(e,n){return()=>e.touch(n).run()}function simulation(e,n){const i=forceSimulation(e),r=i.stop,s=i.restart;let o=!1;return i.stopped=()=>o,i.restart=()=>(o=!1,s()),i.stop=()=>(o=!0,r()),setup(i,n,!0).on("end",()=>o=!0)}function setup(e,n,i,r){var s=array$5(n.forces),o,l,f,d;for(o=0,l=ForceParams.length;o<l;++o)f=ForceParams[o],f!==Forces&&n.modified(f)&&e[f](n[f]);for(o=0,l=s.length;o<l;++o)d=Forces+o,f=i||n.modified(Forces,o)?getForce(s[o]):r&&modified(s[o],r)?e.force(d):null,f&&e.force(d,f);for(l=e.numForces||0;o<l;++o)e.force(Forces+o,null);return e.numForces=s.length,e}function modified(e,n){var i,r;for(i in e)if(isFunction(r=e[i])&&n.modified(accessorFields(r)))return 1;return 0}function getForce(e){var n,i;has$1(ForceMap,e.force)||error("Unrecognized force: "+e.force),n=ForceMap[e.force]();for(i in e)isFunction(n[i])&&setForceParam(n[i],e[i],e);return n}function setForceParam(e,n,i){e(isFunction(n)?r=>n(r,i):n)}const force=Object.freeze(Object.defineProperty({__proto__:null,force:Force},Symbol.toStringTag,{value:"Module"}));function defaultSeparation$2(e,n){return e.parent===n.parent?1:2}function meanX(e){return e.reduce(meanXReduce,0)/e.length}function meanXReduce(e,n){return e+n.x}function maxY(e){return 1+e.reduce(maxYReduce,0)}function maxYReduce(e,n){return Math.max(e,n.y)}function leafLeft(e){for(var n;n=e.children;)e=n[0];return e}function leafRight(e){for(var n;n=e.children;)e=n[n.length-1];return e}function cluster(){var e=defaultSeparation$2,n=1,i=1,r=!1;function s(o){var l,f=0;o.eachAfter(function(S){var T=S.children;T?(S.x=meanX(T),S.y=maxY(T)):(S.x=l?f+=e(S,l):0,S.y=0,l=S)});var d=leafLeft(o),p=leafRight(o),g=d.x-e(d,p)/2,v=p.x+e(p,d)/2;return o.eachAfter(r?function(S){S.x=(S.x-o.x)*n,S.y=(o.y-S.y)*i}:function(S){S.x=(S.x-g)/(v-g)*n,S.y=(1-(o.y?S.y/o.y:1))*i})}return s.separation=function(o){return arguments.length?(e=o,s):e},s.size=function(o){return arguments.length?(r=!1,n=+o[0],i=+o[1],s):r?null:[n,i]},s.nodeSize=function(o){return arguments.length?(r=!0,n=+o[0],i=+o[1],s):r?[n,i]:null},s}function count(e){var n=0,i=e.children,r=i&&i.length;if(!r)n=1;else for(;--r>=0;)n+=i[r].value;e.value=n}function node_count(){return this.eachAfter(count)}function node_each(e,n){let i=-1;for(const r of this)e.call(n,r,++i,this);return this}function node_eachBefore(e,n){for(var i=this,r=[i],s,o,l=-1;i=r.pop();)if(e.call(n,i,++l,this),s=i.children)for(o=s.length-1;o>=0;--o)r.push(s[o]);return this}function node_eachAfter(e,n){for(var i=this,r=[i],s=[],o,l,f,d=-1;i=r.pop();)if(s.push(i),o=i.children)for(l=0,f=o.length;l<f;++l)r.push(o[l]);for(;i=s.pop();)e.call(n,i,++d,this);return this}function node_find(e,n){let i=-1;for(const r of this)if(e.call(n,r,++i,this))return r}function node_sum(e){return this.eachAfter(function(n){for(var i=+e(n.data)||0,r=n.children,s=r&&r.length;--s>=0;)i+=r[s].value;n.value=i})}function node_sort(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function node_path(e){for(var n=this,i=leastCommonAncestor(n,e),r=[n];n!==i;)n=n.parent,r.push(n);for(var s=r.length;e!==i;)r.splice(s,0,e),e=e.parent;return r}function leastCommonAncestor(e,n){if(e===n)return e;var i=e.ancestors(),r=n.ancestors(),s=null;for(e=i.pop(),n=r.pop();e===n;)s=e,e=i.pop(),n=r.pop();return s}function node_ancestors(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function node_descendants(){return Array.from(this)}function node_leaves(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function node_links(){var e=this,n=[];return e.each(function(i){i!==e&&n.push({source:i.parent,target:i})}),n}function*node_iterator(){var e=this,n,i=[e],r,s,o;do for(n=i.reverse(),i=[];e=n.pop();)if(yield e,r=e.children)for(s=0,o=r.length;s<o;++s)i.push(r[s]);while(i.length)}function hierarchy(e,n){e instanceof Map?(e=[void 0,e],n===void 0&&(n=mapChildren)):n===void 0&&(n=objectChildren);for(var i=new Node$2(e),r,s=[i],o,l,f,d;r=s.pop();)if((l=n(r.data))&&(d=(l=Array.from(l)).length))for(r.children=l,f=d-1;f>=0;--f)s.push(o=l[f]=new Node$2(l[f])),o.parent=r,o.depth=r.depth+1;return i.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function objectChildren(e){return e.children}function mapChildren(e){return Array.isArray(e)?e[1]:null}function copyData(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function computeHeight(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function Node$2(e){this.data=e,this.depth=this.height=0,this.parent=null}Node$2.prototype=hierarchy.prototype={constructor:Node$2,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,find:node_find,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy,[Symbol.iterator]:node_iterator};function optional(e){return e==null?null:required(e)}function required(e){if(typeof e!="function")throw new Error;return e}function constantZero(){return 0}function constant(e){return function(){return e}}const a=1664525,c=1013904223,m=4294967296;function lcg(){let e=1;return()=>(e=(a*e+c)%m)/m}function array$2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function shuffle(e,n){let i=e.length,r,s;for(;i;)s=n()*i--|0,r=e[i],e[i]=e[s],e[s]=r;return e}function packEncloseRandom(e,n){for(var i=0,r=(e=shuffle(Array.from(e),n)).length,s=[],o,l;i<r;)o=e[i],l&&enclosesWeak(l,o)?++i:(l=encloseBasis(s=extendBasis(s,o)),i=0);return l}function extendBasis(e,n){var i,r;if(enclosesWeakAll(n,e))return[n];for(i=0;i<e.length;++i)if(enclosesNot(n,e[i])&&enclosesWeakAll(encloseBasis2(e[i],n),e))return[e[i],n];for(i=0;i<e.length-1;++i)for(r=i+1;r<e.length;++r)if(enclosesNot(encloseBasis2(e[i],e[r]),n)&&enclosesNot(encloseBasis2(e[i],n),e[r])&&enclosesNot(encloseBasis2(e[r],n),e[i])&&enclosesWeakAll(encloseBasis3(e[i],e[r],n),e))return[e[i],e[r],n];throw new Error}function enclosesNot(e,n){var i=e.r-n.r,r=n.x-e.x,s=n.y-e.y;return i<0||i*i<r*r+s*s}function enclosesWeak(e,n){var i=e.r-n.r+Math.max(e.r,n.r,1)*1e-9,r=n.x-e.x,s=n.y-e.y;return i>0&&i*i>r*r+s*s}function enclosesWeakAll(e,n){for(var i=0;i<n.length;++i)if(!enclosesWeak(e,n[i]))return!1;return!0}function encloseBasis(e){switch(e.length){case 1:return encloseBasis1(e[0]);case 2:return encloseBasis2(e[0],e[1]);case 3:return encloseBasis3(e[0],e[1],e[2])}}function encloseBasis1(e){return{x:e.x,y:e.y,r:e.r}}function encloseBasis2(e,n){var i=e.x,r=e.y,s=e.r,o=n.x,l=n.y,f=n.r,d=o-i,p=l-r,g=f-s,v=Math.sqrt(d*d+p*p);return{x:(i+o+d/v*g)/2,y:(r+l+p/v*g)/2,r:(v+s+f)/2}}function encloseBasis3(e,n,i){var r=e.x,s=e.y,o=e.r,l=n.x,f=n.y,d=n.r,p=i.x,g=i.y,v=i.r,S=r-l,T=r-p,k=s-f,O=s-g,R=d-o,P=v-o,F=r*r+s*s-o*o,I=F-l*l-f*f+d*d,L=F-p*p-g*g+v*v,N=T*k-S*O,j=(k*L-O*I)/(N*2)-r,z=(O*R-k*P)/N,q=(T*I-S*L)/(N*2)-s,H=(S*P-T*R)/N,W=z*z+H*H-1,U=2*(o+j*z+q*H),Q=j*j+q*q-o*o,J=-(Math.abs(W)>1e-6?(U+Math.sqrt(U*U-4*W*Q))/(2*W):Q/U);return{x:r+j+z*J,y:s+q+H*J,r:J}}function place(e,n,i){var r=e.x-n.x,s,o,l=e.y-n.y,f,d,p=r*r+l*l;p?(o=n.r+i.r,o*=o,d=e.r+i.r,d*=d,o>d?(s=(p+d-o)/(2*p),f=Math.sqrt(Math.max(0,d/p-s*s)),i.x=e.x-s*r-f*l,i.y=e.y-s*l+f*r):(s=(p+o-d)/(2*p),f=Math.sqrt(Math.max(0,o/p-s*s)),i.x=n.x+s*r-f*l,i.y=n.y+s*l+f*r)):(i.x=n.x+i.r,i.y=n.y)}function intersects(e,n){var i=e.r+n.r-1e-6,r=n.x-e.x,s=n.y-e.y;return i>0&&i*i>r*r+s*s}function score(e){var n=e._,i=e.next._,r=n.r+i.r,s=(n.x*i.r+i.x*n.r)/r,o=(n.y*i.r+i.y*n.r)/r;return s*s+o*o}function Node$1(e){this._=e,this.next=null,this.previous=null}function packSiblingsRandom(e,n){if(!(o=(e=array$2(e)).length))return 0;var i,r,s,o,l,f,d,p,g,v,S;if(i=e[0],i.x=0,i.y=0,!(o>1))return i.r;if(r=e[1],i.x=-r.r,r.x=i.r,r.y=0,!(o>2))return i.r+r.r;place(r,i,s=e[2]),i=new Node$1(i),r=new Node$1(r),s=new Node$1(s),i.next=s.previous=r,r.next=i.previous=s,s.next=r.previous=i;e:for(d=3;d<o;++d){place(i._,r._,s=e[d]),s=new Node$1(s),p=r.next,g=i.previous,v=r._.r,S=i._.r;do if(v<=S){if(intersects(p._,s._)){r=p,i.next=r,r.previous=i,--d;continue e}v+=p._.r,p=p.next}else{if(intersects(g._,s._)){i=g,i.next=r,r.previous=i,--d;continue e}S+=g._.r,g=g.previous}while(p!==g.next);for(s.previous=i,s.next=r,i.next=r.previous=r=s,l=score(i);(s=s.next)!==r;)(f=score(s))<l&&(i=s,l=f);r=i.next}for(i=[r._],s=r;(s=s.next)!==r;)i.push(s._);for(s=packEncloseRandom(i,n),d=0;d<o;++d)i=e[d],i.x-=s.x,i.y-=s.y;return s.r}function defaultRadius(e){return Math.sqrt(e.value)}function pack(){var e=null,n=1,i=1,r=constantZero;function s(o){const l=lcg();return o.x=n/2,o.y=i/2,e?o.eachBefore(radiusLeaf(e)).eachAfter(packChildrenRandom(r,.5,l)).eachBefore(translateChild(1)):o.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildrenRandom(constantZero,1,l)).eachAfter(packChildrenRandom(r,o.r/Math.min(n,i),l)).eachBefore(translateChild(Math.min(n,i)/(2*o.r))),o}return s.radius=function(o){return arguments.length?(e=optional(o),s):e},s.size=function(o){return arguments.length?(n=+o[0],i=+o[1],s):[n,i]},s.padding=function(o){return arguments.length?(r=typeof o=="function"?o:constant(+o),s):r},s}function radiusLeaf(e){return function(n){n.children||(n.r=Math.max(0,+e(n)||0))}}function packChildrenRandom(e,n,i){return function(r){if(s=r.children){var s,o,l=s.length,f=e(r)*n||0,d;if(f)for(o=0;o<l;++o)s[o].r+=f;if(d=packSiblingsRandom(s,i),f)for(o=0;o<l;++o)s[o].r-=f;r.r=d+f}}}function translateChild(e){return function(n){var i=n.parent;n.r*=e,i&&(n.x=i.x+e*n.x,n.y=i.y+e*n.y)}}function roundNode(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function treemapDice(e,n,i,r,s){for(var o=e.children,l,f=-1,d=o.length,p=e.value&&(r-n)/e.value;++f<d;)l=o[f],l.y0=i,l.y1=s,l.x0=n,l.x1=n+=l.value*p}function partition$1(){var e=1,n=1,i=0,r=!1;function s(l){var f=l.height+1;return l.x0=l.y0=i,l.x1=e,l.y1=n/f,l.eachBefore(o(n,f)),r&&l.eachBefore(roundNode),l}function o(l,f){return function(d){d.children&&treemapDice(d,d.x0,l*(d.depth+1)/f,d.x1,l*(d.depth+2)/f);var p=d.x0,g=d.y0,v=d.x1-i,S=d.y1-i;v<p&&(p=v=(p+v)/2),S<g&&(g=S=(g+S)/2),d.x0=p,d.y0=g,d.x1=v,d.y1=S}}return s.round=function(l){return arguments.length?(r=!!l,s):r},s.size=function(l){return arguments.length?(e=+l[0],n=+l[1],s):[e,n]},s.padding=function(l){return arguments.length?(i=+l,s):i},s}var preroot={depth:-1},ambiguous={},imputed={};function defaultId(e){return e.id}function defaultParentId(e){return e.parentId}function stratify(){var e=defaultId,n=defaultParentId,i;function r(s){var o=Array.from(s),l=e,f=n,d,p,g,v,S,T,k,O,R=new Map;if(i!=null){const P=o.map((L,N)=>normalize$1(i(L,N,s))),F=P.map(parentof),I=new Set(P).add("");for(const L of F)I.has(L)||(I.add(L),P.push(L),F.push(parentof(L)),o.push(imputed));l=(L,N)=>P[N],f=(L,N)=>F[N]}for(g=0,d=o.length;g<d;++g)p=o[g],T=o[g]=new Node$2(p),(k=l(p,g,s))!=null&&(k+="")&&(O=T.id=k,R.set(O,R.has(O)?ambiguous:T)),(k=f(p,g,s))!=null&&(k+="")&&(T.parent=k);for(g=0;g<d;++g)if(T=o[g],k=T.parent){if(S=R.get(k),!S)throw new Error("missing: "+k);if(S===ambiguous)throw new Error("ambiguous: "+k);S.children?S.children.push(T):S.children=[T],T.parent=S}else{if(v)throw new Error("multiple roots");v=T}if(!v)throw new Error("no root");if(i!=null){for(;v.data===imputed&&v.children.length===1;)v=v.children[0],--d;for(let P=o.length-1;P>=0&&(T=o[P],T.data===imputed);--P)T.data=null}if(v.parent=preroot,v.eachBefore(function(P){P.depth=P.parent.depth+1,--d}).eachBefore(computeHeight),v.parent=null,d>0)throw new Error("cycle");return v}return r.id=function(s){return arguments.length?(e=optional(s),r):e},r.parentId=function(s){return arguments.length?(n=optional(s),r):n},r.path=function(s){return arguments.length?(i=optional(s),r):i},r}function normalize$1(e){e=`${e}`;let n=e.length;return slash(e,n-1)&&!slash(e,n-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function parentof(e){let n=e.length;if(n<2)return"";for(;--n>1&&!slash(e,n););return e.slice(0,n)}function slash(e,n){if(e[n]==="/"){let i=0;for(;n>0&&e[--n]==="\\";)++i;if(!(i&1))return!0}return!1}function defaultSeparation$1(e,n){return e.parent===n.parent?1:2}function nextLeft(e){var n=e.children;return n?n[0]:e.t}function nextRight(e){var n=e.children;return n?n[n.length-1]:e.t}function moveSubtree(e,n,i){var r=i/(n.i-e.i);n.c-=r,n.s+=i,e.c+=r,n.z+=i,n.m+=i}function executeShifts(e){for(var n=0,i=0,r=e.children,s=r.length,o;--s>=0;)o=r[s],o.z+=n,o.m+=n,n+=o.s+(i+=o.c)}function nextAncestor(e,n,i){return e.a.parent===n.parent?e.a:i}function TreeNode(e,n){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}TreeNode.prototype=Object.create(Node$2.prototype);function treeRoot(e){for(var n=new TreeNode(e,0),i,r=[n],s,o,l,f;i=r.pop();)if(o=i._.children)for(i.children=new Array(f=o.length),l=f-1;l>=0;--l)r.push(s=i.children[l]=new TreeNode(o[l],l)),s.parent=i;return(n.parent=new TreeNode(null,0)).children=[n],n}function tree$1(){var e=defaultSeparation$1,n=1,i=1,r=null;function s(p){var g=treeRoot(p);if(g.eachAfter(o),g.parent.m=-g.z,g.eachBefore(l),r)p.eachBefore(d);else{var v=p,S=p,T=p;p.eachBefore(function(F){F.x<v.x&&(v=F),F.x>S.x&&(S=F),F.depth>T.depth&&(T=F)});var k=v===S?1:e(v,S)/2,O=k-v.x,R=n/(S.x+k+O),P=i/(T.depth||1);p.eachBefore(function(F){F.x=(F.x+O)*R,F.y=F.depth*P})}return p}function o(p){var g=p.children,v=p.parent.children,S=p.i?v[p.i-1]:null;if(g){executeShifts(p);var T=(g[0].z+g[g.length-1].z)/2;S?(p.z=S.z+e(p._,S._),p.m=p.z-T):p.z=T}else S&&(p.z=S.z+e(p._,S._));p.parent.A=f(p,S,p.parent.A||v[0])}function l(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function f(p,g,v){if(g){for(var S=p,T=p,k=g,O=S.parent.children[0],R=S.m,P=T.m,F=k.m,I=O.m,L;k=nextRight(k),S=nextLeft(S),k&&S;)O=nextLeft(O),T=nextRight(T),T.a=p,L=k.z+F-S.z-R+e(k._,S._),L>0&&(moveSubtree(nextAncestor(k,p,v),p,L),R+=L,P+=L),F+=k.m,R+=S.m,I+=O.m,P+=T.m;k&&!nextRight(T)&&(T.t=k,T.m+=F-P),S&&!nextLeft(O)&&(O.t=S,O.m+=R-I,v=p)}return v}function d(p){p.x*=n,p.y=p.depth*i}return s.separation=function(p){return arguments.length?(e=p,s):e},s.size=function(p){return arguments.length?(r=!1,n=+p[0],i=+p[1],s):r?null:[n,i]},s.nodeSize=function(p){return arguments.length?(r=!0,n=+p[0],i=+p[1],s):r?[n,i]:null},s}function treemapSlice(e,n,i,r,s){for(var o=e.children,l,f=-1,d=o.length,p=e.value&&(s-i)/e.value;++f<d;)l=o[f],l.x0=n,l.x1=r,l.y0=i,l.y1=i+=l.value*p}var phi=(1+Math.sqrt(5))/2;function squarifyRatio(e,n,i,r,s,o){for(var l=[],f=n.children,d,p,g=0,v=0,S=f.length,T,k,O=n.value,R,P,F,I,L,N,j;g<S;){T=s-i,k=o-r;do R=f[v++].value;while(!R&&v<S);for(P=F=R,N=Math.max(k/T,T/k)/(O*e),j=R*R*N,L=Math.max(F/j,j/P);v<S;++v){if(R+=p=f[v].value,p<P&&(P=p),p>F&&(F=p),j=R*R*N,I=Math.max(F/j,j/P),I>L){R-=p;break}L=I}l.push(d={value:R,dice:T<k,children:f.slice(g,v)}),d.dice?treemapDice(d,i,r,s,O?r+=k*R/O:o):treemapSlice(d,i,r,O?i+=T*R/O:s,o),O-=R,g=v}return l}const treemapSquarify=function e(n){function i(r,s,o,l,f){squarifyRatio(n,r,s,o,l,f)}return i.ratio=function(r){return e((r=+r)>1?r:1)},i}(phi);function treemap(){var e=treemapSquarify,n=!1,i=1,r=1,s=[0],o=constantZero,l=constantZero,f=constantZero,d=constantZero,p=constantZero;function g(S){return S.x0=S.y0=0,S.x1=i,S.y1=r,S.eachBefore(v),s=[0],n&&S.eachBefore(roundNode),S}function v(S){var T=s[S.depth],k=S.x0+T,O=S.y0+T,R=S.x1-T,P=S.y1-T;R<k&&(k=R=(k+R)/2),P<O&&(O=P=(O+P)/2),S.x0=k,S.y0=O,S.x1=R,S.y1=P,S.children&&(T=s[S.depth+1]=o(S)/2,k+=p(S)-T,O+=l(S)-T,R-=f(S)-T,P-=d(S)-T,R<k&&(k=R=(k+R)/2),P<O&&(O=P=(O+P)/2),e(S,k,O,R,P))}return g.round=function(S){return arguments.length?(n=!!S,g):n},g.size=function(S){return arguments.length?(i=+S[0],r=+S[1],g):[i,r]},g.tile=function(S){return arguments.length?(e=required(S),g):e},g.padding=function(S){return arguments.length?g.paddingInner(S).paddingOuter(S):g.paddingInner()},g.paddingInner=function(S){return arguments.length?(o=typeof S=="function"?S:constant(+S),g):o},g.paddingOuter=function(S){return arguments.length?g.paddingTop(S).paddingRight(S).paddingBottom(S).paddingLeft(S):g.paddingTop()},g.paddingTop=function(S){return arguments.length?(l=typeof S=="function"?S:constant(+S),g):l},g.paddingRight=function(S){return arguments.length?(f=typeof S=="function"?S:constant(+S),g):f},g.paddingBottom=function(S){return arguments.length?(d=typeof S=="function"?S:constant(+S),g):d},g.paddingLeft=function(S){return arguments.length?(p=typeof S=="function"?S:constant(+S),g):p},g}function treemapBinary(e,n,i,r,s){var o=e.children,l,f=o.length,d,p=new Array(f+1);for(p[0]=d=l=0;l<f;++l)p[l+1]=d+=o[l].value;g(0,f,e.value,n,i,r,s);function g(v,S,T,k,O,R,P){if(v>=S-1){var F=o[v];F.x0=k,F.y0=O,F.x1=R,F.y1=P;return}for(var I=p[v],L=T/2+I,N=v+1,j=S-1;N<j;){var z=N+j>>>1;p[z]<L?N=z+1:j=z}L-p[N-1]<p[N]-L&&v+1<N&&--N;var q=p[N]-I,H=T-q;if(R-k>P-O){var W=T?(k*H+R*q)/T:R;g(v,N,q,k,O,W,P),g(N,S,H,W,O,R,P)}else{var U=T?(O*H+P*q)/T:P;g(v,N,q,k,O,R,U),g(N,S,H,k,U,R,P)}}}function treemapSliceDice(e,n,i,r,s){(e.depth&1?treemapSlice:treemapDice)(e,n,i,r,s)}const treemapResquarify=function e(n){function i(r,s,o,l,f){if((d=r._squarify)&&d.ratio===n)for(var d,p,g,v,S=-1,T,k=d.length,O=r.value;++S<k;){for(p=d[S],g=p.children,v=p.value=0,T=g.length;v<T;++v)p.value+=g[v].value;p.dice?treemapDice(p,s,o,l,O?o+=(f-o)*p.value/O:f):treemapSlice(p,s,o,O?s+=(l-s)*p.value/O:l,f),O-=p.value}else r._squarify=d=squarifyRatio(n,r,s,o,l,f),d.ratio=n}return i.ratio=function(r){return e((r=+r)>1?r:1)},i}(phi);function lookup$2(e,n,i){const r={};return e.each(s=>{const o=s.data;i(o)&&(r[n(o)]=s)}),e.lookup=r,e}function Nest(e){Transform.call(this,null,e)}Nest.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const children$1=e=>e.values;inherits(Nest,Transform,{transform(e,n){n.source||error("Nest transform requires an upstream data source.");var i=e.generate,r=e.modified(),s=n.clone(),o=this.value;return(!o||r||n.changed())&&(o&&o.each(l=>{l.children&&isTuple(l.data)&&s.rem.push(l.data)}),this.value=o=hierarchy({values:array$5(e.keys).reduce((l,f)=>(l.key(f),l),nest()).entries(s.source)},children$1),i&&o.each(l=>{l.children&&(l=ingest$1(l.data),s.add.push(l),s.source.push(l))}),lookup$2(o,tupleid,tupleid)),s.source.root=o,s}});function nest(){const e=[],n={entries:s=>r(i(s,0),0),key:s=>(e.push(s),n)};function i(s,o){if(o>=e.length)return s;const l=s.length,f=e[o++],d={},p={};let g=-1,v,S,T;for(;++g<l;)v=f(S=s[g])+"",(T=d[v])?T.push(S):d[v]=[S];for(v in d)p[v]=i(d[v],o);return p}function r(s,o){if(++o>e.length)return s;const l=[];for(const f in s)l.push({key:f,values:r(s[f],o)});return l}return n}function HierarchyLayout(e){Transform.call(this,null,e)}const defaultSeparation=(e,n)=>e.parent===n.parent?1:2;inherits(HierarchyLayout,Transform,{transform(e,n){(!n.source||!n.source.root)&&error(this.constructor.name+" transform requires a backing tree data source.");const i=this.layout(e.method),r=this.fields,s=n.source.root,o=e.as||r;e.field?s.sum(e.field):s.count(),e.sort&&s.sort(stableCompare(e.sort,l=>l.data)),setParams(i,this.params,e),i.separation&&i.separation(e.separation!==!1?defaultSeparation:one$2);try{this.value=i(s)}catch(l){error(l)}return s.each(l=>setFields(l,r,o)),n.reflow(e.modified()).modifies(o).modifies("leaf")}});function setParams(e,n,i){for(let r,s=0,o=n.length;s<o;++s)r=n[s],r in i&&e[r](i[r])}function setFields(e,n,i){const r=e.data,s=n.length-1;for(let o=0;o<s;++o)r[i[o]]=e[n[o]];r[i[s]]=e.children?e.children.length:0}const Output$3=["x","y","r","depth","children"];function Pack(e){HierarchyLayout.call(this,e)}Pack.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Output$3.length,default:Output$3}]};inherits(Pack,HierarchyLayout,{layout:pack,params:["radius","size","padding"],fields:Output$3});const Output$2=["x0","y0","x1","y1","depth","children"];function Partition(e){HierarchyLayout.call(this,e)}Partition.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Output$2.length,default:Output$2}]};inherits(Partition,HierarchyLayout,{layout:partition$1,params:["size","round","padding"],fields:Output$2});function Stratify(e){Transform.call(this,null,e)}Stratify.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};inherits(Stratify,Transform,{transform(e,n){n.source||error("Stratify transform requires an upstream data source.");let i=this.value;const r=e.modified(),s=n.fork(n.ALL).materialize(n.SOURCE),o=!i||r||n.changed(n.ADD_REM)||n.modified(e.key.fields)||n.modified(e.parentKey.fields);return s.source=s.source.slice(),o&&(i=s.source.length?lookup$2(stratify().id(e.key).parentId(e.parentKey)(s.source),e.key,truthy):lookup$2(stratify()([{}]),e.key,e.key)),s.source.root=this.value=i,s}});const Layouts={tidy:tree$1,cluster},Output$1$1=["x","y","depth","children"];function Tree(e){HierarchyLayout.call(this,e)}Tree.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Output$1$1.length,default:Output$1$1}]};inherits(Tree,HierarchyLayout,{layout(e){const n=e||"tidy";if(has$1(Layouts,n))return Layouts[n]();error("Unrecognized Tree layout method: "+n)},params:["size","nodeSize"],fields:Output$1$1});function TreeLinks(e){Transform.call(this,[],e)}TreeLinks.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};inherits(TreeLinks,Transform,{transform(e,n){const i=this.value,r=n.source&&n.source.root,s=n.fork(n.NO_SOURCE),o={};return r||error("TreeLinks transform requires a tree data source."),n.changed(n.ADD_REM)?(s.rem=i,n.visit(n.SOURCE,l=>o[tupleid(l)]=1),r.each(l=>{const f=l.data,d=l.parent&&l.parent.data;d&&o[tupleid(f)]&&o[tupleid(d)]&&s.add.push(ingest$1({source:d,target:f}))}),this.value=s.add):n.changed(n.MOD)&&(n.visit(n.MOD,l=>o[tupleid(l)]=1),i.forEach(l=>{(o[tupleid(l.source)]||o[tupleid(l.target)])&&s.mod.push(l)})),s}});const Tiles={binary:treemapBinary,dice:treemapDice,slice:treemapSlice,slicedice:treemapSliceDice,squarify:treemapSquarify,resquarify:treemapResquarify},Output$4=["x0","y0","x1","y1","depth","children"];function Treemap(e){HierarchyLayout.call(this,e)}Treemap.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Output$4.length,default:Output$4}]};inherits(Treemap,HierarchyLayout,{layout(){const e=treemap();return e.ratio=n=>{const i=e.tile();i.ratio&&e.tile(i.ratio(n))},e.method=n=>{has$1(Tiles,n)?e.tile(Tiles[n]):error("Unrecognized Treemap layout method: "+n)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:Output$4});const tree=Object.freeze(Object.defineProperty({__proto__:null,nest:Nest,pack:Pack,partition:Partition,stratify:Stratify,tree:Tree,treelinks:TreeLinks,treemap:Treemap},Symbol.toStringTag,{value:"Module"})),ALPHA_MASK=4278190080;function baseBitmaps(e,n){const i=e.bitmap();return(n||[]).forEach(r=>i.set(e(r.boundary[0]),e(r.boundary[3]))),[i,void 0]}function markBitmaps(e,n,i,r,s){const o=e.width,l=e.height,f=r||s,d=domCanvas(o,l).getContext("2d"),p=domCanvas(o,l).getContext("2d"),g=f&&domCanvas(o,l).getContext("2d");i.forEach(q=>draw(d,q,!1)),draw(p,n,!1),f&&draw(g,n,!0);const v=getBuffer(d,o,l),S=getBuffer(p,o,l),T=f&&getBuffer(g,o,l),k=e.bitmap(),O=f&&e.bitmap();let R,P,F,I,L,N,j,z;for(P=0;P<l;++P)for(R=0;R<o;++R)L=P*o+R,N=v[L]&ALPHA_MASK,z=S[L]&ALPHA_MASK,j=f&&T[L]&ALPHA_MASK,(N||j||z)&&(F=e(R),I=e(P),!s&&(N||z)&&k.set(F,I),f&&(N||j)&&O.set(F,I));return[k,O]}function getBuffer(e,n,i){return new Uint32Array(e.getImageData(0,0,n,i).data.buffer)}function draw(e,n,i){if(!n.length)return;const r=n[0].mark.marktype;r==="group"?n.forEach(s=>{s.items.forEach(o=>draw(e,o.items,i))}):Marks[r].draw(e,{items:i?n.map(prepare):n})}function prepare(e){const n=rederive(e,{});return n.stroke&&n.strokeOpacity!==0||n.fill&&n.fillOpacity!==0?{...n,strokeOpacity:1,stroke:"#000",fillOpacity:0}:n}const DIV=5,MOD=31,SIZE$1=32,RIGHT0=new Uint32Array(SIZE$1+1),RIGHT1=new Uint32Array(SIZE$1+1);RIGHT1[0]=0;RIGHT0[0]=~RIGHT1[0];for(let e=1;e<=SIZE$1;++e)RIGHT1[e]=RIGHT1[e-1]<<1|1,RIGHT0[e]=~RIGHT1[e];function Bitmap(e,n){const i=new Uint32Array(~~((e*n+SIZE$1)/SIZE$1));function r(o,l){i[o]|=l}function s(o,l){i[o]&=l}return{array:i,get:(o,l)=>{const f=l*e+o;return i[f>>>DIV]&1<<(f&MOD)},set:(o,l)=>{const f=l*e+o;r(f>>>DIV,1<<(f&MOD))},clear:(o,l)=>{const f=l*e+o;s(f>>>DIV,~(1<<(f&MOD)))},getRange:(o,l,f,d)=>{let p=d,g,v,S,T;for(;p>=l;--p)if(g=p*e+o,v=p*e+f,S=g>>>DIV,T=v>>>DIV,S===T){if(i[S]&RIGHT0[g&MOD]&RIGHT1[(v&MOD)+1])return!0}else{if(i[S]&RIGHT0[g&MOD]||i[T]&RIGHT1[(v&MOD)+1])return!0;for(let k=S+1;k<T;++k)if(i[k])return!0}return!1},setRange:(o,l,f,d)=>{let p,g,v,S,T;for(;l<=d;++l)if(p=l*e+o,g=l*e+f,v=p>>>DIV,S=g>>>DIV,v===S)r(v,RIGHT0[p&MOD]&RIGHT1[(g&MOD)+1]);else for(r(v,RIGHT0[p&MOD]),r(S,RIGHT1[(g&MOD)+1]),T=v+1;T<S;++T)r(T,4294967295)},clearRange:(o,l,f,d)=>{let p,g,v,S,T;for(;l<=d;++l)if(p=l*e+o,g=l*e+f,v=p>>>DIV,S=g>>>DIV,v===S)s(v,RIGHT1[p&MOD]|RIGHT0[(g&MOD)+1]);else for(s(v,RIGHT1[p&MOD]),s(S,RIGHT0[(g&MOD)+1]),T=v+1;T<S;++T)s(T,0)},outOfBounds:(o,l,f,d)=>o<0||l<0||d>=n||f>=e}}function scaler(e,n,i){const r=Math.max(1,Math.sqrt(e*n/1e6)),s=~~((e+2*i+r)/r),o=~~((n+2*i+r)/r),l=f=>~~((f+i)/r);return l.invert=f=>f*r-i,l.bitmap=()=>Bitmap(s,o),l.ratio=r,l.padding=i,l.width=e,l.height=n,l}function placeAreaLabelNaive(e,n,i,r){const s=e.width,o=e.height;return function(l){const f=l.datum.datum.items[r].items,d=f.length,p=l.datum.fontSize,g=textMetrics.width(l.datum,l.datum.text);let v=0,S,T,k,O,R,P,F;for(let I=0;I<d;++I)S=f[I].x,k=f[I].y,T=f[I].x2===void 0?S:f[I].x2,O=f[I].y2===void 0?k:f[I].y2,R=(S+T)/2,P=(k+O)/2,F=Math.abs(T-S+O-k),F>=v&&(v=F,l.x=R,l.y=P);return R=g/2,P=p/2,S=l.x-R,T=l.x+R,k=l.y-P,O=l.y+P,l.align="center",S<0&&T<=s?l.align="left":0<=S&&s<T&&(l.align="right"),l.baseline="middle",k<0&&O<=o?l.baseline="top":0<=k&&o<O&&(l.baseline="bottom"),!0}}function outOfBounds(e,n,i,r,s,o){let l=i/2;return e-l<0||e+l>s||n-(l=r/2)<0||n+l>o}function collision(e,n,i,r,s,o,l,f){const d=s*o/(r*2),p=e(n-d),g=e(n+d),v=e(i-(o=o/2)),S=e(i+o);return l.outOfBounds(p,v,g,S)||l.getRange(p,v,g,S)||f&&f.getRange(p,v,g,S)}function placeAreaLabelReducedSearch(e,n,i,r){const s=e.width,o=e.height,l=n[0],f=n[1];function d(p,g,v,S,T){const k=e.invert(p),O=e.invert(g);let R=v,P=o,F;if(!outOfBounds(k,O,S,T,s,o)&&!collision(e,k,O,T,S,R,l,f)&&!collision(e,k,O,T,S,T,l,null)){for(;P-R>=1;)F=(R+P)/2,collision(e,k,O,T,S,F,l,f)?P=F:R=F;if(R>v)return[k,O,R,!0]}}return function(p){const g=p.datum.datum.items[r].items,v=g.length,S=p.datum.fontSize,T=textMetrics.width(p.datum,p.datum.text);let k=i?S:0,O=!1,R=!1,P=0,F,I,L,N,j,z,q,H,W,U,Q,J,ne,G,Z,ae,oe;for(let pe=0;pe<v;++pe){for(F=g[pe].x,L=g[pe].y,I=g[pe].x2===void 0?F:g[pe].x2,N=g[pe].y2===void 0?L:g[pe].y2,F>I&&(oe=F,F=I,I=oe),L>N&&(oe=L,L=N,N=oe),W=e(F),Q=e(I),U=~~((W+Q)/2),J=e(L),G=e(N),ne=~~((J+G)/2),q=U;q>=W;--q)for(H=ne;H>=J;--H)ae=d(q,H,k,T,S),ae&&([p.x,p.y,k,O]=ae);for(q=U;q<=Q;++q)for(H=ne;H<=G;++H)ae=d(q,H,k,T,S),ae&&([p.x,p.y,k,O]=ae);!O&&!i&&(Z=Math.abs(I-F+N-L),j=(F+I)/2,z=(L+N)/2,Z>=P&&!outOfBounds(j,z,T,S,s,o)&&!collision(e,j,z,S,T,S,l,null)&&(P=Z,p.x=j,p.y=z,R=!0))}return O||R?(j=T/2,z=S/2,l.setRange(e(p.x-j),e(p.y-z),e(p.x+j),e(p.y+z)),p.align="center",p.baseline="middle",!0):!1}}const X_DIR=[-1,-1,1,1],Y_DIR=[-1,1,-1,1];function placeAreaLabelFloodFill(e,n,i,r){const s=e.width,o=e.height,l=n[0],f=n[1],d=e.bitmap();return function(p){const g=p.datum.datum.items[r].items,v=g.length,S=p.datum.fontSize,T=textMetrics.width(p.datum,p.datum.text),k=[];let O=i?S:0,R=!1,P=!1,F=0,I,L,N,j,z,q,H,W,U,Q,J,ne;for(let G=0;G<v;++G){for(I=g[G].x,N=g[G].y,L=g[G].x2===void 0?I:g[G].x2,j=g[G].y2===void 0?N:g[G].y2,k.push([e((I+L)/2),e((N+j)/2)]);k.length;)if([H,W]=k.pop(),!(l.get(H,W)||f.get(H,W)||d.get(H,W))){d.set(H,W);for(let Z=0;Z<4;++Z)z=H+X_DIR[Z],q=W+Y_DIR[Z],d.outOfBounds(z,q,z,q)||k.push([z,q]);if(z=e.invert(H),q=e.invert(W),U=O,Q=o,!outOfBounds(z,q,T,S,s,o)&&!collision(e,z,q,S,T,U,l,f)&&!collision(e,z,q,S,T,S,l,null)){for(;Q-U>=1;)J=(U+Q)/2,collision(e,z,q,S,T,J,l,f)?Q=J:U=J;U>O&&(p.x=z,p.y=q,O=U,R=!0)}}!R&&!i&&(ne=Math.abs(L-I+j-N),z=(I+L)/2,q=(N+j)/2,ne>=F&&!outOfBounds(z,q,T,S,s,o)&&!collision(e,z,q,S,T,S,l,null)&&(F=ne,p.x=z,p.y=q,P=!0))}return R||P?(z=T/2,q=S/2,l.setRange(e(p.x-z),e(p.y-q),e(p.x+z),e(p.y+q)),p.align="center",p.baseline="middle",!0):!1}}const Aligns=["right","center","left"],Baselines=["bottom","middle","top"];function placeMarkLabel(e,n,i,r){const s=e.width,o=e.height,l=n[0],f=n[1],d=r.length;return function(p){var g;const v=p.boundary,S=p.datum.fontSize;if(v[2]<0||v[5]<0||v[0]>s||v[3]>o)return!1;let T=(g=p.textWidth)!==null&&g!==void 0?g:0,k,O,R,P,F,I,L,N,j,z,q,H,W,U,Q;for(let J=0;J<d;++J){if(k=(i[J]&3)-1,O=(i[J]>>>2&3)-1,R=k===0&&O===0||r[J]<0,P=k&&O?Math.SQRT1_2:1,F=r[J]<0?-1:1,I=v[1+k]+r[J]*k*P,q=v[4+O]+F*S*O/2+r[J]*O*P,N=q-S/2,j=q+S/2,H=e(I),U=e(N),Q=e(j),!T)if(test(H,H,U,Q,l,f,I,I,N,j,v,R))T=textMetrics.width(p.datum,p.datum.text);else continue;if(z=I+F*T*k/2,I=z-T/2,L=z+T/2,H=e(I),W=e(L),test(H,W,U,Q,l,f,I,L,N,j,v,R))return p.x=k?k*F<0?L:I:z,p.y=O?O*F<0?j:N:q,p.align=Aligns[k*F+1],p.baseline=Baselines[O*F+1],l.setRange(H,U,W,Q),!0}return!1}}function test(e,n,i,r,s,o,l,f,d,p,g,v){return!(s.outOfBounds(e,i,n,r)||(v&&o||s).getRange(e,i,n,r))}const TOP=0,MIDDLE=4,BOTTOM=8,LEFT=0,CENTER=1,RIGHT=2,anchorCode={"top-left":TOP+LEFT,top:TOP+CENTER,"top-right":TOP+RIGHT,left:MIDDLE+LEFT,middle:MIDDLE+CENTER,right:MIDDLE+RIGHT,"bottom-left":BOTTOM+LEFT,bottom:BOTTOM+CENTER,"bottom-right":BOTTOM+RIGHT},placeAreaLabel={naive:placeAreaLabelNaive,"reduced-search":placeAreaLabelReducedSearch,floodfill:placeAreaLabelFloodFill};function labelLayout(e,n,i,r,s,o,l,f,d,p,g){if(!e.length)return e;const v=Math.max(r.length,s.length),S=getOffsets(r,v),T=getAnchors(s,v),k=markType(e[0].datum),O=k==="group"&&e[0].datum.items[d].marktype,R=O==="area",P=markBoundary(k,O,f,d),F=p===null||p===1/0,I=R&&g==="naive";let L=-1,N=-1;const j=e.map(W=>{const U=F?textMetrics.width(W,W.text):void 0;return L=Math.max(L,U),N=Math.max(N,W.fontSize),{datum:W,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:P(W),textWidth:U}});p=p===null||p===1/0?Math.max(L,N)+Math.max(...r):p;const z=scaler(n[0],n[1],p);let q;if(!I){i&&j.sort((Q,J)=>i(Q.datum,J.datum));let W=!1;for(let Q=0;Q<T.length&&!W;++Q)W=T[Q]===5||S[Q]<0;const U=(k&&l||R)&&e.map(Q=>Q.datum);q=o.length||U?markBitmaps(z,U||[],o,W,R):baseBitmaps(z,l&&j)}const H=R?placeAreaLabel[g](z,q,l,d):placeMarkLabel(z,q,T,S);return j.forEach(W=>W.opacity=+H(W)),j}function getOffsets(e,n){const i=new Float64Array(n),r=e.length;for(let s=0;s<r;++s)i[s]=e[s]||0;for(let s=r;s<n;++s)i[s]=i[r-1];return i}function getAnchors(e,n){const i=new Int8Array(n),r=e.length;for(let s=0;s<r;++s)i[s]|=anchorCode[e[s]];for(let s=r;s<n;++s)i[s]=i[r-1];return i}function markType(e){return e&&e.mark&&e.mark.marktype}function markBoundary(e,n,i,r){const s=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>s(o.datum):n==="line"?o=>{const l=o.datum.items[r].items;return s(l.length?l[i==="start"?0:l.length-1]:{x:NaN,y:NaN})}:o=>{const l=o.datum.bounds;return[l.x1,(l.x1+l.x2)/2,l.x2,l.y1,(l.y1+l.y2)/2,l.y2]}:s}const Output$1=["x","y","opacity","align","baseline"],Anchors=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Label$1(e){Transform.call(this,null,e)}Label$1.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Anchors},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Output$1.length,default:Output$1}]};inherits(Label$1,Transform,{transform(e,n){function i(o){const l=e[o];return isFunction(l)&&n.modified(l.fields)}const r=e.modified();if(!(r||n.changed(n.ADD_REM)||i("sort")))return;(!e.size||e.size.length!==2)&&error("Size parameter should be specified as a [width, height] array.");const s=e.as||Output$1;return labelLayout(n.materialize(n.SOURCE).source||[],e.size,e.sort,array$5(e.offset==null?1:e.offset),array$5(e.anchor||Anchors),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const l=o.datum;l[s[0]]=o.x,l[s[1]]=o.y,l[s[2]]=o.opacity,l[s[3]]=o.align,l[s[4]]=o.baseline}),n.reflow(r).modifies(s)}});const label=Object.freeze(Object.defineProperty({__proto__:null,label:Label$1},Symbol.toStringTag,{value:"Module"}));function partition(e,n){var i=[],r=function(g){return g(f)},s,o,l,f,d,p;if(n==null)i.push(e);else for(s={},o=0,l=e.length;o<l;++o)f=e[o],d=n.map(r),p=s[d],p||(s[d]=p=[],p.dims=d,i.push(p)),p.push(f);return i}function Loess(e){Transform.call(this,null,e)}Loess.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};inherits(Loess,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE|n.NO_FIELDS);if(!this.value||n.changed()||e.modified()){const r=n.materialize(n.SOURCE).source,s=partition(r,e.groupby),o=(e.groupby||[]).map(accessorName),l=o.length,f=e.as||[accessorName(e.x),accessorName(e.y)],d=[];s.forEach(p=>{loess(p,e.x,e.y,e.bandwidth||.3).forEach(g=>{const v={};for(let S=0;S<l;++S)v[o[S]]=p.dims[S];v[f[0]]=g[0],v[f[1]]=g[1],d.push(ingest$1(v))})}),this.value&&(i.rem=this.value),this.value=i.add=i.source=d}return i}});const Methods={linear:linear$2,log:log$3,exp:exp$1,pow:pow$3,quad,poly},degreesOfFreedom=(e,n)=>e==="poly"?n:e==="quad"?2:1;function Regression(e){Transform.call(this,null,e)}Regression.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Methods)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};inherits(Regression,Transform,{transform(e,n){const i=n.fork(n.NO_SOURCE|n.NO_FIELDS);if(!this.value||n.changed()||e.modified()){const r=n.materialize(n.SOURCE).source,s=partition(r,e.groupby),o=(e.groupby||[]).map(accessorName),l=e.method||"linear",f=e.order||3,d=degreesOfFreedom(l,f),p=e.as||[accessorName(e.x),accessorName(e.y)],g=Methods[l],v=[];let S=e.extent;has$1(Methods,l)||error("Invalid regression method: "+l),S!=null&&l==="log"&&S[0]<=0&&(n.dataflow.warn("Ignoring extent with values <= 0 for log regression."),S=null),s.forEach(T=>{if(T.length<=d){n.dataflow.warn("Skipping regression with more parameters than data points.");return}const O=g(T,e.x,e.y,f);if(e.params){v.push(ingest$1({keys:T.dims,coef:O.coef,rSquared:O.rSquared}));return}const R=S||extent(T,e.x),P=F=>{const I={};for(let L=0;L<o.length;++L)I[o[L]]=T.dims[L];I[p[0]]=F[0],I[p[1]]=F[1],v.push(ingest$1(I))};l==="linear"?R.forEach(F=>P([F,O.predict(F)])):sampleCurve(O.predict,R,25,200).forEach(P)}),this.value&&(i.rem=this.value),this.value=i.add=i.source=v}return i}});const reg=Object.freeze(Object.defineProperty({__proto__:null,loess:Loess,regression:Regression},Symbol.toStringTag,{value:"Module"})),epsilon$1=11102230246251565e-32,splitter=134217729,resulterrbound=(3+8*epsilon$1)*epsilon$1;function sum(e,n,i,r,s){let o,l,f,d,p=n[0],g=r[0],v=0,S=0;g>p==g>-p?(o=p,p=n[++v]):(o=g,g=r[++S]);let T=0;if(v<e&&S<i)for(g>p==g>-p?(l=p+o,f=o-(l-p),p=n[++v]):(l=g+o,f=o-(l-g),g=r[++S]),o=l,f!==0&&(s[T++]=f);v<e&&S<i;)g>p==g>-p?(l=o+p,d=l-o,f=o-(l-d)+(p-d),p=n[++v]):(l=o+g,d=l-o,f=o-(l-d)+(g-d),g=r[++S]),o=l,f!==0&&(s[T++]=f);for(;v<e;)l=o+p,d=l-o,f=o-(l-d)+(p-d),p=n[++v],o=l,f!==0&&(s[T++]=f);for(;S<i;)l=o+g,d=l-o,f=o-(l-d)+(g-d),g=r[++S],o=l,f!==0&&(s[T++]=f);return(o!==0||T===0)&&(s[T++]=o),T}function estimate(e,n){let i=n[0];for(let r=1;r<e;r++)i+=n[r];return i}function vec(e){return new Float64Array(e)}const ccwerrboundA=(3+16*epsilon$1)*epsilon$1,ccwerrboundB=(2+12*epsilon$1)*epsilon$1,ccwerrboundC=(9+64*epsilon$1)*epsilon$1*epsilon$1,B=vec(4),C1=vec(8),C2=vec(12),D=vec(16),u=vec(4);function orient2dadapt(e,n,i,r,s,o,l){let f,d,p,g,v,S,T,k,O,R,P,F,I,L,N,j,z,q;const H=e-s,W=i-s,U=n-o,Q=r-o;L=H*Q,S=splitter*H,T=S-(S-H),k=H-T,S=splitter*Q,O=S-(S-Q),R=Q-O,N=k*R-(L-T*O-k*O-T*R),j=U*W,S=splitter*U,T=S-(S-U),k=U-T,S=splitter*W,O=S-(S-W),R=W-O,z=k*R-(j-T*O-k*O-T*R),P=N-z,v=N-P,B[0]=N-(P+v)+(v-z),F=L+P,v=F-L,I=L-(F-v)+(P-v),P=I-j,v=I-P,B[1]=I-(P+v)+(v-j),q=F+P,v=q-F,B[2]=F-(q-v)+(P-v),B[3]=q;let J=estimate(4,B),ne=ccwerrboundB*l;if(J>=ne||-J>=ne||(v=e-H,f=e-(H+v)+(v-s),v=i-W,p=i-(W+v)+(v-s),v=n-U,d=n-(U+v)+(v-o),v=r-Q,g=r-(Q+v)+(v-o),f===0&&d===0&&p===0&&g===0)||(ne=ccwerrboundC*l+resulterrbound*Math.abs(J),J+=H*g+Q*f-(U*p+W*d),J>=ne||-J>=ne))return J;L=f*Q,S=splitter*f,T=S-(S-f),k=f-T,S=splitter*Q,O=S-(S-Q),R=Q-O,N=k*R-(L-T*O-k*O-T*R),j=d*W,S=splitter*d,T=S-(S-d),k=d-T,S=splitter*W,O=S-(S-W),R=W-O,z=k*R-(j-T*O-k*O-T*R),P=N-z,v=N-P,u[0]=N-(P+v)+(v-z),F=L+P,v=F-L,I=L-(F-v)+(P-v),P=I-j,v=I-P,u[1]=I-(P+v)+(v-j),q=F+P,v=q-F,u[2]=F-(q-v)+(P-v),u[3]=q;const G=sum(4,B,4,u,C1);L=H*g,S=splitter*H,T=S-(S-H),k=H-T,S=splitter*g,O=S-(S-g),R=g-O,N=k*R-(L-T*O-k*O-T*R),j=U*p,S=splitter*U,T=S-(S-U),k=U-T,S=splitter*p,O=S-(S-p),R=p-O,z=k*R-(j-T*O-k*O-T*R),P=N-z,v=N-P,u[0]=N-(P+v)+(v-z),F=L+P,v=F-L,I=L-(F-v)+(P-v),P=I-j,v=I-P,u[1]=I-(P+v)+(v-j),q=F+P,v=q-F,u[2]=F-(q-v)+(P-v),u[3]=q;const Z=sum(G,C1,4,u,C2);L=f*g,S=splitter*f,T=S-(S-f),k=f-T,S=splitter*g,O=S-(S-g),R=g-O,N=k*R-(L-T*O-k*O-T*R),j=d*p,S=splitter*d,T=S-(S-d),k=d-T,S=splitter*p,O=S-(S-p),R=p-O,z=k*R-(j-T*O-k*O-T*R),P=N-z,v=N-P,u[0]=N-(P+v)+(v-z),F=L+P,v=F-L,I=L-(F-v)+(P-v),P=I-j,v=I-P,u[1]=I-(P+v)+(v-j),q=F+P,v=q-F,u[2]=F-(q-v)+(P-v),u[3]=q;const ae=sum(Z,C2,4,u,D);return D[ae-1]}function orient2d(e,n,i,r,s,o){const l=(n-o)*(i-s),f=(e-s)*(r-o),d=l-f;if(l===0||f===0||l>0!=f>0)return d;const p=Math.abs(l+f);return Math.abs(d)>=ccwerrboundA*p?d:-orient2dadapt(e,n,i,r,s,o,p)}const EPSILON=Math.pow(2,-52),EDGE_STACK=new Uint32Array(512);class Delaunator{static from(n,i=defaultGetX,r=defaultGetY){const s=n.length,o=new Float64Array(s*2);for(let l=0;l<s;l++){const f=n[l];o[2*l]=i(f),o[2*l+1]=r(f)}return new Delaunator(o)}constructor(n){const i=n.length>>1;if(i>0&&typeof n[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=n;const r=Math.max(2*i-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(i)),this._hullPrev=new Uint32Array(i),this._hullNext=new Uint32Array(i),this._hullTri=new Uint32Array(i),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(i),this._dists=new Float64Array(i),this.update()}update(){const{coords:n,_hullPrev:i,_hullNext:r,_hullTri:s,_hullHash:o}=this,l=n.length>>1;let f=1/0,d=1/0,p=-1/0,g=-1/0;for(let W=0;W<l;W++){const U=n[2*W],Q=n[2*W+1];U<f&&(f=U),Q<d&&(d=Q),U>p&&(p=U),Q>g&&(g=Q),this._ids[W]=W}const v=(f+p)/2,S=(d+g)/2;let T=1/0,k,O,R;for(let W=0;W<l;W++){const U=dist(v,S,n[2*W],n[2*W+1]);U<T&&(k=W,T=U)}const P=n[2*k],F=n[2*k+1];T=1/0;for(let W=0;W<l;W++){if(W===k)continue;const U=dist(P,F,n[2*W],n[2*W+1]);U<T&&U>0&&(O=W,T=U)}let I=n[2*O],L=n[2*O+1],N=1/0;for(let W=0;W<l;W++){if(W===k||W===O)continue;const U=circumradius(P,F,I,L,n[2*W],n[2*W+1]);U<N&&(R=W,N=U)}let j=n[2*R],z=n[2*R+1];if(N===1/0){for(let Q=0;Q<l;Q++)this._dists[Q]=n[2*Q]-n[0]||n[2*Q+1]-n[1];quicksort(this._ids,this._dists,0,l-1);const W=new Uint32Array(l);let U=0;for(let Q=0,J=-1/0;Q<l;Q++){const ne=this._ids[Q];this._dists[ne]>J&&(W[U++]=ne,J=this._dists[ne])}this.hull=W.subarray(0,U),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(orient2d(P,F,I,L,j,z)<0){const W=O,U=I,Q=L;O=R,I=j,L=z,R=W,j=U,z=Q}const q=circumcenter(P,F,I,L,j,z);this._cx=q.x,this._cy=q.y;for(let W=0;W<l;W++)this._dists[W]=dist(n[2*W],n[2*W+1],q.x,q.y);quicksort(this._ids,this._dists,0,l-1),this._hullStart=k;let H=3;r[k]=i[R]=O,r[O]=i[k]=R,r[R]=i[O]=k,s[k]=0,s[O]=1,s[R]=2,o.fill(-1),o[this._hashKey(P,F)]=k,o[this._hashKey(I,L)]=O,o[this._hashKey(j,z)]=R,this.trianglesLen=0,this._addTriangle(k,O,R,-1,-1,-1);for(let W=0,U,Q;W<this._ids.length;W++){const J=this._ids[W],ne=n[2*J],G=n[2*J+1];if(W>0&&Math.abs(ne-U)<=EPSILON&&Math.abs(G-Q)<=EPSILON||(U=ne,Q=G,J===k||J===O||J===R))continue;let Z=0;for(let ue=0,ee=this._hashKey(ne,G);ue<this._hashSize&&(Z=o[(ee+ue)%this._hashSize],!(Z!==-1&&Z!==r[Z]));ue++);Z=i[Z];let ae=Z,oe;for(;oe=r[ae],orient2d(ne,G,n[2*ae],n[2*ae+1],n[2*oe],n[2*oe+1])>=0;)if(ae=oe,ae===Z){ae=-1;break}if(ae===-1)continue;let pe=this._addTriangle(ae,J,r[ae],-1,-1,s[ae]);s[J]=this._legalize(pe+2),s[ae]=pe,H++;let Se=r[ae];for(;oe=r[Se],orient2d(ne,G,n[2*Se],n[2*Se+1],n[2*oe],n[2*oe+1])<0;)pe=this._addTriangle(Se,J,oe,s[J],-1,s[Se]),s[J]=this._legalize(pe+2),r[Se]=Se,H--,Se=oe;if(ae===Z)for(;oe=i[ae],orient2d(ne,G,n[2*oe],n[2*oe+1],n[2*ae],n[2*ae+1])<0;)pe=this._addTriangle(oe,J,ae,-1,s[ae],s[oe]),this._legalize(pe+2),s[oe]=pe,r[ae]=ae,H--,ae=oe;this._hullStart=i[J]=ae,r[ae]=i[Se]=J,r[J]=Se,o[this._hashKey(ne,G)]=J,o[this._hashKey(n[2*ae],n[2*ae+1])]=ae}this.hull=new Uint32Array(H);for(let W=0,U=this._hullStart;W<H;W++)this.hull[W]=U,U=r[U];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(n,i){return Math.floor(pseudoAngle(n-this._cx,i-this._cy)*this._hashSize)%this._hashSize}_legalize(n){const{_triangles:i,_halfedges:r,coords:s}=this;let o=0,l=0;for(;;){const f=r[n],d=n-n%3;if(l=d+(n+2)%3,f===-1){if(o===0)break;n=EDGE_STACK[--o];continue}const p=f-f%3,g=d+(n+1)%3,v=p+(f+2)%3,S=i[l],T=i[n],k=i[g],O=i[v];if(inCircle(s[2*S],s[2*S+1],s[2*T],s[2*T+1],s[2*k],s[2*k+1],s[2*O],s[2*O+1])){i[n]=O,i[f]=S;const P=r[v];if(P===-1){let I=this._hullStart;do{if(this._hullTri[I]===v){this._hullTri[I]=n;break}I=this._hullPrev[I]}while(I!==this._hullStart)}this._link(n,P),this._link(f,r[l]),this._link(l,v);const F=p+(f+1)%3;o<EDGE_STACK.length&&(EDGE_STACK[o++]=F)}else{if(o===0)break;n=EDGE_STACK[--o]}}return l}_link(n,i){this._halfedges[n]=i,i!==-1&&(this._halfedges[i]=n)}_addTriangle(n,i,r,s,o,l){const f=this.trianglesLen;return this._triangles[f]=n,this._triangles[f+1]=i,this._triangles[f+2]=r,this._link(f,s),this._link(f+1,o),this._link(f+2,l),this.trianglesLen+=3,f}}function pseudoAngle(e,n){const i=e/(Math.abs(e)+Math.abs(n));return(n>0?3-i:1+i)/4}function dist(e,n,i,r){const s=e-i,o=n-r;return s*s+o*o}function inCircle(e,n,i,r,s,o,l,f){const d=e-l,p=n-f,g=i-l,v=r-f,S=s-l,T=o-f,k=d*d+p*p,O=g*g+v*v,R=S*S+T*T;return d*(v*R-O*T)-p*(g*R-O*S)+k*(g*T-v*S)<0}function circumradius(e,n,i,r,s,o){const l=i-e,f=r-n,d=s-e,p=o-n,g=l*l+f*f,v=d*d+p*p,S=.5/(l*p-f*d),T=(p*g-f*v)*S,k=(l*v-d*g)*S;return T*T+k*k}function circumcenter(e,n,i,r,s,o){const l=i-e,f=r-n,d=s-e,p=o-n,g=l*l+f*f,v=d*d+p*p,S=.5/(l*p-f*d),T=e+(p*g-f*v)*S,k=n+(l*v-d*g)*S;return{x:T,y:k}}function quicksort(e,n,i,r){if(r-i<=20)for(let s=i+1;s<=r;s++){const o=e[s],l=n[o];let f=s-1;for(;f>=i&&n[e[f]]>l;)e[f+1]=e[f--];e[f+1]=o}else{const s=i+r>>1;let o=i+1,l=r;swap(e,s,o),n[e[i]]>n[e[r]]&&swap(e,i,r),n[e[o]]>n[e[r]]&&swap(e,o,r),n[e[i]]>n[e[o]]&&swap(e,i,o);const f=e[o],d=n[f];for(;;){do o++;while(n[e[o]]<d);do l--;while(n[e[l]]>d);if(l<o)break;swap(e,o,l)}e[i+1]=e[l],e[l]=f,r-o+1>=l-i?(quicksort(e,n,o,r),quicksort(e,n,i,l-1)):(quicksort(e,n,i,l-1),quicksort(e,n,o,r))}}function swap(e,n,i){const r=e[n];e[n]=e[i],e[i]=r}function defaultGetX(e){return e[0]}function defaultGetY(e){return e[1]}const epsilon=1e-6;class Path{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(n,i){this._+=`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(n,i){this._+=`L${this._x1=+n},${this._y1=+i}`}arc(n,i,r){n=+n,i=+i,r=+r;const s=n+r,o=i;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${o}`:(Math.abs(this._x1-s)>epsilon||Math.abs(this._y1-o)>epsilon)&&(this._+="L"+s+","+o),r&&(this._+=`A${r},${r},0,1,1,${n-r},${i}A${r},${r},0,1,1,${this._x1=s},${this._y1=o}`)}rect(n,i,r,s){this._+=`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}h${+r}v${+s}h${-r}Z`}value(){return this._||null}}class Polygon{constructor(){this._=[]}moveTo(n,i){this._.push([n,i])}closePath(){this._.push(this._[0].slice())}lineTo(n,i){this._.push([n,i])}value(){return this._.length?this._:null}}let Voronoi$1=class{constructor(n,[i,r,s,o]=[0,0,960,500]){if(!((s=+s)>=(i=+i))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=n,this._circumcenters=new Float64Array(n.points.length*2),this.vectors=new Float64Array(n.points.length*2),this.xmax=s,this.xmin=i,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:n,hull:i,triangles:r},vectors:s}=this,o=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let T=0,k=0,O=r.length,R,P;T<O;T+=3,k+=2){const F=r[T]*2,I=r[T+1]*2,L=r[T+2]*2,N=n[F],j=n[F+1],z=n[I],q=n[I+1],H=n[L],W=n[L+1],U=z-N,Q=q-j,J=H-N,ne=W-j,G=(U*ne-Q*J)*2;if(Math.abs(G)<1e-9){let Z=1e9;const ae=r[0]*2;Z*=Math.sign((n[ae]-N)*ne-(n[ae+1]-j)*J),R=(N+H)/2-Z*ne,P=(j+W)/2+Z*J}else{const Z=1/G,ae=U*U+Q*Q,oe=J*J+ne*ne;R=N+(ne*ae-Q*oe)*Z,P=j+(U*oe-J*ae)*Z}o[k]=R,o[k+1]=P}let l=i[i.length-1],f,d=l*4,p,g=n[2*l],v,S=n[2*l+1];s.fill(0);for(let T=0;T<i.length;++T)l=i[T],f=d,p=g,v=S,d=l*4,g=n[2*l],S=n[2*l+1],s[f+2]=s[d]=v-S,s[f+3]=s[d+1]=g-p}render(n){const i=n==null?n=new Path:void 0,{delaunay:{halfedges:r,inedges:s,hull:o},circumcenters:l,vectors:f}=this;if(o.length<=1)return null;for(let g=0,v=r.length;g<v;++g){const S=r[g];if(S<g)continue;const T=Math.floor(g/3)*2,k=Math.floor(S/3)*2,O=l[T],R=l[T+1],P=l[k],F=l[k+1];this._renderSegment(O,R,P,F,n)}let d,p=o[o.length-1];for(let g=0;g<o.length;++g){d=p,p=o[g];const v=Math.floor(s[p]/3)*2,S=l[v],T=l[v+1],k=d*4,O=this._project(S,T,f[k+2],f[k+3]);O&&this._renderSegment(S,T,O[0],O[1],n)}return i&&i.value()}renderBounds(n){const i=n==null?n=new Path:void 0;return n.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),i&&i.value()}renderCell(n,i){const r=i==null?i=new Path:void 0,s=this._clip(n);if(s===null||!s.length)return;i.moveTo(s[0],s[1]);let o=s.length;for(;s[0]===s[o-2]&&s[1]===s[o-1]&&o>1;)o-=2;for(let l=2;l<o;l+=2)(s[l]!==s[l-2]||s[l+1]!==s[l-1])&&i.lineTo(s[l],s[l+1]);return i.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:n}}=this;for(let i=0,r=n.length/2;i<r;++i){const s=this.cellPolygon(i);s&&(s.index=i,yield s)}}cellPolygon(n){const i=new Polygon;return this.renderCell(n,i),i.value()}_renderSegment(n,i,r,s,o){let l;const f=this._regioncode(n,i),d=this._regioncode(r,s);f===0&&d===0?(o.moveTo(n,i),o.lineTo(r,s)):(l=this._clipSegment(n,i,r,s,f,d))&&(o.moveTo(l[0],l[1]),o.lineTo(l[2],l[3]))}contains(n,i,r){return i=+i,i!==i||(r=+r,r!==r)?!1:this.delaunay._step(n,i,r)===n}*neighbors(n){const i=this._clip(n);if(i)for(const r of this.delaunay.neighbors(n)){const s=this._clip(r);if(s){e:for(let o=0,l=i.length;o<l;o+=2)for(let f=0,d=s.length;f<d;f+=2)if(i[o]==s[f]&&i[o+1]==s[f+1]&&i[(o+2)%l]==s[(f+d-2)%d]&&i[(o+3)%l]==s[(f+d-1)%d]){yield r;break e}}}}_cell(n){const{circumcenters:i,delaunay:{inedges:r,halfedges:s,triangles:o}}=this,l=r[n];if(l===-1)return null;const f=[];let d=l;do{const p=Math.floor(d/3);if(f.push(i[p*2],i[p*2+1]),d=d%3===2?d-2:d+1,o[d]!==n)break;d=s[d]}while(d!==l&&d!==-1);return f}_clip(n){if(n===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const i=this._cell(n);if(i===null)return null;const{vectors:r}=this,s=n*4;return r[s]||r[s+1]?this._clipInfinite(n,i,r[s],r[s+1],r[s+2],r[s+3]):this._clipFinite(n,i)}_clipFinite(n,i){const r=i.length;let s=null,o,l,f=i[r-2],d=i[r-1],p,g=this._regioncode(f,d),v,S=0;for(let T=0;T<r;T+=2)if(o=f,l=d,f=i[T],d=i[T+1],p=g,g=this._regioncode(f,d),p===0&&g===0)v=S,S=0,s?s.push(f,d):s=[f,d];else{let k,O,R,P,F;if(p===0){if((k=this._clipSegment(o,l,f,d,p,g))===null)continue;[O,R,P,F]=k}else{if((k=this._clipSegment(f,d,o,l,g,p))===null)continue;[P,F,O,R]=k,v=S,S=this._edgecode(O,R),v&&S&&this._edge(n,v,S,s,s.length),s?s.push(O,R):s=[O,R]}v=S,S=this._edgecode(P,F),v&&S&&this._edge(n,v,S,s,s.length),s?s.push(P,F):s=[P,F]}if(s)v=S,S=this._edgecode(s[0],s[1]),v&&S&&this._edge(n,v,S,s,s.length);else if(this.contains(n,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(n,i,r,s,o,l){for(;;){if(o===0&&l===0)return[n,i,r,s];if(o&l)return null;let f,d,p=o||l;p&8?(f=n+(r-n)*(this.ymax-i)/(s-i),d=this.ymax):p&4?(f=n+(r-n)*(this.ymin-i)/(s-i),d=this.ymin):p&2?(d=i+(s-i)*(this.xmax-n)/(r-n),f=this.xmax):(d=i+(s-i)*(this.xmin-n)/(r-n),f=this.xmin),o?(n=f,i=d,o=this._regioncode(n,i)):(r=f,s=d,l=this._regioncode(r,s))}}_clipInfinite(n,i,r,s,o,l){let f=Array.from(i),d;if((d=this._project(f[0],f[1],r,s))&&f.unshift(d[0],d[1]),(d=this._project(f[f.length-2],f[f.length-1],o,l))&&f.push(d[0],d[1]),f=this._clipFinite(n,f))for(let p=0,g=f.length,v,S=this._edgecode(f[g-2],f[g-1]);p<g;p+=2)v=S,S=this._edgecode(f[p],f[p+1]),v&&S&&(p=this._edge(n,v,S,f,p),g=f.length);else this.contains(n,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(f=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return f}_edge(n,i,r,s,o){for(;i!==r;){let l,f;switch(i){case 5:i=4;continue;case 4:i=6,l=this.xmax,f=this.ymin;break;case 6:i=2;continue;case 2:i=10,l=this.xmax,f=this.ymax;break;case 10:i=8;continue;case 8:i=9,l=this.xmin,f=this.ymax;break;case 9:i=1;continue;case 1:i=5,l=this.xmin,f=this.ymin;break}(s[o]!==l||s[o+1]!==f)&&this.contains(n,l,f)&&(s.splice(o,0,l,f),o+=2)}if(s.length>4)for(let l=0;l<s.length;l+=2){const f=(l+2)%s.length,d=(l+4)%s.length;(s[l]===s[f]&&s[f]===s[d]||s[l+1]===s[f+1]&&s[f+1]===s[d+1])&&(s.splice(f,2),l-=2)}return o}_project(n,i,r,s){let o=1/0,l,f,d;if(s<0){if(i<=this.ymin)return null;(l=(this.ymin-i)/s)<o&&(d=this.ymin,f=n+(o=l)*r)}else if(s>0){if(i>=this.ymax)return null;(l=(this.ymax-i)/s)<o&&(d=this.ymax,f=n+(o=l)*r)}if(r>0){if(n>=this.xmax)return null;(l=(this.xmax-n)/r)<o&&(f=this.xmax,d=i+(o=l)*s)}else if(r<0){if(n<=this.xmin)return null;(l=(this.xmin-n)/r)<o&&(f=this.xmin,d=i+(o=l)*s)}return[f,d]}_edgecode(n,i){return(n===this.xmin?1:n===this.xmax?2:0)|(i===this.ymin?4:i===this.ymax?8:0)}_regioncode(n,i){return(n<this.xmin?1:n>this.xmax?2:0)|(i<this.ymin?4:i>this.ymax?8:0)}};const tau=2*Math.PI,pow=Math.pow;function pointX(e){return e[0]}function pointY(e){return e[1]}function collinear(e){const{triangles:n,coords:i}=e;for(let r=0;r<n.length;r+=3){const s=2*n[r],o=2*n[r+1],l=2*n[r+2];if((i[l]-i[s])*(i[o+1]-i[s+1])-(i[o]-i[s])*(i[l+1]-i[s+1])>1e-10)return!1}return!0}function jitter(e,n,i){return[e+Math.sin(e+n)*i,n+Math.cos(e-n)*i]}class Delaunay{static from(n,i=pointX,r=pointY,s){return new Delaunay("length"in n?flatArray(n,i,r,s):Float64Array.from(flatIterable(n,i,r,s)))}constructor(n){this._delaunator=new Delaunator(n),this.inedges=new Int32Array(n.length/2),this._hullIndex=new Int32Array(n.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const n=this._delaunator,i=this.points;if(n.hull&&n.hull.length>2&&collinear(n)){this.collinear=Int32Array.from({length:i.length/2},(S,T)=>T).sort((S,T)=>i[2*S]-i[2*T]||i[2*S+1]-i[2*T+1]);const d=this.collinear[0],p=this.collinear[this.collinear.length-1],g=[i[2*d],i[2*d+1],i[2*p],i[2*p+1]],v=1e-8*Math.hypot(g[3]-g[1],g[2]-g[0]);for(let S=0,T=i.length/2;S<T;++S){const k=jitter(i[2*S],i[2*S+1],v);i[2*S]=k[0],i[2*S+1]=k[1]}this._delaunator=new Delaunator(i)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,l=this.inedges.fill(-1),f=this._hullIndex.fill(-1);for(let d=0,p=r.length;d<p;++d){const g=o[d%3===2?d-2:d+1];(r[d]===-1||l[g]===-1)&&(l[g]=d)}for(let d=0,p=s.length;d<p;++d)f[s[d]]=d;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],l[s[0]]=1,s.length===2&&(l[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1]))}voronoi(n){return new Voronoi$1(this,n)}*neighbors(n){const{inedges:i,hull:r,_hullIndex:s,halfedges:o,triangles:l,collinear:f}=this;if(f){const v=f.indexOf(n);v>0&&(yield f[v-1]),v<f.length-1&&(yield f[v+1]);return}const d=i[n];if(d===-1)return;let p=d,g=-1;do{if(yield g=l[p],p=p%3===2?p-2:p+1,l[p]!==n)return;if(p=o[p],p===-1){const v=r[(s[n]+1)%r.length];v!==g&&(yield v);return}}while(p!==d)}find(n,i,r=0){if(n=+n,n!==n||(i=+i,i!==i))return-1;const s=r;let o;for(;(o=this._step(r,n,i))>=0&&o!==r&&o!==s;)r=o;return o}_step(n,i,r){const{inedges:s,hull:o,_hullIndex:l,halfedges:f,triangles:d,points:p}=this;if(s[n]===-1||!p.length)return(n+1)%(p.length>>1);let g=n,v=pow(i-p[n*2],2)+pow(r-p[n*2+1],2);const S=s[n];let T=S;do{let k=d[T];const O=pow(i-p[k*2],2)+pow(r-p[k*2+1],2);if(O<v&&(v=O,g=k),T=T%3===2?T-2:T+1,d[T]!==n)break;if(T=f[T],T===-1){if(T=o[(l[n]+1)%o.length],T!==k&&pow(i-p[T*2],2)+pow(r-p[T*2+1],2)<v)return T;break}}while(T!==S);return g}render(n){const i=n==null?n=new Path:void 0,{points:r,halfedges:s,triangles:o}=this;for(let l=0,f=s.length;l<f;++l){const d=s[l];if(d<l)continue;const p=o[l]*2,g=o[d]*2;n.moveTo(r[p],r[p+1]),n.lineTo(r[g],r[g+1])}return this.renderHull(n),i&&i.value()}renderPoints(n,i){i===void 0&&(!n||typeof n.moveTo!="function")&&(i=n,n=null),i=i==null?2:+i;const r=n==null?n=new Path:void 0,{points:s}=this;for(let o=0,l=s.length;o<l;o+=2){const f=s[o],d=s[o+1];n.moveTo(f+i,d),n.arc(f,d,i,0,tau)}return r&&r.value()}renderHull(n){const i=n==null?n=new Path:void 0,{hull:r,points:s}=this,o=r[0]*2,l=r.length;n.moveTo(s[o],s[o+1]);for(let f=1;f<l;++f){const d=2*r[f];n.lineTo(s[d],s[d+1])}return n.closePath(),i&&i.value()}hullPolygon(){const n=new Polygon;return this.renderHull(n),n.value()}renderTriangle(n,i){const r=i==null?i=new Path:void 0,{points:s,triangles:o}=this,l=o[n*=3]*2,f=o[n+1]*2,d=o[n+2]*2;return i.moveTo(s[l],s[l+1]),i.lineTo(s[f],s[f+1]),i.lineTo(s[d],s[d+1]),i.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:n}=this;for(let i=0,r=n.length/3;i<r;++i)yield this.trianglePolygon(i)}trianglePolygon(n){const i=new Polygon;return this.renderTriangle(n,i),i.value()}}function flatArray(e,n,i,r){const s=e.length,o=new Float64Array(s*2);for(let l=0;l<s;++l){const f=e[l];o[l*2]=n.call(r,f,l,e),o[l*2+1]=i.call(r,f,l,e)}return o}function*flatIterable(e,n,i,r){let s=0;for(const o of e)yield n.call(r,o,s,e),yield i.call(r,o,s,e),++s}function Voronoi(e){Transform.call(this,null,e)}Voronoi.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const defaultExtent=[-1e5,-1e5,1e5,1e5];inherits(Voronoi,Transform,{transform(e,n){const i=e.as||"path",r=n.source;if(!r||!r.length)return n;let s=e.size;s=s?[0,0,s[0],s[1]]:(s=e.extent)?[s[0][0],s[0][1],s[1][0],s[1][1]]:defaultExtent;const o=this.value=Delaunay.from(r,e.x,e.y).voronoi(s);for(let l=0,f=r.length;l<f;++l){const d=o.cellPolygon(l);r[l][i]=d?toPathString(d):null}return n.reflow(e.modified()).modifies(i)}});function toPathString(e){const n=e[0][0],i=e[0][1];let r=e.length-1;for(;e[r][0]===n&&e[r][1]===i;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}const voronoi=Object.freeze(Object.defineProperty({__proto__:null,voronoi:Voronoi},Symbol.toStringTag,{value:"Module"}));var cloudRadians=Math.PI/180,cw=1<<11>>5,ch=1<<11;function cloud(){var e=[256,256],n,i,r,s,o,l,f,d=archimedeanSpiral,p=[],g=Math.random,v={};v.layout=function(){for(var k=S(domCanvas()),O=zeroArray((e[0]>>5)*e[1]),R=null,P=p.length,F=-1,I=[],L=p.map(j=>({text:n(j),font:i(j),style:s(j),weight:o(j),rotate:l(j),size:~~(r(j)+1e-14),padding:f(j),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:j})).sort((j,z)=>z.size-j.size);++F<P;){var N=L[F];N.x=e[0]*(g()+.5)>>1,N.y=e[1]*(g()+.5)>>1,cloudSprite(k,N,L,F),N.hasText&&T(O,N,R)&&(I.push(N),R?cloudBounds(R,N):R=[{x:N.x+N.x0,y:N.y+N.y0},{x:N.x+N.x1,y:N.y+N.y1}],N.x-=e[0]>>1,N.y-=e[1]>>1)}return I};function S(k){k.width=k.height=1;var O=Math.sqrt(k.getContext("2d").getImageData(0,0,1,1).data.length>>2);k.width=(cw<<5)/O,k.height=ch/O;var R=k.getContext("2d");return R.fillStyle=R.strokeStyle="red",R.textAlign="center",{context:R,ratio:O}}function T(k,O,R){for(var P=O.x,F=O.y,I=Math.sqrt(e[0]*e[0]+e[1]*e[1]),L=d(e),N=g()<.5?1:-1,j=-N,z,q,H;(z=L(j+=N))&&(q=~~z[0],H=~~z[1],!(Math.min(Math.abs(q),Math.abs(H))>=I));)if(O.x=P+q,O.y=F+H,!(O.x+O.x0<0||O.y+O.y0<0||O.x+O.x1>e[0]||O.y+O.y1>e[1])&&(!R||!cloudCollide(O,k,e[0]))&&(!R||collideRects(O,R))){for(var W=O.sprite,U=O.width>>5,Q=e[0]>>5,J=O.x-(U<<4),ne=J&127,G=32-ne,Z=O.y1-O.y0,ae=(O.y+O.y0)*Q+(J>>5),oe,pe=0;pe<Z;pe++){oe=0;for(var Se=0;Se<=U;Se++)k[ae+Se]|=oe<<G|(Se<U?(oe=W[pe*U+Se])>>>ne:0);ae+=Q}return O.sprite=null,!0}return!1}return v.words=function(k){return arguments.length?(p=k,v):p},v.size=function(k){return arguments.length?(e=[+k[0],+k[1]],v):e},v.font=function(k){return arguments.length?(i=functor(k),v):i},v.fontStyle=function(k){return arguments.length?(s=functor(k),v):s},v.fontWeight=function(k){return arguments.length?(o=functor(k),v):o},v.rotate=function(k){return arguments.length?(l=functor(k),v):l},v.text=function(k){return arguments.length?(n=functor(k),v):n},v.spiral=function(k){return arguments.length?(d=spirals[k]||k,v):d},v.fontSize=function(k){return arguments.length?(r=functor(k),v):r},v.padding=function(k){return arguments.length?(f=functor(k),v):f},v.random=function(k){return arguments.length?(g=k,v):g},v}function cloudSprite(e,n,i,r){if(!n.sprite){var s=e.context,o=e.ratio;s.clearRect(0,0,(cw<<5)/o,ch/o);var l=0,f=0,d=0,p=i.length,g,v,S,T,k;for(--r;++r<p;){if(n=i[r],s.save(),s.font=n.style+" "+n.weight+" "+~~((n.size+1)/o)+"px "+n.font,g=s.measureText(n.text+"m").width*o,S=n.size<<1,n.rotate){var O=Math.sin(n.rotate*cloudRadians),R=Math.cos(n.rotate*cloudRadians),P=g*R,F=g*O,I=S*R,L=S*O;g=Math.max(Math.abs(P+L),Math.abs(P-L))+31>>5<<5,S=~~Math.max(Math.abs(F+I),Math.abs(F-I))}else g=g+31>>5<<5;if(S>d&&(d=S),l+g>=cw<<5&&(l=0,f+=d,d=0),f+S>=ch)break;s.translate((l+(g>>1))/o,(f+(S>>1))/o),n.rotate&&s.rotate(n.rotate*cloudRadians),s.fillText(n.text,0,0),n.padding&&(s.lineWidth=2*n.padding,s.strokeText(n.text,0,0)),s.restore(),n.width=g,n.height=S,n.xoff=l,n.yoff=f,n.x1=g>>1,n.y1=S>>1,n.x0=-n.x1,n.y0=-n.y1,n.hasText=!0,l+=g}for(var N=s.getImageData(0,0,(cw<<5)/o,ch/o).data,j=[];--r>=0;)if(n=i[r],!!n.hasText){for(g=n.width,v=g>>5,S=n.y1-n.y0,T=0;T<S*v;T++)j[T]=0;if(l=n.xoff,l==null)return;f=n.yoff;var z=0,q=-1;for(k=0;k<S;k++){for(T=0;T<g;T++){var H=v*k+(T>>5),W=N[(f+k)*(cw<<5)+(l+T)<<2]?1<<31-T%32:0;j[H]|=W,z|=W}z?q=k:(n.y0++,S--,k--,f++)}n.y1=n.y0+q,n.sprite=j.slice(0,(n.y1-n.y0)*v)}}}function cloudCollide(e,n,i){i>>=5;for(var r=e.sprite,s=e.width>>5,o=e.x-(s<<4),l=o&127,f=32-l,d=e.y1-e.y0,p=(e.y+e.y0)*i+(o>>5),g,v=0;v<d;v++){g=0;for(var S=0;S<=s;S++)if((g<<f|(S<s?(g=r[v*s+S])>>>l:0))&n[p+S])return!0;p+=i}return!1}function cloudBounds(e,n){var i=e[0],r=e[1];n.x+n.x0<i.x&&(i.x=n.x+n.x0),n.y+n.y0<i.y&&(i.y=n.y+n.y0),n.x+n.x1>r.x&&(r.x=n.x+n.x1),n.y+n.y1>r.y&&(r.y=n.y+n.y1)}function collideRects(e,n){return e.x+e.x1>n[0].x&&e.x+e.x0<n[1].x&&e.y+e.y1>n[0].y&&e.y+e.y0<n[1].y}function archimedeanSpiral(e){var n=e[0]/e[1];return function(i){return[n*(i*=.1)*Math.cos(i),i*Math.sin(i)]}}function rectangularSpiral(e){var n=4,i=n*e[0]/e[1],r=0,s=0;return function(o){var l=o<0?-1:1;switch(Math.sqrt(1+4*l*o)-l&3){case 0:r+=i;break;case 1:s+=n;break;case 2:r-=i;break;default:s-=n;break}return[r,s]}}function zeroArray(e){for(var n=[],i=-1;++i<e;)n[i]=0;return n}function functor(e){return typeof e=="function"?e:function(){return e}}var spirals={archimedean:archimedeanSpiral,rectangular:rectangularSpiral};const Output=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Params$1=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Wordcloud(e){Transform.call(this,cloud(),e)}Wordcloud.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Output}]};inherits(Wordcloud,Transform,{transform(e,n){e.size&&!(e.size[0]&&e.size[1])&&error("Wordcloud size dimensions must be non-zero.");function i(k){const O=e[k];return isFunction(O)&&n.modified(O.fields)}const r=e.modified();if(!(r||n.changed(n.ADD_REM)||Params$1.some(i)))return;const s=n.materialize(n.SOURCE).source,o=this.value,l=e.as||Output;let f=e.fontSize||14,d;if(isFunction(f)?d=e.fontSizeRange:f=constant$4(f),d){const k=f,O=scale$4("sqrt")().domain(extent(s,k)).range(d);f=R=>O(k(R))}s.forEach(k=>{k[l[0]]=NaN,k[l[1]]=NaN,k[l[3]]=0});const p=o.words(s).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(f).random(random).layout(),g=o.size(),v=g[0]>>1,S=g[1]>>1,T=p.length;for(let k=0,O,R;k<T;++k)O=p[k],R=O.datum,R[l[0]]=O.x+v,R[l[1]]=O.y+S,R[l[2]]=O.font,R[l[3]]=O.size,R[l[4]]=O.style,R[l[5]]=O.weight,R[l[6]]=O.rotate;return n.reflow(r).modifies(l)}});const wordcloud=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:Wordcloud},Symbol.toStringTag,{value:"Module"})),array8=e=>new Uint8Array(e),array16=e=>new Uint16Array(e),array32=e=>new Uint32Array(e);function Bitmaps(){let e=8,n=[],i=array32(0),r=array$1(0,e),s=array$1(0,e);return{data:()=>n,seen:()=>i=lengthen(i,n.length),add(o){for(let l=0,f=n.length,d=o.length,p;l<d;++l)p=o[l],p._index=f++,n.push(p)},remove(o,l){const f=n.length,d=Array(f-o),p=n;let g,v,S;for(v=0;!l[v]&&v<f;++v)d[v]=n[v],p[v]=v;for(S=v;v<f;++v)g=n[v],l[v]?p[v]=-1:(p[v]=S,r[S]=r[v],s[S]=s[v],d[S]=g,g._index=S++),r[v]=0;return n=d,p},size:()=>n.length,curr:()=>r,prev:()=>s,reset:o=>s[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,l){r[o]|=l},clear(o,l){r[o]&=~l},resize(o,l){const f=r.length;(o>f||l>e)&&(e=Math.max(l,e),r=array$1(o,e,r),s=array$1(o,e))}}}function lengthen(e,n,i){return e.length>=n?e:(i=i||new e.constructor(n),i.set(e),i)}function array$1(e,n,i){const r=(n<257?array8:n<65537?array16:array32)(e);return i&&r.set(i),r}function Dimension(e,n,i){const r=1<<n;return{one:r,zero:~r,range:i.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(s,o){const l=this,f=l.bisect(l.range,s.value),d=s.index,p=f[0],g=f[1],v=d.length;let S;for(S=0;S<p;++S)o[d[S]]|=r;for(S=g;S<v;++S)o[d[S]]|=r;return l}}}function SortedIndex(){let e=array32(0),n=[],i=0;function r(f,d,p){if(!d.length)return[];const g=i,v=d.length,S=array32(v);let T=Array(v),k,O,R;for(R=0;R<v;++R)T[R]=f(d[R]),S[R]=R;if(T=sort(T,S),g)k=n,O=e,n=Array(g+v),e=array32(g+v),merge$1(p,k,O,g,T,S,v,n,e);else{if(p>0)for(R=0;R<v;++R)S[R]+=p;n=T,e=S}return i=g+v,{index:S,value:T}}function s(f,d){const p=i;let g,v,S;for(v=0;!d[e[v]]&&v<p;++v);for(S=v;v<p;++v)d[g=e[v]]||(e[S]=g,n[S]=n[v],++S);i=p-f}function o(f){for(let d=0,p=i;d<p;++d)e[d]=f[e[d]]}function l(f,d){let p;return d?p=d.length:(d=n,p=i),[bisectLeft$1(d,f[0],0,p),bisectRight$1(d,f[1],0,p)]}return{insert:r,remove:s,bisect:l,reindex:o,index:()=>e,size:()=>i}}function sort(e,n){return e.sort.call(n,(i,r)=>{const s=e[i],o=e[r];return s<o?-1:s>o?1:0}),permute(e,n)}function merge$1(e,n,i,r,s,o,l,f,d){let p=0,g=0,v;for(v=0;p<r&&g<l;++v)n[p]<s[g]?(f[v]=n[p],d[v]=i[p++]):(f[v]=s[g],d[v]=o[g++]+e);for(;p<r;++p,++v)f[v]=n[p],d[v]=i[p];for(;g<l;++g,++v)f[v]=s[g],d[v]=o[g]+e}function CrossFilter(e){Transform.call(this,Bitmaps(),e),this._indices=null,this._dims=null}CrossFilter.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};inherits(CrossFilter,Transform,{transform(e,n){if(this._dims){var i=e.modified("fields")||e.fields.some(r=>n.modified(r.fields));return i?this.reinit(e,n):this.eval(e,n)}else return this.init(e,n)},init(e,n){const i=e.fields,r=e.query,s=this._indices={},o=this._dims=[],l=r.length;let f=0,d,p;for(;f<l;++f)d=i[f].fname,p=s[d]||(s[d]=SortedIndex()),o.push(Dimension(p,f,r[f]));return this.eval(e,n)},reinit(e,n){const i=n.materialize().fork(),r=e.fields,s=e.query,o=this._indices,l=this._dims,f=this.value,d=f.curr(),p=f.prev(),g=f.all(),v=i.rem=i.add,S=i.mod,T=s.length,k={};let O,R,P,F,I,L,N,j,z;if(p.set(d),n.rem.length&&(I=this.remove(e,n,i)),n.add.length&&f.add(n.add),n.mod.length)for(L={},F=n.mod,N=0,j=F.length;N<j;++N)L[F[N]._index]=1;for(N=0;N<T;++N)z=r[N],(!l[N]||e.modified("fields",N)||n.modified(z.fields))&&(P=z.fname,(O=k[P])||(o[P]=R=SortedIndex(),k[P]=O=R.insert(z,n.source,0)),l[N]=Dimension(R,N,s[N]).onAdd(O,d));for(N=0,j=f.data().length;N<j;++N)I[N]||(p[N]!==d[N]?v.push(N):L[N]&&d[N]!==g&&S.push(N));return f.mask=(1<<T)-1,i},eval(e,n){const i=n.materialize().fork(),r=this._dims.length;let s=0;return n.rem.length&&(this.remove(e,n,i),s|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(s|=this.update(e,n,i)),n.add.length&&(this.insert(e,n,i),s|=(1<<r)-1),n.mod.length&&(this.modify(n,i),s|=(1<<r)-1),this.value.mask=s,i},insert(e,n,i){const r=n.add,s=this.value,o=this._dims,l=this._indices,f=e.fields,d={},p=i.add,g=s.size()+r.length,v=o.length;let S=s.size(),T,k,O;s.resize(g,v),s.add(r);const R=s.curr(),P=s.prev(),F=s.all();for(T=0;T<v;++T)k=f[T].fname,O=d[k]||(d[k]=l[k].insert(f[T],r,S)),o[T].onAdd(O,R);for(;S<g;++S)P[S]=F,R[S]!==F&&p.push(S)},modify(e,n){const i=n.mod,r=this.value,s=r.curr(),o=r.all(),l=e.mod;let f,d,p;for(f=0,d=l.length;f<d;++f)p=l[f]._index,s[p]!==o&&i.push(p)},remove(e,n,i){const r=this._indices,s=this.value,o=s.curr(),l=s.prev(),f=s.all(),d={},p=i.rem,g=n.rem;let v,S,T,k;for(v=0,S=g.length;v<S;++v)T=g[v]._index,d[T]=1,l[T]=k=o[T],o[T]=f,k!==f&&p.push(T);for(T in r)r[T].remove(S,d);return this.reindex(n,S,d),d},reindex(e,n,i){const r=this._indices,s=this.value;e.runAfter(()=>{const o=s.remove(n,i);for(const l in r)r[l].reindex(o)})},update(e,n,i){const r=this._dims,s=e.query,o=n.stamp,l=r.length;let f=0,d,p;for(i.filters=0,p=0;p<l;++p)e.modified("query",p)&&(d=p,++f);if(f===1)f=r[d].one,this.incrementOne(r[d],s[d],i.add,i.rem);else for(p=0,f=0;p<l;++p)e.modified("query",p)&&(f|=r[p].one,this.incrementAll(r[p],s[p],o,i.add),i.rem=i.add);return f},incrementAll(e,n,i,r){const s=this.value,o=s.seen(),l=s.curr(),f=s.prev(),d=e.index(),p=e.bisect(e.range),g=e.bisect(n),v=g[0],S=g[1],T=p[0],k=p[1],O=e.one;let R,P,F;if(v<T)for(R=v,P=Math.min(T,S);R<P;++R)F=d[R],o[F]!==i&&(f[F]=l[F],o[F]=i,r.push(F)),l[F]^=O;else if(v>T)for(R=T,P=Math.min(v,k);R<P;++R)F=d[R],o[F]!==i&&(f[F]=l[F],o[F]=i,r.push(F)),l[F]^=O;if(S>k)for(R=Math.max(v,k),P=S;R<P;++R)F=d[R],o[F]!==i&&(f[F]=l[F],o[F]=i,r.push(F)),l[F]^=O;else if(S<k)for(R=Math.max(T,S),P=k;R<P;++R)F=d[R],o[F]!==i&&(f[F]=l[F],o[F]=i,r.push(F)),l[F]^=O;e.range=n.slice()},incrementOne(e,n,i,r){const s=this.value,o=s.curr(),l=e.index(),f=e.bisect(e.range),d=e.bisect(n),p=d[0],g=d[1],v=f[0],S=f[1],T=e.one;let k,O,R;if(p<v)for(k=p,O=Math.min(v,g);k<O;++k)R=l[k],o[R]^=T,i.push(R);else if(p>v)for(k=v,O=Math.min(p,S);k<O;++k)R=l[k],o[R]^=T,r.push(R);if(g>S)for(k=Math.max(p,S),O=g;k<O;++k)R=l[k],o[R]^=T,i.push(R);else if(g<S)for(k=Math.max(v,g),O=S;k<O;++k)R=l[k],o[R]^=T,r.push(R);e.range=n.slice()}});function ResolveFilter(e){Transform.call(this,null,e)}ResolveFilter.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};inherits(ResolveFilter,Transform,{transform(e,n){const i=~(e.ignore||0),r=e.filter,s=r.mask;if(!(s&i))return n.StopPropagation;const o=n.fork(n.ALL),l=r.data(),f=r.curr(),d=r.prev(),p=g=>f[g]&i?null:l[g];return o.filter(o.MOD,p),s&s-1?(o.filter(o.ADD,g=>{const v=f[g]&i;return!v&&v^d[g]&i?l[g]:null}),o.filter(o.REM,g=>{const v=f[g]&i;return v&&!(v^(v^d[g]&i))?l[g]:null})):(o.filter(o.ADD,p),o.filter(o.REM,g=>(f[g]&i)===s?l[g]:null)),o.filter(o.SOURCE,g=>p(g._index))}});const xf=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:CrossFilter,resolvefilter:ResolveFilter},Symbol.toStringTag,{value:"Module"})),RawCode="RawCode",Literal="Literal",Property="Property",Identifier="Identifier",ArrayExpression="ArrayExpression",BinaryExpression="BinaryExpression",CallExpression="CallExpression",ConditionalExpression="ConditionalExpression",LogicalExpression="LogicalExpression",MemberExpression="MemberExpression",ObjectExpression="ObjectExpression",UnaryExpression="UnaryExpression";function ASTNode(e){this.type=e}ASTNode.prototype.visit=function(e){let n,i,r;if(e(this))return 1;for(n=children(this),i=0,r=n.length;i<r;++i)if(n[i].visit(e))return 1};function children(e){switch(e.type){case ArrayExpression:return e.elements;case BinaryExpression:case LogicalExpression:return[e.left,e.right];case CallExpression:return[e.callee].concat(e.arguments);case ConditionalExpression:return[e.test,e.consequent,e.alternate];case MemberExpression:return[e.object,e.property];case ObjectExpression:return e.properties;case Property:return[e.key,e.value];case UnaryExpression:return[e.argument];case Identifier:case Literal:case RawCode:default:return[]}}var TokenName,source,index,length,lookahead,TokenBooleanLiteral=1,TokenEOF=2,TokenIdentifier=3,TokenKeyword=4,TokenNullLiteral=5,TokenNumericLiteral=6,TokenPunctuator=7,TokenStringLiteral=8,TokenRegularExpression=9;TokenName={};TokenName[TokenBooleanLiteral]="Boolean";TokenName[TokenEOF]="<end>";TokenName[TokenIdentifier]="Identifier";TokenName[TokenKeyword]="Keyword";TokenName[TokenNullLiteral]="Null";TokenName[TokenNumericLiteral]="Numeric";TokenName[TokenPunctuator]="Punctuator";TokenName[TokenStringLiteral]="String";TokenName[TokenRegularExpression]="RegularExpression";var SyntaxArrayExpression="ArrayExpression",SyntaxBinaryExpression="BinaryExpression",SyntaxCallExpression="CallExpression",SyntaxConditionalExpression="ConditionalExpression",SyntaxIdentifier="Identifier",SyntaxLiteral="Literal",SyntaxLogicalExpression="LogicalExpression",SyntaxMemberExpression="MemberExpression",SyntaxObjectExpression="ObjectExpression",SyntaxProperty="Property",SyntaxUnaryExpression="UnaryExpression",MessageUnexpectedToken="Unexpected token %0",MessageUnexpectedNumber="Unexpected number",MessageUnexpectedString="Unexpected string",MessageUnexpectedIdentifier="Unexpected identifier",MessageUnexpectedReserved="Unexpected reserved word",MessageUnexpectedEOS="Unexpected end of input",MessageInvalidRegExp="Invalid regular expression",MessageUnterminatedRegExp="Invalid regular expression: missing /",MessageStrictOctalLiteral="Octal literals are not allowed in strict mode.",MessageStrictDuplicateProperty="Duplicate data property in object literal not allowed in strict mode",ILLEGAL$1="ILLEGAL",DISABLED="Disabled.",RegexNonAsciiIdentifierStart=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),RegexNonAsciiIdentifierPart=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function assert(e,n){if(!e)throw new Error("ASSERT: "+n)}function isDecimalDigit(e){return e>=48&&e<=57}function isHexDigit(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function isOctalDigit(e){return"01234567".indexOf(e)>=0}function isWhiteSpace(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function isLineTerminator(e){return e===10||e===13||e===8232||e===8233}function isIdentifierStart(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&RegexNonAsciiIdentifierStart.test(String.fromCharCode(e))}function isIdentifierPart(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&RegexNonAsciiIdentifierPart.test(String.fromCharCode(e))}const keywords$1={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function skipComment(){for(;index<length;){const e=source.charCodeAt(index);if(isWhiteSpace(e)||isLineTerminator(e))++index;else break}}function scanHexEscape(e){var n,i,r,s=0;for(i=e==="u"?4:2,n=0;n<i;++n)index<length&&isHexDigit(source[index])?(r=source[index++],s=s*16+"0123456789abcdef".indexOf(r.toLowerCase())):throwError({},MessageUnexpectedToken,ILLEGAL$1);return String.fromCharCode(s)}function scanUnicodeCodePointEscape(){var e,n,i,r;for(e=source[index],n=0,e==="}"&&throwError({},MessageUnexpectedToken,ILLEGAL$1);index<length&&(e=source[index++],!!isHexDigit(e));)n=n*16+"0123456789abcdef".indexOf(e.toLowerCase());return(n>1114111||e!=="}")&&throwError({},MessageUnexpectedToken,ILLEGAL$1),n<=65535?String.fromCharCode(n):(i=(n-65536>>10)+55296,r=(n-65536&1023)+56320,String.fromCharCode(i,r))}function getEscapedIdentifier(){var e,n;for(e=source.charCodeAt(index++),n=String.fromCharCode(e),e===92&&(source.charCodeAt(index)!==117&&throwError({},MessageUnexpectedToken,ILLEGAL$1),++index,e=scanHexEscape("u"),(!e||e==="\\"||!isIdentifierStart(e.charCodeAt(0)))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),n=e);index<length&&(e=source.charCodeAt(index),!!isIdentifierPart(e));)++index,n+=String.fromCharCode(e),e===92&&(n=n.substr(0,n.length-1),source.charCodeAt(index)!==117&&throwError({},MessageUnexpectedToken,ILLEGAL$1),++index,e=scanHexEscape("u"),(!e||e==="\\"||!isIdentifierPart(e.charCodeAt(0)))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),n+=e);return n}function getIdentifier(){var e,n;for(e=index++;index<length;){if(n=source.charCodeAt(index),n===92)return index=e,getEscapedIdentifier();if(isIdentifierPart(n))++index;else break}return source.slice(e,index)}function scanIdentifier(){var e,n,i;return e=index,n=source.charCodeAt(index)===92?getEscapedIdentifier():getIdentifier(),n.length===1?i=TokenIdentifier:keywords$1.hasOwnProperty(n)?i=TokenKeyword:n==="null"?i=TokenNullLiteral:n==="true"||n==="false"?i=TokenBooleanLiteral:i=TokenIdentifier,{type:i,value:n,start:e,end:index}}function scanPunctuator(){var e=index,n=source.charCodeAt(index),i,r=source[index],s,o,l;switch(n){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++index,{type:TokenPunctuator,value:String.fromCharCode(n),start:e,end:index};default:if(i=source.charCodeAt(index+1),i===61)switch(n){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return index+=2,{type:TokenPunctuator,value:String.fromCharCode(n)+String.fromCharCode(i),start:e,end:index};case 33:case 61:return index+=2,source.charCodeAt(index)===61&&++index,{type:TokenPunctuator,value:source.slice(e,index),start:e,end:index}}}if(l=source.substr(index,4),l===">>>=")return index+=4,{type:TokenPunctuator,value:l,start:e,end:index};if(o=l.substr(0,3),o===">>>"||o==="<<="||o===">>=")return index+=3,{type:TokenPunctuator,value:o,start:e,end:index};if(s=o.substr(0,2),r===s[1]&&"+-<>&|".indexOf(r)>=0||s==="=>")return index+=2,{type:TokenPunctuator,value:s,start:e,end:index};if(s==="//"&&throwError({},MessageUnexpectedToken,ILLEGAL$1),"<>=!+-*%&|^/".indexOf(r)>=0)return++index,{type:TokenPunctuator,value:r,start:e,end:index};throwError({},MessageUnexpectedToken,ILLEGAL$1)}function scanHexLiteral(e){let n="";for(;index<length&&isHexDigit(source[index]);)n+=source[index++];return n.length===0&&throwError({},MessageUnexpectedToken,ILLEGAL$1),isIdentifierStart(source.charCodeAt(index))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenNumericLiteral,value:parseInt("0x"+n,16),start:e,end:index}}function scanOctalLiteral(e){let n="0"+source[index++];for(;index<length&&isOctalDigit(source[index]);)n+=source[index++];return(isIdentifierStart(source.charCodeAt(index))||isDecimalDigit(source.charCodeAt(index)))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenNumericLiteral,value:parseInt(n,8),octal:!0,start:e,end:index}}function scanNumericLiteral(){var e,n,i;if(i=source[index],assert(isDecimalDigit(i.charCodeAt(0))||i===".","Numeric literal must start with a decimal digit or a decimal point"),n=index,e="",i!=="."){if(e=source[index++],i=source[index],e==="0"){if(i==="x"||i==="X")return++index,scanHexLiteral(n);if(isOctalDigit(i))return scanOctalLiteral(n);i&&isDecimalDigit(i.charCodeAt(0))&&throwError({},MessageUnexpectedToken,ILLEGAL$1)}for(;isDecimalDigit(source.charCodeAt(index));)e+=source[index++];i=source[index]}if(i==="."){for(e+=source[index++];isDecimalDigit(source.charCodeAt(index));)e+=source[index++];i=source[index]}if(i==="e"||i==="E")if(e+=source[index++],i=source[index],(i==="+"||i==="-")&&(e+=source[index++]),isDecimalDigit(source.charCodeAt(index)))for(;isDecimalDigit(source.charCodeAt(index));)e+=source[index++];else throwError({},MessageUnexpectedToken,ILLEGAL$1);return isIdentifierStart(source.charCodeAt(index))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenNumericLiteral,value:parseFloat(e),start:n,end:index}}function scanStringLiteral(){var e="",n,i,r,s,o=!1;for(n=source[index],assert(n==="'"||n==='"',"String literal must starts with a quote"),i=index,++index;index<length;)if(r=source[index++],r===n){n="";break}else if(r==="\\")if(r=source[index++],!r||!isLineTerminator(r.charCodeAt(0)))switch(r){case"u":case"x":source[index]==="{"?(++index,e+=scanUnicodeCodePointEscape()):e+=scanHexEscape(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:isOctalDigit(r)?(s="01234567".indexOf(r),s!==0&&(o=!0),index<length&&isOctalDigit(source[index])&&(o=!0,s=s*8+"01234567".indexOf(source[index++]),"0123".indexOf(r)>=0&&index<length&&isOctalDigit(source[index])&&(s=s*8+"01234567".indexOf(source[index++]))),e+=String.fromCharCode(s)):e+=r;break}else r==="\r"&&source[index]===`
`&&++index;else{if(isLineTerminator(r.charCodeAt(0)))break;e+=r}return n!==""&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenStringLiteral,value:e,octal:o,start:i,end:index}}function testRegExp(e,n){let i=e;n.indexOf("u")>=0&&(i=i.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,s)=>{if(parseInt(s,16)<=1114111)return"x";throwError({},MessageInvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(i)}catch{throwError({},MessageInvalidRegExp)}try{return new RegExp(e,n)}catch{return null}}function scanRegExpBody(){var e,n,i,r,s;for(e=source[index],assert(e==="/","Regular expression literal must start with a slash"),n=source[index++],i=!1,r=!1;index<length;)if(e=source[index++],n+=e,e==="\\")e=source[index++],isLineTerminator(e.charCodeAt(0))&&throwError({},MessageUnterminatedRegExp),n+=e;else if(isLineTerminator(e.charCodeAt(0)))throwError({},MessageUnterminatedRegExp);else if(i)e==="]"&&(i=!1);else if(e==="/"){r=!0;break}else e==="["&&(i=!0);return r||throwError({},MessageUnterminatedRegExp),s=n.substr(1,n.length-2),{value:s,literal:n}}function scanRegExpFlags(){var e,n,i;for(n="",i="";index<length&&(e=source[index],!!isIdentifierPart(e.charCodeAt(0)));)++index,e==="\\"&&index<length?throwError({},MessageUnexpectedToken,ILLEGAL$1):(i+=e,n+=e);return i.search(/[^gimuy]/g)>=0&&throwError({},MessageInvalidRegExp,i),{value:i,literal:n}}function scanRegExp(){var e,n,i,r;return lookahead=null,skipComment(),e=index,n=scanRegExpBody(),i=scanRegExpFlags(),r=testRegExp(n.value,i.value),{literal:n.literal+i.literal,value:r,regex:{pattern:n.value,flags:i.value},start:e,end:index}}function isIdentifierName(e){return e.type===TokenIdentifier||e.type===TokenKeyword||e.type===TokenBooleanLiteral||e.type===TokenNullLiteral}function advance(){if(skipComment(),index>=length)return{type:TokenEOF,start:index,end:index};const e=source.charCodeAt(index);return isIdentifierStart(e)?scanIdentifier():e===40||e===41||e===59?scanPunctuator():e===39||e===34?scanStringLiteral():e===46?isDecimalDigit(source.charCodeAt(index+1))?scanNumericLiteral():scanPunctuator():isDecimalDigit(e)?scanNumericLiteral():scanPunctuator()}function lex(){const e=lookahead;return index=e.end,lookahead=advance(),index=e.end,e}function peek(){const e=index;lookahead=advance(),index=e}function finishArrayExpression(e){const n=new ASTNode(SyntaxArrayExpression);return n.elements=e,n}function finishBinaryExpression(e,n,i){const r=new ASTNode(e==="||"||e==="&&"?SyntaxLogicalExpression:SyntaxBinaryExpression);return r.operator=e,r.left=n,r.right=i,r}function finishCallExpression(e,n){const i=new ASTNode(SyntaxCallExpression);return i.callee=e,i.arguments=n,i}function finishConditionalExpression(e,n,i){const r=new ASTNode(SyntaxConditionalExpression);return r.test=e,r.consequent=n,r.alternate=i,r}function finishIdentifier(e){const n=new ASTNode(SyntaxIdentifier);return n.name=e,n}function finishLiteral(e){const n=new ASTNode(SyntaxLiteral);return n.value=e.value,n.raw=source.slice(e.start,e.end),e.regex&&(n.raw==="//"&&(n.raw="/(?:)/"),n.regex=e.regex),n}function finishMemberExpression(e,n,i){const r=new ASTNode(SyntaxMemberExpression);return r.computed=e==="[",r.object=n,r.property=i,r.computed||(i.member=!0),r}function finishObjectExpression(e){const n=new ASTNode(SyntaxObjectExpression);return n.properties=e,n}function finishProperty(e,n,i){const r=new ASTNode(SyntaxProperty);return r.key=n,r.value=i,r.kind=e,r}function finishUnaryExpression(e,n){const i=new ASTNode(SyntaxUnaryExpression);return i.operator=e,i.argument=n,i.prefix=!0,i}function throwError(e,n){var i,r=Array.prototype.slice.call(arguments,2),s=n.replace(/%(\d)/g,(o,l)=>(assert(l<r.length,"Message reference must be in range"),r[l]));throw i=new Error(s),i.index=index,i.description=s,i}function throwUnexpected(e){e.type===TokenEOF&&throwError(e,MessageUnexpectedEOS),e.type===TokenNumericLiteral&&throwError(e,MessageUnexpectedNumber),e.type===TokenStringLiteral&&throwError(e,MessageUnexpectedString),e.type===TokenIdentifier&&throwError(e,MessageUnexpectedIdentifier),e.type===TokenKeyword&&throwError(e,MessageUnexpectedReserved),throwError(e,MessageUnexpectedToken,e.value)}function expect(e){const n=lex();(n.type!==TokenPunctuator||n.value!==e)&&throwUnexpected(n)}function match(e){return lookahead.type===TokenPunctuator&&lookahead.value===e}function matchKeyword(e){return lookahead.type===TokenKeyword&&lookahead.value===e}function parseArrayInitialiser(){const e=[];for(index=lookahead.start,expect("[");!match("]");)match(",")?(lex(),e.push(null)):(e.push(parseConditionalExpression()),match("]")||expect(","));return lex(),finishArrayExpression(e)}function parseObjectPropertyKey(){index=lookahead.start;const e=lex();return e.type===TokenStringLiteral||e.type===TokenNumericLiteral?(e.octal&&throwError(e,MessageStrictOctalLiteral),finishLiteral(e)):finishIdentifier(e.value)}function parseObjectProperty(){var e,n,i,r;if(index=lookahead.start,e=lookahead,e.type===TokenIdentifier)return i=parseObjectPropertyKey(),expect(":"),r=parseConditionalExpression(),finishProperty("init",i,r);if(e.type===TokenEOF||e.type===TokenPunctuator)throwUnexpected(e);else return n=parseObjectPropertyKey(),expect(":"),r=parseConditionalExpression(),finishProperty("init",n,r)}function parseObjectInitialiser(){var e=[],n,i,r,s={},o=String;for(index=lookahead.start,expect("{");!match("}");)n=parseObjectProperty(),n.key.type===SyntaxIdentifier?i=n.key.name:i=o(n.key.value),r="$"+i,Object.prototype.hasOwnProperty.call(s,r)?throwError({},MessageStrictDuplicateProperty):s[r]=!0,e.push(n),match("}")||expect(",");return expect("}"),finishObjectExpression(e)}function parseGroupExpression(){expect("(");const e=parseExpression$1();return expect(")"),e}const legalKeywords={if:1};function parsePrimaryExpression(){var e,n,i;if(match("("))return parseGroupExpression();if(match("["))return parseArrayInitialiser();if(match("{"))return parseObjectInitialiser();if(e=lookahead.type,index=lookahead.start,e===TokenIdentifier||legalKeywords[lookahead.value])i=finishIdentifier(lex().value);else if(e===TokenStringLiteral||e===TokenNumericLiteral)lookahead.octal&&throwError(lookahead,MessageStrictOctalLiteral),i=finishLiteral(lex());else{if(e===TokenKeyword)throw new Error(DISABLED);e===TokenBooleanLiteral?(n=lex(),n.value=n.value==="true",i=finishLiteral(n)):e===TokenNullLiteral?(n=lex(),n.value=null,i=finishLiteral(n)):match("/")||match("/=")?(i=finishLiteral(scanRegExp()),peek()):throwUnexpected(lex())}return i}function parseArguments(){const e=[];if(expect("("),!match(")"))for(;index<length&&(e.push(parseConditionalExpression()),!match(")"));)expect(",");return expect(")"),e}function parseNonComputedProperty(){index=lookahead.start;const e=lex();return isIdentifierName(e)||throwUnexpected(e),finishIdentifier(e.value)}function parseNonComputedMember(){return expect("."),parseNonComputedProperty()}function parseComputedMember(){expect("[");const e=parseExpression$1();return expect("]"),e}function parseLeftHandSideExpressionAllowCall(){var e,n,i;for(e=parsePrimaryExpression();;)if(match("."))i=parseNonComputedMember(),e=finishMemberExpression(".",e,i);else if(match("("))n=parseArguments(),e=finishCallExpression(e,n);else if(match("["))i=parseComputedMember(),e=finishMemberExpression("[",e,i);else break;return e}function parsePostfixExpression(){const e=parseLeftHandSideExpressionAllowCall();if(lookahead.type===TokenPunctuator&&(match("++")||match("--")))throw new Error(DISABLED);return e}function parseUnaryExpression(){var e,n;if(lookahead.type!==TokenPunctuator&&lookahead.type!==TokenKeyword)n=parsePostfixExpression();else{if(match("++")||match("--"))throw new Error(DISABLED);if(match("+")||match("-")||match("~")||match("!"))e=lex(),n=parseUnaryExpression(),n=finishUnaryExpression(e.value,n);else{if(matchKeyword("delete")||matchKeyword("void")||matchKeyword("typeof"))throw new Error(DISABLED);n=parsePostfixExpression()}}return n}function binaryPrecedence(e){let n=0;if(e.type!==TokenPunctuator&&e.type!==TokenKeyword)return 0;switch(e.value){case"||":n=1;break;case"&&":n=2;break;case"|":n=3;break;case"^":n=4;break;case"&":n=5;break;case"==":case"!=":case"===":case"!==":n=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":n=7;break;case"<<":case">>":case">>>":n=8;break;case"+":case"-":n=9;break;case"*":case"/":case"%":n=11;break}return n}function parseBinaryExpression(){var e,n,i,r,s,o,l,f,d,p;if(e=lookahead,d=parseUnaryExpression(),r=lookahead,s=binaryPrecedence(r),s===0)return d;for(r.prec=s,lex(),n=[e,lookahead],l=parseUnaryExpression(),o=[d,r,l];(s=binaryPrecedence(lookahead))>0;){for(;o.length>2&&s<=o[o.length-2].prec;)l=o.pop(),f=o.pop().value,d=o.pop(),n.pop(),i=finishBinaryExpression(f,d,l),o.push(i);r=lex(),r.prec=s,o.push(r),n.push(lookahead),i=parseUnaryExpression(),o.push(i)}for(p=o.length-1,i=o[p],n.pop();p>1;)n.pop(),i=finishBinaryExpression(o[p-1].value,o[p-2],i),p-=2;return i}function parseConditionalExpression(){var e,n,i;return e=parseBinaryExpression(),match("?")&&(lex(),n=parseConditionalExpression(),expect(":"),i=parseConditionalExpression(),e=finishConditionalExpression(e,n,i)),e}function parseExpression$1(){const e=parseConditionalExpression();if(match(","))throw new Error(DISABLED);return e}function parser$1(e){source=e,index=0,length=source.length,lookahead=null,peek();const n=parseExpression$1();if(lookahead.type!==TokenEOF)throw new Error("Unexpect token after expression.");return n}var Constants={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Functions(e){function n(l,f,d,p){let g=e(f[0]);return d&&(g=d+"("+g+")",d.lastIndexOf("new ",0)===0&&(g="("+g+")")),g+"."+l+(p<0?"":p===0?"()":"("+f.slice(1).map(e).join(",")+")")}function i(l,f,d){return p=>n(l,p,f,d)}const r="new Date",s="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(l){l.length<3&&error("Missing arguments to clamp function."),l.length>3&&error("Too many arguments to clamp function.");const f=l.map(e);return"Math.max("+f[1]+", Math.min("+f[2]+","+f[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:i("getDate",r,0),day:i("getDay",r,0),year:i("getFullYear",r,0),month:i("getMonth",r,0),hours:i("getHours",r,0),minutes:i("getMinutes",r,0),seconds:i("getSeconds",r,0),milliseconds:i("getMilliseconds",r,0),time:i("getTime",r,0),timezoneoffset:i("getTimezoneOffset",r,0),utcdate:i("getUTCDate",r,0),utcday:i("getUTCDay",r,0),utcyear:i("getUTCFullYear",r,0),utcmonth:i("getUTCMonth",r,0),utchours:i("getUTCHours",r,0),utcminutes:i("getUTCMinutes",r,0),utcseconds:i("getUTCSeconds",r,0),utcmilliseconds:i("getUTCMilliseconds",r,0),length:i("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:i("toUpperCase",s,0),lower:i("toLowerCase",s,0),substring:i("substring",s),split:i("split",s),trim:i("trim",s,0),regexp:o,test:i("test",o),if:function(l){l.length<3&&error("Missing arguments to if function."),l.length>3&&error("Too many arguments to if function.");const f=l.map(e);return"("+f[0]+"?"+f[1]+":"+f[2]+")"}}}function stripQuotes(e){const n=e&&e.length-1;return n&&(e[0]==='"'&&e[n]==='"'||e[0]==="'"&&e[n]==="'")?e.slice(1,-1):e}function codegen(e){e=e||{};const n=e.allowed?toSet(e.allowed):{},i=e.forbidden?toSet(e.forbidden):{},r=e.constants||Constants,s=(e.functions||Functions)(v),o=e.globalvar,l=e.fieldvar,f=isFunction(o)?o:k=>`${o}["${k}"]`;let d={},p={},g=0;function v(k){if(isString(k))return k;const O=S[k.type];return O==null&&error("Unsupported type: "+k.type),O(k)}const S={Literal:k=>k.raw,Identifier:k=>{const O=k.name;return g>0?O:has$1(i,O)?error("Illegal identifier: "+O):has$1(r,O)?r[O]:has$1(n,O)?O:(d[O]=1,f(O))},MemberExpression:k=>{const O=!k.computed,R=v(k.object);O&&(g+=1);const P=v(k.property);return R===l&&(p[stripQuotes(P)]=1),O&&(g-=1),R+(O?"."+P:"["+P+"]")},CallExpression:k=>{k.callee.type!=="Identifier"&&error("Illegal callee type: "+k.callee.type);const O=k.callee.name,R=k.arguments,P=has$1(s,O)&&s[O];return P||error("Unrecognized function: "+O),isFunction(P)?P(R):P+"("+R.map(v).join(",")+")"},ArrayExpression:k=>"["+k.elements.map(v).join(",")+"]",BinaryExpression:k=>"("+v(k.left)+" "+k.operator+" "+v(k.right)+")",UnaryExpression:k=>"("+k.operator+v(k.argument)+")",ConditionalExpression:k=>"("+v(k.test)+"?"+v(k.consequent)+":"+v(k.alternate)+")",LogicalExpression:k=>"("+v(k.left)+k.operator+v(k.right)+")",ObjectExpression:k=>"{"+k.properties.map(v).join(",")+"}",Property:k=>{g+=1;const O=v(k.key);return g-=1,O+":"+v(k.value)}};function T(k){const O={code:v(k),globals:Object.keys(d),fields:Object.keys(p)};return d={},p={},O}return T.functions=s,T.constants=r,T}function ascending(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function bisector(e){let n=e,i=e,r=e;e.length!==2&&(n=(f,d)=>e(f)-d,i=ascending,r=(f,d)=>ascending(e(f),d));function s(f,d,p=0,g=f.length){if(p<g){if(i(d,d)!==0)return g;do{const v=p+g>>>1;r(f[v],d)<0?p=v+1:g=v}while(p<g)}return p}function o(f,d,p=0,g=f.length){if(p<g){if(i(d,d)!==0)return g;do{const v=p+g>>>1;r(f[v],d)<=0?p=v+1:g=v}while(p<g)}return p}function l(f,d,p=0,g=f.length){const v=s(f,d,p,g-1);return v>p&&n(f[v-1],d)>-n(f[v],d)?v-1:v}return{left:s,center:l,right:o}}function intersection(e,...n){e=new InternSet(e),n=n.map(set$1);e:for(const i of e)for(const r of n)if(!r.has(i)){e.delete(i);continue e}return e}function set$1(e){return e instanceof InternSet?e:new InternSet(e)}function union(...e){const n=new InternSet;for(const i of e)for(const r of i)n.add(r);return n}const Intersect="intersect",Union="union",VlMulti="vlMulti",VlPoint="vlPoint",Or="or",And="and",SelectionId="_vgsid_",$selectionId=field$1(SelectionId),TYPE_ENUM="E",TYPE_RANGE_INC="R",TYPE_RANGE_EXC="R-E",TYPE_RANGE_LE="R-LE",TYPE_RANGE_RE="R-RE",UNIT_INDEX="index:unit";function testPoint(e,n){for(var i=n.fields,r=n.values,s=i.length,o=0,l,f;o<s;++o)if(f=i[o],f.getter=field$1.getter||field$1(f.field),l=f.getter(e),isDate$1(l)&&(l=toNumber(l)),isDate$1(r[o])&&(r[o]=toNumber(r[o])),isDate$1(r[o][0])&&(r[o]=r[o].map(toNumber)),f.type===TYPE_ENUM){if(isArray(r[o])?r[o].indexOf(l)<0:l!==r[o])return!1}else if(f.type===TYPE_RANGE_INC){if(!inrange(l,r[o]))return!1}else if(f.type===TYPE_RANGE_RE){if(!inrange(l,r[o],!0,!1))return!1}else if(f.type===TYPE_RANGE_EXC){if(!inrange(l,r[o],!1,!1))return!1}else if(f.type===TYPE_RANGE_LE&&!inrange(l,r[o],!1,!0))return!1;return!0}function selectionTest(e,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o=r?r[UNIT_INDEX]&&r[UNIT_INDEX].value:void 0,l=i===Intersect,f=s.length,d=0,p,g,v,S,T;d<f;++d)if(p=s[d],o&&l){if(g=g||{},v=g[S=p.unit]||0,v===-1)continue;if(T=testPoint(n,p),g[S]=T?-1:++v,T&&o.size===1)return!0;if(!T&&v===o.get(S).count)return!1}else if(T=testPoint(n,p),l^T)return T;return f&&l}const bisect=bisector($selectionId),bisectLeft=bisect.left,bisectRight=bisect.right;function selectionIdTest(e,n,i){const r=this.context.data[e],s=r?r.values.value:[],o=r?r[UNIT_INDEX]&&r[UNIT_INDEX].value:void 0,l=i===Intersect,f=$selectionId(n),d=bisectLeft(s,f);if(d===s.length||$selectionId(s[d])!==f)return!1;if(o&&l){if(o.size===1)return!0;if(bisectRight(s,f)-d<o.size)return!1}return!0}function selectionTuples(e,n){return e.map(i=>extend$1(n.fields?{values:n.fields.map(r=>(r.getter||(r.getter=field$1(r.field)))(i.datum))}:{[SelectionId]:$selectionId(i.datum)},n))}function selectionResolve(e,n,i,r){for(var s=this.context.data[e],o=s?s.values.value:[],l={},f={},d={},p,g,v,S,T,k,O,R,P,F,I=o.length,L=0,N,j;L<I;++L)if(p=o[L],S=p.unit,g=p.fields,v=p.values,g&&v){for(N=0,j=g.length;N<j;++N)T=g[N],O=l[T.field]||(l[T.field]={}),R=O[S]||(O[S]=[]),d[T.field]=P=T.type.charAt(0),F=ops["".concat(P,"_union")],O[S]=F(R,array$5(v[N]));i&&(R=f[S]||(f[S]=[]),R.push(array$5(v).reduce((z,q,H)=>(z[g[H].field]=q,z),{})))}else T=SelectionId,k=$selectionId(p),O=l[T]||(l[T]={}),R=O[S]||(O[S]=[]),R.push(k),i&&(R=f[S]||(f[S]=[]),R.push({[SelectionId]:k}));if(n=n||Union,l[SelectionId]?l[SelectionId]=ops["".concat(SelectionId,"_").concat(n)](...Object.values(l[SelectionId])):Object.keys(l).forEach(z=>{l[z]=Object.keys(l[z]).map(q=>l[z][q]).reduce((q,H)=>q===void 0?H:ops["".concat(d[z],"_").concat(n)](q,H))}),o=Object.keys(f),i&&o.length){const z=r?VlPoint:VlMulti;l[z]=n===Union?{[Or]:o.reduce((q,H)=>(q.push(...f[H]),q),[])}:{[And]:o.map(q=>({[Or]:f[q]}))}}return l}var ops={["".concat(SelectionId,"_union")]:union,["".concat(SelectionId,"_intersect")]:intersection,E_union:function(e,n){if(!e.length)return n;for(var i=0,r=n.length;i<r;++i)e.indexOf(n[i])<0&&e.push(n[i]);return e},E_intersect:function(e,n){return e.length?e.filter(i=>n.indexOf(i)>=0):n},R_union:function(e,n){var i=toNumber(n[0]),r=toNumber(n[1]);return i>r&&(i=n[1],r=n[0]),e.length?(e[0]>i&&(e[0]=i),e[1]<r&&(e[1]=r),e):[i,r]},R_intersect:function(e,n){var i=toNumber(n[0]),r=toNumber(n[1]);return i>r&&(i=n[1],r=n[0]),e.length?r<e[0]||e[1]<i?[]:(e[0]<i&&(e[0]=i),e[1]>r&&(e[1]=r),e):[i,r]}};const DataPrefix$1=":",IndexPrefix$1="@";function selectionVisitor(e,n,i,r){n[0].type!==Literal&&error("First argument to selection functions must be a string literal.");const s=n[0].value,o=n.length>=2&&peek$1(n).value,l="unit",f=IndexPrefix$1+l,d=DataPrefix$1+s;o===Intersect&&!has$1(r,f)&&(r[f]=i.getData(s).indataRef(i,l)),has$1(r,d)||(r[d]=i.getData(s).tuplesRef())}function data$1(e){const n=this.context.data[e];return n?n.values.value:[]}function indata(e,n,i){const r=this.context.data[e]["index:"+n],s=r?r.value.get(i):void 0;return s&&s.count}function setdata(e,n){const i=this.context.dataflow,r=this.context.data[e],s=r.input;return i.pulse(s,i.changeset().remove(truthy).insert(n)),1}function encode(e,n,i){if(e){const r=this.context.dataflow,s=e.mark.source;r.pulse(s,r.changeset().encode(e,n))}return i!==void 0?i:e}const wrap$1=e=>function(n,i){return this.context.dataflow.locale()[e](i)(n)},format=wrap$1("format"),timeFormat$1=wrap$1("timeFormat"),utcFormat=wrap$1("utcFormat"),timeParse=wrap$1("timeParse"),utcParse=wrap$1("utcParse"),dateObj=new Date(2e3,0,1);function time(e,n,i){return!Number.isInteger(e)||!Number.isInteger(n)?"":(dateObj.setYear(2e3),dateObj.setMonth(e),dateObj.setDate(n),timeFormat$1.call(this,dateObj,i))}function monthFormat(e){return time.call(this,e,1,"%B")}function monthAbbrevFormat(e){return time.call(this,e,1,"%b")}function dayFormat(e){return time.call(this,0,2+e,"%A")}function dayAbbrevFormat(e){return time.call(this,0,2+e,"%a")}const DataPrefix=":",IndexPrefix="@",ScalePrefix="%",SignalPrefix="$";function dataVisitor(e,n,i,r){n[0].type!==Literal&&error("First argument to data functions must be a string literal.");const s=n[0].value,o=DataPrefix+s;if(!has$1(o,r))try{r[o]=i.getData(s).tuplesRef()}catch{}}function indataVisitor(e,n,i,r){n[0].type!==Literal&&error("First argument to indata must be a string literal."),n[1].type!==Literal&&error("Second argument to indata must be a string literal.");const s=n[0].value,o=n[1].value,l=IndexPrefix+o;has$1(l,r)||(r[l]=i.getData(s).indataRef(i,o))}function scaleVisitor(e,n,i,r){if(n[0].type===Literal)addScaleDependency(i,r,n[0].value);else for(e in i.scales)addScaleDependency(i,r,e)}function addScaleDependency(e,n,i){const r=ScalePrefix+i;if(!has$1(n,r))try{n[r]=e.scaleRef(i)}catch{}}function getScale(e,n){let i;return isFunction(e)?e:isString(e)?(i=n.scales[e])&&i.value:void 0}function internalScaleFunctions(e,n,i){n.__bandwidth=s=>s&&s.bandwidth?s.bandwidth():0,i._bandwidth=scaleVisitor,i._range=scaleVisitor,i._scale=scaleVisitor;const r=s=>"_["+(s.type===Literal?$(ScalePrefix+s.value):$(ScalePrefix)+"+"+e(s))+"]";return{_bandwidth:s=>"this.__bandwidth(".concat(r(s[0]),")"),_range:s=>"".concat(r(s[0]),".range()"),_scale:s=>"".concat(r(s[0]),"(").concat(e(s[1]),")")}}function geoMethod(e,n){return function(i,r,s){if(i){const o=getScale(i,(s||this).context);return o&&o.path[e](r)}else return n(r)}}const geoArea=geoMethod("area",geoArea$1),geoBounds=geoMethod("bounds",geoBounds$1),geoCentroid=geoMethod("centroid",geoCentroid$1);function inScope(e){const n=this.context.group;let i=!1;if(n)for(;e;){if(e===n){i=!0;break}e=e.mark.group}return i}function log(e,n,i){try{e[n].apply(e,["EXPRESSION"].concat([].slice.call(i)))}catch(r){e.warn(r)}return i[i.length-1]}function warn$1(){return log(this.context.dataflow,"warn",arguments)}function info(){return log(this.context.dataflow,"info",arguments)}function debug$3(){return log(this.context.dataflow,"debug",arguments)}function channel_luminance_value(e){const n=e/255;return n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}function luminance(e){const n=rgb$1(e),i=channel_luminance_value(n.r),r=channel_luminance_value(n.g),s=channel_luminance_value(n.b);return .2126*i+.7152*r+.0722*s}function contrast(e,n){const i=luminance(e),r=luminance(n),s=Math.max(i,r),o=Math.min(i,r);return(s+.05)/(o+.05)}function merge(){const e=[].slice.call(arguments);return e.unshift({}),extend$1(...e)}function equal(e,n){return e===n||e!==e&&n!==n?!0:isArray(e)?isArray(n)&&e.length===n.length?equalArray(e,n):!1:isObject(e)&&isObject(n)?equalObject(e,n):!1}function equalArray(e,n){for(let i=0,r=e.length;i<r;++i)if(!equal(e[i],n[i]))return!1;return!0}function equalObject(e,n){for(const i in e)if(!equal(e[i],n[i]))return!1;return!0}function removePredicate(e){return n=>equalObject(e,n)}function modify(e,n,i,r,s,o){const l=this.context.dataflow,f=this.context.data[e],d=f.input,p=l.stamp();let g=f.changes,v,S;if(l._trigger===!1||!(d.value.length||n||r))return 0;if((!g||g.stamp<p)&&(f.changes=g=l.changeset(),g.stamp=p,l.runAfter(()=>{f.modified=!0,l.pulse(d,g).run()},!0,1)),i&&(v=i===!0?truthy:isArray(i)||isTuple(i)?i:removePredicate(i),g.remove(v)),n&&g.insert(n),r&&(v=removePredicate(r),d.value.some(v)?g.remove(v):g.insert(r)),s)for(S in o)g.modify(s,S,o[S]);return 1}function pinchDistance(e){const n=e.touches,i=n[0].clientX-n[1].clientX,r=n[0].clientY-n[1].clientY;return Math.sqrt(i*i+r*r)}function pinchAngle(e){const n=e.touches;return Math.atan2(n[0].clientY-n[1].clientY,n[0].clientX-n[1].clientX)}const accessors={};function pluck(e,n){const i=accessors[n]||(accessors[n]=field$1(n));return isArray(e)?e.map(i):i(e)}function array(e){return isArray(e)||ArrayBuffer.isView(e)?e:null}function sequence(e){return array(e)||(isString(e)?e:null)}function join(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return array(e).join(...i)}function indexof(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return sequence(e).indexOf(...i)}function lastindexof(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return sequence(e).lastIndexOf(...i)}function slice(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return sequence(e).slice(...i)}function replace(e,n,i){return isFunction(i)&&error("Function argument passed to replace."),String(e).replace(n,i)}function reverse$1(e){return array(e).slice().reverse()}function bandspace(e,n,i){return bandSpace(e||0,n||0,i||0)}function bandwidth(e,n){const i=getScale(e,(n||this).context);return i&&i.bandwidth?i.bandwidth():0}function copy(e,n){const i=getScale(e,(n||this).context);return i?i.copy():void 0}function domain$1(e,n){const i=getScale(e,(n||this).context);return i?i.domain():[]}function invert(e,n,i){const r=getScale(e,(i||this).context);return r?isArray(n)?(r.invertRange||r.invert)(n):(r.invert||r.invertExtent)(n):void 0}function range$2(e,n){const i=getScale(e,(n||this).context);return i&&i.range?i.range():[]}function scale$2(e,n,i){const r=getScale(e,(i||this).context);return r?r(n):void 0}function scaleGradient(e,n,i,r,s){e=getScale(e,(s||this).context);const o=Gradient$1(n,i);let l=e.domain(),f=l[0],d=peek$1(l),p=identity$6;return d-f?p=scaleFraction(e,f,d):e=(e.interpolator?scale$4("sequential")().interpolator(e.interpolator()):scale$4("linear")().interpolate(e.interpolate()).range(e.range())).domain([f=0,d=1]),e.ticks&&(l=e.ticks(+r||15),f!==l[0]&&l.unshift(f),d!==peek$1(l)&&l.push(d)),l.forEach(g=>o.stop(p(g),e(g))),o}function geoShape(e,n,i){const r=getScale(e,(i||this).context);return function(s){return r?r.path.context(s)(n):""}}function pathShape(e){let n=null;return function(i){return i?pathRender(i,n=n||parse$3(e)):e}}const datum=e=>e.data;function treeNodes(e,n){const i=data$1.call(n,e);return i.root&&i.root.lookup||{}}function treePath(e,n,i){const r=treeNodes(e,this),s=r[n],o=r[i];return s&&o?s.path(o).map(datum):void 0}function treeAncestors(e,n){const i=treeNodes(e,this)[n];return i?i.ancestors().map(datum):void 0}const _window=()=>typeof window<"u"&&window||null;function screen(){const e=_window();return e?e.screen:{}}function windowSize(){const e=_window();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function containerSize(){const e=this.context.dataflow,n=e.container&&e.container();return n?[n.clientWidth,n.clientHeight]:[void 0,void 0]}function intersect(e,n,i){if(!e)return[];const[r,s]=e,o=new Bounds().set(r[0],r[1],s[0],s[1]),l=i||this.context.dataflow.scenegraph().root;return intersect$2(l,o,filter(n))}function filter(e){let n=null;if(e){const i=array$5(e.marktype),r=array$5(e.markname);n=s=>(!i.length||i.some(o=>s.marktype===o))&&(!r.length||r.some(o=>s.name===o))}return n}function lassoAppend(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;const s=e[e.length-1];return s===void 0||Math.sqrt((s[0]-n)**2+(s[1]-i)**2)>r?(e.push([n,i]),[...e]):e}function lassoPath(e){return(e??[]).reduce((n,i,r)=>{let[s,o]=i;return n+=r==0?"M ".concat(s,",").concat(o," "):r===e.length-1?" Z":"L ".concat(s,",").concat(o," ")},"")}function intersectLasso(e,n,i){const{x:r,y:s,mark:o}=i,l=new Bounds().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[d,p]of n)d<l.x1&&(l.x1=d),d>l.x2&&(l.x2=d),p<l.y1&&(l.y1=p),p>l.y2&&(l.y2=p);return l.translate(r,s),intersect([[l.x1,l.y1],[l.x2,l.y2]],e,o).filter(d=>pointInPolygon(d.x,d.y,n))}function pointInPolygon(e,n,i){let r=0;for(let s=0,o=i.length-1;s<i.length;o=s++){const[l,f]=i[o],[d,p]=i[s];p>n!=f>n&&e<(l-d)*(n-p)/(f-p)+d&&r++}return r&1}const functionContext={random(){return random()},cumulativeNormal,cumulativeLogNormal,cumulativeUniform,densityNormal,densityLogNormal,densityUniform,quantileNormal,quantileLogNormal,quantileUniform,sampleNormal,sampleLogNormal,sampleUniform,isArray,isBoolean:isBoolean$2,isDate:isDate$1,isDefined(e){return e!==void 0},isNumber:isNumber$1,isObject,isRegExp,isString,isTuple,isValid(e){return e!=null&&e===e},toBoolean,toDate(e){return toDate(e)},toNumber,toString,indexof,join,lastindexof,replace,reverse:reverse$1,slice,flush,lerp,merge,pad:pad$2,peek:peek$1,pluck,span,inrange,truncate:truncate$1,rgb:rgb$1,lab:lab$1,hcl:hcl$2,hsl:hsl$2,luminance,contrast,sequence:range$4,format,utcFormat,utcParse,utcOffset,utcSequence,timeFormat:timeFormat$1,timeParse,timeOffset,timeSequence,timeUnitSpecifier,monthFormat,monthAbbrevFormat,dayFormat,dayAbbrevFormat,quarter,utcquarter,week,utcweek,dayofyear,utcdayofyear,warn:warn$1,info,debug:debug$3,extent(e){return extent(e)},inScope,intersect,clampRange,pinchDistance,pinchAngle,screen,containerSize,windowSize,bandspace,setdata,pathShape,panLinear,panLog,panPow,panSymlog,zoomLinear,zoomLog,zoomPow,zoomSymlog,encode,modify,lassoAppend,lassoPath,intersectLasso},eventFunctions=["view","item","group","xy","x","y"],eventPrefix="event.vega.",thisPrefix="this.",astVisitors={},codegenParams={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat($(SignalPrefix+e),"]"),functions:buildFunctions,constants:Constants,visitors:astVisitors},codeGenerator=codegen(codegenParams);function buildFunctions(e){const n=Functions(e);eventFunctions.forEach(i=>n[i]=eventPrefix+i);for(const i in functionContext)n[i]=thisPrefix+i;return extend$1(n,internalScaleFunctions(e,functionContext,astVisitors)),n}function expressionFunction(e,n,i){return arguments.length===1?functionContext[e]:(functionContext[e]=n,i&&(astVisitors[e]=i),codeGenerator&&(codeGenerator.functions[e]=thisPrefix+e),this)}expressionFunction("bandwidth",bandwidth,scaleVisitor);expressionFunction("copy",copy,scaleVisitor);expressionFunction("domain",domain$1,scaleVisitor);expressionFunction("range",range$2,scaleVisitor);expressionFunction("invert",invert,scaleVisitor);expressionFunction("scale",scale$2,scaleVisitor);expressionFunction("gradient",scaleGradient,scaleVisitor);expressionFunction("geoArea",geoArea,scaleVisitor);expressionFunction("geoBounds",geoBounds,scaleVisitor);expressionFunction("geoCentroid",geoCentroid,scaleVisitor);expressionFunction("geoShape",geoShape,scaleVisitor);expressionFunction("indata",indata,indataVisitor);expressionFunction("data",data$1,dataVisitor);expressionFunction("treePath",treePath,dataVisitor);expressionFunction("treeAncestors",treeAncestors,dataVisitor);expressionFunction("vlSelectionTest",selectionTest,selectionVisitor);expressionFunction("vlSelectionIdTest",selectionIdTest,selectionVisitor);expressionFunction("vlSelectionResolve",selectionResolve,selectionVisitor);expressionFunction("vlSelectionTuples",selectionTuples);function parser(e,n){const i={};let r;try{e=isString(e)?e:$(e)+"",r=parser$1(e)}catch{error("Expression parse error: "+e)}r.visit(o=>{if(o.type!==CallExpression)return;const l=o.callee.name,f=codegenParams.visitors[l];f&&f(l,o.arguments,n,i)});const s=codeGenerator(r);return s.globals.forEach(o=>{const l=SignalPrefix+o;!has$1(i,l)&&n.getSignal(o)&&(i[l]=n.signalRef(o))}),{$expr:extend$1({code:s.code},n.options.ast?{ast:r}:null),$fields:s.fields,$params:i}}function parse$2(e){const n=this,i=e.operators||[];return e.background&&(n.background=e.background),e.eventConfig&&(n.eventConfig=e.eventConfig),e.locale&&(n.locale=e.locale),i.forEach(r=>n.parseOperator(r)),i.forEach(r=>n.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>n.parseStream(r)),(e.updates||[]).forEach(r=>n.parseUpdate(r)),n.resolve()}const Skip$2=toSet(["rule"]),Swap=toSet(["group","image","rect"]);function adjustSpatial(e,n){let i="";return Skip$2[n]||(e.x2&&(e.x?(Swap[n]&&(i+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),i+="o.width=o.x2-o.x;"):i+="o.x=o.x2-(o.width||0);"),e.xc&&(i+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(Swap[n]&&(i+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),i+="o.height=o.y2-o.y;"):i+="o.y=o.y2-(o.height||0);"),e.yc&&(i+="o.y=o.yc-(o.height||0)/2;")),i}function canonicalType(e){return(e+"").toLowerCase()}function isOperator(e){return canonicalType(e)==="operator"}function isCollect(e){return canonicalType(e)==="collect"}function expression$1(e,n,i){i[i.length-1]!==";"&&(i="return("+i+");");const r=Function(...n.concat(i));return e&&e.functions?r.bind(e.functions):r}function _compare(e,n,i,r){return"((u = ".concat(e,") < (v = ").concat(n,") || u == null) && v != null ? ").concat(i,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(i,`
  : v !== v && u === u ? `).concat(r," : ")}var expressionCodegen={operator:(e,n)=>expression$1(e,["_"],n.code),parameter:(e,n)=>expression$1(e,["datum","_"],n.code),event:(e,n)=>expression$1(e,["event"],n.code),handler:(e,n)=>{const i="var datum=event.item&&event.item.datum;return ".concat(n.code,";");return expression$1(e,["_","event"],i)},encode:(e,n)=>{const{marktype:i,channels:r}=n;let s="var o=item,datum=o.datum,m=0,$;";for(const o in r){const l="o["+$(o)+"]";s+="$=".concat(r[o].code,";if(").concat(l,"!==$)").concat(l,"=$,m=1;")}return s+=adjustSpatial(r,i),s+="return m;",expression$1(e,["item","_"],s)},codegen:{get(e){const n="[".concat(e.map($).join("]["),"]"),i=Function("_","return _".concat(n,";"));return i.path=n,i},comparator(e,n){let i;const r=(o,l)=>{const f=n[l];let d,p;return o.path?(d="a".concat(o.path),p="b".concat(o.path)):((i=i||{})["f"+l]=o,d="this.f".concat(l,"(a)"),p="this.f".concat(l,"(b)")),_compare(d,p,-f,f)},s=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return i?s.bind(i):s}}};function parseOperator(e){const n=this;isOperator(e.type)||!e.type?n.operator(e,e.update?n.operatorExpression(e.update):null):n.transform(e,e.type)}function parseOperatorParameters(e){const n=this;if(e.params){const i=n.get(e.id);i||error("Invalid operator id: "+e.id),n.dataflow.connect(i,i.parameters(n.parseParameters(e.params),e.react,e.initonly))}}function parseParameters$1(e,n){n=n||{};const i=this;for(const r in e){const s=e[r];n[r]=isArray(s)?s.map(o=>parseParameter$2(o,i,n)):parseParameter$2(s,i,n)}return n}function parseParameter$2(e,n,i){if(!e||!isObject(e))return e;for(let r=0,s=PARSERS.length,o;r<s;++r)if(o=PARSERS[r],has$1(e,o.key))return o.parse(e,n,i);return e}var PARSERS=[{key:"$ref",parse:getOperator},{key:"$key",parse:getKey},{key:"$expr",parse:getExpression},{key:"$field",parse:getField},{key:"$encode",parse:getEncode},{key:"$compare",parse:getCompare},{key:"$context",parse:getContext},{key:"$subflow",parse:getSubflow},{key:"$tupleid",parse:getTupleId}];function getOperator(e,n){return n.get(e.$ref)||error("Operator not defined: "+e.$ref)}function getExpression(e,n,i){e.$params&&n.parseParameters(e.$params,i);const r="e:"+e.$expr.code+"_"+e.$name;return n.fn[r]||(n.fn[r]=accessor(n.parameterExpression(e.$expr),e.$fields,e.$name))}function getKey(e,n){const i="k:"+e.$key+"_"+!!e.$flat;return n.fn[i]||(n.fn[i]=key(e.$key,e.$flat,n.expr.codegen))}function getField(e,n){if(!e.$field)return null;const i="f:"+e.$field+"_"+e.$name;return n.fn[i]||(n.fn[i]=field$1(e.$field,e.$name,n.expr.codegen))}function getCompare(e,n){const i="c:"+e.$compare+"_"+e.$order,r=array$5(e.$compare).map(s=>s&&s.$tupleid?tupleid:s);return n.fn[i]||(n.fn[i]=compare$8(r,e.$order,n.expr.codegen))}function getEncode(e,n){const i=e.$encode,r={};for(const s in i){const o=i[s];r[s]=accessor(n.encodeExpression(o.$expr),o.$fields),r[s].output=o.$output}return r}function getContext(e,n){return n}function getSubflow(e,n){const i=e.$subflow;return function(r,s,o){const l=n.fork().parse(i),f=l.get(i.operators[0].id),d=l.signals.parent;return d&&d.set(o),f.detachSubflow=()=>n.detach(l),f}}function getTupleId(){return tupleid}function parseStream$2(e){var n=this,i=e.filter!=null?n.eventExpression(e.filter):void 0,r=e.stream!=null?n.get(e.stream):void 0,s;e.source?r=n.events(e.source,e.type,i):e.merge&&(s=e.merge.map(o=>n.get(o)),r=s[0].merge.apply(s[0],s.slice(1))),e.between&&(s=e.between.map(o=>n.get(o)),r=r.between(s[0],s[1])),e.filter&&(r=r.filter(i)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&error("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),n.stream(e,r)}function parseUpdate$1(e){var n=this,i=isObject(i=e.source)?i.$ref:i,r=n.get(i),s=null,o=e.update,l=void 0;r||error("Source not defined: "+e.source),s=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),o&&o.$expr&&(o.$params&&(l=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(e,r,s,o,l)}const SKIP={skip:!0};function getState$1(e){var n=this,i={};if(e.signals){var r=i.signals={};Object.keys(n.signals).forEach(o=>{const l=n.signals[o];e.signals(o,l)&&(r[o]=l.value)})}if(e.data){var s=i.data={};Object.keys(n.data).forEach(o=>{const l=n.data[o];e.data(o,l)&&(s[o]=l.input.value)})}return n.subcontext&&e.recurse!==!1&&(i.subcontext=n.subcontext.map(o=>o.getState(e))),i}function setState$1(e){var n=this,i=n.dataflow,r=e.data,s=e.signals;Object.keys(s||{}).forEach(o=>{i.update(n.signals[o],s[o],SKIP)}),Object.keys(r||{}).forEach(o=>{i.pulse(n.data[o].input,i.changeset().remove(truthy).insert(r[o]))}),(e.subcontext||[]).forEach((o,l)=>{const f=n.subcontext[l];f&&f.setState(o)})}function context(e,n,i,r){return new Context$1(e,n,i,r)}function Context$1(e,n,i,r){this.dataflow=e,this.transforms=n,this.events=e.events.bind(e),this.expr=r||expressionCodegen,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},i&&(this.functions=Object.create(i),this.functions.context=this)}function Subcontext(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Context$1.prototype=Subcontext.prototype={fork(){const e=new Subcontext(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(i=>i!==e);const n=Object.keys(e.nodes);for(const i of n)e.nodes[i]._targets=null;for(const i of n)e.nodes[i].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,n){return this.nodes[e]=n},add(e,n){const i=this,r=i.dataflow,s=e.value;if(i.set(e.id,n),isCollect(e.type)&&s&&(s.$ingest?r.ingest(n,s.$ingest,s.$format):s.$request?r.preload(n,s.$request,s.$format):r.pulse(n,r.changeset().insert(s))),e.root&&(i.root=n),e.parent){let o=i.get(e.parent.$ref);o?(r.connect(o,[n]),n.targets().add(o)):(i.unresolved=i.unresolved||[]).push(()=>{o=i.get(e.parent.$ref),r.connect(o,[n]),n.targets().add(o)})}if(e.signal&&(i.signals[e.signal]=n),e.scale&&(i.scales[e.scale]=n),e.data)for(const o in e.data){const l=i.data[o]||(i.data[o]={});e.data[o].forEach(f=>l[f]=n)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,n){this.add(e,this.dataflow.add(e.value,n))},transform(e,n){this.add(e,this.dataflow.add(this.transforms[canonicalType(n)]))},stream(e,n){this.set(e.id,n)},update(e,n,i,r,s){this.dataflow.on(n,i,r,s,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:parse$2,parseOperator,parseOperatorParameters,parseParameters:parseParameters$1,parseStream:parseStream$2,parseUpdate:parseUpdate$1,getState:getState$1,setState:setState$1};function initializeAria(e){const n=e.container();n&&(n.setAttribute("role","graphics-document"),n.setAttribute("aria-roleDescription","visualization"),ariaLabel(n,e.description()))}function ariaLabel(e,n){e&&(n==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",n))}function background(e){e.add(null,n=>(e._background=n.bg,e._resize=1,n.bg),{bg:e._signals.background})}const Default="default";function cursor$1(e){const n=e._signals.cursor||(e._signals.cursor=e.add({user:Default,item:null}));e.on(e.events("view","mousemove"),n,(i,r)=>{const s=n.value,o=s?isString(s)?s:s.user:Default,l=r.item&&r.item.cursor||null;return s&&o===s.user&&l==s.item?s:{user:o,item:l}}),e.add(null,function(i){let r=i.cursor,s=this.value;return isString(r)||(s=r.item,r=r.user),setCursor(e,r&&r!==Default?r:s||r),s},{cursor:n})}function setCursor(e,n){const i=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(i)return n==null?i.style.removeProperty("cursor"):i.style.cursor=n}function dataref(e,n){var i=e._runtime.data;return has$1(i,n)||error("Unrecognized data set: "+n),i[n]}function data(e,n){return arguments.length<2?dataref(this,e).values.value:change.call(this,e,changeset().remove(truthy).insert(n))}function change(e,n){isChangeSet(n)||error("Second argument to changes must be a changeset.");const i=dataref(this,e);return i.modified=!0,this.pulse(i.input,n)}function insert$1(e,n){return change.call(this,e,changeset().insert(n))}function remove(e,n){return change.call(this,e,changeset().remove(n))}function width(e){var n=e.padding();return Math.max(0,e._viewWidth+n.left+n.right)}function height(e){var n=e.padding();return Math.max(0,e._viewHeight+n.top+n.bottom)}function offset(e){var n=e.padding(),i=e._origin;return[n.left+i[0],n.top+i[1]]}function resizeRenderer(e){var n=offset(e),i=width(e),r=height(e);e._renderer.background(e.background()),e._renderer.resize(i,r,n),e._handler.origin(n),e._resizeListeners.forEach(s=>{try{s(i,r)}catch(o){e.error(o)}})}function eventExtend(e,n,i){var r=e._renderer,s=r&&r.canvas(),o,l,f;return s&&(f=offset(e),l=n.changedTouches?n.changedTouches[0]:n,o=point$2(l,s),o[0]-=f[0],o[1]-=f[1]),n.dataflow=e,n.item=i,n.vega=extension(e,i,o),n}function extension(e,n,i){const r=n?n.mark.marktype==="group"?n:n.mark.group:null;function s(l){var f=r,d;if(l){for(d=n;d;d=d.mark.group)if(d.mark.name===l){f=d;break}}return f&&f.mark&&f.mark.interactive?f:{}}function o(l){if(!l)return i;isString(l)&&(l=s(l));const f=i.slice();for(;l;)f[0]-=l.x||0,f[1]-=l.y||0,l=l.mark&&l.mark.group;return f}return{view:constant$4(e),item:constant$4(n||{}),group:s,xy:o,x:l=>o(l)[0],y:l=>o(l)[1]}}const VIEW$1="view",TIMER="timer",WINDOW="window",NO_TRAP={trap:!1};function initializeEventConfig(e){const n=extend$1({defaults:{}},e),i=(r,s)=>{s.forEach(o=>{isArray(r[o])&&(r[o]=toSet(r[o]))})};return i(n.defaults,["prevent","allow"]),i(n,["view","window","selector"]),n}function trackEventListener(e,n,i,r){e._eventListeners.push({type:i,sources:array$5(n),handler:r})}function prevent(e,n){var i=e._eventConfig.defaults,r=i.prevent,s=i.allow;return r===!1||s===!0?!1:r===!0||s===!1?!0:r?r[n]:s?!s[n]:e.preventDefault()}function permit(e,n,i){const r=e._eventConfig&&e._eventConfig[n];return r===!1||isObject(r)&&!r[i]?(e.warn("Blocked ".concat(n," ").concat(i," event listener.")),!1):!0}function events$1(e,n,i){var r=this,s=new EventStream(i),o=function(p,g){r.runAsync(null,()=>{e===VIEW$1&&prevent(r,n)&&p.preventDefault(),s.receive(eventExtend(r,p,g))})},l;if(e===TIMER)permit(r,"timer",n)&&r.timer(o,n);else if(e===VIEW$1)permit(r,"view",n)&&r.addEventListener(n,o,NO_TRAP);else if(e===WINDOW?permit(r,"window",n)&&typeof window<"u"&&(l=[window]):typeof document<"u"&&permit(r,"selector",n)&&(l=document.querySelectorAll(e)),!l)r.warn("Can not resolve event source: "+e);else{for(var f=0,d=l.length;f<d;++f)l[f].addEventListener(n,o);trackEventListener(r,l,n,o)}return s}function itemFilter(e){return e.item}function markTarget(e){return e.item.mark.source}function invoke(e){return function(n,i){return i.vega.view().changeset().encode(i.item,e)}}function hover(e,n){return e=[e||"hover"],n=[n||"update",e[0]],this.on(this.events("view","mouseover",itemFilter),markTarget,invoke(e)),this.on(this.events("view","mouseout",itemFilter),markTarget,invoke(n)),this}function finalize(){var e=this._tooltip,n=this._timers,i=this._eventListeners,r,s,o;for(r=n.length;--r>=0;)n[r].stop();for(r=i.length;--r>=0;)for(o=i[r],s=o.sources.length;--s>=0;)o.sources[s].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function element(e,n,i){const r=document.createElement(e);for(const s in n)r.setAttribute(s,n[s]);return i!=null&&(r.textContent=i),r}const BindClass="vega-bind",NameClass="vega-bind-name",RadioClass="vega-bind-radio";function bind(e,n,i){if(!n)return;const r=i.param;let s=i.state;return s||(s=i.state={elements:null,active:!1,set:null,update:l=>{l!=e.signal(r.signal)&&e.runAsync(null,()=>{s.source=!0,e.signal(r.signal,l)})}},r.debounce&&(s.update=debounce(r.debounce,s.update))),(r.input==null&&r.element?target:generate)(s,n,r,e),s.active||(e.on(e._signals[r.signal],null,()=>{s.source?s.source=!1:s.set(e.signal(r.signal))}),s.active=!0),s}function target(e,n,i,r){const s=i.event||"input",o=()=>e.update(n.value);r.signal(i.signal,n.value),n.addEventListener(s,o),trackEventListener(r,n,s,o),e.set=l=>{n.value=l,n.dispatchEvent(event(s))}}function event(e){return typeof Event<"u"?new Event(e):{type:e}}function generate(e,n,i,r){const s=r.signal(i.signal),o=element("div",{class:BindClass}),l=i.input==="radio"?o:o.appendChild(element("label"));l.appendChild(element("span",{class:NameClass},i.name||i.signal)),n.appendChild(o);let f=form;switch(i.input){case"checkbox":f=checkbox;break;case"select":f=select;break;case"radio":f=radio;break;case"range":f=range$1;break}f(e,l,i,s)}function form(e,n,i,r){const s=element("input");for(const o in i)o!=="signal"&&o!=="element"&&s.setAttribute(o==="input"?"type":o,i[o]);s.setAttribute("name",i.signal),s.value=r,n.appendChild(s),s.addEventListener("input",()=>e.update(s.value)),e.elements=[s],e.set=o=>s.value=o}function checkbox(e,n,i,r){const s={type:"checkbox",name:i.signal};r&&(s.checked=!0);const o=element("input",s);n.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=l=>o.checked=!!l||null}function select(e,n,i,r){const s=element("select",{name:i.signal}),o=i.labels||[];i.options.forEach((l,f)=>{const d={value:l};valuesEqual(l,r)&&(d.selected=!0),s.appendChild(element("option",d,(o[f]||l)+""))}),n.appendChild(s),s.addEventListener("change",()=>{e.update(i.options[s.selectedIndex])}),e.elements=[s],e.set=l=>{for(let f=0,d=i.options.length;f<d;++f)if(valuesEqual(i.options[f],l)){s.selectedIndex=f;return}}}function radio(e,n,i,r){const s=element("span",{class:RadioClass}),o=i.labels||[];n.appendChild(s),e.elements=i.options.map((l,f)=>{const d={type:"radio",name:i.signal,value:l};valuesEqual(l,r)&&(d.checked=!0);const p=element("input",d);p.addEventListener("change",()=>e.update(l));const g=element("label",{},(o[f]||l)+"");return g.prepend(p),s.appendChild(g),p}),e.set=l=>{const f=e.elements,d=f.length;for(let p=0;p<d;++p)valuesEqual(f[p].value,l)&&(f[p].checked=!0)}}function range$1(e,n,i,r){r=r!==void 0?r:(+i.max+ +i.min)/2;const s=i.max!=null?i.max:Math.max(100,+r)||100,o=i.min||Math.min(0,s,+r)||0,l=i.step||tickStep(o,s,100),f=element("input",{type:"range",name:i.signal,min:o,max:s,step:l});f.value=r;const d=element("span",{},+r);n.appendChild(f),n.appendChild(d);const p=()=>{d.textContent=f.value,e.update(+f.value)};f.addEventListener("input",p),f.addEventListener("change",p),e.elements=[f],e.set=g=>{f.value=g,d.textContent=g}}function valuesEqual(e,n){return e===n||e+""==n+""}function initializeRenderer(e,n,i,r,s,o){return n=n||new r(e.loader()),n.initialize(i,width(e),height(e),offset(e),s,o).background(e.background())}function trap(e,n){return n?function(){try{n.apply(this,arguments)}catch(i){e.error(i)}}:null}function initializeHandler(e,n,i,r){const s=new r(e.loader(),trap(e,e.tooltip())).scene(e.scenegraph().root).initialize(i,offset(e),e);return n&&n.handlers().forEach(o=>{s.on(o.type,o.handler)}),s}function initialize(e,n){const i=this,r=i._renderType,s=i._eventConfig.bind,o=renderModule(r);e=i._el=e?lookup$1(i,e,!0):null,initializeAria(i),o||i.error("Unrecognized renderer type: "+r);const l=o.handler||CanvasHandler,f=e?o.renderer:o.headless;return i._renderer=f?initializeRenderer(i,i._renderer,e,f):null,i._handler=initializeHandler(i,i._handler,e,l),i._redraw=!0,e&&s!=="none"&&(n=n?i._elBind=lookup$1(i,n,!0):e.appendChild(element("form",{class:"vega-bindings"})),i._bind.forEach(d=>{d.param.element&&s!=="container"&&(d.element=lookup$1(i,d.param.element,!!d.param.input))}),i._bind.forEach(d=>{bind(i,d.element||n,d)})),i}function lookup$1(e,n,i){if(typeof n=="string")if(typeof document<"u"){if(n=document.querySelector(n),!n)return e.error("Signal bind element not found: "+n),null}else return e.error("DOM document instance not found."),null;if(n&&i)try{n.textContent=""}catch(r){n=null,e.error(r)}return n}const number$1=e=>+e||0,paddingObject$1=e=>({top:e,bottom:e,left:e,right:e});function padding$1(e){return isObject(e)?{top:number$1(e.top),bottom:number$1(e.bottom),left:number$1(e.left),right:number$1(e.right)}:paddingObject$1(number$1(e))}async function renderHeadless(e,n,i,r){const s=renderModule(n),o=s&&s.headless;return o||error("Unrecognized renderer type: "+n),await e.runAsync(),initializeRenderer(e,null,null,o,i,r).renderAsync(e._scenegraph.root)}async function renderToImageURL(e,n){e!==RenderType.Canvas&&e!==RenderType.SVG&&e!==RenderType.PNG&&error("Unrecognized image type: "+e);const i=await renderHeadless(this,e,n);return e===RenderType.SVG?toBlobURL(i.svg(),"image/svg+xml"):i.canvas().toDataURL("image/png")}function toBlobURL(e,n){const i=new Blob([e],{type:n});return window.URL.createObjectURL(i)}async function renderToCanvas(e,n){return(await renderHeadless(this,RenderType.Canvas,e,n)).canvas()}async function renderToSVG(e){return(await renderHeadless(this,RenderType.SVG,e)).svg()}function runtime(e,n,i){return context(e,transforms,functionContext,i).parse(n)}function scale$1(e){var n=this._runtime.scales;return has$1(n,e)||error("Unrecognized scale or projection: "+e),n[e].value}var Width="width",Height="height",Padding="padding",Skip$1={skip:!0};function viewWidth(e,n){var i=e.autosize(),r=e.padding();return n-(i&&i.contains===Padding?r.left+r.right:0)}function viewHeight(e,n){var i=e.autosize(),r=e.padding();return n-(i&&i.contains===Padding?r.top+r.bottom:0)}function initializeResize(e){var n=e._signals,i=n[Width],r=n[Height],s=n[Padding];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,f=>{e._width=f.size,e._viewWidth=viewWidth(e,f.size),o()},{size:i}),e._resizeHeight=e.add(null,f=>{e._height=f.size,e._viewHeight=viewHeight(e,f.size),o()},{size:r});const l=e.add(null,o,{pad:s});e._resizeWidth.rank=i.rank+1,e._resizeHeight.rank=r.rank+1,l.rank=s.rank+1}function resizeView(e,n,i,r,s,o){this.runAfter(l=>{let f=0;l._autosize=0,l.width()!==i&&(f=1,l.signal(Width,i,Skip$1),l._resizeWidth.skip(!0)),l.height()!==r&&(f=1,l.signal(Height,r,Skip$1),l._resizeHeight.skip(!0)),l._viewWidth!==e&&(l._resize=1,l._viewWidth=e),l._viewHeight!==n&&(l._resize=1,l._viewHeight=n),(l._origin[0]!==s[0]||l._origin[1]!==s[1])&&(l._resize=1,l._origin=s),f&&l.run("enter"),o&&l.runAfter(d=>d.resize())},!1,1)}function getState(e){return this._runtime.getState(e||{data:dataTest,signals:signalTest,recurse:!0})}function dataTest(e,n){return n.modified&&isArray(n.input.value)&&e.indexOf("_:vega:_")}function signalTest(e,n){return!(e==="parent"||n instanceof transforms.proxy)}function setState(e){return this.runAsync(null,n=>{n._trigger=!1,n._runtime.setState(e)},n=>{n._trigger=!0}),this}function timer(e,n){function i(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(interval$1(i,n))}function defaultTooltip(e,n,i,r){const s=e.element();s&&s.setAttribute("title",formatTooltip(r))}function formatTooltip(e){return e==null?"":isArray(e)?formatArray(e):isObject(e)&&!isDate$1(e)?formatObject(e):e+""}function formatObject(e){return Object.keys(e).map(n=>{const i=e[n];return n+": "+(isArray(i)?formatArray(i):formatValue(i))}).join(`
`)}function formatArray(e){return"["+e.map(formatValue).join(", ")+"]"}function formatValue(e){return isArray(e)?"[]":isObject(e)&&!isDate$1(e)?"{}":e}function View$1(e,n){const i=this;if(n=n||{},Dataflow.call(i),n.loader&&i.loader(n.loader),n.logger&&i.logger(n.logger),n.logLevel!=null&&i.logLevel(n.logLevel),n.locale||e.locale){const o=extend$1({},e.locale,n.locale);i.locale(locale(o.number,o.time))}i._el=null,i._elBind=null,i._renderType=n.renderer||RenderType.Canvas,i._scenegraph=new Scenegraph;const r=i._scenegraph.root;i._renderer=null,i._tooltip=n.tooltip||defaultTooltip,i._redraw=!0,i._handler=new CanvasHandler().scene(r),i._globalCursor=!1,i._preventDefault=!1,i._timers=[],i._eventListeners=[],i._resizeListeners=[],i._eventConfig=initializeEventConfig(e.eventConfig),i.globalCursor(i._eventConfig.globalCursor);const s=runtime(i,e,n.expr);i._runtime=s,i._signals=s.signals,i._bind=(e.bindings||[]).map(o=>({state:null,param:extend$1({},o)})),s.root&&s.root.set(r),r.source=s.data.root.input,i.pulse(s.data.root.input,i.changeset().insert(r.items)),i._width=i.width(),i._height=i.height(),i._viewWidth=viewWidth(i,i._width),i._viewHeight=viewHeight(i,i._height),i._origin=[0,0],i._resize=0,i._autosize=1,initializeResize(i),background(i),cursor$1(i),i.description(e.description),n.hover&&i.hover(),n.container&&i.initialize(n.container,n.bind)}function lookupSignal(e,n){return has$1(e._signals,n)?e._signals[n]:error("Unrecognized signal name: "+$(n))}function findOperatorHandler(e,n){const i=(e._targets||[]).filter(r=>r._update&&r._update.handler===n);return i.length?i[0]:null}function addOperatorListener(e,n,i,r){let s=findOperatorHandler(i,r);return s||(s=trap(e,()=>r(n,i.value)),s.handler=r,e.on(i,null,s)),e}function removeOperatorListener(e,n,i){const r=findOperatorHandler(n,i);return r&&n._targets.remove(r),e}inherits(View$1,Dataflow,{async evaluate(e,n,i){if(await Dataflow.prototype.evaluate.call(this,e,n),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,resizeRenderer(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return i&&asyncCallback(this,i),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const n=e!=null?e+"":null;return n!==this._desc&&ariaLabel(this._el,this._desc=n),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,n,i){const r=lookupSignal(this,e);return arguments.length===1?r.value:this.update(r,n,i)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",padding$1(e)):padding$1(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(renderModule(e)||error("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Dataflow.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(lookupSignal(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:resizeView,addEventListener(e,n,i){let r=n;return i&&i.trap===!1||(r=trap(this,n),r.raw=n),this._handler.on(e,r),this},removeEventListener(e,n){for(var i=this._handler.handlers(e),r=i.length,s,o;--r>=0;)if(o=i[r].type,s=i[r].handler,e===o&&(n===s||n===s.raw)){this._handler.off(o,s);break}return this},addResizeListener(e){const n=this._resizeListeners;return n.indexOf(e)<0&&n.push(e),this},removeResizeListener(e){var n=this._resizeListeners,i=n.indexOf(e);return i>=0&&n.splice(i,1),this},addSignalListener(e,n){return addOperatorListener(this,e,lookupSignal(this,e),n)},removeSignalListener(e,n){return removeOperatorListener(this,lookupSignal(this,e),n)},addDataListener(e,n){return addOperatorListener(this,e,dataref(this,e).values,n)},removeDataListener(e,n){return removeOperatorListener(this,dataref(this,e).values,n)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const n=setCursor(this,null);this._globalCursor=!!e,n&&setCursor(this,n)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer,events:events$1,finalize,hover,data,change,insert:insert$1,remove,scale:scale$1,initialize,toImageURL:renderToImageURL,toCanvas:renderToCanvas,toSVG:renderToSVG,getState,setState});const VIEW="view",LBRACK="[",RBRACK="]",LBRACE="{",RBRACE="}",COLON=":",COMMA=",",NAME="@",GT=">",ILLEGAL=/[[\]{}]/,DEFAULT_MARKS={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let DEFAULT_SOURCE,MARKS;function eventSelector(e,n,i){return DEFAULT_SOURCE=n||VIEW,MARKS=i||DEFAULT_MARKS,parseMerge(e.trim()).map(parseSelector)}function isMarkType(e){return MARKS[e]}function find(e,n,i,r,s){const o=e.length;let l=0,f;for(;n<o;++n){if(f=e[n],!l&&f===i)return n;s&&s.indexOf(f)>=0?--l:r&&r.indexOf(f)>=0&&++l}return n}function parseMerge(e){const n=[],i=e.length;let r=0,s=0;for(;s<i;)s=find(e,s,COMMA,LBRACK+LBRACE,RBRACK+RBRACE),n.push(e.substring(r,s).trim()),r=++s;if(n.length===0)throw"Empty event selector: "+e;return n}function parseSelector(e){return e[0]==="["?parseBetween(e):parseStream$1(e)}function parseBetween(e){const n=e.length;let i=1,r;if(i=find(e,i,RBRACK,LBRACK,RBRACK),i===n)throw"Empty between selector: "+e;if(r=parseMerge(e.substring(1,i)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(i+1).trim(),e[0]!==GT)throw"Expected '>' after between selector: "+e;r=r.map(parseSelector);const s=parseSelector(e.slice(1).trim());return s.between?{between:r,stream:s}:(s.between=r,s)}function parseStream$1(e){const n={source:DEFAULT_SOURCE},i=[];let r=[0,0],s=0,o=0,l=e.length,f=0,d,p;if(e[l-1]===RBRACE){if(f=e.lastIndexOf(LBRACE),f>=0){try{r=parseThrottle(e.substring(f+1,l-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,f).trim(),l=e.length}else throw"Unmatched right brace: "+e;f=0}if(!l)throw e;if(e[0]===NAME&&(s=++f),d=find(e,f,COLON),d<l&&(i.push(e.substring(o,d).trim()),o=f=++d),f=find(e,f,LBRACK),f===l)i.push(e.substring(o,l).trim());else if(i.push(e.substring(o,f).trim()),p=[],o=++f,o===l)throw"Unmatched left bracket: "+e;for(;f<l;){if(f=find(e,f,RBRACK),f===l)throw"Unmatched left bracket: "+e;if(p.push(e.substring(o,f).trim()),f<l-1&&e[++f]!==LBRACK)throw"Expected left bracket: "+e;o=++f}if(!(l=i.length)||ILLEGAL.test(i[l-1]))throw"Invalid event selector: "+e;return l>1?(n.type=i[1],s?n.markname=i[0].slice(1):isMarkType(i[0])?n.marktype=i[0]:n.source=i[0]):n.type=i[0],n.type.slice(-1)==="!"&&(n.consume=!0,n.type=n.type.slice(0,-1)),p!=null&&(n.filter=p),r[0]&&(n.throttle=r[0]),r[1]&&(n.debounce=r[1]),n}function parseThrottle(e){const n=e.split(COMMA);if(!e.length||n.length>2)throw e;return n.map(i=>{const r=+i;if(r!==r)throw e;return r})}function parseAutosize(e){return isObject(e)?e:{type:e||"pad"}}const number=e=>+e||0,paddingObject=e=>({top:e,bottom:e,left:e,right:e});function parsePadding(e){return isObject(e)?e.signal?e:{top:number(e.top),bottom:number(e.bottom),left:number(e.left),right:number(e.right)}:paddingObject(number(e))}const encoder=e=>isObject(e)&&!isArray(e)?extend$1({},e):{value:e};function addEncode(e,n,i,r){return i!=null?(isObject(i)&&!isArray(i)||isArray(i)&&i.length&&isObject(i[0])?e.update[n]=i:e[r||"enter"][n]={value:i},1):0}function addEncoders(e,n,i){for(const r in n)addEncode(e,r,n[r]);for(const r in i)addEncode(e,r,i[r],"update")}function extendEncode(e,n,i){for(const r in n)i&&has$1(i,r)||(e[r]=extend$1(e[r]||{},n[r]));return e}function has(e,n){return n&&(n.enter&&n.enter[e]||n.update&&n.update[e])}const MarkRole="mark",FrameRole="frame",ScopeRole="scope",AxisRole="axis",AxisDomainRole="axis-domain",AxisGridRole="axis-grid",AxisLabelRole="axis-label",AxisTickRole="axis-tick",AxisTitleRole="axis-title",LegendRole="legend",LegendBandRole="legend-band",LegendEntryRole="legend-entry",LegendGradientRole="legend-gradient",LegendLabelRole="legend-label",LegendSymbolRole="legend-symbol",LegendTitleRole="legend-title",TitleRole="title",TitleTextRole="title-text",TitleSubtitleRole="title-subtitle";function applyDefaults(e,n,i,r,s){const o={},l={};let f,d,p,g;d="lineBreak",n==="text"&&s[d]!=null&&!has(d,e)&&applyDefault(o,d,s[d]),(i=="legend"||String(i).startsWith("axis"))&&(i=null),g=i===FrameRole?s.group:i===MarkRole?extend$1({},s.mark,s[n]):null;for(d in g)p=has(d,e)||(d==="fill"||d==="stroke")&&(has("fill",e)||has("stroke",e)),p||applyDefault(o,d,g[d]);array$5(r).forEach(v=>{const S=s.style&&s.style[v];for(const T in S)has(T,e)||applyDefault(o,T,S[T])}),e=extend$1({},e);for(d in o)g=o[d],g.signal?(f=f||{})[d]=g:l[d]=g;return e.enter=extend$1(l,e.enter),f&&(e.update=extend$1(f,e.update)),e}function applyDefault(e,n,i){e[n]=i&&i.signal?{signal:i.signal}:{value:i}}const scaleRef=e=>isString(e)?$(e):e.signal?`(${e.signal})`:field(e);function entry$1(e){if(e.gradient!=null)return gradient$1(e);let n=e.signal?`(${e.signal})`:e.color?color$1(e.color):e.field!=null?field(e.field):e.value!==void 0?$(e.value):void 0;return e.scale!=null&&(n=scale(e,n)),n===void 0&&(n=null),e.exponent!=null&&(n=`pow(${n},${property(e.exponent)})`),e.mult!=null&&(n+=`*${property(e.mult)}`),e.offset!=null&&(n+=`+${property(e.offset)}`),e.round&&(n=`round(${n})`),n}const _color=(e,n,i,r)=>`(${e}(${[n,i,r].map(entry$1).join(",")})+'')`;function color$1(e){return e.c?_color("hcl",e.h,e.c,e.l):e.h||e.s?_color("hsl",e.h,e.s,e.l):e.l||e.a?_color("lab",e.l,e.a,e.b):e.r||e.g||e.b?_color("rgb",e.r,e.g,e.b):null}function gradient$1(e){const n=[e.start,e.stop,e.count].map(i=>i==null?null:$(i));for(;n.length&&peek$1(n)==null;)n.pop();return n.unshift(scaleRef(e.gradient)),`gradient(${n.join(",")})`}function property(e){return isObject(e)?"("+entry$1(e)+")":e}function field(e){return resolveField(isObject(e)?e:{datum:e})}function resolveField(e){let n,i,r;if(e.signal)n="datum",r=e.signal;else if(e.group||e.parent){for(i=Math.max(1,e.level||1),n="item";i-- >0;)n+=".mark.group";e.parent?(r=e.parent,n+=".datum"):r=e.group}else e.datum?(n="datum",r=e.datum):error("Invalid field reference: "+$(e));return e.signal||(r=isString(r)?splitAccessPath(r).map($).join("]["):resolveField(r)),n+"["+r+"]"}function scale(e,n){const i=scaleRef(e.scale);return e.range!=null?n=`lerp(_range(${i}), ${+e.range})`:(n!==void 0&&(n=`_scale(${i}, ${n})`),e.band&&(n=(n?n+"+":"")+`_bandwidth(${i})`+(+e.band==1?"":"*"+property(e.band)),e.extra&&(n=`(datum.extra ? _scale(${i}, datum.extra.value) : ${n})`)),n==null&&(n="0")),n}function rule$1(e){let n="";return e.forEach(i=>{const r=entry$1(i);n+=i.test?`(${i.test})?${r}:`:r}),peek$1(n)===":"&&(n+="null"),n}function parseEncode(e,n,i,r,s,o){const l={};o=o||{},o.encoders={$encode:l},e=applyDefaults(e,n,i,r,s.config);for(const f in e)l[f]=parseBlock(e[f],n,o,s);return o}function parseBlock(e,n,i,r){const s={},o={};for(const l in e)e[l]!=null&&(s[l]=parse$1(expr(e[l]),r,i,o));return{$expr:{marktype:n,channels:s},$fields:Object.keys(o),$output:Object.keys(e)}}function expr(e){return isArray(e)?rule$1(e):entry$1(e)}function parse$1(e,n,i,r){const s=parser(e,n);return s.$fields.forEach(o=>r[o]=1),extend$1(i,s.$params),s.$expr}const OUTER="outer",OUTER_INVALID=["value","update","init","react","bind"];function outerError(e,n){error(e+' for "outer" push: '+$(n))}function parseSignal(e,n){const i=e.name;if(e.push===OUTER)n.signals[i]||outerError("No prior signal definition",i),OUTER_INVALID.forEach(r=>{e[r]!==void 0&&outerError("Invalid property ",r)});else{const r=n.addSignal(i,e.value);e.react===!1&&(r.react=!1),e.bind&&n.addBinding(i,e.bind)}}function Entry$1(e,n,i,r){this.id=-1,this.type=e,this.value=n,this.params=i,r&&(this.parent=r)}function entry(e,n,i,r){return new Entry$1(e,n,i,r)}function operator(e,n){return entry("operator",e,n)}function ref(e){const n={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(n),n}function fieldRef$1(e,n){return n?{$field:e,$name:n}:{$field:e}}const keyFieldRef=fieldRef$1("key");function compareRef(e,n){return{$compare:e,$order:n}}function keyRef(e,n){const i={$key:e};return n&&(i.$flat=!0),i}const Ascending="ascending",Descending="descending";function sortKey(e){return isObject(e)?(e.order===Descending?"-":"+")+aggrField(e.op,e.field):""}function aggrField(e,n){return(e&&e.signal?"$"+e.signal:e||"")+(e&&n?"_":"")+(n&&n.signal?"$"+n.signal:n||"")}const Scope$1="scope",View="view";function isSignal(e){return e&&e.signal}function isExpr$1(e){return e&&e.expr}function hasSignal(e){if(isSignal(e))return!0;if(isObject(e)){for(const n in e)if(hasSignal(e[n]))return!0}return!1}function value(e,n){return e??n}function deref(e){return e&&e.signal||e}const Timer="timer";function parseStream(e,n){return(e.merge?mergeStream:e.stream?nestedStream:e.type?eventStream:error("Invalid stream specification: "+$(e)))(e,n)}function eventSource(e){return e===Scope$1?View:e||View}function mergeStream(e,n){const i=e.merge.map(s=>parseStream(s,n)),r=streamParameters({merge:i},e,n);return n.addStream(r).id}function nestedStream(e,n){const i=parseStream(e.stream,n),r=streamParameters({stream:i},e,n);return n.addStream(r).id}function eventStream(e,n){let i;e.type===Timer?(i=n.event(Timer,e.throttle),e={between:e.between,filter:e.filter}):i=n.event(eventSource(e.source),e.type);const r=streamParameters({stream:i},e,n);return Object.keys(r).length===1?i:n.addStream(r).id}function streamParameters(e,n,i){let r=n.between;return r&&(r.length!==2&&error('Stream "between" parameter must have 2 entries: '+$(n)),e.between=[parseStream(r[0],i),parseStream(r[1],i)]),r=n.filter?[].concat(n.filter):[],(n.marktype||n.markname||n.markrole)&&r.push(filterMark(n.marktype,n.markname,n.markrole)),n.source===Scope$1&&r.push("inScope(event.item)"),r.length&&(e.filter=parser("("+r.join(")&&(")+")",i).$expr),(r=n.throttle)!=null&&(e.throttle=+r),(r=n.debounce)!=null&&(e.debounce=+r),n.consume&&(e.consume=!0),e}function filterMark(e,n,i){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(i?"&&"+r+".mark.role==='"+i+"'":"")+(n?"&&"+r+".mark.name==='"+n+"'":"")}const OP_VALUE_EXPR={code:"_.$value",ast:{type:"Identifier",value:"value"}};function parseUpdate(e,n,i){const r=e.encode,s={target:i};let o=e.events,l=e.update,f=[];o||error("Signal update missing events specification."),isString(o)&&(o=eventSelector(o,n.isSubscope()?Scope$1:View)),o=array$5(o).filter(d=>d.signal||d.scale?(f.push(d),0):1),f.length>1&&(f=[mergeSources(f)]),o.length&&f.push(o.length>1?{merge:o}:o[0]),r!=null&&(l&&error("Signal encode and update are mutually exclusive."),l="encode(item(),"+$(r)+")"),s.update=isString(l)?parser(l,n):l.expr!=null?parser(l.expr,n):l.value!=null?l.value:l.signal!=null?{$expr:OP_VALUE_EXPR,$params:{$value:n.signalRef(l.signal)}}:error("Invalid signal update specification."),e.force&&(s.options={force:!0}),f.forEach(d=>n.addUpdate(extend$1(streamSource(d,n),s)))}function streamSource(e,n){return{source:e.signal?n.signalRef(e.signal):e.scale?n.scaleRef(e.scale):parseStream(e,n)}}function mergeSources(e){return{signal:"["+e.map(n=>n.scale?'scale("'+n.scale+'")':n.signal)+"]"}}function parseSignalUpdates(e,n){const i=n.getSignal(e.name);let r=e.update;e.init&&(r?error("Signals can not include both init and update expressions."):(r=e.init,i.initonly=!0)),r&&(r=parser(r,n),i.update=r.$expr,i.params=r.$params),e.on&&e.on.forEach(s=>parseUpdate(s,n,i.id))}const transform=e=>(n,i,r)=>entry(e,i,n||void 0,r),Aggregate=transform("aggregate"),AxisTicks=transform("axisticks"),Bound=transform("bound"),Collect=transform("collect"),Compare=transform("compare"),DataJoin=transform("datajoin"),Encode=transform("encode"),Expression=transform("expression"),Facet=transform("facet"),Field=transform("field"),Key=transform("key"),LegendEntries=transform("legendentries"),Load=transform("load"),Mark$1=transform("mark"),MultiExtent=transform("multiextent"),MultiValues=transform("multivalues"),Overlap=transform("overlap"),Params=transform("params"),PreFacet=transform("prefacet"),Projection=transform("projection"),Proxy$1=transform("proxy"),Relay=transform("relay"),Render=transform("render"),Scale=transform("scale"),Sieve=transform("sieve"),SortItems=transform("sortitems"),ViewLayout=transform("viewlayout"),Values=transform("values");let FIELD_REF_ID=0;const MULTIDOMAIN_SORT_OPS={min:"min",max:"max",count:"sum"};function initScale(e,n){const i=e.type||"linear";isValidScaleType(i)||error("Unrecognized scale type: "+$(i)),n.addScale(e.name,{type:i,domain:void 0})}function parseScale(e,n){const i=n.getScale(e.name).params;let r;i.domain=parseScaleDomain$1(e.domain,e,n),e.range!=null&&(i.range=parseScaleRange$1(e,n,i)),e.interpolate!=null&&parseScaleInterpolate(e.interpolate,i),e.nice!=null&&(i.nice=parseScaleNice(e.nice)),e.bins!=null&&(i.bins=parseScaleBins(e.bins,n));for(r in e)has$1(i,r)||r==="name"||(i[r]=parseLiteral(e[r],n))}function parseLiteral(e,n){return isObject(e)?e.signal?n.signalRef(e.signal):error("Unsupported object: "+$(e)):e}function parseArray(e,n){return e.signal?n.signalRef(e.signal):e.map(i=>parseLiteral(i,n))}function dataLookupError(e){error("Can not find data set: "+$(e))}function parseScaleDomain$1(e,n,i){if(!e){(n.domainMin!=null||n.domainMax!=null)&&error("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?i.signalRef(e.signal):(isArray(e)?explicitDomain:e.fields?multipleDomain:singularDomain)(e,n,i)}function explicitDomain(e,n,i){return e.map(r=>parseLiteral(r,i))}function singularDomain(e,n,i){const r=i.getData(e.data);return r||dataLookupError(e.data),isDiscrete$2(n.type)?r.valuesRef(i,e.field,parseSort(e.sort,!1)):isQuantile$1(n.type)?r.domainRef(i,e.field):r.extentRef(i,e.field)}function multipleDomain(e,n,i){const r=e.data,s=e.fields.reduce((o,l)=>(l=isString(l)?{data:r,field:l}:isArray(l)||l.signal?fieldRef(l,i):l,o.push(l),o),[]);return(isDiscrete$2(n.type)?ordinalMultipleDomain:isQuantile$1(n.type)?quantileMultipleDomain:numericMultipleDomain)(e,i,s)}function fieldRef(e,n){const i="_:vega:_"+FIELD_REF_ID++,r=Collect({});if(isArray(e))r.value={$ingest:e};else if(e.signal){const s="setdata("+$(i)+","+e.signal+")";r.params.input=n.signalRef(s)}return n.addDataPipeline(i,[r,Sieve({})]),{data:i,field:"data"}}function ordinalMultipleDomain(e,n,i){const r=parseSort(e.sort,!0);let s,o;const l=i.map(p=>{const g=n.getData(p.data);return g||dataLookupError(p.data),g.countsRef(n,p.field,r)}),f={groupby:keyFieldRef,pulse:l};r&&(s=r.op||"count",o=r.field?aggrField(s,r.field):"count",f.ops=[MULTIDOMAIN_SORT_OPS[s]],f.fields=[n.fieldRef(o)],f.as=[o]),s=n.add(Aggregate(f));const d=n.add(Collect({pulse:ref(s)}));return o=n.add(Values({field:keyFieldRef,sort:n.sortRef(r),pulse:ref(d)})),ref(o)}function parseSort(e,n){return e&&(!e.field&&!e.op?isObject(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?error("No field provided for sort aggregate op: "+e.op):n&&e.field&&e.op&&!MULTIDOMAIN_SORT_OPS[e.op]&&error("Multiple domain scales can not be sorted using "+e.op)),e}function quantileMultipleDomain(e,n,i){const r=i.map(s=>{const o=n.getData(s.data);return o||dataLookupError(s.data),o.domainRef(n,s.field)});return ref(n.add(MultiValues({values:r})))}function numericMultipleDomain(e,n,i){const r=i.map(s=>{const o=n.getData(s.data);return o||dataLookupError(s.data),o.extentRef(n,s.field)});return ref(n.add(MultiExtent({extents:r})))}function parseScaleBins(e,n){return e.signal||isArray(e)?parseArray(e,n):n.objectProperty(e)}function parseScaleNice(e){return isObject(e)?{interval:parseLiteral(e.interval),step:parseLiteral(e.step)}:parseLiteral(e)}function parseScaleInterpolate(e,n){n.interpolate=parseLiteral(e.type||e),e.gamma!=null&&(n.interpolateGamma=parseLiteral(e.gamma))}function parseScaleRange$1(e,n,i){const r=n.config.range;let s=e.range;if(s.signal)return n.signalRef(s.signal);if(isString(s)){if(r&&has$1(r,s))return e=extend$1({},e,{range:r[s]}),parseScaleRange$1(e,n,i);s==="width"?s=[0,{signal:"width"}]:s==="height"?s=isDiscrete$2(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:error("Unrecognized scale range value: "+$(s))}else if(s.scheme){i.scheme=isArray(s.scheme)?parseArray(s.scheme,n):parseLiteral(s.scheme,n),s.extent&&(i.schemeExtent=parseArray(s.extent,n)),s.count&&(i.schemeCount=parseLiteral(s.count,n));return}else if(s.step){i.rangeStep=parseLiteral(s.step,n);return}else{if(isDiscrete$2(e.type)&&!isArray(s))return parseScaleDomain$1(s,e,n);isArray(s)||error("Unsupported range type: "+$(s))}return s.map(o=>(isArray(o)?parseArray:parseLiteral)(o,n))}function parseProjection$1(e,n){const i=n.config.projection||{},r={};for(const s in e)s!=="name"&&(r[s]=parseParameter$1(e[s],s,n));for(const s in i)r[s]==null&&(r[s]=parseParameter$1(i[s],s,n));n.addProjection(e.name,r)}function parseParameter$1(e,n,i){return isArray(e)?e.map(r=>parseParameter$1(r,n,i)):isObject(e)?e.signal?i.signalRef(e.signal):n==="fit"?e:error("Unsupported parameter object: "+$(e)):e}const Top="top",Left="left",Right="right",Bottom="bottom",Center="center",Vertical="vertical",Start="start",Middle="middle",End="end",Index="index",Label="label",Offset="offset",Perc="perc",Perc2="perc2",Value="value",GuideLabelStyle="guide-label",GuideTitleStyle="guide-title",GroupTitleStyle="group-title",GroupSubtitleStyle="group-subtitle",Symbols="symbol",Gradient="gradient",Discrete="discrete",Size="size",Shape="shape",Fill="fill",Stroke="stroke",StrokeWidth="strokeWidth",StrokeDash="strokeDash",Opacity="opacity",LegendScales=[Size,Shape,Fill,Stroke,StrokeWidth,StrokeDash,Opacity],Skip={name:1,style:1,interactive:1},zero$1={value:0},one={value:1},GroupMark="group",RectMark="rect",RuleMark="rule",SymbolMark="symbol",TextMark="text";function guideGroup(e){return e.type=GroupMark,e.interactive=e.interactive||!1,e}function lookup(e,n){const i=(r,s)=>value(e[r],value(n[r],s));return i.isVertical=r=>Vertical===value(e.direction,n.direction||(r?n.symbolDirection:n.gradientDirection)),i.gradientLength=()=>value(e.gradientLength,n.gradientLength||n.gradientWidth),i.gradientThickness=()=>value(e.gradientThickness,n.gradientThickness||n.gradientHeight),i.entryColumns=()=>value(e.columns,value(n.columns,+i.isVertical(!0))),i}function getEncoding(e,n){const i=n&&(n.update&&n.update[e]||n.enter&&n.enter[e]);return i&&i.signal?i:i?i.value:null}function getStyle(e,n,i){const r=n.config.style[i];return r&&r[e]}function anchorExpr(e,n,i){return`item.anchor === '${Start}' ? ${e} : item.anchor === '${End}' ? ${n} : ${i}`}const alignExpr$1=anchorExpr($(Left),$(Right),$(Center));function tickBand(e){const n=e("tickBand");let i=e("tickOffset"),r,s;return n?n.signal?(r={signal:`(${n.signal}) === 'extent' ? 1 : 0.5`},s={signal:`(${n.signal}) === 'extent'`},isObject(i)||(i={signal:`(${n.signal}) === 'extent' ? 0 : ${i}`})):n==="extent"?(r=1,s=!0,i=0):(r=.5,s=!1):(r=e("bandPosition"),s=e("tickExtra")),{extra:s,band:r,offset:i}}function extendOffset(e,n){return n?e?isObject(e)?Object.assign({},e,{offset:extendOffset(e.offset,n)}):{value:e,offset:n}:n:e}function guideMark(e,n){return n?(e.name=n.name,e.style=n.style||e.style,e.interactive=!!n.interactive,e.encode=extendEncode(e.encode,n,Skip)):e.interactive=!1,e}function legendGradient(e,n,i,r){const s=lookup(e,i),o=s.isVertical(),l=s.gradientThickness(),f=s.gradientLength();let d,p,g,v,S;o?(p=[0,1],g=[0,0],v=l,S=f):(p=[0,0],g=[1,0],v=f,S=l);const T={enter:d={opacity:zero$1,x:zero$1,y:zero$1,width:encoder(v),height:encoder(S)},update:extend$1({},d,{opacity:one,fill:{gradient:n,start:p,stop:g}}),exit:{opacity:zero$1}};return addEncoders(T,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),guideMark({type:RectMark,role:LegendGradientRole,encode:T},r)}function legendGradientDiscrete(e,n,i,r,s){const o=lookup(e,i),l=o.isVertical(),f=o.gradientThickness(),d=o.gradientLength();let p,g,v,S,T="";l?(p="y",v="y2",g="x",S="width",T="1-"):(p="x",v="x2",g="y",S="height");const k={opacity:zero$1,fill:{scale:n,field:Value}};k[p]={signal:T+"datum."+Perc,mult:d},k[g]=zero$1,k[v]={signal:T+"datum."+Perc2,mult:d},k[S]=encoder(f);const O={enter:k,update:extend$1({},k,{opacity:one}),exit:{opacity:zero$1}};return addEncoders(O,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),guideMark({type:RectMark,role:LegendBandRole,key:Value,from:s,encode:O},r)}const alignExpr=`datum.${Perc}<=0?"${Left}":datum.${Perc}>=1?"${Right}":"${Center}"`,baselineExpr=`datum.${Perc}<=0?"${Bottom}":datum.${Perc}>=1?"${Top}":"${Middle}"`;function legendGradientLabels(e,n,i,r){const s=lookup(e,n),o=s.isVertical(),l=encoder(s.gradientThickness()),f=s.gradientLength();let d=s("labelOverlap"),p,g,v,S,T="";const k={enter:p={opacity:zero$1},update:g={opacity:one,text:{field:Label}},exit:{opacity:zero$1}};return addEncoders(k,{fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:value(e.labelLimit,n.gradientLabelLimit)}),o?(p.align={value:"left"},p.baseline=g.baseline={signal:baselineExpr},v="y",S="x",T="1-"):(p.align=g.align={signal:alignExpr},p.baseline={value:"top"},v="x",S="y"),p[v]=g[v]={signal:T+"datum."+Perc,mult:f},p[S]=g[S]=l,l.offset=value(e.labelOffset,n.gradientLabelOffset)||0,d=d?{separation:s("labelSeparation"),method:d,order:"datum."+Index}:void 0,guideMark({type:TextMark,role:LegendLabelRole,style:GuideLabelStyle,key:Value,from:r,encode:k,overlap:d},i)}function legendSymbolGroups(e,n,i,r,s){const o=lookup(e,n),l=i.entries,f=!!(l&&l.interactive),d=l?l.name:void 0,p=o("clipHeight"),g=o("symbolOffset"),v={data:"value"},S=`(${s}) ? datum.${Offset} : datum.${Size}`,T=p?encoder(p):{field:Size},k=`datum.${Index}`,O=`max(1, ${s})`;let R,P,F,I,L;T.mult=.5,R={enter:P={opacity:zero$1,x:{signal:S,mult:.5,offset:g},y:T},update:F={opacity:one,x:P.x,y:P.y},exit:{opacity:zero$1}};let N=null,j=null;e.fill||(N=n.symbolBaseFillColor,j=n.symbolBaseStrokeColor),addEncoders(R,{fill:o("symbolFillColor",N),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",j),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),LegendScales.forEach(W=>{e[W]&&(F[W]=P[W]={scale:e[W],field:Value})});const z=guideMark({type:SymbolMark,role:LegendSymbolRole,key:Value,from:v,clip:p?!0:void 0,encode:R},i.symbols),q=encoder(g);q.offset=o("labelOffset"),R={enter:P={opacity:zero$1,x:{signal:S,offset:q},y:T},update:F={opacity:one,text:{field:Label},x:P.x,y:P.y},exit:{opacity:zero$1}},addEncoders(R,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const H=guideMark({type:TextMark,role:LegendLabelRole,style:GuideLabelStyle,key:Value,from:v,encode:R},i.labels);return R={enter:{noBound:{value:!p},width:zero$1,height:p?encoder(p):zero$1,opacity:zero$1},exit:{opacity:zero$1},update:F={opacity:one,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(I=`ceil(item.mark.items.length / ${O})`,F.row.signal=`${k}%${I}`,F.column.signal=`floor(${k} / ${I})`,L={field:["row",k]}):(F.row.signal=`floor(${k} / ${O})`,F.column.signal=`${k} % ${O}`,L={field:k}),F.column.signal=`(${s})?${F.column.signal}:${k}`,r={facet:{data:r,name:"value",groupby:Index}},guideGroup({role:ScopeRole,from:r,encode:extendEncode(R,l,Skip),marks:[z,H],name:d,interactive:f,sort:L})}function legendSymbolLayout(e,n){const i=lookup(e,n);return{align:i("gridAlign"),columns:i.entryColumns(),center:{row:!0,column:!1},padding:{row:i("rowPadding"),column:i("columnPadding")}}}const isL='item.orient === "left"',isR='item.orient === "right"',isLR=`(${isL} || ${isR})`,isVG=`datum.vgrad && ${isLR}`,baseline$1=anchorExpr('"top"','"bottom"','"middle"'),alignFlip=anchorExpr('"right"','"left"','"center"'),exprAlign=`datum.vgrad && ${isR} ? (${alignFlip}) : (${isLR} && !(datum.vgrad && ${isL})) ? "left" : ${alignExpr$1}`,exprAnchor=`item._anchor || (${isLR} ? "middle" : "start")`,exprAngle=`${isVG} ? (${isL} ? -90 : 90) : 0`,exprBaseline=`${isLR} ? (datum.vgrad ? (${isR} ? "bottom" : "top") : ${baseline$1}) : "top"`;function legendTitle(e,n,i,r){const s=lookup(e,n),o={enter:{opacity:zero$1},update:{opacity:one,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:zero$1}};return addEncoders(o,{orient:s("titleOrient"),_anchor:s("titleAnchor"),anchor:{signal:exprAnchor},angle:{signal:exprAngle},align:{signal:exprAlign},baseline:{signal:exprBaseline},text:e.title,fill:s("titleColor"),fillOpacity:s("titleOpacity"),font:s("titleFont"),fontSize:s("titleFontSize"),fontStyle:s("titleFontStyle"),fontWeight:s("titleFontWeight"),limit:s("titleLimit"),lineHeight:s("titleLineHeight")},{align:s("titleAlign"),baseline:s("titleBaseline")}),guideMark({type:TextMark,role:LegendTitleRole,style:GuideTitleStyle,from:r,encode:o},i)}function clip(e,n){let i;return isObject(e)&&(e.signal?i=e.signal:e.path?i="pathShape("+param(e.path)+")":e.sphere&&(i="geoShape("+param(e.sphere)+', {type: "Sphere"})')),i?n.signalRef(i):!!e}function param(e){return isObject(e)&&e.signal?e.signal:$(e)}function getRole(e){const n=e.role||"";return!n.indexOf("axis")||!n.indexOf("legend")||!n.indexOf("title")?n:e.type===GroupMark?ScopeRole:n||MarkRole}function definition(e){return{marktype:e.type,name:e.name||void 0,role:e.role||getRole(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function interactive(e,n){return e&&e.signal?n.signalRef(e.signal):e!==!1}function parseTransform(e,n){const i=definition$1(e.type);i||error("Unrecognized transform type: "+$(e.type));const r=entry(i.type.toLowerCase(),null,parseParameters(i,e,n));return e.signal&&n.addSignal(e.signal,n.proxy(r)),r.metadata=i.metadata||{},r}function parseParameters(e,n,i){const r={},s=e.params.length;for(let o=0;o<s;++o){const l=e.params[o];r[l.name]=parseParameter(l,n,i)}return r}function parseParameter(e,n,i){const r=e.type,s=n[e.name];if(r==="index")return parseIndexParameter(e,n,i);if(s===void 0){e.required&&error("Missing required "+$(n.type)+" parameter: "+$(e.name));return}else{if(r==="param")return parseSubParameters(e,n,i);if(r==="projection")return i.projectionRef(n[e.name])}return e.array&&!isSignal(s)?s.map(o=>parameterValue(e,o,i)):parameterValue(e,s,i)}function parameterValue(e,n,i){const r=e.type;if(isSignal(n))return isExpr(r)?error("Expression references can not be signals."):isField(r)?i.fieldRef(n):isCompare(r)?i.compareRef(n):i.signalRef(n.signal);{const s=e.expr||isField(r);return s&&outerExpr(n)?i.exprRef(n.expr,n.as):s&&outerField(n)?fieldRef$1(n.field,n.as):isExpr(r)?parser(n,i):isData(r)?ref(i.getData(n).values):isField(r)?fieldRef$1(n):isCompare(r)?i.compareRef(n):n}}function parseIndexParameter(e,n,i){return isString(n.from)||error('Lookup "from" parameter must be a string literal.'),i.getData(n.from).lookupRef(i,n.key)}function parseSubParameters(e,n,i){const r=n[e.name];return e.array?(isArray(r)||error("Expected an array of sub-parameters. Instead: "+$(r)),r.map(s=>parseSubParameter(e,s,i))):parseSubParameter(e,r,i)}function parseSubParameter(e,n,i){const r=e.params.length;let s;for(let l=0;l<r;++l){s=e.params[l];for(const f in s.key)if(s.key[f]!==n[f]){s=null;break}if(s)break}s||error("Unsupported parameter: "+$(n));const o=extend$1(parseParameters(s,n,i),s.key);return ref(i.add(Params(o)))}const outerExpr=e=>e&&e.expr,outerField=e=>e&&e.field,isData=e=>e==="data",isExpr=e=>e==="expr",isField=e=>e==="field",isCompare=e=>e==="compare";function parseData$1(e,n,i){let r,s,o,l,f;return e?(r=e.facet)&&(n||error("Only group marks can be faceted."),r.field!=null?l=f=getDataRef(r,i):(e.data?f=ref(i.getData(e.data).aggregate):(o=parseTransform(extend$1({type:"aggregate",groupby:array$5(r.groupby)},r.aggregate),i),o.params.key=i.keyRef(r.groupby),o.params.pulse=getDataRef(r,i),l=f=ref(i.add(o))),s=i.keyRef(r.groupby,!0))):l=ref(i.add(Collect(null,[{}]))),l||(l=getDataRef(e,i)),{key:s,pulse:l,parent:f}}function getDataRef(e,n){return e.$ref?e:e.data&&e.data.$ref?e.data:ref(n.getData(e.data).output)}function DataScope(e,n,i,r,s){this.scope=e,this.input=n,this.output=i,this.values=r,this.aggregate=s,this.index={}}DataScope.fromEntries=function(e,n){const i=n.length,r=n[i-1],s=n[i-2];let o=n[0],l=null,f=1;for(o&&o.type==="load"&&(o=n[1]),e.add(n[0]);f<i;++f)n[f].params.pulse=ref(n[f-1]),e.add(n[f]),n[f].type==="aggregate"&&(l=n[f]);return new DataScope(e,o,s,r,l)};function fieldKey(e){return isString(e)?e:null}function addSortField(e,n,i){const r=aggrField(i.op,i.field);let s;if(n.ops){for(let o=0,l=n.as.length;o<l;++o)if(n.as[o]===r)return}else n.ops=["count"],n.fields=[null],n.as=["count"];i.op&&(n.ops.push((s=i.op.signal)?e.signalRef(s):i.op),n.fields.push(e.fieldRef(i.field)),n.as.push(r))}function cache(e,n,i,r,s,o,l){const f=n[i]||(n[i]={}),d=sortKey(o);let p=fieldKey(s),g,v;if(p!=null&&(e=n.scope,p=p+(d?"|"+d:""),g=f[p]),!g){const S=o?{field:keyFieldRef,pulse:n.countsRef(e,s,o)}:{field:e.fieldRef(s),pulse:ref(n.output)};d&&(S.sort=e.sortRef(o)),v=e.add(entry(r,void 0,S)),l&&(n.index[s]=v),g=ref(v),p!=null&&(f[p]=g)}return g}DataScope.prototype={countsRef(e,n,i){const r=this,s=r.counts||(r.counts={}),o=fieldKey(n);let l,f,d;return o!=null&&(e=r.scope,l=s[o]),l?i&&i.field&&addSortField(e,l.agg.params,i):(d={groupby:e.fieldRef(n,"key"),pulse:ref(r.output)},i&&i.field&&addSortField(e,d,i),f=e.add(Aggregate(d)),l=e.add(Collect({pulse:ref(f)})),l={agg:f,ref:ref(l)},o!=null&&(s[o]=l)),l.ref},tuplesRef(){return ref(this.values)},extentRef(e,n){return cache(e,this,"extent","extent",n,!1)},domainRef(e,n){return cache(e,this,"domain","values",n,!1)},valuesRef(e,n,i){return cache(e,this,"vals","values",n,i||!0)},lookupRef(e,n){return cache(e,this,"lookup","tupleindex",n,!1)},indataRef(e,n){return cache(e,this,"indata","tupleindex",n,!0,!0)}};function parseFacet(e,n,i){const r=e.from.facet,s=r.name,o=getDataRef(r,n);let l;r.name||error("Facet must have a name: "+$(r)),r.data||error("Facet must reference a data set: "+$(r)),r.field?l=n.add(PreFacet({field:n.fieldRef(r.field),pulse:o})):r.groupby?l=n.add(Facet({key:n.keyRef(r.groupby),group:ref(n.proxy(i.parent)),pulse:o})):error("Facet must specify groupby or field: "+$(r));const f=n.fork(),d=f.add(Collect()),p=f.add(Sieve({pulse:ref(d)}));f.addData(s,new DataScope(f,d,d,p)),f.addSignal("parent",null),l.params.subflow={$subflow:f.parse(e).toRuntime()}}function parseSubflow(e,n,i){const r=n.add(PreFacet({pulse:i.pulse})),s=n.fork();s.add(Sieve()),s.addSignal("parent",null),r.params.subflow={$subflow:s.parse(e).toRuntime()}}function parseTrigger(e,n,i){const r=e.remove,s=e.insert,o=e.toggle,l=e.modify,f=e.values,d=n.add(operator()),p="if("+e.trigger+',modify("'+i+'",'+[s,r,o,l,f].map(v=>v??"null").join(",")+"),0)",g=parser(p,n);d.update=g.$expr,d.params=g.$params}function parseMark(e,n){const i=getRole(e),r=e.type===GroupMark,s=e.from&&e.from.facet,o=e.overlap;let l=e.layout||i===ScopeRole||i===FrameRole,f,d,p,g,v,S,T;const k=i===MarkRole||l||s,O=parseData$1(e.from,r,n);d=n.add(DataJoin({key:O.key||(e.key?fieldRef$1(e.key):void 0),pulse:O.pulse,clean:!r}));const R=ref(d);d=p=n.add(Collect({pulse:R})),d=n.add(Mark$1({markdef:definition(e),interactive:interactive(e.interactive,n),clip:clip(e.clip,n),context:{$context:!0},groups:n.lookup(),parent:n.signals.parent?n.signalRef("parent"):null,index:n.markpath(),pulse:ref(d)}));const P=ref(d);d=g=n.add(Encode(parseEncode(e.encode,e.type,i,e.style,n,{mod:!1,pulse:P}))),d.params.parent=n.encode(),e.transform&&e.transform.forEach(j=>{const z=parseTransform(j,n),q=z.metadata;(q.generates||q.changes)&&error("Mark transforms should not generate new data."),q.nomod||(g.params.mod=!0),z.params.pulse=ref(d),n.add(d=z)}),e.sort&&(d=n.add(SortItems({sort:n.compareRef(e.sort),pulse:ref(d)})));const F=ref(d);(s||l)&&(l=n.add(ViewLayout({layout:n.objectProperty(e.layout),legends:n.legends,mark:P,pulse:F})),S=ref(l));const I=n.add(Bound({mark:P,pulse:S||F}));T=ref(I),r&&(k&&(f=n.operators,f.pop(),l&&f.pop()),n.pushState(F,S||T,R),s?parseFacet(e,n,O):k?parseSubflow(e,n,O):n.parse(e),n.popState(),k&&(l&&f.push(l),f.push(I))),o&&(T=parseOverlap(o,T,n));const L=n.add(Render({pulse:T})),N=n.add(Sieve({pulse:ref(L)},void 0,n.parent()));e.name!=null&&(v=e.name,n.addData(v,new DataScope(n,p,L,N)),e.on&&e.on.forEach(j=>{(j.insert||j.remove||j.toggle)&&error("Marks only support modify triggers."),parseTrigger(j,n,v)}))}function parseOverlap(e,n,i){const r=e.method,s=e.bound,o=e.separation,l={separation:isSignal(o)?i.signalRef(o.signal):o,method:isSignal(r)?i.signalRef(r.signal):r,pulse:n};if(e.order&&(l.sort=i.compareRef({field:e.order})),s){const f=s.tolerance;l.boundTolerance=isSignal(f)?i.signalRef(f.signal):+f,l.boundScale=i.scaleRef(s.scale),l.boundOrient=s.orient}return ref(i.add(Overlap(l)))}function parseLegend$1(e,n){const i=n.config.legend,r=e.encode||{},s=lookup(e,i),o=r.legend||{},l=o.name||void 0,f=o.interactive,d=o.style,p={};let g=0,v,S,T;LegendScales.forEach(I=>e[I]?(p[I]=e[I],g=g||e[I]):0),g||error("Missing valid scale for legend.");const k=legendType(e,n.scaleType(g)),O={title:e.title!=null,scales:p,type:k,vgrad:k!=="symbol"&&s.isVertical()},R=ref(n.add(Collect(null,[O]))),P={enter:{x:{value:0},y:{value:0}}},F=ref(n.add(LegendEntries(S={type:k,scale:n.scaleRef(g),count:n.objectProperty(s("tickCount")),limit:n.property(s("symbolLimit")),values:n.objectProperty(e.values),minstep:n.property(e.tickMinStep),formatType:n.property(e.formatType),formatSpecifier:n.property(e.format)})));return k===Gradient?(T=[legendGradient(e,g,i,r.gradient),legendGradientLabels(e,i,r.labels,F)],S.count=S.count||n.signalRef(`max(2,2*floor((${deref(s.gradientLength())})/100))`)):k===Discrete?T=[legendGradientDiscrete(e,g,i,r.gradient,F),legendGradientLabels(e,i,r.labels,F)]:(v=legendSymbolLayout(e,i),T=[legendSymbolGroups(e,i,r,F,deref(v.columns))],S.size=sizeExpression(e,n,T[0].marks)),T=[guideGroup({role:LegendEntryRole,from:R,encode:P,marks:T,layout:v,interactive:f})],O.title&&T.push(legendTitle(e,i,r.title,R)),parseMark(guideGroup({role:LegendRole,from:R,encode:extendEncode(buildLegendEncode(s,e,i),o,Skip),marks:T,aria:s("aria"),description:s("description"),zindex:s("zindex"),name:l,interactive:f,style:d}),n)}function legendType(e,n){let i=e.type||Symbols;return!e.type&&scaleCount(e)===1&&(e.fill||e.stroke)&&(i=isContinuous$1(n)?Gradient:isDiscretizing$1(n)?Discrete:Symbols),i!==Gradient?i:isDiscretizing$1(n)?Discrete:Gradient}function scaleCount(e){return LegendScales.reduce((n,i)=>n+(e[i]?1:0),0)}function buildLegendEncode(e,n,i){const r={enter:{},update:{}};return addEncoders(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:i.strokeWidth,strokeDash:i.strokeDash,x:e("legendX"),y:e("legendY"),format:n.format,formatType:n.formatType}),r}function sizeExpression(e,n,i){const r=deref(getChannel("size",e,i)),s=deref(getChannel("strokeWidth",e,i)),o=deref(getFontSize(i[1].encode,n,GuideLabelStyle));return parser(`max(ceil(sqrt(${r})+${s}),${o})`,n)}function getChannel(e,n,i){return n[e]?`scale("${n[e]}",datum)`:getEncoding(e,i[0].encode)}function getFontSize(e,n,i){return getEncoding("fontSize",e)||getStyle("fontSize",n,i)}const angleExpr=`item.orient==="${Left}"?-90:item.orient==="${Right}"?90:0`;function parseTitle(e,n){e=isString(e)?{text:e}:e;const i=lookup(e,n.config.title),r=e.encode||{},s=r.group||{},o=s.name||void 0,l=s.interactive,f=s.style,d=[],p={},g=ref(n.add(Collect(null,[p])));return d.push(buildTitle(e,i,titleEncode(e),g)),e.subtitle&&d.push(buildSubTitle(e,i,r.subtitle,g)),parseMark(guideGroup({role:TitleRole,from:g,encode:groupEncode(i,s),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:l,style:f}),n)}function titleEncode(e){const n=e.encode;return n&&n.title||extend$1({name:e.name,interactive:e.interactive,style:e.style},n)}function groupEncode(e,n){const i={enter:{},update:{}};return addEncoders(i,{orient:e("orient"),anchor:e("anchor"),align:{signal:alignExpr$1},angle:{signal:angleExpr},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),extendEncode(i,n,Skip)}function buildTitle(e,n,i,r){const s={value:0},o=e.text,l={enter:{opacity:s},update:{opacity:{value:1}},exit:{opacity:s}};return addEncoders(l,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:n("dx"),dy:n("dy"),fill:n("color"),font:n("font"),fontSize:n("fontSize"),fontStyle:n("fontStyle"),fontWeight:n("fontWeight"),lineHeight:n("lineHeight")},{align:n("align"),angle:n("angle"),baseline:n("baseline")}),guideMark({type:TextMark,role:TitleTextRole,style:GroupTitleStyle,from:r,encode:l},i)}function buildSubTitle(e,n,i,r){const s={value:0},o=e.subtitle,l={enter:{opacity:s},update:{opacity:{value:1}},exit:{opacity:s}};return addEncoders(l,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:n("dx"),dy:n("dy"),fill:n("subtitleColor"),font:n("subtitleFont"),fontSize:n("subtitleFontSize"),fontStyle:n("subtitleFontStyle"),fontWeight:n("subtitleFontWeight"),lineHeight:n("subtitleLineHeight")},{align:n("align"),angle:n("angle"),baseline:n("baseline")}),guideMark({type:TextMark,role:TitleSubtitleRole,style:GroupSubtitleStyle,from:r,encode:l},i)}function parseData$2(e,n){const i=[];e.transform&&e.transform.forEach(r=>{i.push(parseTransform(r,n))}),e.on&&e.on.forEach(r=>{parseTrigger(r,n,e.name)}),n.addDataPipeline(e.name,analyze(e,n,i))}function analyze(e,n,i){const r=[];let s=null,o=!1,l=!1,f,d,p,g,v;for(e.values?isSignal(e.values)||hasSignal(e.format)?(r.push(load(n,e)),r.push(s=collect())):r.push(s=collect({$ingest:e.values,$format:e.format})):e.url?hasSignal(e.url)||hasSignal(e.format)?(r.push(load(n,e)),r.push(s=collect())):r.push(s=collect({$request:e.url,$format:e.format})):e.source&&(s=f=array$5(e.source).map(S=>ref(n.getData(S).output)),r.push(null)),d=0,p=i.length;d<p;++d)g=i[d],v=g.metadata,!s&&!v.source&&r.push(s=collect()),r.push(g),v.generates&&(l=!0),v.modifies&&!l&&(o=!0),v.source?s=g:v.changes&&(s=null);return f&&(p=f.length-1,r[0]=Relay({derive:o,pulse:p?f:f[0]}),(o||p)&&r.splice(1,0,collect())),s||r.push(collect()),r.push(Sieve({})),r}function collect(e){const n=Collect({},e);return n.metadata={source:!0},n}function load(e,n){return Load({url:n.url?e.property(n.url):void 0,async:n.async?e.property(n.async):void 0,values:n.values?e.property(n.values):void 0,format:e.objectProperty(n.format)})}const isX=e=>e===Bottom||e===Top,getSign=(e,n,i)=>isSignal(e)?ifLeftTopExpr(e.signal,n,i):e===Left||e===Top?n:i,ifX=(e,n,i)=>isSignal(e)?ifXEnc(e.signal,n,i):isX(e)?n:i,ifY=(e,n,i)=>isSignal(e)?ifYEnc(e.signal,n,i):isX(e)?i:n,ifTop=(e,n,i)=>isSignal(e)?ifTopExpr(e.signal,n,i):e===Top?{value:n}:{value:i},ifRight=(e,n,i)=>isSignal(e)?ifRightExpr(e.signal,n,i):e===Right?{value:n}:{value:i},ifXEnc=(e,n,i)=>ifEnc(`${e} === '${Top}' || ${e} === '${Bottom}'`,n,i),ifYEnc=(e,n,i)=>ifEnc(`${e} !== '${Top}' && ${e} !== '${Bottom}'`,n,i),ifLeftTopExpr=(e,n,i)=>ifExpr(`${e} === '${Left}' || ${e} === '${Top}'`,n,i),ifTopExpr=(e,n,i)=>ifExpr(`${e} === '${Top}'`,n,i),ifRightExpr=(e,n,i)=>ifExpr(`${e} === '${Right}'`,n,i),ifEnc=(e,n,i)=>(n=n!=null?encoder(n):n,i=i!=null?encoder(i):i,isSimple(n)&&isSimple(i)?(n=n?n.signal||$(n.value):null,i=i?i.signal||$(i.value):null,{signal:`${e} ? (${n}) : (${i})`}):[extend$1({test:e},n)].concat(i||[])),isSimple=e=>e==null||Object.keys(e).length===1,ifExpr=(e,n,i)=>({signal:`${e} ? (${toExpr(n)}) : (${toExpr(i)})`}),ifOrient=(e,n,i,r,s)=>({signal:(r!=null?`${e} === '${Left}' ? (${toExpr(r)}) : `:"")+(i!=null?`${e} === '${Bottom}' ? (${toExpr(i)}) : `:"")+(s!=null?`${e} === '${Right}' ? (${toExpr(s)}) : `:"")+(n!=null?`${e} === '${Top}' ? (${toExpr(n)}) : `:"")+"(null)"}),toExpr=e=>isSignal(e)?e.signal:e==null?null:$(e),mult=(e,n)=>n===0?0:isSignal(e)?{signal:`(${e.signal}) * ${n}`}:{value:e*n},patch=(e,n)=>{const i=e.signal;return i&&i.endsWith("(null)")?{signal:i.slice(0,-6)+n.signal}:e};function fallback(e,n,i,r){let s;if(n&&has$1(n,e))return n[e];if(has$1(i,e))return i[e];if(e.startsWith("title")){switch(e){case"titleColor":s="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":s=e[5].toLowerCase()+e.slice(6)}return r[GuideTitleStyle][s]}else if(e.startsWith("label")){switch(e){case"labelColor":s="fill";break;case"labelFont":case"labelFontSize":s=e[5].toLowerCase()+e.slice(6)}return r[GuideLabelStyle][s]}return null}function keys$2(e){const n={};for(const i of e)if(i)for(const r in i)n[r]=1;return Object.keys(n)}function axisConfig(e,n){var i=n.config,r=i.style,s=i.axis,o=n.scaleType(e.scale)==="band"&&i.axisBand,l=e.orient,f,d,p;if(isSignal(l)){const v=keys$2([i.axisX,i.axisY]),S=keys$2([i.axisTop,i.axisBottom,i.axisLeft,i.axisRight]);f={};for(p of v)f[p]=ifX(l,fallback(p,i.axisX,s,r),fallback(p,i.axisY,s,r));d={};for(p of S)d[p]=ifOrient(l.signal,fallback(p,i.axisTop,s,r),fallback(p,i.axisBottom,s,r),fallback(p,i.axisLeft,s,r),fallback(p,i.axisRight,s,r))}else f=l===Top||l===Bottom?i.axisX:i.axisY,d=i["axis"+l[0].toUpperCase()+l.slice(1)];return f||d||o?extend$1({},s,f,d,o):s}function axisDomain(e,n,i,r){const s=lookup(e,n),o=e.orient;let l,f;const d={enter:l={opacity:zero$1},update:f={opacity:one},exit:{opacity:zero$1}};addEncoders(d,{stroke:s("domainColor"),strokeCap:s("domainCap"),strokeDash:s("domainDash"),strokeDashOffset:s("domainDashOffset"),strokeWidth:s("domainWidth"),strokeOpacity:s("domainOpacity")});const p=position(e,0),g=position(e,1);return l.x=f.x=ifX(o,p,zero$1),l.x2=f.x2=ifX(o,g),l.y=f.y=ifY(o,p,zero$1),l.y2=f.y2=ifY(o,g),guideMark({type:RuleMark,role:AxisDomainRole,from:r,encode:d},i)}function position(e,n){return{scale:e.scale,range:n}}function axisGrid(e,n,i,r,s){const o=lookup(e,n),l=e.orient,f=e.gridScale,d=getSign(l,1,-1),p=offsetValue(e.offset,d);let g,v,S;const T={enter:g={opacity:zero$1},update:S={opacity:one},exit:v={opacity:zero$1}};addEncoders(T,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const k={scale:e.scale,field:Value,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")},O=ifX(l,{signal:"height"},{signal:"width"}),R=f?{scale:f,range:0,mult:d,offset:p}:{value:0,offset:p},P=f?{scale:f,range:1,mult:d,offset:p}:extend$1(O,{mult:d,offset:p});return g.x=S.x=ifX(l,k,R),g.y=S.y=ifY(l,k,R),g.x2=S.x2=ifY(l,P),g.y2=S.y2=ifX(l,P),v.x=ifX(l,k),v.y=ifY(l,k),guideMark({type:RuleMark,role:AxisGridRole,key:Value,from:r,encode:T},i)}function offsetValue(e,n){if(n!==1)if(!isObject(e))e=isSignal(n)?{signal:`(${n.signal}) * (${e||0})`}:n*(e||0);else{let i=e=extend$1({},e);for(;i.mult!=null;)if(isObject(i.mult))i=i.mult=extend$1({},i.mult);else return i.mult=isSignal(n)?{signal:`(${i.mult}) * (${n.signal})`}:i.mult*n,e;i.mult=n}return e}function axisTicks(e,n,i,r,s,o){const l=lookup(e,n),f=e.orient,d=getSign(f,-1,1);let p,g,v;const S={enter:p={opacity:zero$1},update:v={opacity:one},exit:g={opacity:zero$1}};addEncoders(S,{stroke:l("tickColor"),strokeCap:l("tickCap"),strokeDash:l("tickDash"),strokeDashOffset:l("tickDashOffset"),strokeOpacity:l("tickOpacity"),strokeWidth:l("tickWidth")});const T=encoder(s);T.mult=d;const k={scale:e.scale,field:Value,band:o.band,extra:o.extra,offset:o.offset,round:l("tickRound")};return v.y=p.y=ifX(f,zero$1,k),v.y2=p.y2=ifX(f,T),g.x=ifX(f,k),v.x=p.x=ifY(f,zero$1,k),v.x2=p.x2=ifY(f,T),g.y=ifY(f,k),guideMark({type:RuleMark,role:AxisTickRole,key:Value,from:r,encode:S},i)}function flushExpr(e,n,i,r,s){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+n+","+i+","+r+","+s+")"}}function axisLabels(e,n,i,r,s,o){const l=lookup(e,n),f=e.orient,d=e.scale,p=getSign(f,-1,1),g=deref(l("labelFlush")),v=deref(l("labelFlushOffset")),S=l("labelAlign"),T=l("labelBaseline");let k=g===0||!!g,O;const R=encoder(s);R.mult=p,R.offset=encoder(l("labelPadding")||0),R.offset.mult=p;const P={scale:d,field:Value,band:.5,offset:extendOffset(o.offset,l("labelOffset"))},F=ifX(f,k?flushExpr(d,g,'"left"','"right"','"center"'):{value:"center"},ifRight(f,"left","right")),I=ifX(f,ifTop(f,"bottom","top"),k?flushExpr(d,g,'"top"','"bottom"','"middle"'):{value:"middle"}),L=flushExpr(d,g,`-(${v})`,v,0);k=k&&v;const N={opacity:zero$1,x:ifX(f,P,R),y:ifY(f,P,R)},j={enter:N,update:O={opacity:one,text:{field:Label},x:N.x,y:N.y,align:F,baseline:I},exit:{opacity:zero$1,x:N.x,y:N.y}};addEncoders(j,{dx:!S&&k?ifX(f,L):null,dy:!T&&k?ifY(f,L):null}),addEncoders(j,{angle:l("labelAngle"),fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontWeight:l("labelFontWeight"),fontStyle:l("labelFontStyle"),limit:l("labelLimit"),lineHeight:l("labelLineHeight")},{align:S,baseline:T});const z=l("labelBound");let q=l("labelOverlap");return q=q||z?{separation:l("labelSeparation"),method:q,order:"datum.index",bound:z?{scale:d,orient:f,tolerance:z}:null}:void 0,O.align!==F&&(O.align=patch(O.align,F)),O.baseline!==I&&(O.baseline=patch(O.baseline,I)),guideMark({type:TextMark,role:AxisLabelRole,style:GuideLabelStyle,key:Value,from:r,encode:j,overlap:q},i)}function axisTitle(e,n,i,r){const s=lookup(e,n),o=e.orient,l=getSign(o,-1,1);let f,d;const p={enter:f={opacity:zero$1,anchor:encoder(s("titleAnchor",null)),align:{signal:alignExpr$1}},update:d=extend$1({},f,{opacity:one,text:encoder(e.title)}),exit:{opacity:zero$1}},g={signal:`lerp(range("${e.scale}"), ${anchorExpr(0,1,.5)})`};return d.x=ifX(o,g),d.y=ifY(o,g),f.angle=ifX(o,zero$1,mult(l,90)),f.baseline=ifX(o,ifTop(o,Bottom,Top),{value:Bottom}),d.angle=f.angle,d.baseline=f.baseline,addEncoders(p,{fill:s("titleColor"),fillOpacity:s("titleOpacity"),font:s("titleFont"),fontSize:s("titleFontSize"),fontStyle:s("titleFontStyle"),fontWeight:s("titleFontWeight"),limit:s("titleLimit"),lineHeight:s("titleLineHeight")},{align:s("titleAlign"),angle:s("titleAngle"),baseline:s("titleBaseline")}),autoLayout(s,o,p,i),p.update.align=patch(p.update.align,f.align),p.update.angle=patch(p.update.angle,f.angle),p.update.baseline=patch(p.update.baseline,f.baseline),guideMark({type:TextMark,role:AxisTitleRole,style:GuideTitleStyle,from:r,encode:p},i)}function autoLayout(e,n,i,r){const s=(f,d)=>f!=null?(i.update[d]=patch(encoder(f),i.update[d]),!1):!has(d,r),o=s(e("titleX"),"x"),l=s(e("titleY"),"y");i.enter.auto=l===o?encoder(l):ifX(n,encoder(l),encoder(o))}function parseAxis$1(e,n){const i=axisConfig(e,n),r=e.encode||{},s=r.axis||{},o=s.name||void 0,l=s.interactive,f=s.style,d=lookup(e,i),p=tickBand(d),g={scale:e.scale,ticks:!!d("ticks"),labels:!!d("labels"),grid:!!d("grid"),domain:!!d("domain"),title:e.title!=null},v=ref(n.add(Collect({},[g]))),S=ref(n.add(AxisTicks({scale:n.scaleRef(e.scale),extra:n.property(p.extra),count:n.objectProperty(e.tickCount),values:n.objectProperty(e.values),minstep:n.property(e.tickMinStep),formatType:n.property(e.formatType),formatSpecifier:n.property(e.format)}))),T=[];let k;return g.grid&&T.push(axisGrid(e,i,r.grid,S,p)),g.ticks&&(k=d("tickSize"),T.push(axisTicks(e,i,r.ticks,S,k,p))),g.labels&&(k=g.ticks?k:0,T.push(axisLabels(e,i,r.labels,S,k,p))),g.domain&&T.push(axisDomain(e,i,r.domain,v)),g.title&&T.push(axisTitle(e,i,r.title,v)),parseMark(guideGroup({role:AxisRole,from:v,encode:extendEncode(buildAxisEncode(d,e),s,Skip),marks:T,aria:d("aria"),description:d("description"),zindex:d("zindex"),name:o,interactive:l,style:f}),n)}function buildAxisEncode(e,n){const i={enter:{},update:{}};return addEncoders(i,{orient:e("orient"),offset:e("offset")||0,position:value(n.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${n.scale}")))`},translate:e("translate"),format:n.format,formatType:n.formatType}),i}function parseScope(e,n,i){const r=array$5(e.signals),s=array$5(e.scales);return i||r.forEach(o=>parseSignal(o,n)),array$5(e.projections).forEach(o=>parseProjection$1(o,n)),s.forEach(o=>initScale(o,n)),array$5(e.data).forEach(o=>parseData$2(o,n)),s.forEach(o=>parseScale(o,n)),(i||r).forEach(o=>parseSignalUpdates(o,n)),array$5(e.axes).forEach(o=>parseAxis$1(o,n)),array$5(e.marks).forEach(o=>parseMark(o,n)),array$5(e.legends).forEach(o=>parseLegend$1(o,n)),e.title&&parseTitle(e.title,n),n.parseLambdas(),n}const rootEncode=e=>extendEncode({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function parseView(e,n){const i=n.config,r=ref(n.root=n.add(operator())),s=collectSignals(e,i);s.forEach(p=>parseSignal(p,n)),n.description=e.description||i.description,n.eventConfig=i.events,n.legends=n.objectProperty(i.legend&&i.legend.layout),n.locale=i.locale;const o=n.add(Collect()),l=n.add(Encode(parseEncode(rootEncode(e.encode),GroupMark,FrameRole,e.style,n,{pulse:ref(o)}))),f=n.add(ViewLayout({layout:n.objectProperty(e.layout),legends:n.legends,autosize:n.signalRef("autosize"),mark:r,pulse:ref(l)}));n.operators.pop(),n.pushState(ref(l),ref(f),null),parseScope(e,n,s),n.operators.push(f);let d=n.add(Bound({mark:r,pulse:ref(f)}));return d=n.add(Render({pulse:ref(d)})),d=n.add(Sieve({pulse:ref(d)})),n.addData("root",new DataScope(n,o,o,d)),n}function signalObject(e,n){return n&&n.signal?{name:e,update:n.signal}:{name:e,value:n}}function collectSignals(e,n){const i=l=>value(e[l],n[l]),r=[signalObject("background",i("background")),signalObject("autosize",parseAutosize(i("autosize"))),signalObject("padding",parsePadding(i("padding"))),signalObject("width",i("width")||0),signalObject("height",i("height")||0)],s=r.reduce((l,f)=>(l[f.name]=f,l),{}),o={};return array$5(e.signals).forEach(l=>{has$1(s,l.name)?l=extend$1(s[l.name],l):r.push(l),o[l.name]=l}),array$5(n.signals).forEach(l=>{!has$1(o,l.name)&&!has$1(s,l.name)&&r.push(l)}),r}function Scope(e,n){this.config=e||{},this.options=n||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Subscope(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Scope.prototype=Subscope.prototype={parse(e){return parseScope(e,this)},fork(){return new Subscope(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(n=>{n.$ref=e.id}),e.refs=null),e},proxy(e){const n=e instanceof Entry$1?ref(e):e;return this.add(Proxy$1({value:n}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,n;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function i(r,s,o){let l,f;r&&(l=r.data||(r.data={}),f=l[s]||(l[s]=[]),f.push(o))}for(e in this.data){n=this.data[e],i(n.input,e,"input"),i(n.output,e,"output"),i(n.values,e,"values");for(const r in n.index)i(n.index[r],e,"index:"+r)}return this},pushState(e,n,i){this._encode.push(ref(this.add(Sieve({pulse:e})))),this._parent.push(n),this._lookup.push(i?ref(this.proxy(i)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return peek$1(this._parent)},encode(){return peek$1(this._encode)},lookup(){return peek$1(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,n){if(isString(e))return fieldRef$1(e,n);e.signal||error("Unsupported field reference: "+$(e));const i=e.signal;let r=this.field[i];if(!r){const s={name:this.signalRef(i)};n&&(s.as=n),this.field[i]=r=ref(this.add(Field(s)))}return r},compareRef(e){let n=!1;const i=o=>isSignal(o)?(n=!0,this.signalRef(o.signal)):isExpr$1(o)?(n=!0,this.exprRef(o.expr)):o,r=array$5(e.field).map(i),s=array$5(e.order).map(i);return n?ref(this.add(Compare({fields:r,orders:s}))):compareRef(r,s)},keyRef(e,n){let i=!1;const r=o=>isSignal(o)?(i=!0,ref(s[o.signal])):o,s=this.signals;return e=array$5(e).map(r),i?ref(this.add(Key({fields:e,flat:n}))):keyRef(e,n)},sortRef(e){if(!e)return e;const n=aggrField(e.op,e.field),i=e.order||Ascending;return i.signal?ref(this.add(Compare({fields:n,orders:this.signalRef(i.signal)}))):compareRef(n,i)},event(e,n){const i=e+":"+n;if(!this.events[i]){const r=this.id();this.streams.push({id:r,source:e,type:n}),this.events[i]=r}return this.events[i]},hasOwnSignal(e){return has$1(this.signals,e)},addSignal(e,n){this.hasOwnSignal(e)&&error("Duplicate signal name: "+$(e));const i=n instanceof Entry$1?n:this.add(operator(n));return this.signals[e]=i},getSignal(e){return this.signals[e]||error("Unrecognized signal name: "+$(e)),this.signals[e]},signalRef(e){return this.signals[e]?ref(this.signals[e]):(has$1(this.lambdas,e)||(this.lambdas[e]=this.add(operator(null))),ref(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let n=0,i=e.length;n<i;++n){const r=e[n],s=parser(r,this),o=this.lambdas[r];o.params=s.$params,o.update=s.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!isObject(e)?e:this.signalRef(e.signal||propertyLambda(e))},exprRef(e,n){const i={expr:parser(e,this)};return n&&(i.expr.$name=n),ref(this.add(Expression(i)))},addBinding(e,n){this.bindings||error("Nested signals do not support binding: "+$(e)),this.bindings.push(extend$1({signal:e},n))},addScaleProj(e,n){has$1(this.scales,e)&&error("Duplicate scale or projection name: "+$(e)),this.scales[e]=this.add(n)},addScale(e,n){this.addScaleProj(e,Scale(n))},addProjection(e,n){this.addScaleProj(e,Projection(n))},getScale(e){return this.scales[e]||error("Unrecognized scale name: "+$(e)),this.scales[e]},scaleRef(e){return ref(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,n){return has$1(this.data,e)&&error("Duplicate data set name: "+$(e)),this.data[e]=n},getData(e){return this.data[e]||error("Undefined data set name: "+$(e)),this.data[e]},addDataPipeline(e,n){return has$1(this.data,e)&&error("Duplicate data set name: "+$(e)),this.addData(e,DataScope.fromEntries(this,n))}};function propertyLambda(e){return(isArray(e)?arrayLambda:objectLambda)(e)}function arrayLambda(e){const n=e.length;let i="[";for(let r=0;r<n;++r){const s=e[r];i+=(r>0?",":"")+(isObject(s)?s.signal||propertyLambda(s):$(s))}return i+"]"}function objectLambda(e){let n="{",i=0,r,s;for(r in e)s=e[r],n+=(++i>1?",":"")+$(r)+":"+(isObject(s)?s.signal||propertyLambda(s):$(s));return n+"}"}function defaults(){const e="sans-serif",r="#4c78a8",s="#000",o="#888",l="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:s},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:s,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:s,font:e,fontSize:10},"guide-title":{fill:s,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:s,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:s,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:l}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:l,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:l,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function parse(e,n,i){return isObject(e)||error("Input Vega specification must be an object."),n=mergeConfig(defaults(),n,e.config),parseView(e,new Scope(n,i)).toRuntime()}var version$2="5.22.1";extend$1(transforms,tx,vtx,encode$1,geo,force,label,tree,reg,voronoi,wordcloud,xf);const vegaImport=Object.freeze(Object.defineProperty({__proto__:null,Bounds,CanvasHandler,CanvasRenderer,DATE,DAY,DAYOFYEAR,Dataflow,Debug,Error:Error$1,EventStream,Gradient:Gradient$1,GroupItem,HOURS,Handler,Info,Item,MILLISECONDS,MINUTES,MONTH,Marks,MultiPulse,None:None$2,Operator,Parameters,Pulse,QUARTER,RenderType,Renderer,ResourceLoader,SECONDS,SVGHandler,SVGRenderer,SVGStringRenderer,Scenegraph,TIME_UNITS,Transform,View:View$1,WEEK,Warn,YEAR,accessor,accessorFields,accessorName,array:array$5,ascending:ascending$3,bandwidthNRD:estimateBandwidth,bin:bin$1,bootstrapCI,boundClip,boundContext,boundItem:boundItem$1,boundMark,boundStroke,changeset,clampRange,codegenExpression:codegen,compare:compare$8,constant:constant$4,cumulativeLogNormal,cumulativeNormal,cumulativeUniform,dayofyear,debounce,defaultLocale,definition:definition$1,densityLogNormal,densityNormal,densityUniform,domChild,domClear,domCreate,domFind,dotbin,error,expressionFunction,extend:extend$1,extent,extentIndex,falsy,fastmap,field:field$1,flush,font,fontFamily,fontSize,format:format$2,formatLocale:numberFormatDefaultLocale,formats:formats$1,hasOwnProperty:has$1,id,identity:identity$6,inferType,inferTypes,ingest:ingest$1,inherits,inrange,interpolate:interpolate$1,interpolateColors,interpolateRange:interpolateRange$1,intersect:intersect$2,intersectBoxLine,intersectPath,intersectPoint,intersectRule,isArray,isBoolean:isBoolean$2,isDate:isDate$1,isFunction,isIterable,isNumber:isNumber$1,isObject,isRegExp,isString,isTuple,key,lerp,lineHeight,loader,locale,logger,lruCache:lruCache$1,markup,merge:merge$3,mergeConfig,multiLineOffset,one:one$2,pad:pad$2,panLinear,panLog,panPow,panSymlog,parse,parseExpression:parser$1,parseSelector:eventSelector,path:path$3,pathCurves:curves,pathEqual,pathParse:parse$3,pathRectangle:vg_rect,pathRender,pathSymbols:symbols$1,pathTrail:vg_trail,peek:peek$1,point:point$2,projection,quantileLogNormal,quantileNormal,quantileUniform,quantiles,quantizeInterpolator,quarter,quartiles,get random(){return random},randomInteger:integer,randomKDE:kde,randomLCG:lcg$2,randomLogNormal:lognormal,randomMixture:mixture$1,randomNormal:gaussian,randomUniform:uniform,read,regressionExp:exp$1,regressionLinear:linear$2,regressionLoess:loess,regressionLog:log$3,regressionPoly:poly,regressionPow:pow$3,regressionQuad:quad,renderModule,repeat,resetDefaultLocale,resetSVGClipId,resetSVGDefIds,responseType,runtimeContext:context,sampleCurve,sampleLogNormal,sampleNormal,sampleUniform,scale:scale$4,sceneEqual,sceneFromJSON,scenePickVisit:pickVisit,sceneToJSON,sceneVisit:visit,sceneZOrder:zorder,scheme,serializeXML,setRandom,span,splitAccessPath,stringValue:$,textMetrics,timeBin:bin$2,timeFloor,timeFormatLocale:timeFormatDefaultLocale,timeInterval,timeOffset,timeSequence,timeUnitSpecifier,timeUnits,toBoolean,toDate,toNumber,toSet,toString,transform:transform$2,transforms,truncate:truncate$1,truthy,tupleid,typeParsers,utcFloor,utcInterval,utcOffset,utcSequence,utcdayofyear,utcquarter,utcweek,version:version$2,visitArray,week,writeConfig,zero:zero$4,zoomLinear,zoomLog,zoomPow,zoomSymlog},Symbol.toStringTag,{value:"Module"})),name="vega-lite",author='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version$1="5.5.0",collaborators=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage="https://vega.github.io/vega-lite/",description$1="Vega-Lite is a concise high-level language for interactive visualization.",keywords=["vega","chart","visualization"],main$1="build/vega-lite.js",unpkg="build/vega-lite.min.js",jsdelivr="build/vega-lite.min.js",module="build/src/index",types="build/src/index.d.ts",bin={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},files=["bin","build","src","vega-lite*","tsconfig.json"],scripts={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"yarn run prebuild && yarn build && yarn shipit",shipit:"auto shipit"},repository={type:"git",url:"https://github.com/vega/vega-lite.git"},license="BSD-3-Clause",bugs={url:"https://github.com/vega/vega-lite/issues"},devDependencies={"@auto-it/conventional-commits":"^10.37.6","@auto-it/first-time-contributor":"^10.37.6","@babel/core":"^7.19.1","@babel/preset-env":"^7.19.1","@babel/preset-typescript":"^7.18.6","@rollup/plugin-alias":"^4.0.0","@rollup/plugin-babel":"^6.0.0","@rollup/plugin-commonjs":"^23.0.0","@rollup/plugin-json":"^4.1.0","@types/jest":"^27.4.1","@rollup/plugin-node-resolve":"^14.1.0","@types/chai":"^4.3.3","@types/d3":"^7.4.0","@types/mkdirp":"^1.0.2","@types/pako":"^2.0.0","@typescript-eslint/eslint-plugin":"^5.38.0","@typescript-eslint/parser":"^5.38.0",ajv:"^8.11.0","ajv-formats":"^2.1.1",auto:"^10.37.6",chai:"^4.3.6",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^2.2.2",d3:"^7.6.1","del-cli":"^5.0.0",eslint:"^8.23.1","eslint-config-prettier":"^8.5.0","eslint-plugin-jest":"^27.0.4","eslint-plugin-prettier":"^4.2.1","gh-pages":"^4.0.0",jest:"^27.5.1","highlight.js":"^11.6.0","jest-dev-server":"^6.1.1",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.7.1",puppeteer:"^15.0.0",rollup:"^2.79.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^14.0.1",terser:"^5.15.0","ts-jest":"^29.0.1","ts-json-schema-generator":"^1.1.1","vega-cli":"^5.22.1",typescript:"~4.8.3","vega-datasets":"~2.5.1","vega-embed":"^6.21.0","vega-tooltip":"^0.28.0","yaml-front-matter":"^4.1.1"},dependencies={"@types/clone":"~2.1.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.4.0","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-util":"~1.17.0",yargs:"~17.6.0"},peerDependencies={vega:"^5.22.0"},engines={node:">=12"},pkg={name,author,version:version$1,collaborators,homepage,description:description$1,keywords,main:main$1,unpkg,jsdelivr,module,types,bin,files,scripts,repository,license,bugs,devDependencies,dependencies,peerDependencies,engines};var cloneExports={},clone={get exports(){return cloneExports},set exports(e){cloneExports=e}};(function(e){var n=function(){function i(S,T){return T!=null&&S instanceof T}var r;try{r=Map}catch{r=function(){}}var s;try{s=Set}catch{s=function(){}}var o;try{o=Promise}catch{o=function(){}}function l(S,T,k,O,R){typeof T=="object"&&(k=T.depth,O=T.prototype,R=T.includeNonEnumerable,T=T.circular);var P=[],F=[],I=typeof Buffer<"u";typeof T>"u"&&(T=!0),typeof k>"u"&&(k=1/0);function L(N,j){if(N===null)return null;if(j===0)return N;var z,q;if(typeof N!="object")return N;if(i(N,r))z=new r;else if(i(N,s))z=new s;else if(i(N,o))z=new o(function(ae,oe){N.then(function(pe){ae(L(pe,j-1))},function(pe){oe(L(pe,j-1))})});else if(l.__isArray(N))z=[];else if(l.__isRegExp(N))z=new RegExp(N.source,v(N)),N.lastIndex&&(z.lastIndex=N.lastIndex);else if(l.__isDate(N))z=new Date(N.getTime());else{if(I&&Buffer.isBuffer(N))return Buffer.allocUnsafe?z=Buffer.allocUnsafe(N.length):z=new Buffer(N.length),N.copy(z),z;i(N,Error)?z=Object.create(N):typeof O>"u"?(q=Object.getPrototypeOf(N),z=Object.create(q)):(z=Object.create(O),q=O)}if(T){var H=P.indexOf(N);if(H!=-1)return F[H];P.push(N),F.push(z)}i(N,r)&&N.forEach(function(ae,oe){var pe=L(oe,j-1),Se=L(ae,j-1);z.set(pe,Se)}),i(N,s)&&N.forEach(function(ae){var oe=L(ae,j-1);z.add(oe)});for(var W in N){var U;q&&(U=Object.getOwnPropertyDescriptor(q,W)),!(U&&U.set==null)&&(z[W]=L(N[W],j-1))}if(Object.getOwnPropertySymbols)for(var Q=Object.getOwnPropertySymbols(N),W=0;W<Q.length;W++){var J=Q[W],ne=Object.getOwnPropertyDescriptor(N,J);ne&&!ne.enumerable&&!R||(z[J]=L(N[J],j-1),ne.enumerable||Object.defineProperty(z,J,{enumerable:!1}))}if(R)for(var G=Object.getOwnPropertyNames(N),W=0;W<G.length;W++){var Z=G[W],ne=Object.getOwnPropertyDescriptor(N,Z);ne&&ne.enumerable||(z[Z]=L(N[Z],j-1),Object.defineProperty(z,Z,{enumerable:!1}))}return z}return L(S,k)}l.clonePrototype=function(T){if(T===null)return null;var k=function(){};return k.prototype=T,new k};function f(S){return Object.prototype.toString.call(S)}l.__objToStr=f;function d(S){return typeof S=="object"&&f(S)==="[object Date]"}l.__isDate=d;function p(S){return typeof S=="object"&&f(S)==="[object Array]"}l.__isArray=p;function g(S){return typeof S=="object"&&f(S)==="[object RegExp]"}l.__isRegExp=g;function v(S){var T="";return S.global&&(T+="g"),S.ignoreCase&&(T+="i"),S.multiline&&(T+="m"),T}return l.__getRegExpFlags=v,l}();e.exports&&(e.exports=n)})(clone);const clone_=cloneExports;var fastDeepEqual=function e(n,i){if(n===i)return!0;if(n&&i&&typeof n=="object"&&typeof i=="object"){if(n.constructor!==i.constructor)return!1;var r,s,o;if(Array.isArray(n)){if(r=n.length,r!=i.length)return!1;for(s=r;s--!==0;)if(!e(n[s],i[s]))return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===i.toString();if(o=Object.keys(n),r=o.length,r!==Object.keys(i).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(i,o[s]))return!1;for(s=r;s--!==0;){var l=o[s];if(!e(n[l],i[l]))return!1}return!0}return n!==n&&i!==i},fastJsonStableStringify=function(e,n){n||(n={}),typeof n=="function"&&(n={cmp:n});var i=typeof n.cycles=="boolean"?n.cycles:!1,r=n.cmp&&function(o){return function(l){return function(f,d){var p={key:f,value:l[f]},g={key:d,value:l[d]};return o(p,g)}}}(n.cmp),s=[];return function o(l){if(l&&l.toJSON&&typeof l.toJSON=="function"&&(l=l.toJSON()),l!==void 0){if(typeof l=="number")return isFinite(l)?""+l:"null";if(typeof l!="object")return JSON.stringify(l);var f,d;if(Array.isArray(l)){for(d="[",f=0;f<l.length;f++)f&&(d+=","),d+=o(l[f])||"null";return d+"]"}if(l===null)return"null";if(s.indexOf(l)!==-1){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var p=s.push(l)-1,g=Object.keys(l).sort(r&&r(l));for(d="",f=0;f<g.length;f++){var v=g[f],S=o(l[v]);S&&(d&&(d+=","),d+=JSON.stringify(v)+":"+S)}return s.splice(p,1),"{"+d+"}"}}(e)};function isLogicalOr(e){return!!e.or}function isLogicalAnd(e){return!!e.and}function isLogicalNot(e){return!!e.not}function forEachLeaf(e,n){if(isLogicalNot(e))forEachLeaf(e.not,n);else if(isLogicalAnd(e))for(const i of e.and)forEachLeaf(i,n);else if(isLogicalOr(e))for(const i of e.or)forEachLeaf(i,n);else n(e)}function normalizeLogicalComposition(e,n){return isLogicalNot(e)?{not:normalizeLogicalComposition(e.not,n)}:isLogicalAnd(e)?{and:e.and.map(i=>normalizeLogicalComposition(i,n))}:isLogicalOr(e)?{or:e.or.map(i=>normalizeLogicalComposition(i,n))}:n(e)}const deepEqual=fastDeepEqual,duplicate=clone_;function never(e){throw new Error(e)}function pick(e,n){const i={};for(const r of n)has$1(e,r)&&(i[r]=e[r]);return i}function omit(e,n){const i=Object.assign({},e);for(const r of n)delete i[r];return i}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>fastJsonStableStringify(e)).join(",")})`};const stringify=fastJsonStableStringify;function hash(e){if(isNumber$1(e))return e;const n=isString(e)?e:fastJsonStableStringify(e);if(n.length<250)return n;let i=0;for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);i=(i<<5)-i+s,i=i&i}return i}function isNullOrFalse(e){return e===!1||e===null}function contains(e,n){return e.includes(n)}function some(e,n){let i=0;for(const[r,s]of e.entries())if(n(s,r,i++))return!0;return!1}function every(e,n){let i=0;for(const[r,s]of e.entries())if(!n(s,r,i++))return!1;return!0}function mergeDeep(e,...n){for(const i of n)deepMerge_(e,i??{});return e}function deepMerge_(e,n){for(const i of keys$1(n))writeConfig(e,i,n[i],!0)}function unique(e,n){const i=[],r={};let s;for(const o of e)s=n(o),!(s in r)&&(r[s]=1,i.push(o));return i}function isEqual(e,n){const i=keys$1(e),r=keys$1(n);if(i.length!==r.length)return!1;for(const s of i)if(e[s]!==n[s])return!1;return!0}function setEqual(e,n){if(e.size!==n.size)return!1;for(const i of e)if(!n.has(i))return!1;return!0}function hasIntersection(e,n){for(const i of e)if(n.has(i))return!0;return!1}function prefixGenerator(e){const n=new Set;for(const i of e){const s=splitAccessPath(i).map((l,f)=>f===0?l:`[${l}]`),o=s.map((l,f)=>s.slice(0,f+1).join(""));for(const l of o)n.add(l)}return n}function fieldIntersection(e,n){return e===void 0||n===void 0?!0:hasIntersection(prefixGenerator(e),prefixGenerator(n))}function isEmpty(e){return keys$1(e).length===0}const keys$1=Object.keys,vals=Object.values,entries$1=Object.entries;function isBoolean(e){return e===!0||e===!1}function varName(e){const n=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+n}function logicalExpr(e,n){return isLogicalNot(e)?`!(${logicalExpr(e.not,n)})`:isLogicalAnd(e)?`(${e.and.map(i=>logicalExpr(i,n)).join(") && (")})`:isLogicalOr(e)?`(${e.or.map(i=>logicalExpr(i,n)).join(") || (")})`:n(e)}function deleteNestedProperty(e,n){if(n.length===0)return!0;const i=n.shift();return i in e&&deleteNestedProperty(e[i],n)&&delete e[i],isEmpty(e)}function titleCase(e){return e.charAt(0).toUpperCase()+e.substr(1)}function accessPathWithDatum(e,n="datum"){const i=splitAccessPath(e),r=[];for(let s=1;s<=i.length;s++){const o=`[${i.slice(0,s).map($).join("][")}]`;r.push(`${n}${o}`)}return r.join(" && ")}function flatAccessWithDatum(e,n="datum"){return`${n}[${$(splitAccessPath(e).join("."))}]`}function escapePathAccess(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function replacePathInField(e){return`${splitAccessPath(e).map(escapePathAccess).join("\\.")}`}function replaceAll(e,n,i){return e.replace(new RegExp(n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),i)}function removePathFromField(e){return`${splitAccessPath(e).join(".")}`}function accessPathDepth(e){return e?splitAccessPath(e).length:0}function getFirstDefined(...e){for(const n of e)if(n!==void 0)return n}let idCounter=42;function uniqueId(e){const n=++idCounter;return e?String(e)+n:n}function resetIdCounter(){idCounter=42}function internalField(e){return isInternalField(e)?e:`__${e}`}function isInternalField(e){return e.startsWith("__")}function normalizeAngle(e){if(e!==void 0)return(e%360+360)%360}function isNumeric(e){return isNumber$1(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var __rest$v=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const ROW="row",COLUMN="column",FACET="facet",X="x",Y="y",X2="x2",Y2="y2",XOFFSET="xOffset",YOFFSET="yOffset",RADIUS="radius",RADIUS2="radius2",THETA="theta",THETA2="theta2",LATITUDE="latitude",LONGITUDE="longitude",LATITUDE2="latitude2",LONGITUDE2="longitude2",COLOR="color",FILL="fill",STROKE="stroke",SHAPE="shape",SIZE="size",ANGLE="angle",OPACITY="opacity",FILLOPACITY="fillOpacity",STROKEOPACITY="strokeOpacity",STROKEWIDTH="strokeWidth",STROKEDASH="strokeDash",TEXT$1="text",ORDER="order",DETAIL="detail",KEY="key",TOOLTIP="tooltip",HREF="href",URL$1="url",DESCRIPTION="description",POSITION_CHANNEL_INDEX={x:1,y:1,x2:1,y2:1},POLAR_POSITION_CHANNEL_INDEX={theta:1,theta2:1,radius:1,radius2:1};function isPolarPositionChannel(e){return e in POLAR_POSITION_CHANNEL_INDEX}const GEO_POSIITON_CHANNEL_INDEX={longitude:1,longitude2:1,latitude:1,latitude2:1};function getPositionChannelFromLatLong(e){switch(e){case LATITUDE:return"y";case LATITUDE2:return"y2";case LONGITUDE:return"x";case LONGITUDE2:return"x2"}}function isGeoPositionChannel(e){return e in GEO_POSIITON_CHANNEL_INDEX}const GEOPOSITION_CHANNELS=keys$1(GEO_POSIITON_CHANNEL_INDEX),UNIT_CHANNEL_INDEX=Object.assign(Object.assign(Object.assign(Object.assign({},POSITION_CHANNEL_INDEX),POLAR_POSITION_CHANNEL_INDEX),GEO_POSIITON_CHANNEL_INDEX),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function isColorChannel(e){return e===COLOR||e===FILL||e===STROKE}const FACET_CHANNEL_INDEX={row:1,column:1,facet:1},FACET_CHANNELS=keys$1(FACET_CHANNEL_INDEX),CHANNEL_INDEX=Object.assign(Object.assign({},UNIT_CHANNEL_INDEX),FACET_CHANNEL_INDEX),CHANNELS=keys$1(CHANNEL_INDEX),SINGLE_DEF_CHANNEL_INDEX=__rest$v(CHANNEL_INDEX,["order","detail","tooltip"]),SINGLE_DEF_UNIT_CHANNEL_INDEX=__rest$v(SINGLE_DEF_CHANNEL_INDEX,["row","column","facet"]);function isSingleDefUnitChannel(e){return!!SINGLE_DEF_UNIT_CHANNEL_INDEX[e]}function isChannel(e){return!!CHANNEL_INDEX[e]}const SECONDARY_RANGE_CHANNEL=[X2,Y2,LATITUDE2,LONGITUDE2,THETA2,RADIUS2];function isSecondaryRangeChannel(e){return getMainRangeChannel(e)!==e}function getMainRangeChannel(e){switch(e){case X2:return X;case Y2:return Y;case LATITUDE2:return LATITUDE;case LONGITUDE2:return LONGITUDE;case THETA2:return THETA;case RADIUS2:return RADIUS}return e}function getVgPositionChannel(e){if(isPolarPositionChannel(e))switch(e){case THETA:return"startAngle";case THETA2:return"endAngle";case RADIUS:return"outerRadius";case RADIUS2:return"innerRadius"}return e}function getSecondaryRangeChannel(e){switch(e){case X:return X2;case Y:return Y2;case LATITUDE:return LATITUDE2;case LONGITUDE:return LONGITUDE2;case THETA:return THETA2;case RADIUS:return RADIUS2}}function getSizeChannel(e){switch(e){case X:case X2:return"width";case Y:case Y2:return"height"}}function getOffsetChannel(e){switch(e){case X:return"xOffset";case Y:return"yOffset";case X2:return"x2Offset";case Y2:return"y2Offset";case THETA:return"thetaOffset";case RADIUS:return"radiusOffset";case THETA2:return"theta2Offset";case RADIUS2:return"radius2Offset"}}function getOffsetScaleChannel(e){switch(e){case X:return"xOffset";case Y:return"yOffset"}}function getMainChannelFromOffsetChannel(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const UNIT_CHANNELS=keys$1(UNIT_CHANNEL_INDEX),NONPOSITION_CHANNEL_INDEX=__rest$v(UNIT_CHANNEL_INDEX,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),NONPOSITION_CHANNELS=keys$1(NONPOSITION_CHANNEL_INDEX),POSITION_SCALE_CHANNEL_INDEX={x:1,y:1},POSITION_SCALE_CHANNELS=keys$1(POSITION_SCALE_CHANNEL_INDEX);function isXorY(e){return e in POSITION_SCALE_CHANNEL_INDEX}const POLAR_POSITION_SCALE_CHANNEL_INDEX={theta:1,radius:1},POLAR_POSITION_SCALE_CHANNELS=keys$1(POLAR_POSITION_SCALE_CHANNEL_INDEX);function getPositionScaleChannel(e){return e==="width"?X:Y}const OFFSET_SCALE_CHANNEL_INDEX={xOffset:1,yOffset:1};function isXorYOffset(e){return e in OFFSET_SCALE_CHANNEL_INDEX}const NONPOSITION_SCALE_CHANNEL_INDEX=__rest$v(NONPOSITION_CHANNEL_INDEX,["text","tooltip","href","url","description","detail","key","order"]),NONPOSITION_SCALE_CHANNELS=keys$1(NONPOSITION_SCALE_CHANNEL_INDEX);function isNonPositionScaleChannel(e){return!!NONPOSITION_CHANNEL_INDEX[e]}function supportLegend(e){switch(e){case COLOR:case FILL:case STROKE:case SIZE:case SHAPE:case OPACITY:case STROKEWIDTH:case STROKEDASH:return!0;case FILLOPACITY:case STROKEOPACITY:case ANGLE:return!1}}const SCALE_CHANNEL_INDEX=Object.assign(Object.assign(Object.assign(Object.assign({},POSITION_SCALE_CHANNEL_INDEX),POLAR_POSITION_SCALE_CHANNEL_INDEX),OFFSET_SCALE_CHANNEL_INDEX),NONPOSITION_SCALE_CHANNEL_INDEX),SCALE_CHANNELS=keys$1(SCALE_CHANNEL_INDEX);function isScaleChannel(e){return!!SCALE_CHANNEL_INDEX[e]}function supportMark(e,n){return getSupportedMark(e)[n]}const ALL_MARKS={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},ALL_MARKS_EXCEPT_GEOSHAPE=__rest$v(ALL_MARKS,["geoshape"]);function getSupportedMark(e){switch(e){case COLOR:case FILL:case STROKE:case DESCRIPTION:case DETAIL:case KEY:case TOOLTIP:case HREF:case ORDER:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEWIDTH:case FACET:case ROW:case COLUMN:return ALL_MARKS;case X:case Y:case XOFFSET:case YOFFSET:case LATITUDE:case LONGITUDE:return ALL_MARKS_EXCEPT_GEOSHAPE;case X2:case Y2:case LATITUDE2:case LONGITUDE2:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case SIZE:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case STROKEDASH:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case SHAPE:return{point:"always",geoshape:"always"};case TEXT$1:return{text:"always"};case ANGLE:return{point:"always",square:"always",text:"always"};case URL$1:return{image:"always"};case THETA:return{text:"always",arc:"always"};case RADIUS:return{text:"always",arc:"always"};case THETA2:case RADIUS2:return{arc:"always"}}}function rangeType(e){switch(e){case X:case Y:case THETA:case RADIUS:case XOFFSET:case YOFFSET:case SIZE:case ANGLE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case X2:case Y2:case THETA2:case RADIUS2:return;case FACET:case ROW:case COLUMN:case SHAPE:case STROKEDASH:case TEXT$1:case TOOLTIP:case HREF:case URL$1:case DESCRIPTION:return"discrete";case COLOR:case FILL:case STROKE:return"flexible";case LATITUDE:case LONGITUDE:case LATITUDE2:case LONGITUDE2:case DETAIL:case KEY:case ORDER:return}}const AGGREGATE_OP_INDEX={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},MULTIDOMAIN_SORT_OP_INDEX={count:1,min:1,max:1};function isArgminDef(e){return!!e&&!!e.argmin}function isArgmaxDef(e){return!!e&&!!e.argmax}function isAggregateOp(e){return isString(e)&&!!AGGREGATE_OP_INDEX[e]}const COUNTING_OPS=new Set(["count","valid","missing","distinct"]);function isCountingAggregateOp(e){return isString(e)&&COUNTING_OPS.has(e)}function isMinMaxOp(e){return isString(e)&&contains(["min","max"],e)}const SUM_OPS=new Set(["count","sum","distinct","valid","missing"]),SHARED_DOMAIN_OPS=new Set(["mean","average","median","q1","q3","min","max"]);function binToString(e){return isBoolean$2(e)&&(e=normalizeBin(e,void 0)),"bin"+keys$1(e).map(n=>isParameterExtent(e[n])?varName(`_${n}_${entries$1(e[n])}`):varName(`_${n}_${e[n]}`)).join("")}function isBinning(e){return e===!0||isBinParams(e)&&!e.binned}function isBinned(e){return e==="binned"||isBinParams(e)&&e.binned===!0}function isBinParams(e){return isObject(e)}function isParameterExtent(e){return e==null?void 0:e.param}function autoMaxBins(e){switch(e){case ROW:case COLUMN:case SIZE:case COLOR:case FILL:case STROKE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case SHAPE:return 6;case STROKEDASH:return 4;default:return 10}}function isExprRef(e){return!!(e!=null&&e.expr)}function replaceExprRef(e){const n=keys$1(e||{}),i={};for(const r of n)i[r]=signalRefOrValue(e[r]);return i}var __rest$u=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function extractTitleConfig(e){const{anchor:n,frame:i,offset:r,orient:s,angle:o,limit:l,color:f,subtitleColor:d,subtitleFont:p,subtitleFontSize:g,subtitleFontStyle:v,subtitleFontWeight:S,subtitleLineHeight:T,subtitlePadding:k}=e,O=__rest$u(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),R=Object.assign(Object.assign({},O),f?{fill:f}:{}),P=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n?{anchor:n}:{}),i?{frame:i}:{}),r?{offset:r}:{}),s?{orient:s}:{}),o!==void 0?{angle:o}:{}),l!==void 0?{limit:l}:{}),F=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d?{subtitleColor:d}:{}),p?{subtitleFont:p}:{}),g?{subtitleFontSize:g}:{}),v?{subtitleFontStyle:v}:{}),S?{subtitleFontWeight:S}:{}),T?{subtitleLineHeight:T}:{}),k?{subtitlePadding:k}:{}),I=pick(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:R,subtitleMarkConfig:I,nonMarkTitleProperties:P,subtitle:F}}function isText(e){return isString(e)||isArray(e)&&isString(e[0])}function isSignalRef(e){return!!(e!=null&&e.signal)}function isVgRangeStep(e){return!!e.step}function isDataRefUnionedDomain(e){return isArray(e)?!1:"fields"in e&&!("data"in e)}function isFieldRefUnionDomain(e){return isArray(e)?!1:"fields"in e&&"data"in e}function isDataRefDomain(e){return isArray(e)?!1:"field"in e&&"data"in e}const VG_MARK_CONFIG_INDEX={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},VG_MARK_CONFIGS=keys$1(VG_MARK_CONFIG_INDEX),VG_MARK_INDEX={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},VG_CORNERRADIUS_CHANNELS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var __rest$t=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function signalOrValueRefWithCondition(e){const n=isArray(e.condition)?e.condition.map(conditionalSignalRefOrValue):conditionalSignalRefOrValue(e.condition);return Object.assign(Object.assign({},signalRefOrValue(e)),{condition:n})}function signalRefOrValue(e){if(isExprRef(e)){const{expr:n}=e,i=__rest$t(e,["expr"]);return Object.assign({signal:n},i)}return e}function conditionalSignalRefOrValue(e){if(isExprRef(e)){const{expr:n}=e,i=__rest$t(e,["expr"]);return Object.assign({signal:n},i)}return e}function signalOrValueRef(e){if(isExprRef(e)){const{expr:n}=e,i=__rest$t(e,["expr"]);return Object.assign({signal:n},i)}return isSignalRef(e)?e:e!==void 0?{value:e}:void 0}function exprFromSignalRefOrValue(e){return isSignalRef(e)?e.signal:$(e)}function exprFromValueRefOrSignalRef(e){return isSignalRef(e)?e.signal:$(e.value)}function signalOrStringValue(e){return isSignalRef(e)?e.signal:e==null?null:$(e)}function applyMarkConfig(e,n,i){for(const r of i){const s=getMarkConfig(r,n.markDef,n.config);s!==void 0&&(e[r]=signalOrValueRef(s))}return e}function getStyles(e){var n;return[].concat(e.type,(n=e.style)!==null&&n!==void 0?n:[])}function getMarkPropOrConfig(e,n,i,r={}){const{vgChannel:s,ignoreVgConfig:o}=r;return s&&n[s]!==void 0?n[s]:n[e]!==void 0?n[e]:o&&(!s||s===e)?void 0:getMarkConfig(e,n,i,r)}function getMarkConfig(e,n,i,{vgChannel:r}={}){return getFirstDefined(r?getMarkStyleConfig(e,n,i.style):void 0,getMarkStyleConfig(e,n,i.style),r?i[n.type][r]:void 0,i[n.type][e],r?i.mark[r]:i.mark[e])}function getMarkStyleConfig(e,n,i){return getStyleConfig(e,getStyles(n),i)}function getStyleConfig(e,n,i){n=array$5(n);let r;for(const s of n){const o=i[s];o&&o[e]!==void 0&&(r=o[e])}return r}function sortParams(e,n){return array$5(e).reduce((i,r)=>{var s;return i.field.push(vgField(r,n)),i.order.push((s=r.sort)!==null&&s!==void 0?s:"ascending"),i},{field:[],order:[]})}function mergeTitleFieldDefs(e,n){const i=[...e];return n.forEach(r=>{for(const s of i)if(deepEqual(s,r))return;i.push(r)}),i}function mergeTitle(e,n){return deepEqual(e,n)||!n?e:e?[...array$5(e),...array$5(n)].join(", "):n}function mergeTitleComponent(e,n){const i=e.value,r=n.value;if(i==null||r===null)return{explicit:e.explicit,value:null};if((isText(i)||isSignalRef(i))&&(isText(r)||isSignalRef(r)))return{explicit:e.explicit,value:mergeTitle(i,r)};if(isText(i)||isSignalRef(i))return{explicit:e.explicit,value:i};if(isText(r)||isSignalRef(r))return{explicit:e.explicit,value:r};if(!isText(i)&&!isSignalRef(i)&&!isText(r)&&!isSignalRef(r))return{explicit:e.explicit,value:mergeTitleFieldDefs(i,r)};throw new Error("It should never reach here")}function invalidSpec(e){return`Invalid specification ${stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.';function containerSizeNonSingle(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function containerSizeNotCompatibleWithAutosize(e){const n=e=="width"?"Width":"Height",i=e=="width"?"x":"y";return`${n} "container" only works well with autosize "fit" or "fit-${i}".`}function droppingFit(e){return e?`Dropping "fit-${e}" because spec has discrete ${getSizeChannel(e)}.`:'Dropping "fit" because spec has discrete size.'}function unknownField(e){return`Unknown field for ${e}. Cannot calculate view size.`}function cannotProjectOnChannelWithoutField(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function cannotProjectAggregate(e,n){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${n}").`}function nearestNotSupportForContinuous(e){return`The "nearest" transform is not supported for ${e} marks.`}function selectionNotSupported(e){return`Selection not supported for ${e} yet.`}function selectionNotFound(e){return`Cannot find a selection named "${e}".`}const SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.",LEGEND_BINDINGS_MUST_HAVE_PROJECTION="Legend bindings are only supported for selections over an individual field or encoding channel.";function cannotLookupVariableParameter(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function noSameUnitLookup(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const NEEDS_SAME_SELECTION="The same selection must be used to override scale domains in a layered view.",INTERVAL_INITIALIZED_WITH_X_Y='Interval selections should be initialized using "x" and/or "y" keys.';function noSuchRepeatedValue(e){return`Unknown repeated value "${e}".`}function columnsNotSupportByRowCol(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function unrecognizedParse(e){return`Unrecognized parse "${e}".`}function differentParse(e,n,i){return`An ancestor parsed field "${e}" as ${i} but a child wants to parse the field as ${n}.`}const ADD_SAME_CHILD_TWICE="Attempt to add the same child twice.";function invalidTransformIgnored(e){return`Ignoring an invalid transform: ${stringify(e)}.`}const NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function customFormatTypeNotAllowed(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function projectionOverridden(e){const{parentProjection:n,projection:i}=e;return`Layer's shared projection ${stringify(n)} is overridden by a child projection ${stringify(i)}.`}const REPLACE_ANGLE_WITH_THETA="Arc marks uses theta channel rather than angle, replacing angle with theta.";function offsetNestedInsideContinuousPositionScaleDropped(e){return`${e}Offset dropped because ${e} is continuous`}function replaceOffsetWithMainChannel(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function primitiveChannelDef(e,n,i){return`Channel ${e} is a ${n}. Converted to {value: ${stringify(i)}}.`}function invalidFieldType(e){return`Invalid field type "${e}".`}function invalidFieldTypeForCountAggregate(e,n){return`Invalid field type "${e}" for aggregate: "${n}", using "quantitative" instead.`}function invalidAggregate(e){return`Invalid aggregation operator "${e}".`}function droppingColor(e,n){const{fill:i,stroke:r}=n;return`Dropping color ${e} as the plot also has ${i&&r?"fill and stroke":i?"fill":"stroke"}.`}function relativeBandSizeNotSupported(e){return`Position range does not support relative band size for ${e}.`}function emptyFieldDef(e,n){return`Dropping ${stringify(e)} from channel "${n}" since it does not contain any data field, datum, value, or signal.`}const LINE_WITH_VARYING_SIZE="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function incompatibleChannel(e,n,i){return`${e} dropped as it is incompatible with "${n}"${i?` when ${i}`:""}.`}function offsetEncodingScaleIgnored(e){return`${e} encoding has no scale, so specified scale is ignored.`}function invalidEncodingChannel(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function channelShouldBeDiscrete(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function channelShouldBeDiscreteOrDiscretizing(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function facetChannelDropped(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function discreteChannelCannotEncode(e,n){return`Using discrete channel "${e}" to encode "${n}" field can be misleading as it does not encode ${n==="ordinal"?"order":"magnitude"}.`}function rangeMarkAlignmentCannotBeExpression(e){return`The ${e} for range marks cannot be an expression`}function lineWithRange(e,n){return`Line mark is for continuous lines and thus cannot be used with ${e&&n?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function orientOverridden(e,n){return`Specified orient "${e}" overridden with "${n}".`}function cannotUseScalePropertyWithNonColor(e){return`Cannot use the scale property "${e}" with non-color channel.`}function cannotUseRelativeBandSizeWithNonBandScale(e){return`Cannot use the relative band size with ${e} scale.`}function unaggregateDomainHasNoEffectForRawField(e){return`Using unaggregated domain with raw field has no effect (${stringify(e)}).`}function unaggregateDomainWithNonSharedDomainOp(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function unaggregatedDomainWithLogScale(e){return`Unaggregated domain is currently unsupported for log scale (${stringify(e)}).`}function cannotApplySizeToNonOrientedMark(e){return`Cannot apply size to non-oriented mark "${e}".`}function scaleTypeNotWorkWithChannel(e,n,i){return`Channel "${e}" does not work with "${n}" scale. We are using "${i}" scale instead.`}function scaleTypeNotWorkWithFieldDef(e,n){return`FieldDef does not work with "${e}" scale. We are using "${n}" scale instead.`}function scalePropertyNotWorkWithScaleType(e,n,i){return`${i}-scale's "${n}" is dropped as it does not work with ${e} scale.`}function stepDropped(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function mergeConflictingProperty(e,n,i,r){return`Conflicting ${n.toString()} property "${e.toString()}" (${stringify(i)} and ${stringify(r)}). Using ${stringify(i)}.`}function mergeConflictingDomainProperty(e,n,i,r){return`Conflicting ${n.toString()} property "${e.toString()}" (${stringify(i)} and ${stringify(r)}). Using the union of the two domains.`}function independentScaleMeansIndependentGuide(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function domainSortDropped(e){return`Dropping sort property ${stringify(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",FACETED_INDEPENDENT_DIFFERENT_SOURCES="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",FACETED_INDEPENDENT_SAME_SOURCE="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function cannotStackRangedMark(e){return`Cannot stack "${e}" if there is already "${e}2".`}function cannotStackNonLinearScale(e){return`Cannot stack non-linear scale (${e}).`}function stackNonSummativeAggregate(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function invalidTimeUnit(e,n){return`Invalid ${e}: ${stringify(n)}.`}function droppedDay(e){return`Dropping day from datetime ${stringify(e)} as day cannot be combined with other units.`}function errorBarCenterAndExtentAreNotNeeded(e,n){return`${n?"extent ":""}${n&&e?"and ":""}${e?"center ":""}${n&&e?"are ":"is "}not needed when data are aggregated.`}function errorBarCenterIsUsedWithWrongExtent(e,n,i){return`${e} is not usually used with ${n} for ${i}.`}function errorBarContinuousAxisHasCustomizedAggregate(e,n){return`Continuous axis should not have customized aggregation function ${e}; ${n} already agregates the axis.`}function errorBand1DNotSupport(e){return`1D error band does not support ${e}.`}function channelRequiredForBinned(e){return`Channel ${e} is required for "binned" bin.`}function channelShouldNotBeUsedForBinned(e){return`Channel ${e} should not be used with "binned" bin.`}function domainRequiredForThresholdScale(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const main=logger(Warn);let current=main;function set(e){return current=e,current}function reset(){return current=main,current}function warn(...e){current.warn(...e)}function debug$2(...e){current.debug(...e)}function isDateTime(e){if(e&&isObject(e)){for(const n of TIMEUNIT_PARTS)if(n in e)return!0}return!1}const MONTHS=["january","february","march","april","may","june","july","august","september","october","november","december"],SHORT_MONTHS=MONTHS.map(e=>e.substr(0,3)),DAYS=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],SHORT_DAYS=DAYS.map(e=>e.substr(0,3));function normalizeQuarter(e){if(isNumeric(e)&&(e=+e),isNumber$1(e))return e>4&&warn(invalidTimeUnit("quarter",e)),e-1;throw new Error(invalidTimeUnit("quarter",e))}function normalizeMonth(e){if(isNumeric(e)&&(e=+e),isNumber$1(e))return e-1;{const n=e.toLowerCase(),i=MONTHS.indexOf(n);if(i!==-1)return i;const r=n.substr(0,3),s=SHORT_MONTHS.indexOf(r);if(s!==-1)return s;throw new Error(invalidTimeUnit("month",e))}}function normalizeDay(e){if(isNumeric(e)&&(e=+e),isNumber$1(e))return e%7;{const n=e.toLowerCase(),i=DAYS.indexOf(n);if(i!==-1)return i;const r=n.substr(0,3),s=SHORT_DAYS.indexOf(r);if(s!==-1)return s;throw new Error(invalidTimeUnit("day",e))}}function dateTimeParts(e,n){const i=[];if(n&&e.day!==void 0&&keys$1(e).length>1&&(warn(droppedDay(e)),e=duplicate(e),delete e.day),e.year!==void 0?i.push(e.year):i.push(2012),e.month!==void 0){const r=n?normalizeMonth(e.month):e.month;i.push(r)}else if(e.quarter!==void 0){const r=n?normalizeQuarter(e.quarter):e.quarter;i.push(isNumber$1(r)?r*3:`${r}*3`)}else i.push(0);if(e.date!==void 0)i.push(e.date);else if(e.day!==void 0){const r=n?normalizeDay(e.day):e.day;i.push(isNumber$1(r)?r+1:`${r}+1`)}else i.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const s=e[r];i.push(typeof s>"u"?0:s)}return i}function dateTimeToExpr(e){const i=dateTimeParts(e,!0).join(", ");return e.utc?`utc(${i})`:`datetime(${i})`}function dateTimeExprToExpr(e){const i=dateTimeParts(e,!1).join(", ");return e.utc?`utc(${i})`:`datetime(${i})`}function dateTimeToTimestamp(e){const n=dateTimeParts(e,!0);return e.utc?+new Date(Date.UTC(...n)):+new Date(...n)}var __rest$s=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const LOCAL_SINGLE_TIMEUNIT_INDEX={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},TIMEUNIT_PARTS=keys$1(LOCAL_SINGLE_TIMEUNIT_INDEX);function isLocalSingleTimeUnit(e){return!!LOCAL_SINGLE_TIMEUNIT_INDEX[e]}function isUTCTimeUnit(e){return e.startsWith("utc")}function getLocalTimeUnit(e){return e.substr(3)}const VEGALITE_TIMEFORMAT={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function getTimeUnitParts(e){return TIMEUNIT_PARTS.filter(n=>containsTimeUnit(e,n))}function containsTimeUnit(e,n){const i=e.indexOf(n);return!(i<0||i>0&&n==="seconds"&&e.charAt(i-1)==="i"||e.length>i+3&&n==="day"&&e.charAt(i+3)==="o"||i>0&&n==="year"&&e.charAt(i-1)==="f")}function fieldExpr(e,n,{end:i}={end:!1}){const r=accessPathWithDatum(n),s=isUTCTimeUnit(e)?"utc":"";function o(d){return d==="quarter"?`(${s}quarter(${r})-1)`:`${s}${d}(${r})`}let l;const f={};for(const d of TIMEUNIT_PARTS)containsTimeUnit(e,d)&&(f[d]=o(d),l=d);return i&&(f[l]+="+1"),dateTimeExprToExpr(f)}function timeUnitSpecifierExpression(e){if(!e)return;const n=getTimeUnitParts(e);return`timeUnitSpecifier(${stringify(n)}, ${stringify(VEGALITE_TIMEFORMAT)})`}function formatExpression(e,n,i){if(!e)return;const r=timeUnitSpecifierExpression(e);return`${i||isUTCTimeUnit(e)?"utc":"time"}Format(${n}, ${r})`}function normalizeTimeUnit(e){if(!e)return;let n;return isString(e)?n={unit:e}:isObject(e)&&(n=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),isUTCTimeUnit(n.unit)&&(n.utc=!0,n.unit=getLocalTimeUnit(n.unit)),n}function timeUnitToString(e){const n=normalizeTimeUnit(e),{utc:i}=n,r=__rest$s(n,["utc"]);return r.unit?(i?"utc":"")+keys$1(r).map(s=>varName(`${s==="unit"?"":`_${s}_`}${r[s]}`)).join(""):(i?"utc":"")+"timeunit"+keys$1(r).map(s=>varName(`_${s}_${r[s]}`)).join("")}function isSelectionPredicate(e){return e==null?void 0:e.param}function isFieldEqualPredicate(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function isFieldLTPredicate(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function isFieldLTEPredicate(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function isFieldGTPredicate(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function isFieldGTEPredicate(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function isFieldRangePredicate(e){if(e!=null&&e.field){if(isArray(e.range)&&e.range.length===2)return!0;if(isSignalRef(e.range))return!0}return!1}function isFieldOneOfPredicate(e){return!!(e!=null&&e.field)&&(isArray(e.oneOf)||isArray(e.in))}function isFieldValidPredicate(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function isFieldPredicate(e){return isFieldOneOfPredicate(e)||isFieldEqualPredicate(e)||isFieldRangePredicate(e)||isFieldLTPredicate(e)||isFieldGTPredicate(e)||isFieldLTEPredicate(e)||isFieldGTEPredicate(e)}function predicateValueExpr(e,n){return valueExpr(e,{timeUnit:n,wrapTime:!0})}function predicateValuesExpr(e,n){return e.map(i=>predicateValueExpr(i,n))}function fieldFilterExpression(e,n=!0){var i;const{field:r}=e,s=(i=normalizeTimeUnit(e.timeUnit))===null||i===void 0?void 0:i.unit,o=s?`time(${fieldExpr(s,r)})`:vgField(e,{expr:"datum"});if(isFieldEqualPredicate(e))return`${o}===${predicateValueExpr(e.equal,s)}`;if(isFieldLTPredicate(e)){const l=e.lt;return`${o}<${predicateValueExpr(l,s)}`}else if(isFieldGTPredicate(e)){const l=e.gt;return`${o}>${predicateValueExpr(l,s)}`}else if(isFieldLTEPredicate(e)){const l=e.lte;return`${o}<=${predicateValueExpr(l,s)}`}else if(isFieldGTEPredicate(e)){const l=e.gte;return`${o}>=${predicateValueExpr(l,s)}`}else{if(isFieldOneOfPredicate(e))return`indexof([${predicateValuesExpr(e.oneOf,s).join(",")}], ${o}) !== -1`;if(isFieldValidPredicate(e))return fieldValidPredicate(o,e.valid);if(isFieldRangePredicate(e)){const{range:l}=e,f=isSignalRef(l)?{signal:`${l.signal}[0]`}:l[0],d=isSignalRef(l)?{signal:`${l.signal}[1]`}:l[1];if(f!==null&&d!==null&&n)return"inrange("+o+", ["+predicateValueExpr(f,s)+", "+predicateValueExpr(d,s)+"])";const p=[];return f!==null&&p.push(`${o} >= ${predicateValueExpr(f,s)}`),d!==null&&p.push(`${o} <= ${predicateValueExpr(d,s)}`),p.length>0?p.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${stringify(e)}`)}function fieldValidPredicate(e,n=!0){return n?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function normalizePredicate$1(e){var n;return isFieldPredicate(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(n=normalizeTimeUnit(e.timeUnit))===null||n===void 0?void 0:n.unit}):e}const Type={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function isContinuous(e){return e==="quantitative"||e==="temporal"}function isDiscrete$1(e){return e==="ordinal"||e==="nominal"}const QUANTITATIVE=Type.quantitative,ORDINAL=Type.ordinal,TEMPORAL=Type.temporal,NOMINAL=Type.nominal,GEOJSON=Type.geojson;function getFullName(e){if(e)switch(e=e.toLowerCase(),e){case"q":case QUANTITATIVE:return"quantitative";case"t":case TEMPORAL:return"temporal";case"o":case ORDINAL:return"ordinal";case"n":case NOMINAL:return"nominal";case GEOJSON:return"geojson"}}var __rest$r=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const ScaleType={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},SCALE_CATEGORY_INDEX={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function scaleCompatible(e,n){const i=SCALE_CATEGORY_INDEX[e],r=SCALE_CATEGORY_INDEX[n];return i===r||i==="ordinal-position"&&r==="time"||r==="ordinal-position"&&i==="time"}const SCALE_PRECEDENCE_INDEX={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function scaleTypePrecedence(e){return SCALE_PRECEDENCE_INDEX[e]}const QUANTITATIVE_SCALES=new Set(["linear","log","pow","sqrt","symlog"]),CONTINUOUS_TO_CONTINUOUS_SCALES=new Set([...QUANTITATIVE_SCALES,"time","utc"]);function isQuantitative(e){return QUANTITATIVE_SCALES.has(e)}const CONTINUOUS_TO_DISCRETE_SCALES=new Set(["quantile","quantize","threshold"]),CONTINUOUS_DOMAIN_SCALES=new Set([...CONTINUOUS_TO_CONTINUOUS_SCALES,...CONTINUOUS_TO_DISCRETE_SCALES,"sequential","identity"]),DISCRETE_DOMAIN_SCALES=new Set(["ordinal","bin-ordinal","point","band"]);function hasDiscreteDomain(e){return DISCRETE_DOMAIN_SCALES.has(e)}function hasContinuousDomain(e){return CONTINUOUS_DOMAIN_SCALES.has(e)}function isContinuousToContinuous(e){return CONTINUOUS_TO_CONTINUOUS_SCALES.has(e)}function isContinuousToDiscrete(e){return CONTINUOUS_TO_DISCRETE_SCALES.has(e)}const defaultScaleConfig={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function isExtendedScheme(e){return!isString(e)&&!!e.name}function isParameterDomain(e){return e==null?void 0:e.param}function isDomainUnionWith(e){return e==null?void 0:e.unionWith}function isFieldRange(e){return isObject(e)&&"field"in e}const SCALE_PROPERTY_INDEX={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX=__rest$r(SCALE_PROPERTY_INDEX,["type","domain","range","rangeMax","rangeMin","scheme"]),NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES=keys$1(NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX);function scaleTypeSupportProperty(e,n){switch(n){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return isContinuousToContinuous(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return isContinuousToContinuous(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return isContinuousToContinuous(e);case"nice":return isContinuousToContinuous(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return hasContinuousDomain(e)&&!contains(["log","time","utc","threshold","quantile"],e)}}function channelScalePropertyIncompatability(e,n){switch(n){case"interpolate":case"scheme":case"domainMid":return isColorChannel(e)?void 0:cannotUseScalePropertyWithNonColor(n);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function scaleTypeSupportDataType(e,n){return contains([ORDINAL,NOMINAL],n)?e===void 0||hasDiscreteDomain(e):n===TEMPORAL?contains([ScaleType.TIME,ScaleType.UTC,void 0],e):n===QUANTITATIVE?isQuantitative(e)||isContinuousToDiscrete(e)||e===void 0:!0}function channelSupportScaleType(e,n,i=!1){if(!isScaleChannel(e))return!1;switch(e){case X:case Y:case XOFFSET:case YOFFSET:case THETA:case RADIUS:return isContinuousToContinuous(n)||n==="band"?!0:n==="point"?!i:!1;case SIZE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case ANGLE:return isContinuousToContinuous(n)||isContinuousToDiscrete(n)||contains(["band","point","ordinal"],n);case COLOR:case FILL:case STROKE:return n!=="band";case STROKEDASH:case SHAPE:return n==="ordinal"||isContinuousToDiscrete(n)}}const Mark={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},ARC=Mark.arc,AREA=Mark.area,BAR=Mark.bar,IMAGE=Mark.image,LINE=Mark.line,POINT=Mark.point,RECT=Mark.rect,RULE=Mark.rule,TEXT=Mark.text,TICK=Mark.tick,TRAIL=Mark.trail,CIRCLE=Mark.circle,SQUARE=Mark.square,GEOSHAPE=Mark.geoshape;function isPathMark(e){return["line","area","trail"].includes(e)}function isRectBasedMark(e){return["rect","bar","image","arc"].includes(e)}const PRIMITIVE_MARKS=new Set(keys$1(Mark));function isMarkDef(e){return e.type}const STROKE_CONFIG=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],FILL_CONFIG=["fill","fillOpacity"],FILL_STROKE_CONFIG=[...STROKE_CONFIG,...FILL_CONFIG],VL_ONLY_MARK_CONFIG_INDEX={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},VL_ONLY_MARK_CONFIG_PROPERTIES=keys$1(VL_ONLY_MARK_CONFIG_INDEX),VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},defaultMarkConfig={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},MARK_CONFIG_INDEX={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},MARK_CONFIGS=keys$1(MARK_CONFIG_INDEX);function isRelativeBandSize(e){return e&&e.band!=null}const BAR_CORNER_RADIUS_INDEX={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},DEFAULT_RECT_BAND_SIZE=5,defaultBarConfig={binSpacing:1,continuousBandSize:DEFAULT_RECT_BAND_SIZE,timeUnitBandPosition:.5},defaultRectConfig={binSpacing:0,continuousBandSize:DEFAULT_RECT_BAND_SIZE,timeUnitBandPosition:.5},defaultTickConfig={thickness:1};function getMarkType(e){return isMarkDef(e)?e.type:e}function midPointRefWithPositionInvalidTest(e){const{channel:n,channelDef:i,markDef:r,scale:s,config:o}=e,l=midPoint(e);return isFieldDef(i)&&!isCountingAggregateOp(i.aggregate)&&s&&isContinuousToContinuous(s.get("type"))?wrapPositionInvalidTest({fieldDef:i,channel:n,markDef:r,ref:l,config:o}):l}function wrapPositionInvalidTest({fieldDef:e,channel:n,markDef:i,ref:r,config:s}){return isPathMark(i.type)?r:getMarkPropOrConfig("invalid",i,s)===null?[fieldInvalidTestValueRef(e,n),r]:r}function fieldInvalidTestValueRef(e,n){const i=fieldInvalidPredicate(e,!0),s=getMainRangeChannel(n)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:i},s)}function fieldInvalidPredicate(e,n=!0){return fieldValidPredicate(isString(e)?e:vgField(e,{expr:"datum"}),!n)}function datumDefToExpr(e){const{datum:n}=e;return isDateTime(n)?dateTimeToExpr(n):`${stringify(n)}`}function valueRefForFieldOrDatumDef(e,n,i,r){const s={};if(n&&(s.scale=n),isDatumDef(e)){const{datum:o}=e;isDateTime(o)?s.signal=dateTimeToExpr(o):isSignalRef(o)?s.signal=o.signal:isExprRef(o)?s.signal=o.expr:s.value=o}else s.field=vgField(e,i);if(r){const{offset:o,band:l}=r;o&&(s.offset=o),l&&(s.band=l)}return s}function interpolatedSignalRef({scaleName:e,fieldOrDatumDef:n,fieldOrDatumDef2:i,offset:r,startSuffix:s,bandPosition:o=.5}){const l=0<o&&o<1?"datum":void 0,f=vgField(n,{expr:l,suffix:s}),d=i!==void 0?vgField(i,{expr:l}):vgField(n,{suffix:"end",expr:l}),p={};if(o===0||o===1){p.scale=e;const g=o===0?f:d;p.field=g}else{const g=isSignalRef(o)?`${o.signal} * ${f} + (1-${o.signal}) * ${d}`:`${o} * ${f} + ${1-o} * ${d}`;p.signal=`scale("${e}", ${g})`}return r&&(p.offset=r),p}function midPoint({channel:e,channelDef:n,channel2Def:i,markDef:r,config:s,scaleName:o,scale:l,stack:f,offset:d,defaultRef:p,bandPosition:g}){var v;if(n){if(isFieldOrDatumDef(n)){const S=l==null?void 0:l.get("type");if(isTypedFieldDef(n)){g??(g=getBandPosition({fieldDef:n,fieldDef2:i,markDef:r,config:s}));const{bin:T,timeUnit:k,type:O}=n;if(isBinning(T)||g&&k&&O===TEMPORAL)return f!=null&&f.impute?valueRefForFieldOrDatumDef(n,o,{binSuffix:"mid"},{offset:d}):g&&!hasDiscreteDomain(S)?interpolatedSignalRef({scaleName:o,fieldOrDatumDef:n,bandPosition:g,offset:d}):valueRefForFieldOrDatumDef(n,o,binRequiresRange(n,e)?{binSuffix:"range"}:{},{offset:d});if(isBinned(T)){if(isFieldDef(i))return interpolatedSignalRef({scaleName:o,fieldOrDatumDef:n,fieldOrDatumDef2:i,bandPosition:g,offset:d});warn(channelRequiredForBinned(e===X?X2:Y2))}}return valueRefForFieldOrDatumDef(n,o,hasDiscreteDomain(S)?{binSuffix:"range"}:{},{offset:d,band:S==="band"?(v=g??n.bandPosition)!==null&&v!==void 0?v:.5:void 0})}else if(isValueDef(n)){const S=n.value,T=d?{offset:d}:{};return Object.assign(Object.assign({},widthHeightValueOrSignalRef(e,S)),T)}}return isFunction(p)&&(p=p()),p&&Object.assign(Object.assign({},p),d?{offset:d}:{})}function widthHeightValueOrSignalRef(e,n){return contains(["x","x2"],e)&&n==="width"?{field:{group:"width"}}:contains(["y","y2"],e)&&n==="height"?{field:{group:"height"}}:signalOrValueRef(n)}function isCustomFormatType(e){return e&&e!=="number"&&e!=="time"}function customFormatExpr(e,n,i){return`${e}(${n}${i?`, ${stringify(i)}`:""})`}const BIN_RANGE_DELIMITER="  ";function formatSignalRef({fieldOrDatumDef:e,format:n,formatType:i,expr:r,normalizeStack:s,config:o}){var l,f;if(isCustomFormatType(i))return formatCustomType({fieldOrDatumDef:e,format:n,formatType:i,expr:r,config:o});const d=fieldToFormat(e,r,s),p=channelDefType(e);if(n===void 0&&i===void 0&&o.customFormatTypes){if(p==="quantitative"){if(s&&o.normalizedNumberFormatType)return formatCustomType({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return formatCustomType({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(p==="temporal"&&o.timeFormatType&&isFieldDef(e)&&e.timeUnit===void 0)return formatCustomType({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(isFieldOrDatumDefForTimeFormat(e)){const g=timeFormatExpression({field:d,timeUnit:isFieldDef(e)?(l=normalizeTimeUnit(e.timeUnit))===null||l===void 0?void 0:l.unit:void 0,format:n,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:isScaleFieldDef(e)&&((f=e.scale)===null||f===void 0?void 0:f.type)===ScaleType.UTC});return g?{signal:g}:void 0}if(n=numberFormat({type:p,specifiedFormat:n,config:o,normalizeStack:s}),isFieldDef(e)&&isBinning(e.bin)){const g=vgField(e,{expr:r,binSuffix:"end"});return{signal:binFormatExpression(d,g,n,i,o)}}else return n||channelDefType(e)==="quantitative"?{signal:`${formatExpr(d,n)}`}:{signal:`isValid(${d}) ? ${d} : ""+${d}`}}function fieldToFormat(e,n,i){return isFieldDef(e)?i?`${vgField(e,{expr:n,suffix:"end"})}-${vgField(e,{expr:n,suffix:"start"})}`:vgField(e,{expr:n}):datumDefToExpr(e)}function formatCustomType({fieldOrDatumDef:e,format:n,formatType:i,expr:r,normalizeStack:s,config:o,field:l}){if(l??(l=fieldToFormat(e,r,s)),l!=="datum.value"&&isFieldDef(e)&&isBinning(e.bin)){const f=vgField(e,{expr:r,binSuffix:"end"});return{signal:binFormatExpression(l,f,n,i,o)}}return{signal:customFormatExpr(i,l,n)}}function guideFormat(e,n,i,r,s,o){var l;if(!isCustomFormatType(r)&&!(i===void 0&&r===void 0&&s.customFormatTypes&&channelDefType(e)==="quantitative"&&(s.normalizedNumberFormatType&&isPositionFieldOrDatumDef(e)&&e.stack==="normalize"||s.numberFormatType))){if(isPositionFieldOrDatumDef(e)&&e.stack==="normalize"&&s.normalizedNumberFormat)return numberFormat({type:"quantitative",config:s,normalizeStack:!0});if(isFieldOrDatumDefForTimeFormat(e)){const f=isFieldDef(e)?(l=normalizeTimeUnit(e.timeUnit))===null||l===void 0?void 0:l.unit:void 0;return f===void 0&&s.customFormatTypes&&s.timeFormatType?void 0:timeFormat({specifiedFormat:i,timeUnit:f,config:s,omitTimeFormatConfig:o})}return numberFormat({type:n,specifiedFormat:i,config:s})}}function guideFormatType(e,n,i){var r;if(e&&(isSignalRef(e)||e==="number"||e==="time"))return e;if(isFieldOrDatumDefForTimeFormat(n)&&i!=="time"&&i!=="utc")return isFieldDef(n)&&(!((r=normalizeTimeUnit(n==null?void 0:n.timeUnit))===null||r===void 0)&&r.utc)?"utc":"time"}function numberFormat({type:e,specifiedFormat:n,config:i,normalizeStack:r}){if(isString(n))return n;if(e===QUANTITATIVE)return r?i.normalizedNumberFormat:i.numberFormat}function timeFormat({specifiedFormat:e,timeUnit:n,config:i,omitTimeFormatConfig:r}){return e||(n?{signal:timeUnitSpecifierExpression(n)}:r?void 0:i.timeFormat)}function formatExpr(e,n){return`format(${e}, "${n||""}")`}function binNumberFormatExpr(e,n,i,r){var s;return isCustomFormatType(i)?customFormatExpr(i,e,n):formatExpr(e,(s=isString(n)?n:void 0)!==null&&s!==void 0?s:r.numberFormat)}function binFormatExpression(e,n,i,r,s){if(i===void 0&&r===void 0&&s.customFormatTypes&&s.numberFormatType)return binFormatExpression(e,n,s.numberFormat,s.numberFormatType,s);const o=binNumberFormatExpr(e,i,r,s),l=binNumberFormatExpr(n,i,r,s);return`${fieldValidPredicate(e,!1)} ? "null" : ${o} + "${BIN_RANGE_DELIMITER}" + ${l}`}function timeFormatExpression({field:e,timeUnit:n,format:i,formatType:r,rawTimeFormat:s,isUTCScale:o}){return!n||i?!n&&r?`${r}(${e}, '${i}')`:(i=isString(i)?i:s,`${o?"utc":"time"}Format(${e}, '${i}')`):formatExpression(n,e,o)}const DEFAULT_SORT_OP="min",SORT_BY_CHANNEL_INDEX={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function isSortByChannel(e){return e in SORT_BY_CHANNEL_INDEX}function isSortByEncoding(e){return!!(e!=null&&e.encoding)}function isSortField(e){return e&&(e.op==="count"||!!e.field)}function isSortArray(e){return e&&isArray(e)}function isFacetMapping(e){return"row"in e||"column"in e}function isFacetFieldDef(e){return!!e&&"header"in e}function isFacetSpec(e){return"facet"in e}var __rest$q=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function isConditionalParameter(e){return e.param}function isRepeatRef(e){return e&&!isString(e)&&"repeat"in e}function toFieldDefBase(e){const{field:n,timeUnit:i,bin:r,aggregate:s}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},i?{timeUnit:i}:{}),r?{bin:r}:{}),s?{aggregate:s}:{}),{field:n})}function isSortableFieldDef(e){return"sort"in e}function getBandPosition({fieldDef:e,fieldDef2:n,markDef:i,config:r}){if(isFieldOrDatumDef(e)&&e.bandPosition!==void 0)return e.bandPosition;if(isFieldDef(e)){const{timeUnit:s,bin:o}=e;if(s&&!n)return isRectBasedMark(i.type)?0:getMarkConfig("timeUnitBandPosition",i,r);if(isBinning(o))return .5}}function getBandSize({channel:e,fieldDef:n,fieldDef2:i,markDef:r,config:s,scaleType:o,useVlSizeChannel:l}){var f,d,p;const g=getSizeChannel(e),v=getMarkPropOrConfig(l?"size":g,r,s,{vgChannel:g});if(v!==void 0)return v;if(isFieldDef(n)){const{timeUnit:S,bin:T}=n;if(S&&!i)return{band:getMarkConfig("timeUnitBandSize",r,s)};if(isBinning(T)&&!hasDiscreteDomain(o))return{band:1}}if(isRectBasedMark(r.type))return o?hasDiscreteDomain(o)?((f=s[r.type])===null||f===void 0?void 0:f.discreteBandSize)||{band:1}:(d=s[r.type])===null||d===void 0?void 0:d.continuousBandSize:(p=s[r.type])===null||p===void 0?void 0:p.discreteBandSize}function hasBandEnd(e,n,i,r){return isBinning(e.bin)||e.timeUnit&&isTypedFieldDef(e)&&e.type==="temporal"?getBandPosition({fieldDef:e,fieldDef2:n,markDef:i,config:r})!==void 0:!1}function isConditionalDef(e){return e&&"condition"in e}function hasConditionalFieldDef(e){const n=e==null?void 0:e.condition;return!!n&&!isArray(n)&&isFieldDef(n)}function hasConditionalFieldOrDatumDef(e){const n=e==null?void 0:e.condition;return!!n&&!isArray(n)&&isFieldOrDatumDef(n)}function hasConditionalValueDef(e){const n=e==null?void 0:e.condition;return!!n&&(isArray(n)||isValueDef(n))}function isFieldDef(e){return e&&(!!e.field||e.aggregate==="count")}function channelDefType(e){return e==null?void 0:e.type}function isDatumDef(e){return e&&"datum"in e}function isContinuousFieldOrDatumDef(e){return isTypedFieldDef(e)&&!isDiscrete(e)||isNumericDataDef(e)}function isNumericDataDef(e){return isDatumDef(e)&&isNumber$1(e.datum)}function isFieldOrDatumDef(e){return isFieldDef(e)||isDatumDef(e)}function isTypedFieldDef(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function isValueDef(e){return e&&"value"in e&&"value"in e}function isScaleFieldDef(e){return e&&("scale"in e||"sort"in e)}function isPositionFieldOrDatumDef(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function isMarkPropFieldOrDatumDef(e){return e&&"legend"in e}function isStringFieldOrDatumDef(e){return e&&("format"in e||"formatType"in e)}function toStringFieldDef(e){return omit(e,["legend","axis","header","scale"])}function isOpFieldDef(e){return"op"in e}function vgField(e,n={}){var i,r,s;let o=e.field;const l=n.prefix;let f=n.suffix,d="";if(isCount(e))o=internalField("count");else{let p;if(!n.nofn)if(isOpFieldDef(e))p=e.op;else{const{bin:g,aggregate:v,timeUnit:S}=e;isBinning(g)?(p=binToString(g),f=((i=n.binSuffix)!==null&&i!==void 0?i:"")+((r=n.suffix)!==null&&r!==void 0?r:"")):v?isArgmaxDef(v)?(d=`["${o}"]`,o=`argmax_${v.argmax}`):isArgminDef(v)?(d=`["${o}"]`,o=`argmin_${v.argmin}`):p=String(v):S&&(p=timeUnitToString(S),f=(!["range","mid"].includes(n.binSuffix)&&n.binSuffix||"")+((s=n.suffix)!==null&&s!==void 0?s:""))}p&&(o=o?`${p}_${o}`:p)}return f&&(o=`${o}_${f}`),l&&(o=`${l}_${o}`),n.forAs?removePathFromField(o):n.expr?flatAccessWithDatum(o,n.expr)+d:replacePathInField(o)+d}function isDiscrete(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return isFieldDef(e)&&!!e.bin;case"temporal":return!1}throw new Error(invalidFieldType(e.type))}function isDiscretizing(e){var n;return isScaleFieldDef(e)&&isContinuousToDiscrete((n=e.scale)===null||n===void 0?void 0:n.type)}function isCount(e){return e.aggregate==="count"}function verbalTitleFormatter(e,n){var i;const{field:r,bin:s,timeUnit:o,aggregate:l}=e;if(l==="count")return n.countTitle;if(isBinning(s))return`${r} (binned)`;if(o){const f=(i=normalizeTimeUnit(o))===null||i===void 0?void 0:i.unit;if(f)return`${r} (${getTimeUnitParts(f).join("-")})`}else if(l)return isArgmaxDef(l)?`${r} for max ${l.argmax}`:isArgminDef(l)?`${r} for min ${l.argmin}`:`${titleCase(l)} of ${r}`;return r}function functionalTitleFormatter(e){const{aggregate:n,bin:i,timeUnit:r,field:s}=e;if(isArgmaxDef(n))return`${s} for argmax(${n.argmax})`;if(isArgminDef(n))return`${s} for argmin(${n.argmin})`;const o=normalizeTimeUnit(r),l=n||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||isBinning(i)&&"bin";return l?`${l.toUpperCase()}(${s})`:s}const defaultTitleFormatter=(e,n)=>{switch(n.fieldTitle){case"plain":return e.field;case"functional":return functionalTitleFormatter(e);default:return verbalTitleFormatter(e,n)}};let titleFormatter=defaultTitleFormatter;function setTitleFormatter(e){titleFormatter=e}function resetTitleFormatter(){setTitleFormatter(defaultTitleFormatter)}function title(e,n,{allowDisabling:i,includeDefault:r=!0}){var s,o;const l=(s=getGuide(e))===null||s===void 0?void 0:s.title;if(!isFieldDef(e))return l??e.title;const f=e,d=r?defaultTitle(f,n):void 0;return i?getFirstDefined(l,f.title,d):(o=l??f.title)!==null&&o!==void 0?o:d}function getGuide(e){if(isPositionFieldOrDatumDef(e)&&e.axis)return e.axis;if(isMarkPropFieldOrDatumDef(e)&&e.legend)return e.legend;if(isFacetFieldDef(e)&&e.header)return e.header}function defaultTitle(e,n){return titleFormatter(e,n)}function getFormatMixins(e){var n;if(isStringFieldOrDatumDef(e)){const{format:i,formatType:r}=e;return{format:i,formatType:r}}else{const i=(n=getGuide(e))!==null&&n!==void 0?n:{},{format:r,formatType:s}=i;return{format:r,formatType:s}}}function defaultType$2(e,n){var i;switch(n){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(isSortableFieldDef(e)&&isArray(e.sort))return"ordinal";const{aggregate:r,bin:s,timeUnit:o}=e;if(o)return"temporal";if(s||r&&!isArgmaxDef(r)&&!isArgminDef(r))return"quantitative";if(isScaleFieldDef(e)&&(!((i=e.scale)===null||i===void 0)&&i.type))switch(SCALE_CATEGORY_INDEX[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function getFieldDef(e){if(isFieldDef(e))return e;if(hasConditionalFieldDef(e))return e.condition}function getFieldOrDatumDef(e){if(isFieldOrDatumDef(e))return e;if(hasConditionalFieldOrDatumDef(e))return e.condition}function initChannelDef(e,n,i,r={}){if(isString(e)||isNumber$1(e)||isBoolean$2(e)){const s=isString(e)?"string":isNumber$1(e)?"number":"boolean";return warn(primitiveChannelDef(n,s,e)),{value:e}}return isFieldOrDatumDef(e)?initFieldOrDatumDef(e,n,i,r):hasConditionalFieldOrDatumDef(e)?Object.assign(Object.assign({},e),{condition:initFieldOrDatumDef(e.condition,n,i,r)}):e}function initFieldOrDatumDef(e,n,i,r){if(isStringFieldOrDatumDef(e)){const{format:s,formatType:o}=e,l=__rest$q(e,["format","formatType"]);if(isCustomFormatType(o)&&!i.customFormatTypes)return warn(customFormatTypeNotAllowed(n)),initFieldOrDatumDef(l,n,i,r)}else{const s=isPositionFieldOrDatumDef(e)?"axis":isMarkPropFieldOrDatumDef(e)?"legend":isFacetFieldDef(e)?"header":null;if(s&&e[s]){const o=e[s],{format:l,formatType:f}=o,d=__rest$q(o,["format","formatType"]);if(isCustomFormatType(f)&&!i.customFormatTypes)return warn(customFormatTypeNotAllowed(n)),initFieldOrDatumDef(Object.assign(Object.assign({},e),{[s]:d}),n,i,r)}}return isFieldDef(e)?initFieldDef(e,n,r):initDatumDef(e)}function initDatumDef(e){let n=e.type;if(n)return e;const{datum:i}=e;return n=isNumber$1(i)?"quantitative":isString(i)?"nominal":isDateTime(i)?"temporal":void 0,Object.assign(Object.assign({},e),{type:n})}function initFieldDef(e,n,{compositeMark:i=!1}={}){const{aggregate:r,timeUnit:s,bin:o,field:l}=e,f=Object.assign({},e);if(!i&&r&&!isAggregateOp(r)&&!isArgmaxDef(r)&&!isArgminDef(r)&&(warn(invalidAggregate(r)),delete f.aggregate),s&&(f.timeUnit=normalizeTimeUnit(s)),l&&(f.field=`${l}`),isBinning(o)&&(f.bin=normalizeBin(o,n)),isBinned(o)&&!isXorY(n)&&warn(channelShouldNotBeUsedForBinned(n)),isTypedFieldDef(f)){const{type:d}=f,p=getFullName(d);d!==p&&(f.type=p),d!=="quantitative"&&isCountingAggregateOp(r)&&(warn(invalidFieldTypeForCountAggregate(d,r)),f.type="quantitative")}else if(!isSecondaryRangeChannel(n)){const d=defaultType$2(f,n);f.type=d}if(isTypedFieldDef(f)){const{compatible:d,warning:p}=channelCompatibility(f,n)||{};d===!1&&warn(p)}if(isSortableFieldDef(f)&&isString(f.sort)){const{sort:d}=f;if(isSortByChannel(d))return Object.assign(Object.assign({},f),{sort:{encoding:d}});const p=d.substr(1);if(d.charAt(0)==="-"&&isSortByChannel(p))return Object.assign(Object.assign({},f),{sort:{encoding:p,order:"descending"}})}if(isFacetFieldDef(f)){const{header:d}=f;if(d){const{orient:p}=d,g=__rest$q(d,["orient"]);if(p)return Object.assign(Object.assign({},f),{header:Object.assign(Object.assign({},g),{labelOrient:d.labelOrient||p,titleOrient:d.titleOrient||p})})}}return f}function normalizeBin(e,n){return isBoolean$2(e)?{maxbins:autoMaxBins(n)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:autoMaxBins(n)}):e}const COMPATIBLE={compatible:!0};function channelCompatibility(e,n){const i=e.type;if(i==="geojson"&&n!=="shape")return{compatible:!1,warning:`Channel ${n} should not be used with a geojson data.`};switch(n){case ROW:case COLUMN:case FACET:return isDiscrete(e)?COMPATIBLE:{compatible:!1,warning:channelShouldBeDiscrete(n)};case X:case Y:case XOFFSET:case YOFFSET:case COLOR:case FILL:case STROKE:case TEXT$1:case DETAIL:case KEY:case TOOLTIP:case HREF:case URL$1:case ANGLE:case THETA:case RADIUS:case DESCRIPTION:return COMPATIBLE;case LONGITUDE:case LONGITUDE2:case LATITUDE:case LATITUDE2:return i!==QUANTITATIVE?{compatible:!1,warning:`Channel ${n} should be used with a quantitative field only, not ${e.type} field.`}:COMPATIBLE;case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEWIDTH:case SIZE:case THETA2:case RADIUS2:case X2:case Y2:return i==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${n} should not be used with an unsorted discrete field.`}:COMPATIBLE;case SHAPE:case STROKEDASH:return!isDiscrete(e)&&!isDiscretizing(e)?{compatible:!1,warning:channelShouldBeDiscreteOrDiscretizing(n)}:COMPATIBLE;case ORDER:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:COMPATIBLE}}function isFieldOrDatumDefForTimeFormat(e){const{formatType:n}=getFormatMixins(e);return n==="time"||!n&&isTimeFieldDef(e)}function isTimeFieldDef(e){return e&&(e.type==="temporal"||isFieldDef(e)&&!!e.timeUnit)}function valueExpr(e,{timeUnit:n,type:i,wrapTime:r,undefinedIfExprNotRequired:s}){var o;const l=n&&((o=normalizeTimeUnit(n))===null||o===void 0?void 0:o.unit);let f=l||i==="temporal",d;return isExprRef(e)?d=e.expr:isSignalRef(e)?d=e.signal:isDateTime(e)?(f=!0,d=dateTimeToExpr(e)):(isString(e)||isNumber$1(e))&&f&&(d=`datetime(${stringify(e)})`,isLocalSingleTimeUnit(l)&&(isNumber$1(e)&&e<1e4||isString(e)&&isNaN(Date.parse(e)))&&(d=dateTimeToExpr({[l]:e}))),d?r&&f?`time(${d})`:d:s?void 0:stringify(e)}function valueArray(e,n){const{type:i}=e;return n.map(r=>{const s=valueExpr(r,{timeUnit:isFieldDef(e)?e.timeUnit:void 0,type:i,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:r})}function binRequiresRange(e,n){return isBinning(e.bin)?isScaleChannel(n)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const CONDITIONAL_AXIS_PROP_INDEX={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function isConditionalAxisValue(e){return e==null?void 0:e.condition}const AXIS_PARTS=["domain","grid","labels","ticks","title"],AXIS_PROPERTY_TYPE={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},COMMON_AXIS_PROPERTIES_INDEX={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},AXIS_PROPERTIES_INDEX=Object.assign(Object.assign({},COMMON_AXIS_PROPERTIES_INDEX),{style:1,labelExpr:1,encoding:1});function isAxisProperty(e){return!!AXIS_PROPERTIES_INDEX[e]}const AXIS_CONFIGS_INDEX={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},AXIS_CONFIGS=keys$1(AXIS_CONFIGS_INDEX);function isUnitSpec(e){return"mark"in e}class CompositeMarkNormalizer{constructor(n,i){this.name=n,this.run=i}hasMatchingType(n){return isUnitSpec(n)?getMarkType(n.mark)===this.name:!1}}var __rest$p=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function channelHasField(e,n){const i=e&&e[n];return i?isArray(i)?some(i,r=>!!r.field):isFieldDef(i)||hasConditionalFieldDef(i):!1}function channelHasFieldOrDatum(e,n){const i=e&&e[n];return i?isArray(i)?some(i,r=>!!r.field):isFieldDef(i)||isDatumDef(i)||hasConditionalFieldOrDatumDef(i):!1}function channelHasNestedOffsetScale(e,n){if(isXorY(n)){const i=e[n];if((isFieldDef(i)||isDatumDef(i))&&isDiscrete$1(i.type)){const r=getOffsetScaleChannel(n);return channelHasFieldOrDatum(e,r)}}return!1}function isAggregate$1(e){return some(CHANNELS,n=>{if(channelHasField(e,n)){const i=e[n];if(isArray(i))return some(i,r=>!!r.aggregate);{const r=getFieldDef(i);return r&&!!r.aggregate}}return!1})}function extractTransformsFromEncoding(e,n){const i=[],r=[],s=[],o=[],l={};return forEach(e,(f,d)=>{if(isFieldDef(f)){const{field:p,aggregate:g,bin:v,timeUnit:S}=f,T=__rest$p(f,["field","aggregate","bin","timeUnit"]);if(g||S||v){const k=getGuide(f),O=k==null?void 0:k.title;let R=vgField(f,{forAs:!0});const P=Object.assign(Object.assign(Object.assign({},O?[]:{title:title(f,n,{allowDisabling:!0})}),T),{field:R});if(g){let F;if(isArgmaxDef(g)?(F="argmax",R=vgField({op:"argmax",field:g.argmax},{forAs:!0}),P.field=`${R}.${p}`):isArgminDef(g)?(F="argmin",R=vgField({op:"argmin",field:g.argmin},{forAs:!0}),P.field=`${R}.${p}`):g!=="boxplot"&&g!=="errorbar"&&g!=="errorband"&&(F=g),F){const I={op:F,as:R};p&&(I.field=p),o.push(I)}}else if(i.push(R),isTypedFieldDef(f)&&isBinning(v)){if(r.push({bin:v,field:p,as:R}),i.push(vgField(f,{binSuffix:"end"})),binRequiresRange(f,d)&&i.push(vgField(f,{binSuffix:"range"})),isXorY(d)){const F={field:`${R}_end`};l[`${d}2`]=F}P.bin="binned",isSecondaryRangeChannel(d)||(P.type=QUANTITATIVE)}else if(S){s.push({timeUnit:S,field:p,as:R});const F=isTypedFieldDef(f)&&f.type!==TEMPORAL&&"time";F&&(d===TEXT$1||d===TOOLTIP?P.formatType=F:isNonPositionScaleChannel(d)?P.legend=Object.assign({formatType:F},P.legend):isXorY(d)&&(P.axis=Object.assign({formatType:F},P.axis)))}l[d]=P}else i.push(p),l[d]=e[d]}else l[d]=e[d]}),{bins:r,timeUnits:s,aggregate:o,groupby:i,encoding:l}}function markChannelCompatible(e,n,i){const r=supportMark(n,i);if(r){if(r==="binned"){const s=e[n===X2?X:Y];return!!(isFieldDef(s)&&isFieldDef(e[n])&&isBinned(s.bin))}}else return!1;return!0}function initEncoding(e,n,i,r){const s={};for(const o of keys$1(e))isChannel(o)||warn(invalidEncodingChannel(o));for(let o of UNIT_CHANNELS){if(!e[o])continue;const l=e[o];if(isXorYOffset(o)){const f=getMainChannelFromOffsetChannel(o),d=s[f];if(isFieldDef(d)){if(isContinuous(d.type)&&isFieldDef(l)){warn(offsetNestedInsideContinuousPositionScaleDropped(f));continue}}else o=f,warn(replaceOffsetWithMainChannel(f))}if(o==="angle"&&n==="arc"&&!e.theta&&(warn(REPLACE_ANGLE_WITH_THETA),o=THETA),!markChannelCompatible(e,o,n)){warn(incompatibleChannel(o,n));continue}if(o===SIZE&&n==="line"){const f=getFieldDef(e[o]);if(f!=null&&f.aggregate){warn(LINE_WITH_VARYING_SIZE);continue}}if(o===COLOR&&(i?"fill"in e:"stroke"in e)){warn(droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===DETAIL||o===ORDER&&!isArray(l)&&!isValueDef(l)||o===TOOLTIP&&isArray(l))l&&(s[o]=array$5(l).reduce((f,d)=>(isFieldDef(d)?f.push(initFieldDef(d,o)):warn(emptyFieldDef(d,o)),f),[]));else{if(o===TOOLTIP&&l===null)s[o]=null;else if(!isFieldDef(l)&&!isDatumDef(l)&&!isValueDef(l)&&!isConditionalDef(l)&&!isSignalRef(l)){warn(emptyFieldDef(l,o));continue}s[o]=initChannelDef(l,o,r)}}return s}function normalizeEncoding(e,n){const i={};for(const r of keys$1(e)){const s=initChannelDef(e[r],r,n,{compositeMark:!0});i[r]=s}return i}function fieldDefs(e){const n=[];for(const i of keys$1(e))if(channelHasField(e,i)){const r=e[i],s=array$5(r);for(const o of s)isFieldDef(o)?n.push(o):hasConditionalFieldDef(o)&&n.push(o.condition)}return n}function forEach(e,n,i){if(e)for(const r of keys$1(e)){const s=e[r];if(isArray(s))for(const o of s)n.call(i,o,r);else n.call(i,s,r)}}function reduce(e,n,i,r){return e?keys$1(e).reduce((s,o)=>{const l=e[o];return isArray(l)?l.reduce((f,d)=>n.call(r,f,d,o),s):n.call(r,s,l,o)},i):i}function pathGroupingFields(e,n){return keys$1(n).reduce((i,r)=>{switch(r){case X:case Y:case HREF:case DESCRIPTION:case URL$1:case X2:case Y2:case XOFFSET:case YOFFSET:case THETA:case THETA2:case RADIUS:case RADIUS2:case LATITUDE:case LONGITUDE:case LATITUDE2:case LONGITUDE2:case TEXT$1:case SHAPE:case ANGLE:case TOOLTIP:return i;case ORDER:if(e==="line"||e==="trail")return i;case DETAIL:case KEY:{const s=n[r];if(isArray(s)||isFieldDef(s))for(const o of array$5(s))o.aggregate||i.push(vgField(o,{}));return i}case SIZE:if(e==="trail")return i;case COLOR:case FILL:case STROKE:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEDASH:case STROKEWIDTH:{const s=getFieldDef(n[r]);return s&&!s.aggregate&&i.push(vgField(s,{})),i}}},[])}var __rest$o=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function filterTooltipWithAggregatedField(e){const{tooltip:n}=e,i=__rest$o(e,["tooltip"]);if(!n)return{filteredEncoding:i};let r,s;if(isArray(n)){for(const o of n)o.aggregate?(r||(r=[]),r.push(o)):(s||(s=[]),s.push(o));r&&(i.tooltip=r)}else n.aggregate?i.tooltip=n:s=n;return isArray(s)&&s.length===1&&(s=s[0]),{customTooltipWithoutAggregatedField:s,filteredEncoding:i}}function getCompositeMarkTooltip(e,n,i,r=!0){if("tooltip"in i)return{tooltip:i.tooltip};const s=e.map(({fieldPrefix:l,titlePrefix:f})=>{const d=r?` of ${getTitle(n)}`:"";return{field:l+n.field,type:n.type,title:isSignalRef(f)?{signal:`${f}"${escape(d)}"`}:f+d}}),o=fieldDefs(i).map(toStringFieldDef);return{tooltip:[...s,...unique(o,hash)]}}function getTitle(e){const{title:n,field:i}=e;return getFirstDefined(n,i)}function makeCompositeAggregatePartFactory(e,n,i,r,s){const{scale:o,axis:l}=i;return({partName:f,mark:d,positionPrefix:p,endPositionPrefix:g=void 0,extraEncoding:v={}})=>{const S=getTitle(i);return partLayerMixins(e,f,s,{mark:d,encoding:Object.assign(Object.assign(Object.assign({[n]:Object.assign(Object.assign(Object.assign({field:`${p}_${i.field}`,type:i.type},S!==void 0?{title:S}:{}),o!==void 0?{scale:o}:{}),l!==void 0?{axis:l}:{})},isString(g)?{[`${n}2`]:{field:`${g}_${i.field}`}}:{}),r),v)})}}function partLayerMixins(e,n,i,r){const{clip:s,color:o,opacity:l}=e,f=e.type;return e[n]||e[n]===void 0&&i[n]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i[n]),s?{clip:s}:{}),o?{color:o}:{}),l?{opacity:l}:{}),isMarkDef(r.mark)?r.mark:{type:r.mark}),{style:`${f}-${String(n)}`}),isBoolean$2(e[n])?{}:e[n])})]:[]}function compositeMarkContinuousAxis(e,n,i){const{encoding:r}=e,s=n==="vertical"?"y":"x",o=r[s],l=r[`${s}2`],f=r[`${s}Error`],d=r[`${s}Error2`];return{continuousAxisChannelDef:filterAggregateFromChannelDef(o,i),continuousAxisChannelDef2:filterAggregateFromChannelDef(l,i),continuousAxisChannelDefError:filterAggregateFromChannelDef(f,i),continuousAxisChannelDefError2:filterAggregateFromChannelDef(d,i),continuousAxis:s}}function filterAggregateFromChannelDef(e,n){if(e!=null&&e.aggregate){const{aggregate:i}=e,r=__rest$o(e,["aggregate"]);return i!==n&&warn(errorBarContinuousAxisHasCustomizedAggregate(i,n)),r}else return e}function compositeMarkOrient(e,n){const{mark:i,encoding:r}=e,{x:s,y:o}=r;if(isMarkDef(i)&&i.orient)return i.orient;if(isContinuousFieldOrDatumDef(s)){if(isContinuousFieldOrDatumDef(o)){const l=isFieldDef(s)&&s.aggregate,f=isFieldDef(o)&&o.aggregate;if(!l&&f===n)return"vertical";if(!f&&l===n)return"horizontal";if(l===n&&f===n)throw new Error("Both x and y cannot have aggregate");return isFieldOrDatumDefForTimeFormat(o)&&!isFieldOrDatumDefForTimeFormat(s)?"horizontal":"vertical"}return"horizontal"}else{if(isContinuousFieldOrDatumDef(o))return"vertical";throw new Error(`Need a valid continuous axis for ${n}s`)}}var __rest$n=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const BOXPLOT="boxplot",BOXPLOT_PARTS=["box","median","outliers","rule","ticks"],boxPlotNormalizer=new CompositeMarkNormalizer(BOXPLOT,normalizeBoxPlot);function getBoxPlotType(e){return isNumber$1(e)?"tukey":e}function normalizeBoxPlot(e,{config:n}){var i,r;e=Object.assign(Object.assign({},e),{encoding:normalizeEncoding(e.encoding,n)});const{mark:s,encoding:o,params:l,projection:f}=e,d=__rest$n(e,["mark","encoding","params","projection"]),p=isMarkDef(s)?s:{type:s};l&&warn(selectionNotSupported("boxplot"));const g=(i=p.extent)!==null&&i!==void 0?i:n.boxplot.extent,v=getMarkPropOrConfig("size",p,n),S=p.invalid,T=getBoxPlotType(g),{bins:k,timeUnits:O,transform:R,continuousAxisChannelDef:P,continuousAxis:F,groupby:I,aggregate:L,encodingWithoutContinuousAxis:N,ticksOrient:j,boxOrient:z,customTooltipWithoutAggregatedField:q}=boxParams(e,g,n),{color:H,size:W}=N,U=__rest$n(N,["color","size"]),Q=ge=>makeCompositeAggregatePartFactory(p,F,P,ge,n.boxplot),J=Q(U),ne=Q(N),G=Q(Object.assign(Object.assign({},U),W?{size:W}:{})),Z=getCompositeMarkTooltip([{fieldPrefix:T==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:T==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],P,N),ae={type:"tick",color:"black",opacity:1,orient:j,invalid:S,aria:!1},oe=T==="min-max"?Z:getCompositeMarkTooltip([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],P,N),pe=[...J({partName:"rule",mark:{type:"rule",invalid:S,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:oe}),...J({partName:"rule",mark:{type:"rule",invalid:S,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:oe}),...J({partName:"ticks",mark:ae,positionPrefix:"lower_whisker",extraEncoding:oe}),...J({partName:"ticks",mark:ae,positionPrefix:"upper_whisker",extraEncoding:oe})],Se=[...T!=="tukey"?pe:[],...ne({partName:"box",mark:Object.assign(Object.assign({type:"bar"},v?{size:v}:{}),{orient:z,invalid:S,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:Z}),...G({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:S},isObject(n.boxplot.median)&&n.boxplot.median.color?{color:n.boxplot.median.color}:{}),v?{size:v}:{}),{orient:j,aria:!1}),positionPrefix:"mid_box",extraEncoding:Z})];if(T==="min-max")return Object.assign(Object.assign({},d),{transform:((r=d.transform)!==null&&r!==void 0?r:[]).concat(R),layer:Se});const ue=`datum["lower_box_${P.field}"]`,ee=`datum["upper_box_${P.field}"]`,V=`(${ee} - ${ue})`,se=`${ue} - ${g} * ${V}`,fe=`${ee} + ${g} * ${V}`,he=`datum["${P.field}"]`,be={joinaggregate:boxParamsQuartiles(P.field),groupby:I},xe={transform:[{filter:`(${se} <= ${he}) && (${he} <= ${fe})`},{aggregate:[{op:"min",field:P.field,as:`lower_whisker_${P.field}`},{op:"max",field:P.field,as:`upper_whisker_${P.field}`},{op:"min",field:`lower_box_${P.field}`,as:`lower_box_${P.field}`},{op:"max",field:`upper_box_${P.field}`,as:`upper_box_${P.field}`},...L],groupby:I}],layer:pe},ye=__rest$n(U,["tooltip"]),{scale:we,axis:$e}=P,ve=getTitle(P),Te=omit($e,["title"]),te=partLayerMixins(p,"outliers",n.boxplot,{transform:[{filter:`(${he} < ${se}) || (${he} > ${fe})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[F]:Object.assign(Object.assign(Object.assign({field:P.field,type:P.type},ve!==void 0?{title:ve}:{}),we!==void 0?{scale:we}:{}),isEmpty(Te)?{}:{axis:Te})},ye),H?{color:H}:{}),q?{tooltip:q}:{})})[0];let ie;const ce=[...k,...O,be];return te?ie={transform:ce,layer:[te,xe]}:(ie=xe,ie.transform.unshift(...ce)),Object.assign(Object.assign({},d),{layer:[ie,{transform:R,layer:Se}]})}function boxParamsQuartiles(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function boxParams(e,n,i){const r=compositeMarkOrient(e,BOXPLOT),{continuousAxisChannelDef:s,continuousAxis:o}=compositeMarkContinuousAxis(e,r,BOXPLOT),l=s.field,f=getBoxPlotType(n),d=[...boxParamsQuartiles(l),{op:"median",field:l,as:`mid_box_${l}`},{op:"min",field:l,as:(f==="min-max"?"lower_whisker_":"min_")+l},{op:"max",field:l,as:(f==="min-max"?"upper_whisker_":"max_")+l}],p=f==="min-max"||f==="tukey"?[]:[{calculate:`datum["upper_box_${l}"] - datum["lower_box_${l}"]`,as:`iqr_${l}`},{calculate:`min(datum["upper_box_${l}"] + datum["iqr_${l}"] * ${n}, datum["max_${l}"])`,as:`upper_whisker_${l}`},{calculate:`max(datum["lower_box_${l}"] - datum["iqr_${l}"] * ${n}, datum["min_${l}"])`,as:`lower_whisker_${l}`}],g=e.encoding,v=o;g[v];const S=__rest$n(g,[typeof v=="symbol"?v:v+""]),{customTooltipWithoutAggregatedField:T,filteredEncoding:k}=filterTooltipWithAggregatedField(S),{bins:O,timeUnits:R,aggregate:P,groupby:F,encoding:I}=extractTransformsFromEncoding(k,i),L=r==="vertical"?"horizontal":"vertical",N=r,j=[...O,...R,{aggregate:[...P,...d],groupby:F},...p];return{bins:O,timeUnits:R,transform:j,groupby:F,aggregate:P,continuousAxisChannelDef:s,continuousAxis:o,encodingWithoutContinuousAxis:I,ticksOrient:L,boxOrient:N,customTooltipWithoutAggregatedField:T}}var __rest$m=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const ERRORBAR="errorbar",ERRORBAR_PARTS=["ticks","rule"],errorBarNormalizer=new CompositeMarkNormalizer(ERRORBAR,normalizeErrorBar);function normalizeErrorBar(e,{config:n}){e=Object.assign(Object.assign({},e),{encoding:normalizeEncoding(e.encoding,n)});const{transform:i,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:o,ticksOrient:l,markDef:f,outerSpec:d,tooltipEncoding:p}=errorBarParams(e,ERRORBAR,n);delete o.size;const g=makeCompositeAggregatePartFactory(f,s,r,o,n.errorbar),v=f.thickness,S=f.size,T=Object.assign(Object.assign({type:"tick",orient:l,aria:!1},v!==void 0?{thickness:v}:{}),S!==void 0?{size:S}:{}),k=[...g({partName:"ticks",mark:T,positionPrefix:"lower",extraEncoding:p}),...g({partName:"ticks",mark:T,positionPrefix:"upper",extraEncoding:p}),...g({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},v!==void 0?{size:v}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:p})];return Object.assign(Object.assign(Object.assign({},d),{transform:i}),k.length>1?{layer:k}:Object.assign({},k[0]))}function errorBarOrientAndInputType(e,n){const{encoding:i}=e;if(errorBarIsInputTypeRaw(i))return{orient:compositeMarkOrient(e,n),inputType:"raw"};const r=errorBarIsInputTypeAggregatedUpperLower(i),s=errorBarIsInputTypeAggregatedError(i),o=i.x,l=i.y;if(r){if(s)throw new Error(`${n} cannot be both type aggregated-upper-lower and aggregated-error`);const f=i.x2,d=i.y2;if(isFieldOrDatumDef(f)&&isFieldOrDatumDef(d))throw new Error(`${n} cannot have both x2 and y2`);if(isFieldOrDatumDef(f)){if(isContinuousFieldOrDatumDef(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${n}`)}else if(isFieldOrDatumDef(d)){if(isContinuousFieldOrDatumDef(l))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${n}`)}throw new Error("No ranged axis")}else{const f=i.xError,d=i.xError2,p=i.yError,g=i.yError2;if(isFieldOrDatumDef(d)&&!isFieldOrDatumDef(f))throw new Error(`${n} cannot have xError2 without xError`);if(isFieldOrDatumDef(g)&&!isFieldOrDatumDef(p))throw new Error(`${n} cannot have yError2 without yError`);if(isFieldOrDatumDef(f)&&isFieldOrDatumDef(p))throw new Error(`${n} cannot have both xError and yError with both are quantiative`);if(isFieldOrDatumDef(f)){if(isContinuousFieldOrDatumDef(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(isFieldOrDatumDef(p)){if(isContinuousFieldOrDatumDef(l))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function errorBarIsInputTypeRaw(e){return(isFieldOrDatumDef(e.x)||isFieldOrDatumDef(e.y))&&!isFieldOrDatumDef(e.x2)&&!isFieldOrDatumDef(e.y2)&&!isFieldOrDatumDef(e.xError)&&!isFieldOrDatumDef(e.xError2)&&!isFieldOrDatumDef(e.yError)&&!isFieldOrDatumDef(e.yError2)}function errorBarIsInputTypeAggregatedUpperLower(e){return isFieldOrDatumDef(e.x2)||isFieldOrDatumDef(e.y2)}function errorBarIsInputTypeAggregatedError(e){return isFieldOrDatumDef(e.xError)||isFieldOrDatumDef(e.xError2)||isFieldOrDatumDef(e.yError)||isFieldOrDatumDef(e.yError2)}function errorBarParams(e,n,i){var r;const{mark:s,encoding:o,params:l,projection:f}=e,d=__rest$m(e,["mark","encoding","params","projection"]),p=isMarkDef(s)?s:{type:s};l&&warn(selectionNotSupported(n));const{orient:g,inputType:v}=errorBarOrientAndInputType(e,n),{continuousAxisChannelDef:S,continuousAxisChannelDef2:T,continuousAxisChannelDefError:k,continuousAxisChannelDefError2:O,continuousAxis:R}=compositeMarkContinuousAxis(e,g,n),{errorBarSpecificAggregate:P,postAggregateCalculates:F,tooltipSummary:I,tooltipTitleWithFieldName:L}=errorBarAggregationAndCalculation(p,S,T,k,O,v,n,i),N=o,j=R;N[j];const z=R==="x"?"x2":"y2";N[z];const q=R==="x"?"xError":"yError";N[q];const H=R==="x"?"xError2":"yError2";N[H];const W=__rest$m(N,[typeof j=="symbol"?j:j+"",typeof z=="symbol"?z:z+"",typeof q=="symbol"?q:q+"",typeof H=="symbol"?H:H+""]),{bins:U,timeUnits:Q,aggregate:J,groupby:ne,encoding:G}=extractTransformsFromEncoding(W,i),Z=[...J,...P],ae=v!=="raw"?[]:ne,oe=getCompositeMarkTooltip(I,S,G,L);return{transform:[...(r=d.transform)!==null&&r!==void 0?r:[],...U,...Q,...Z.length===0?[]:[{aggregate:Z,groupby:ae}],...F],groupby:ae,continuousAxisChannelDef:S,continuousAxis:R,encodingWithoutContinuousAxis:G,ticksOrient:g==="vertical"?"horizontal":"vertical",markDef:p,outerSpec:d,tooltipEncoding:oe}}function errorBarAggregationAndCalculation(e,n,i,r,s,o,l,f){let d=[],p=[];const g=n.field;let v,S=!1;if(o==="raw"){const T=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":f.errorbar.center,k=e.extent?e.extent:T==="mean"?"stderr":"iqr";if(T==="median"!=(k==="iqr")&&warn(errorBarCenterIsUsedWithWrongExtent(T,k,l)),k==="stderr"||k==="stdev")d=[{op:k,field:g,as:`extent_${g}`},{op:T,field:g,as:`center_${g}`}],p=[{calculate:`datum["center_${g}"] + datum["extent_${g}"]`,as:`upper_${g}`},{calculate:`datum["center_${g}"] - datum["extent_${g}"]`,as:`lower_${g}`}],v=[{fieldPrefix:"center_",titlePrefix:titleCase(T)},{fieldPrefix:"upper_",titlePrefix:getTitlePrefix(T,k,"+")},{fieldPrefix:"lower_",titlePrefix:getTitlePrefix(T,k,"-")}],S=!0;else{let O,R,P;k==="ci"?(O="mean",R="ci0",P="ci1"):(O="median",R="q1",P="q3"),d=[{op:R,field:g,as:`lower_${g}`},{op:P,field:g,as:`upper_${g}`},{op:O,field:g,as:`center_${g}`}],v=[{fieldPrefix:"upper_",titlePrefix:title({field:g,aggregate:P,type:"quantitative"},f,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:title({field:g,aggregate:R,type:"quantitative"},f,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:title({field:g,aggregate:O,type:"quantitative"},f,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&warn(errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),o==="aggregated-upper-lower"?(v=[],p=[{calculate:`datum["${i.field}"]`,as:`upper_${g}`},{calculate:`datum["${g}"]`,as:`lower_${g}`}]):o==="aggregated-error"&&(v=[{fieldPrefix:"",titlePrefix:g}],p=[{calculate:`datum["${g}"] + datum["${r.field}"]`,as:`upper_${g}`}],s?p.push({calculate:`datum["${g}"] + datum["${s.field}"]`,as:`lower_${g}`}):p.push({calculate:`datum["${g}"] - datum["${r.field}"]`,as:`lower_${g}`}));for(const T of p)v.push({fieldPrefix:T.as.substring(0,6),titlePrefix:replaceAll(replaceAll(T.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:p,errorBarSpecificAggregate:d,tooltipSummary:v,tooltipTitleWithFieldName:S}}function getTitlePrefix(e,n,i){return`${titleCase(e)} ${i} ${n}`}const ERRORBAND="errorband",ERRORBAND_PARTS=["band","borders"],errorBandNormalizer=new CompositeMarkNormalizer(ERRORBAND,normalizeErrorBand);function normalizeErrorBand(e,{config:n}){e=Object.assign(Object.assign({},e),{encoding:normalizeEncoding(e.encoding,n)});const{transform:i,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:o,markDef:l,outerSpec:f,tooltipEncoding:d}=errorBarParams(e,ERRORBAND,n),p=l,g=makeCompositeAggregatePartFactory(p,s,r,o,n.errorband),v=e.encoding.x!==void 0&&e.encoding.y!==void 0;let S={type:v?"area":"rect"},T={type:v?"line":"rule"};const k=Object.assign(Object.assign({},p.interpolate?{interpolate:p.interpolate}:{}),p.tension&&p.interpolate?{tension:p.tension}:{});return v?(S=Object.assign(Object.assign(Object.assign({},S),k),{ariaRoleDescription:"errorband"}),T=Object.assign(Object.assign(Object.assign({},T),k),{aria:!1})):p.interpolate?warn(errorBand1DNotSupport("interpolate")):p.tension&&warn(errorBand1DNotSupport("tension")),Object.assign(Object.assign({},f),{transform:i,layer:[...g({partName:"band",mark:S,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:d}),...g({partName:"borders",mark:T,positionPrefix:"lower",extraEncoding:d}),...g({partName:"borders",mark:T,positionPrefix:"upper",extraEncoding:d})]})}const compositeMarkRegistry={};function add(e,n,i){const r=new CompositeMarkNormalizer(e,n);compositeMarkRegistry[e]={normalizer:r,parts:i}}function getAllCompositeMarks(){return keys$1(compositeMarkRegistry)}add(BOXPLOT,normalizeBoxPlot,BOXPLOT_PARTS);add(ERRORBAR,normalizeErrorBar,ERRORBAR_PARTS);add(ERRORBAND,normalizeErrorBand,ERRORBAND_PARTS);const VL_ONLY_LEGEND_CONFIG=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],HEADER_TITLE_PROPERTIES_MAP={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},HEADER_LABEL_PROPERTIES_MAP={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},HEADER_TITLE_PROPERTIES=keys$1(HEADER_TITLE_PROPERTIES_MAP),HEADER_LABEL_PROPERTIES=keys$1(HEADER_LABEL_PROPERTIES_MAP),HEADER_CONFIGS_INDEX={header:1,headerRow:1,headerColumn:1,headerFacet:1},HEADER_CONFIGS=keys$1(HEADER_CONFIGS_INDEX),LEGEND_SCALE_CHANNELS=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],defaultLegendConfig={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},COMMON_LEGEND_PROPERTY_INDEX={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},SELECTION_ID="_vgsid_",defaultConfig$1={point:{on:"click",fields:[SELECTION_ID],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function isLegendBinding(e){return e==="legend"||!!(e!=null&&e.legend)}function isLegendStreamBinding(e){return isLegendBinding(e)&&isObject(e)}function isSelectionParameter(e){return!!(e!=null&&e.select)}var __rest$l=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function assembleParameterSignals(e){const n=[];for(const i of e||[]){if(isSelectionParameter(i))continue;const{expr:r,bind:s}=i,o=__rest$l(i,["expr","bind"]);if(s&&r){const l=Object.assign(Object.assign({},o),{bind:s,init:r});n.push(l)}else{const l=Object.assign(Object.assign(Object.assign({},o),r?{update:r}:{}),s?{bind:s}:{});n.push(l)}}return n}function isAnyConcatSpec(e){return isVConcatSpec(e)||isHConcatSpec(e)||isConcatSpec(e)}function isConcatSpec(e){return"concat"in e}function isVConcatSpec(e){return"vconcat"in e}function isHConcatSpec(e){return"hconcat"in e}function getStepFor({step:e,offsetIsDiscrete:n}){var i;return n?(i=e.for)!==null&&i!==void 0?i:"offset":"position"}function isStep(e){return isObject(e)&&e.step!==void 0}function isFrameMixins(e){return e.view||e.width||e.height}const DEFAULT_SPACING=20,COMPOSITION_LAYOUT_INDEX={align:1,bounds:1,center:1,columns:1,spacing:1},COMPOSITION_LAYOUT_PROPERTIES=keys$1(COMPOSITION_LAYOUT_INDEX);function extractCompositionLayout(e,n,i){var r,s;const o=i[n],l={},{spacing:f,columns:d}=o;f!==void 0&&(l.spacing=f),d!==void 0&&(isFacetSpec(e)&&!isFacetMapping(e.facet)||isConcatSpec(e))&&(l.columns=d),isVConcatSpec(e)&&(l.columns=1);for(const p of COMPOSITION_LAYOUT_PROPERTIES)if(e[p]!==void 0)if(p==="spacing"){const g=e[p];l[p]=isNumber$1(g)?g:{row:(r=g.row)!==null&&r!==void 0?r:f,column:(s=g.column)!==null&&s!==void 0?s:f}}else l[p]=e[p];return l}var __rest$k=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function getViewConfigContinuousSize(e,n){var i;return(i=e[n])!==null&&i!==void 0?i:e[n==="width"?"continuousWidth":"continuousHeight"]}function getViewConfigDiscreteStep(e,n){const i=getViewConfigDiscreteSize(e,n);return isStep(i)?i.step:DEFAULT_STEP}function getViewConfigDiscreteSize(e,n){var i;const r=(i=e[n])!==null&&i!==void 0?i:e[n==="width"?"discreteWidth":"discreteHeight"];return getFirstDefined(r,{step:e.step})}const DEFAULT_STEP=20,defaultViewConfig={continuousWidth:200,continuousHeight:200,step:DEFAULT_STEP},defaultConfig={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:defaultViewConfig,mark:defaultMarkConfig,arc:{},area:{},bar:defaultBarConfig,circle:{},geoshape:{},image:{},line:{},point:{},rect:defaultRectConfig,rule:{color:"black"},square:{},text:{color:"black"},tick:defaultTickConfig,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:defaultScaleConfig,projection:{},legend:defaultLegendConfig,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:defaultConfig$1,style:{},title:{},facet:{spacing:DEFAULT_SPACING},concat:{spacing:DEFAULT_SPACING},normalizedNumberFormat:".0%"},tab10=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],DEFAULT_FONT_SIZE={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},DEFAULT_COLOR={blue:tab10[0],orange:tab10[1],red:tab10[2],teal:tab10[3],green:tab10[4],yellow:tab10[5],purple:tab10[6],pink:tab10[7],brown:tab10[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function colorSignalConfig(e={}){return{signals:[{name:"color",value:isObject(e)?Object.assign(Object.assign({},DEFAULT_COLOR),e):DEFAULT_COLOR}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function fontSizeSignalConfig(e){return{signals:[{name:"fontSize",value:isObject(e)?Object.assign(Object.assign({},DEFAULT_FONT_SIZE),e):DEFAULT_FONT_SIZE}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function fontConfig(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function getAxisConfigInternal(e){const n=keys$1(e||{}),i={};for(const r of n){const s=e[r];i[r]=isConditionalAxisValue(s)?signalOrValueRefWithCondition(s):signalRefOrValue(s)}return i}function getStyleConfigInternal(e){const n=keys$1(e),i={};for(const r of n)i[r]=getAxisConfigInternal(e[r]);return i}const configPropsWithExpr=[...MARK_CONFIGS,...AXIS_CONFIGS,...HEADER_CONFIGS,"background","padding","legend","lineBreak","scale","style","title","view"];function initConfig(e={}){const{color:n,font:i,fontSize:r,selection:s}=e,o=__rest$k(e,["color","font","fontSize","selection"]),l=mergeConfig({},duplicate(defaultConfig),i?fontConfig(i):{},n?colorSignalConfig(n):{},r?fontSizeSignalConfig(r):{},o||{});s&&writeConfig(l,"selection",s,!0);const f=omit(l,configPropsWithExpr);for(const d of["background","lineBreak","padding"])l[d]&&(f[d]=signalRefOrValue(l[d]));for(const d of MARK_CONFIGS)l[d]&&(f[d]=replaceExprRef(l[d]));for(const d of AXIS_CONFIGS)l[d]&&(f[d]=getAxisConfigInternal(l[d]));for(const d of HEADER_CONFIGS)l[d]&&(f[d]=replaceExprRef(l[d]));return l.legend&&(f.legend=replaceExprRef(l.legend)),l.scale&&(f.scale=replaceExprRef(l.scale)),l.style&&(f.style=getStyleConfigInternal(l.style)),l.title&&(f.title=replaceExprRef(l.title)),l.view&&(f.view=replaceExprRef(l.view)),f}const MARK_STYLES=new Set(["view",...PRIMITIVE_MARKS]),VL_ONLY_CONFIG_PROPERTIES=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX);function stripAndRedirectConfig(e){e=duplicate(e);for(const n of VL_ONLY_CONFIG_PROPERTIES)delete e[n];if(e.axis)for(const n in e.axis)isConditionalAxisValue(e.axis[n])&&delete e.axis[n];if(e.legend)for(const n of VL_ONLY_LEGEND_CONFIG)delete e.legend[n];if(e.mark){for(const n of VL_ONLY_MARK_CONFIG_PROPERTIES)delete e.mark[n];e.mark.tooltip&&isObject(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(assembleParameterSignals(e.params)),delete e.params);for(const n of MARK_STYLES){for(const r of VL_ONLY_MARK_CONFIG_PROPERTIES)delete e[n][r];const i=VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX[n];if(i)for(const r of i)delete e[n][r];redirectConfigToStyleConfig(e,n)}for(const n of getAllCompositeMarks())delete e[n];redirectTitleConfig(e);for(const n in e)isObject(e[n])&&isEmpty(e[n])&&delete e[n];return isEmpty(e)?void 0:e}function redirectTitleConfig(e){const{titleMarkConfig:n,subtitleMarkConfig:i,subtitle:r}=extractTitleConfig(e.title);isEmpty(n)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n)),isEmpty(i)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),i)),isEmpty(r)?delete e.title:e.title=r}function redirectConfigToStyleConfig(e,n,i,r){const s=r?e[n][r]:e[n];n==="view"&&(i="cell");const o=Object.assign(Object.assign({},s),e.style[i??n]);isEmpty(o)||(e.style[i??n]=o),r||delete e[n]}function isLayerSpec(e){return"layer"in e}function isRepeatSpec(e){return"repeat"in e}function isLayerRepeatSpec(e){return!isArray(e.repeat)&&e.repeat.layer}var __rest$j=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class SpecMapper{map(n,i){return isFacetSpec(n)?this.mapFacet(n,i):isRepeatSpec(n)?this.mapRepeat(n,i):isHConcatSpec(n)?this.mapHConcat(n,i):isVConcatSpec(n)?this.mapVConcat(n,i):isConcatSpec(n)?this.mapConcat(n,i):this.mapLayerOrUnit(n,i)}mapLayerOrUnit(n,i){if(isLayerSpec(n))return this.mapLayer(n,i);if(isUnitSpec(n))return this.mapUnit(n,i);throw new Error(invalidSpec(n))}mapLayer(n,i){return Object.assign(Object.assign({},n),{layer:n.layer.map(r=>this.mapLayerOrUnit(r,i))})}mapHConcat(n,i){return Object.assign(Object.assign({},n),{hconcat:n.hconcat.map(r=>this.map(r,i))})}mapVConcat(n,i){return Object.assign(Object.assign({},n),{vconcat:n.vconcat.map(r=>this.map(r,i))})}mapConcat(n,i){const{concat:r}=n,s=__rest$j(n,["concat"]);return Object.assign(Object.assign({},s),{concat:r.map(o=>this.map(o,i))})}mapFacet(n,i){return Object.assign(Object.assign({},n),{spec:this.map(n.spec,i)})}mapRepeat(n,i){return Object.assign(Object.assign({},n),{spec:this.map(n.spec,i)})}}const STACK_OFFSET_INDEX={zero:1,center:1,normalize:1};function isStackOffset(e){return e in STACK_OFFSET_INDEX}const STACKABLE_MARKS=new Set([ARC,BAR,AREA,RULE,POINT,CIRCLE,SQUARE,LINE,TEXT,TICK]),STACK_BY_DEFAULT_MARKS=new Set([BAR,AREA,ARC]);function isUnbinnedQuantitative(e){return isFieldDef(e)&&channelDefType(e)==="quantitative"&&!e.bin}function potentialStackedChannel(e,n){var i,r;const s=n==="x"?"y":"radius",o=e[n],l=e[s];if(isFieldDef(o)&&isFieldDef(l))if(isUnbinnedQuantitative(o)&&isUnbinnedQuantitative(l)){if(o.stack)return n;if(l.stack)return s;const f=isFieldDef(o)&&!!o.aggregate,d=isFieldDef(l)&&!!l.aggregate;if(f!==d)return f?n:s;{const p=(i=o.scale)===null||i===void 0?void 0:i.type,g=(r=l.scale)===null||r===void 0?void 0:r.type;if(p&&p!=="linear")return s;if(g&&g!=="linear")return n}}else{if(isUnbinnedQuantitative(o))return n;if(isUnbinnedQuantitative(l))return s}else{if(isUnbinnedQuantitative(o))return n;if(isUnbinnedQuantitative(l))return s}}function getDimensionChannel(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function stack(e,n){var i,r;const s=isMarkDef(e)?e.type:e;if(!STACKABLE_MARKS.has(s))return null;const o=potentialStackedChannel(n,"x")||potentialStackedChannel(n,"theta");if(!o)return null;const l=n[o],f=isFieldDef(l)?vgField(l,{}):void 0,d=getDimensionChannel(o),p=[],g=new Set;if(n[d]){const T=n[d],k=isFieldDef(T)?vgField(T,{}):void 0;k&&k!==f&&(p.push(d),g.add(k));const O=d==="x"?"xOffset":"yOffset",R=n[O],P=isFieldDef(R)?vgField(R,{}):void 0;P&&P!==f&&(p.push(O),g.add(P))}const v=NONPOSITION_CHANNELS.reduce((T,k)=>{if(k!=="tooltip"&&channelHasField(n,k)){const O=n[k];for(const R of array$5(O)){const P=getFieldDef(R);if(P.aggregate)continue;const F=vgField(P,{});(!F||!g.has(F))&&T.push({channel:k,fieldDef:P})}}return T},[]);let S;return l.stack!==void 0?isBoolean$2(l.stack)?S=l.stack?"zero":null:S=l.stack:STACK_BY_DEFAULT_MARKS.has(s)&&(S="zero"),!S||!isStackOffset(S)||isAggregate$1(n)&&v.length===0?null:!((i=l==null?void 0:l.scale)===null||i===void 0)&&i.type&&((r=l==null?void 0:l.scale)===null||r===void 0?void 0:r.type)!==ScaleType.LINEAR?(warn(cannotStackNonLinearScale(l.scale.type)),null):isFieldOrDatumDef(n[getSecondaryRangeChannel(o)])?(l.stack!==void 0&&warn(cannotStackRangedMark(o)),null):(isFieldDef(l)&&l.aggregate&&!SUM_OPS.has(l.aggregate)&&warn(stackNonSummativeAggregate(l.aggregate)),{groupbyChannels:p,groupbyFields:g,fieldChannel:o,impute:l.impute===null?!1:isPathMark(s),stackBy:v,offset:S})}var __rest$i=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function dropLineAndPoint(e){const n=__rest$i(e,["point","line"]);return keys$1(n).length>1?n:n.type}function dropLineAndPointFromConfig(e){for(const n of["line","area","rule","trail"])e[n]&&(e=Object.assign(Object.assign({},e),{[n]:omit(e[n],["point","line"])}));return e}function getPointOverlay(e,n={},i){return e.point==="transparent"?{opacity:0}:e.point?isObject(e.point)?e.point:{}:e.point!==void 0?null:n.point||i.shape?isObject(n.point)?n.point:{}:void 0}function getLineOverlay(e,n={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:n.line?n.line===!0?{}:n.line:void 0}class PathOverlayNormalizer{constructor(){this.name="path-overlay"}hasMatchingType(n,i){if(isUnitSpec(n)){const{mark:r,encoding:s}=n,o=isMarkDef(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!getPointOverlay(o,i[o.type],s);case"area":return!!getPointOverlay(o,i[o.type],s)||!!getLineOverlay(o,i[o.type])}}return!1}run(n,i,r){const{config:s}=i,{params:o,projection:l,mark:f,encoding:d}=n,p=__rest$i(n,["params","projection","mark","encoding"]),g=normalizeEncoding(d,s),v=isMarkDef(f)?f:{type:f},S=getPointOverlay(v,s[v.type],g),T=v.type==="area"&&getLineOverlay(v,s[v.type]),k=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:dropLineAndPoint(Object.assign(Object.assign({},v.type==="area"&&v.opacity===void 0&&v.fillOpacity===void 0?{opacity:.7}:{}),v)),encoding:omit(g,["shape"])})],O=stack(v,g);let R=g;if(O){const{fieldChannel:P,offset:F}=O;R=Object.assign(Object.assign({},g),{[P]:Object.assign(Object.assign({},g[P]),F?{stack:F}:{})})}return R=omit(R,["y2","x2"]),T&&k.push(Object.assign(Object.assign({},l?{projection:l}:{}),{mark:Object.assign(Object.assign({type:"line"},pick(v,["clip","interpolate","tension","tooltip"])),T),encoding:R})),S&&k.push(Object.assign(Object.assign({},l?{projection:l}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},pick(v,["clip","tooltip"])),S),encoding:R})),r(Object.assign(Object.assign({},p),{layer:k}),Object.assign(Object.assign({},i),{config:dropLineAndPointFromConfig(s)}))}}var __rest$h=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function replaceRepeaterInFacet(e,n){return n?isFacetMapping(e)?replaceRepeaterInMapping(e,n):replaceRepeaterInFieldDef(e,n):e}function replaceRepeaterInEncoding(e,n){return n?replaceRepeaterInMapping(e,n):e}function replaceRepeatInProp(e,n,i){const r=n[e];if(isRepeatRef(r)){if(r.repeat in i)return Object.assign(Object.assign({},n),{[e]:i[r.repeat]});warn(noSuchRepeatedValue(r.repeat));return}return n}function replaceRepeaterInFieldDef(e,n){if(e=replaceRepeatInProp("field",e,n),e!==void 0){if(e===null)return null;if(isSortableFieldDef(e)&&isSortField(e.sort)){const i=replaceRepeatInProp("field",e.sort,n);e=Object.assign(Object.assign({},e),i?{sort:i}:{})}return e}}function replaceRepeaterInFieldOrDatumDef(e,n){if(isFieldDef(e))return replaceRepeaterInFieldDef(e,n);{const i=replaceRepeatInProp("datum",e,n);return i!==e&&!i.type&&(i.type="nominal"),i}}function replaceRepeaterInChannelDef(e,n){if(isFieldOrDatumDef(e)){const i=replaceRepeaterInFieldOrDatumDef(e,n);if(i)return i;if(isConditionalDef(e))return{condition:e.condition}}else{if(hasConditionalFieldOrDatumDef(e)){const i=replaceRepeaterInFieldOrDatumDef(e.condition,n);return i?Object.assign(Object.assign({},e),{condition:i}):__rest$h(e,["condition"])}return e}}function replaceRepeaterInMapping(e,n){const i={};for(const r in e)if(has$1(e,r)){const s=e[r];if(isArray(s))i[r]=s.map(o=>replaceRepeaterInChannelDef(o,n)).filter(o=>o);else{const o=replaceRepeaterInChannelDef(s,n);o!==void 0&&(i[r]=o)}}return i}class RuleForRangedLineNormalizer{constructor(){this.name="RuleForRangedLine"}hasMatchingType(n){if(isUnitSpec(n)){const{encoding:i,mark:r}=n;if(r==="line"||isMarkDef(r)&&r.type==="line")for(const s of SECONDARY_RANGE_CHANNEL){const o=getMainRangeChannel(s),l=i[o];if(i[s]&&(isFieldDef(l)&&!isBinned(l.bin)||isDatumDef(l)))return!0}}return!1}run(n,i,r){const{encoding:s,mark:o}=n;return warn(lineWithRange(!!s.x2,!!s.y2)),r(Object.assign(Object.assign({},n),{mark:isObject(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),i)}}var __rest$g=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class CoreNormalizer extends SpecMapper{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[boxPlotNormalizer,errorBarNormalizer,errorBandNormalizer,new PathOverlayNormalizer,new RuleForRangedLineNormalizer]}map(n,i){if(isUnitSpec(n)){const r=channelHasField(n.encoding,ROW),s=channelHasField(n.encoding,COLUMN),o=channelHasField(n.encoding,FACET);if(r||s||o)return this.mapFacetedUnit(n,i)}return super.map(n,i)}mapUnit(n,i){const{parentEncoding:r,parentProjection:s}=i,o=replaceRepeaterInEncoding(n.encoding,i.repeater),l=Object.assign(Object.assign({},n),o?{encoding:o}:{});if(r||s)return this.mapUnitWithParentEncodingOrProjection(l,i);const f=this.mapLayerOrUnit.bind(this);for(const d of this.nonFacetUnitNormalizers)if(d.hasMatchingType(l,i.config))return d.run(l,i,f);return l}mapRepeat(n,i){return isLayerRepeatSpec(n)?this.mapLayerRepeat(n,i):this.mapNonLayerRepeat(n,i)}mapLayerRepeat(n,i){const{repeat:r,spec:s}=n,o=__rest$g(n,["repeat","spec"]),{row:l,column:f,layer:d}=r,{repeater:p={},repeaterPrefix:g=""}=i;return l||f?this.mapRepeat(Object.assign(Object.assign({},n),{repeat:Object.assign(Object.assign({},l?{row:l}:{}),f?{column:f}:{}),spec:{repeat:{layer:d},spec:s}}),i):Object.assign(Object.assign({},o),{layer:d.map(v=>{const S=Object.assign(Object.assign({},p),{layer:v}),T=`${(s.name||"")+g}child__layer_${varName(v)}`,k=this.mapLayerOrUnit(s,Object.assign(Object.assign({},i),{repeater:S,repeaterPrefix:T}));return k.name=T,k})})}mapNonLayerRepeat(n,i){var r;const{repeat:s,spec:o,data:l}=n,f=__rest$g(n,["repeat","spec","data"]);!isArray(s)&&n.columns&&(n=omit(n,["columns"]),warn(columnsNotSupportByRowCol("repeat")));const d=[],{repeater:p={},repeaterPrefix:g=""}=i,v=!isArray(s)&&s.row||[p?p.row:null],S=!isArray(s)&&s.column||[p?p.column:null],T=isArray(s)&&s||[p?p.repeat:null];for(const O of T)for(const R of v)for(const P of S){const F={repeat:O,row:R,column:P,layer:p.layer},I=(o.name||"")+g+"child__"+(isArray(s)?`${varName(O)}`:(s.row?`row_${varName(R)}`:"")+(s.column?`column_${varName(P)}`:"")),L=this.map(o,Object.assign(Object.assign({},i),{repeater:F,repeaterPrefix:I}));L.name=I,d.push(omit(L,["data"]))}const k=isArray(s)?n.columns:s.column?s.column.length:1;return Object.assign(Object.assign({data:(r=o.data)!==null&&r!==void 0?r:l,align:"all"},f),{columns:k,concat:d})}mapFacet(n,i){const{facet:r}=n;return isFacetMapping(r)&&n.columns&&(n=omit(n,["columns"]),warn(columnsNotSupportByRowCol("facet"))),super.mapFacet(n,i)}mapUnitWithParentEncodingOrProjection(n,i){const{encoding:r,projection:s}=n,{parentEncoding:o,parentProjection:l,config:f}=i,d=mergeProjection({parentProjection:l,projection:s}),p=mergeEncoding({parentEncoding:o,encoding:replaceRepeaterInEncoding(r,i.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},n),d?{projection:d}:{}),p?{encoding:p}:{}),{config:f})}mapFacetedUnit(n,i){const r=n.encoding,{row:s,column:o,facet:l}=r,f=__rest$g(r,["row","column","facet"]),{mark:d,width:p,projection:g,height:v,view:S,params:T,encoding:k}=n,O=__rest$g(n,["mark","width","projection","height","view","params","encoding"]),{facetMapping:R,layout:P}=this.getFacetMappingAndLayout({row:s,column:o,facet:l},i),F=replaceRepeaterInEncoding(f,i.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},O),P),{facet:R,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},p?{width:p}:{}),v?{height:v}:{}),S?{view:S}:{}),g?{projection:g}:{}),{mark:d,encoding:F}),T?{params:T}:{})}),i)}getFacetMappingAndLayout(n,i){var r;const{row:s,column:o,facet:l}=n;if(s||o){l&&warn(facetChannelDropped([...s?[ROW]:[],...o?[COLUMN]:[]]));const f={},d={};for(const p of[ROW,COLUMN]){const g=n[p];if(g){const v=__rest$g(g,["align","center","spacing","columns"]);f[p]=v;for(const S of["align","center","spacing"])g[S]!==void 0&&((r=d[S])!==null&&r!==void 0||(d[S]={}),d[S][p]=g[S])}}return{facetMapping:f,layout:d}}else{const{align:f,center:d,spacing:p,columns:g}=l,v=__rest$g(l,["align","center","spacing","columns"]);return{facetMapping:replaceRepeaterInFacet(v,i.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},f?{align:f}:{}),d?{center:d}:{}),p?{spacing:p}:{}),g?{columns:g}:{})}}}mapLayer(n,i){var{parentEncoding:r,parentProjection:s}=i,o=__rest$g(i,["parentEncoding","parentProjection"]);const{encoding:l,projection:f}=n,d=__rest$g(n,["encoding","projection"]),p=Object.assign(Object.assign({},o),{parentEncoding:mergeEncoding({parentEncoding:r,encoding:l,layer:!0}),parentProjection:mergeProjection({parentProjection:s,projection:f})});return super.mapLayer(d,p)}}function mergeEncoding({parentEncoding:e,encoding:n={},layer:i}){let r={};if(e){const s=new Set([...keys$1(e),...keys$1(n)]);for(const o of s){const l=n[o],f=e[o];if(isFieldOrDatumDef(l)){const d=Object.assign(Object.assign({},f),l);r[o]=d}else hasConditionalFieldOrDatumDef(l)?r[o]=Object.assign(Object.assign({},l),{condition:Object.assign(Object.assign({},f),l.condition)}):l||l===null?r[o]=l:(i||isValueDef(f)||isSignalRef(f)||isFieldOrDatumDef(f)||isArray(f))&&(r[o]=f)}}else r=n;return!r||isEmpty(r)?void 0:r}function mergeProjection(e){const{parentProjection:n,projection:i}=e;return n&&i&&warn(projectionOverridden({parentProjection:n,projection:i})),i??n}function isFilter(e){return"filter"in e}function isImputeSequence(e){return(e==null?void 0:e.stop)!==void 0}function isLookup(e){return"lookup"in e}function isLookupData(e){return"data"in e}function isLookupSelection(e){return"param"in e}function isPivot(e){return"pivot"in e}function isDensity(e){return"density"in e}function isQuantile(e){return"quantile"in e}function isRegression(e){return"regression"in e}function isLoess(e){return"loess"in e}function isSample(e){return"sample"in e}function isWindow(e){return"window"in e}function isJoinAggregate(e){return"joinaggregate"in e}function isFlatten(e){return"flatten"in e}function isCalculate(e){return"calculate"in e}function isBin(e){return"bin"in e}function isImpute(e){return"impute"in e}function isTimeUnit(e){return"timeUnit"in e}function isAggregate(e){return"aggregate"in e}function isStack(e){return"stack"in e}function isFold(e){return"fold"in e}function normalizeTransform(e){return e.map(n=>isFilter(n)?{filter:normalizeLogicalComposition(n.filter,normalizePredicate$1)}:n)}var __rest$f=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class SelectionCompatibilityNormalizer extends SpecMapper{map(n,i){var r,s;return(r=i.emptySelections)!==null&&r!==void 0||(i.emptySelections={}),(s=i.selectionPredicates)!==null&&s!==void 0||(i.selectionPredicates={}),n=normalizeTransforms(n,i),super.map(n,i)}mapLayerOrUnit(n,i){if(n=normalizeTransforms(n,i),n.encoding){const r={};for(const[s,o]of entries$1(n.encoding))r[s]=normalizeChannelDef(o,i);n=Object.assign(Object.assign({},n),{encoding:r})}return super.mapLayerOrUnit(n,i)}mapUnit(n,i){const r=n,{selection:s}=r,o=__rest$f(r,["selection"]);return s?Object.assign(Object.assign({},o),{params:entries$1(s).map(([l,f])=>{var d;const p=f,{init:g,bind:v,empty:S}=p,T=__rest$f(p,["init","bind","empty"]);T.type==="single"?(T.type="point",T.toggle=!1):T.type==="multi"&&(T.type="point"),i.emptySelections[l]=S!=="none";for(const k of vals((d=i.selectionPredicates[l])!==null&&d!==void 0?d:{}))k.empty=S!=="none";return{name:l,value:g,select:T,bind:v}})}):n}}function normalizeTransforms(e,n){const{transform:i}=e,r=__rest$f(e,["transform"]);if(i){const s=i.map(o=>{if(isFilter(o))return{filter:normalizePredicate(o,n)};if(isBin(o)&&isBinParams(o.bin))return Object.assign(Object.assign({},o),{bin:normalizeBinExtent(o.bin)});if(isLookup(o)){const l=o.from,{selection:f}=l,d=__rest$f(l,["selection"]);return f?Object.assign(Object.assign({},o),{from:Object.assign({param:f},d)}):o}return o});return Object.assign(Object.assign({},r),{transform:s})}return e}function normalizeChannelDef(e,n){var i,r;const s=duplicate(e);if(isFieldDef(s)&&isBinParams(s.bin)&&(s.bin=normalizeBinExtent(s.bin)),isScaleFieldDef(s)&&(!((r=(i=s.scale)===null||i===void 0?void 0:i.domain)===null||r===void 0)&&r.selection)){const o=s.scale.domain,{selection:l}=o,f=__rest$f(o,["selection"]);s.scale.domain=Object.assign(Object.assign({},f),l?{param:l}:{})}if(isConditionalDef(s))if(isArray(s.condition))s.condition=s.condition.map(o=>{const{selection:l,param:f,test:d}=o,p=__rest$f(o,["selection","param","test"]);return f?o:Object.assign(Object.assign({},p),{test:normalizePredicate(o,n)})});else{const o=normalizeChannelDef(s.condition,n),{selection:l,param:f,test:d}=o,p=__rest$f(o,["selection","param","test"]);s.condition=f?s.condition:Object.assign(Object.assign({},p),{test:normalizePredicate(s.condition,n)})}return s}function normalizeBinExtent(e){const n=e.extent;if(n!=null&&n.selection){const{selection:i}=n,r=__rest$f(n,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},r),{param:i})})}return e}function normalizePredicate(e,n){const i=r=>normalizeLogicalComposition(r,s=>{var o,l,f;const d=(o=n.emptySelections[s])!==null&&o!==void 0?o:!0,p={param:s,empty:d};return(l=(f=n.selectionPredicates)[s])!==null&&l!==void 0||(f[s]=[]),n.selectionPredicates[s].push(p),p});return e.selection?i(e.selection):normalizeLogicalComposition(e.test||e.filter,r=>r.selection?i(r.selection):r)}class TopLevelSelectionsNormalizer extends SpecMapper{map(n,i){var r;const s=(r=i.selections)!==null&&r!==void 0?r:[];if(n.params&&!isUnitSpec(n)){const o=[];for(const l of n.params)isSelectionParameter(l)?s.push(l):o.push(l);n.params=o}return i.selections=s,super.map(n,addSpecNameToParams(n,i))}mapUnit(n,i){var r;const s=i.selections;if(!s||!s.length)return n;const o=((r=i.path)!==null&&r!==void 0?r:[]).concat(n.name),l=[];for(const f of s)if(!f.views||!f.views.length)l.push(f);else for(const d of f.views)(isString(d)&&(d===n.name||o.indexOf(d)>=0)||isArray(d)&&d.map(p=>o.indexOf(p)).every((p,g,v)=>p!==-1&&(g===0||p>v[g-1])))&&l.push(f);return l.length&&(n.params=l),n}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const n=TopLevelSelectionsNormalizer.prototype[e];TopLevelSelectionsNormalizer.prototype[e]=function(i,r){return n.call(this,i,addSpecNameToParams(i,r))}}function addSpecNameToParams(e,n){var i;return e.name?Object.assign(Object.assign({},n),{path:((i=n.path)!==null&&i!==void 0?i:[]).concat(e.name)}):n}function normalize(e,n){n===void 0&&(n=initConfig(e.config));const i=normalizeGenericSpec(e,n),{width:r,height:s}=e,o=normalizeAutoSize(i,{width:r,height:s,autosize:e.autosize},n);return Object.assign(Object.assign({},i),o?{autosize:o}:{})}const coreNormalizer=new CoreNormalizer,selectionCompatNormalizer=new SelectionCompatibilityNormalizer,topLevelSelectionNormalizer=new TopLevelSelectionsNormalizer;function normalizeGenericSpec(e,n={}){const i={config:n};return topLevelSelectionNormalizer.map(coreNormalizer.map(selectionCompatNormalizer.map(e,i),i),i)}function _normalizeAutoSize(e){return isString(e)?{type:e}:e??{}}function normalizeAutoSize(e,n,i){let{width:r,height:s}=n;const o=isUnitSpec(e)||isLayerSpec(e),l={};o?r=="container"&&s=="container"?(l.type="fit",l.contains="padding"):r=="container"?(l.type="fit-x",l.contains="padding"):s=="container"&&(l.type="fit-y",l.contains="padding"):(r=="container"&&(warn(containerSizeNonSingle("width")),r=void 0),s=="container"&&(warn(containerSizeNonSingle("height")),s=void 0));const f=Object.assign(Object.assign(Object.assign({type:"pad"},l),i?_normalizeAutoSize(i.autosize):{}),_normalizeAutoSize(e.autosize));if(f.type==="fit"&&!o&&(warn(FIT_NON_SINGLE),f.type="pad"),r=="container"&&!(f.type=="fit"||f.type=="fit-x")&&warn(containerSizeNotCompatibleWithAutosize("width")),s=="container"&&!(f.type=="fit"||f.type=="fit-y")&&warn(containerSizeNotCompatibleWithAutosize("height")),!deepEqual(f,{type:"pad"}))return f}function isFitType(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function getFitType(e){return e?`fit-${getPositionScaleChannel(e)}`:"fit"}const TOP_LEVEL_PROPERTIES=["background","padding"];function extractTopLevelProperties(e,n){const i={};for(const r of TOP_LEVEL_PROPERTIES)e&&e[r]!==void 0&&(i[r]=signalRefOrValue(e[r]));return n&&(i.params=e.params),i}class Split{constructor(n={},i={}){this.explicit=n,this.implicit=i}clone(){return new Split(duplicate(this.explicit),duplicate(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(n){return getFirstDefined(this.explicit[n],this.implicit[n])}getWithExplicit(n){return this.explicit[n]!==void 0?{explicit:!0,value:this.explicit[n]}:this.implicit[n]!==void 0?{explicit:!1,value:this.implicit[n]}:{explicit:!1,value:void 0}}setWithExplicit(n,{value:i,explicit:r}){i!==void 0&&this.set(n,i,r)}set(n,i,r){return delete this[r?"implicit":"explicit"][n],this[r?"explicit":"implicit"][n]=i,this}copyKeyFromSplit(n,{explicit:i,implicit:r}){i[n]!==void 0?this.set(n,i[n],!0):r[n]!==void 0&&this.set(n,r[n],!1)}copyKeyFromObject(n,i){i[n]!==void 0&&this.set(n,i[n],!0)}copyAll(n){for(const i of keys$1(n.combine())){const r=n.getWithExplicit(i);this.setWithExplicit(i,r)}}}function makeExplicit(e){return{explicit:!0,value:e}}function makeImplicit(e){return{explicit:!1,value:e}}function tieBreakByComparing(e){return(n,i,r,s)=>{const o=e(n.value,i.value);return o>0?n:o<0?i:defaultTieBreaker(n,i,r,s)}}function defaultTieBreaker(e,n,i,r){return e.explicit&&n.explicit&&warn(mergeConflictingProperty(i,r,e.value,n.value)),e}function mergeValuesWithExplicit(e,n,i,r,s=defaultTieBreaker){return e===void 0||e.value===void 0?n:e.explicit&&!n.explicit?e:n.explicit&&!e.explicit?n:deepEqual(e.value,n.value)?e:s(e,n,i,r)}class AncestorParse extends Split{constructor(n={},i={},r=!1){super(n,i),this.explicit=n,this.implicit=i,this.parseNothing=r}clone(){const n=super.clone();return n.parseNothing=this.parseNothing,n}}function isUrlData(e){return"url"in e}function isInlineData(e){return"values"in e}function isNamedData(e){return"name"in e&&!isUrlData(e)&&!isInlineData(e)&&!isGenerator(e)}function isGenerator(e){return e&&(isSequenceGenerator(e)||isSphereGenerator(e)||isGraticuleGenerator(e))}function isSequenceGenerator(e){return"sequence"in e}function isSphereGenerator(e){return"sphere"in e}function isGraticuleGenerator(e){return"graticule"in e}var DataSourceType;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(DataSourceType||(DataSourceType={}));var __rest$e=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function assembleInit(e,n=!0,i=identity$6){if(isArray(e)){const r=e.map(s=>assembleInit(s,n,i));return n?`[${r.join(", ")}]`:r}else if(isDateTime(e))return i(n?dateTimeToExpr(e):dateTimeToTimestamp(e));return n?i(stringify(e)):e}function assembleUnitSelectionSignals(e,n){var i;for(const r of vals((i=e.component.selection)!==null&&i!==void 0?i:{})){const s=r.name;let o=`${s}${TUPLE}, ${r.resolve==="global"?"true":`{unit: ${unitName(e)}}`}`;for(const l of selectionCompilers)l.defined(r)&&(l.signals&&(n=l.signals(e,r,n)),l.modifyExpr&&(o=l.modifyExpr(e,r,o)));n.push({name:s+MODIFY,on:[{events:{signal:r.name+TUPLE},update:`modify(${$(r.name+STORE)}, ${o})`}]})}return cleanupEmptyOnArray(n)}function assembleFacetSignals(e,n){if(e.component.selection&&keys$1(e.component.selection).length){const i=$(e.getName("cell"));n.unshift({name:"facet",value:{},on:[{events:eventSelector("mousemove","scope"),update:`isTuple(facet) ? facet : group(${i}).datum`}]})}return cleanupEmptyOnArray(n)}function assembleTopLevelSignals(e,n){var i;let r=!1;for(const s of vals((i=e.component.selection)!==null&&i!==void 0?i:{})){const o=s.name,l=$(o+STORE);if(n.filter(d=>d.name===o).length===0){const d=s.resolve==="global"?"union":s.resolve,p=s.type==="point"?", true, true)":")";n.push({name:s.name,update:`${VL_SELECTION_RESOLVE}(${l}, ${$(d)}${p}`})}r=!0;for(const d of selectionCompilers)d.defined(s)&&d.topLevelSignals&&(n=d.topLevelSignals(e,s,n))}return r&&n.filter(o=>o.name==="unit").length===0&&n.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),cleanupEmptyOnArray(n)}function assembleUnitSelectionData(e,n){var i;const r=[...n],s=unitName(e,{escape:!1});for(const o of vals((i=e.component.selection)!==null&&i!==void 0?i:{})){const l={name:o.name+STORE};if(o.project.hasSelectionId&&(l.transform=[{type:"collect",sort:{field:SELECTION_ID}}]),o.init){const d=o.project.items.map(p=>__rest$e(p,["signals"]));l.values=o.project.hasSelectionId?o.init.map(p=>({unit:s,[SELECTION_ID]:assembleInit(p,!1)[0]})):o.init.map(p=>({unit:s,fields:d,values:assembleInit(p,!1)}))}r.filter(d=>d.name===o.name+STORE).length||r.push(l)}return r}function assembleUnitSelectionMarks(e,n){var i;for(const r of vals((i=e.component.selection)!==null&&i!==void 0?i:{}))for(const s of selectionCompilers)s.defined(r)&&s.marks&&(n=s.marks(e,r,n));return n}function assembleLayerSelectionMarks(e,n){for(const i of e.children)isUnitModel(i)&&(n=assembleUnitSelectionMarks(i,n));return n}function assembleSelectionScaleDomain(e,n,i,r){const s=parseSelectionExtent(e,n.param,n);return{signal:hasContinuousDomain(i.get("type"))&&isArray(r)&&r[0]>r[1]?`isValid(${s}) && reverse(${s})`:s}}function cleanupEmptyOnArray(e){return e.map(n=>(n.on&&!n.on.length&&delete n.on,n))}class DataFlowNode{constructor(n,i){this.debugName=i,this._children=[],this._parent=null,n&&(this.parent=n)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(n){this._parent=n,n&&n.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(n,i){if(this._children.includes(n)){warn(ADD_SAME_CHILD_TWICE);return}i!==void 0?this._children.splice(i,0,n):this._children.push(n)}removeChild(n){const i=this._children.indexOf(n);return this._children.splice(i,1),i}remove(){let n=this._parent.removeChild(this);for(const i of this._children)i._parent=this._parent,this._parent.addChild(i,n++)}insertAsParentOf(n){const i=n.parent;i.removeChild(this),this.parent=i,n.parent=this}swapWithParent(){const n=this._parent,i=n.parent;for(const s of this._children)s.parent=n;this._children=[],n.removeChild(this);const r=n.parent.removeChild(n);this._parent=i,i.addChild(this,r),n.parent=this}}class OutputNode extends DataFlowNode{constructor(n,i,r,s){super(n,i),this.type=r,this.refCounts=s,this._source=this._name=i,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const n=new this.constructor;return n.debugName=`clone_${this.debugName}`,n._source=this._source,n._name=`clone_${this._name}`,n.type=this.type,n.refCounts=this.refCounts,n.refCounts[n._name]=0,n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${uniqueId()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(n){this._source=n}}var __rest$d=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class TimeUnitNode extends DataFlowNode{constructor(n,i){super(n),this.formula=i}clone(){return new TimeUnitNode(null,duplicate(this.formula))}static makeFromEncoding(n,i){const r=i.reduceFieldDef((s,o)=>{const{field:l,timeUnit:f}=o;if(f){const d=vgField(o,{forAs:!0});s[hash({as:d,field:l,timeUnit:f})]={as:d,field:l,timeUnit:f}}return s},{});return isEmpty(r)?null:new TimeUnitNode(n,r)}static makeFromTransform(n,i){const r=Object.assign({},i),{timeUnit:s}=r,o=__rest$d(r,["timeUnit"]),l=normalizeTimeUnit(s),f=Object.assign(Object.assign({},o),{timeUnit:l});return new TimeUnitNode(n,{[hash(f)]:f})}merge(n){this.formula=Object.assign({},this.formula);for(const i in n.formula)this.formula[i]||(this.formula[i]=n.formula[i]);for(const i of n.children)n.removeChild(i),i.parent=this;n.remove()}removeFormulas(n){const i={};for(const[r,s]of entries$1(this.formula))n.has(s.as)||(i[r]=s);this.formula=i}producedFields(){return new Set(vals(this.formula).map(n=>n.as))}dependentFields(){return new Set(vals(this.formula).map(n=>n.field))}hash(){return`TimeUnit ${hash(this.formula)}`}assemble(){const n=[];for(const i of vals(this.formula)){const{field:r,as:s,timeUnit:o}=i,l=normalizeTimeUnit(o),{unit:f,utc:d}=l,p=__rest$d(l,["unit","utc"]);n.push(Object.assign(Object.assign(Object.assign(Object.assign({field:replacePathInField(r),type:"timeunit"},f?{units:getTimeUnitParts(f)}:{}),d?{timezone:"utc"}:{}),p),{as:[s,`${s}_end`]}))}return n}}var __rest$c=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const TUPLE_FIELDS="_tuple_fields";class SelectionProjectionComponent{constructor(...n){this.items=n,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const project={defined:()=>!0,parse:(e,n,i)=>{var r;const s=n.name,o=(r=n.project)!==null&&r!==void 0?r:n.project=new SelectionProjectionComponent,l={},f={},d=new Set,p=(O,R)=>{const P=R==="visual"?O.channel:O.field;let F=varName(`${s}_${P}`);for(let I=1;d.has(F);I++)F=varName(`${s}_${P}_${I}`);return d.add(F),{[R]:F}},g=n.type,v=e.config.selection[g],S=i.value!==void 0?array$5(i.value):null;let{fields:T,encodings:k}=isObject(i.select)?i.select:{};if(!T&&!k&&S){for(const O of S)if(isObject(O))for(const R of keys$1(O))isSingleDefUnitChannel(R)?(k||(k=[])).push(R):g==="interval"?(warn(INTERVAL_INITIALIZED_WITH_X_Y),k=v.encodings):(T||(T=[])).push(R)}!T&&!k&&(k=v.encodings,"fields"in v&&(T=v.fields));for(const O of k??[]){const R=e.fieldDef(O);if(R){let P=R.field;if(R.aggregate){warn(cannotProjectAggregate(O,R.aggregate));continue}else if(!P){warn(cannotProjectOnChannelWithoutField(O));continue}if(R.timeUnit){P=e.vgField(O);const F={timeUnit:R.timeUnit,as:P,field:R.field};f[hash(F)]=F}if(!l[P]){let F="E";if(g==="interval"){const L=e.getScaleComponent(O).get("type");hasContinuousDomain(L)&&(F="R")}else R.bin&&(F="R-RE");const I={field:P,channel:O,type:F};I.signals=Object.assign(Object.assign({},p(I,"data")),p(I,"visual")),o.items.push(l[P]=I),o.hasField[P]=o.hasChannel[O]=l[P],o.hasSelectionId=o.hasSelectionId||P===SELECTION_ID}}else warn(cannotProjectOnChannelWithoutField(O))}for(const O of T??[]){if(o.hasField[O])continue;const R={type:"E",field:O};R.signals=Object.assign({},p(R,"data")),o.items.push(R),o.hasField[O]=R,o.hasSelectionId=o.hasSelectionId||O===SELECTION_ID}S&&(n.init=S.map(O=>o.items.map(R=>isObject(O)?O[R.channel]!==void 0?O[R.channel]:O[R.field]:O))),isEmpty(f)||(o.timeUnit=new TimeUnitNode(null,f))},signals:(e,n,i)=>{const r=n.name+TUPLE_FIELDS;return i.filter(o=>o.name===r).length>0||n.project.hasSelectionId?i:i.concat({name:r,value:n.project.items.map(o=>{const l=__rest$c(o,["signals","hasLegend"]);return l.field=replacePathInField(l.field),l})})}},scaleBindings={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,n)=>{const i=n.scales=[];for(const r of n.project.items){const s=r.channel;if(!isScaleChannel(s))continue;const o=e.getScaleComponent(s),l=o?o.get("type"):void 0;if(!o||!hasContinuousDomain(l)){warn(SCALE_BINDINGS_CONTINUOUS);continue}o.set("selectionExtent",{param:n.name,field:r.field},!0),i.push(r)}},topLevelSignals:(e,n,i)=>{const r=n.scales.filter(l=>i.filter(f=>f.name===l.signals.data).length===0);if(!e.parent||isTopLevelLayer(e)||r.length===0)return i;const s=i.filter(l=>l.name===n.name)[0];let o=s.update;if(o.indexOf(VL_SELECTION_RESOLVE)>=0)s.update=`{${r.map(l=>`${$(replacePathInField(l.field))}: ${l.signals.data}`).join(", ")}}`;else{for(const l of r){const f=`${$(replacePathInField(l.field))}: ${l.signals.data}`;o.includes(f)||(o=`${o.substring(0,o.length-1)}, ${f}}`)}s.update=o}return i.concat(r.map(l=>({name:l.signals.data})))},signals:(e,n,i)=>{if(e.parent&&!isTopLevelLayer(e))for(const r of n.scales){const s=i.filter(o=>o.name===r.signals.data)[0];s.push="outer",delete s.value,delete s.update}return i}};function domain(e,n){return`domain(${$(e.scaleName(n))})`}function isTopLevelLayer(e){var n;return e.parent&&isLayerModel(e.parent)&&((n=!e.parent.parent)!==null&&n!==void 0?n:isTopLevelLayer(e.parent.parent))}var __rest$b=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};const BRUSH="_brush",SCALE_TRIGGER="_scale_trigger",interval={defined:e=>e.type==="interval",signals:(e,n,i)=>{const r=n.name,s=r+TUPLE_FIELDS,o=scaleBindings.defined(n),l=n.init?n.init[0]:null,f=[],d=[];if(n.translate&&!o){const g=`!event.item || event.item.mark.name !== ${$(r+BRUSH)}`;events(n,(v,S)=>{var T,k;const O=array$5((T=(k=S.between[0]).filter)!==null&&T!==void 0?T:k.filter=[]);return O.includes(g)||O.push(g),v})}n.project.items.forEach((g,v)=>{const S=g.channel;if(S!==X&&S!==Y){warn("Interval selections only support x and y encoding channels.");return}const T=l?l[v]:null,k=channelSignals(e,n,g,T),O=g.signals.data,R=g.signals.visual,P=$(e.scaleName(S)),F=e.getScaleComponent(S).get("type"),I=hasContinuousDomain(F)?"+":"";i.push(...k),f.push(O),d.push({scaleName:e.scaleName(S),expr:`(!isArray(${O}) || (${I}invert(${P}, ${R})[0] === ${I}${O}[0] && ${I}invert(${P}, ${R})[1] === ${I}${O}[1]))`})}),!o&&d.length&&i.push({name:r+SCALE_TRIGGER,value:{},on:[{events:d.map(g=>({scale:g.scaleName})),update:`${d.map(g=>g.expr).join(" && ")} ? ${r+SCALE_TRIGGER} : {}`}]});const p=`unit: ${unitName(e)}, fields: ${s}, values`;return i.concat(Object.assign(Object.assign({name:r+TUPLE},l?{init:`{${p}: ${assembleInit(l)}}`}:{}),f.length?{on:[{events:[{signal:f.join(" || ")}],update:`${f.join(" && ")} ? {${p}: [${f}]} : null`}]}:{}))},marks:(e,n,i)=>{const r=n.name,{x:s,y:o}=n.project.hasChannel,l=s==null?void 0:s.signals.visual,f=o==null?void 0:o.signals.visual,d=`data(${$(n.name+STORE)})`;if(scaleBindings.defined(n)||!s&&!o)return i;const p={x:s!==void 0?{signal:`${l}[0]`}:{value:0},y:o!==void 0?{signal:`${f}[0]`}:{value:0},x2:s!==void 0?{signal:`${l}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${f}[1]`}:{field:{group:"height"}}};if(n.resolve==="global")for(const R of keys$1(p))p[R]=[Object.assign({test:`${d}.length && ${d}[0].unit === ${unitName(e)}`},p[R]),{value:0}];const g=n.mark,{fill:v,fillOpacity:S,cursor:T}=g,k=__rest$b(g,["fill","fillOpacity","cursor"]),O=keys$1(k).reduce((R,P)=>(R[P]=[{test:[s!==void 0&&`${l}[0] !== ${l}[1]`,o!==void 0&&`${f}[0] !== ${f}[1]`].filter(F=>F).join(" && "),value:k[P]},{value:null}],R),{});return[{name:`${r+BRUSH}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:v},fillOpacity:{value:S}},update:p}},...i,{name:r+BRUSH,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},T?{cursor:{value:T}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},p),O)}}]}};function channelSignals(e,n,i,r){const s=i.channel,o=i.signals.visual,l=i.signals.data,f=scaleBindings.defined(n),d=$(e.scaleName(s)),p=e.getScaleComponent(s),g=p?p.get("type"):void 0,v=O=>`scale(${d}, ${O})`,S=e.getSizeSignalRef(s===X?"width":"height").signal,T=`${s}(unit)`,k=events(n,(O,R)=>[...O,{events:R.between[0],update:`[${T}, ${T}]`},{events:R,update:`[${o}[0], clamp(${T}, 0, ${S})]`}]);return k.push({events:{signal:n.name+SCALE_TRIGGER},update:hasContinuousDomain(g)?`[${v(`${l}[0]`)}, ${v(`${l}[1]`)}]`:"[0, 0]"}),f?[{name:l,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:assembleInit(r,!0,v)}:{value:[]}),{on:k}),Object.assign(Object.assign({name:l},r?{init:assembleInit(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${d}, ${o})`}]})]}function events(e,n){return e.events.reduce((i,r)=>r.between?n(i,r):(warn(`${r} is not an ordered event stream for interval selections.`),i),[])}const point$1={defined:e=>e.type==="point",signals:(e,n,i)=>{var r;const s=n.name,o=s+TUPLE_FIELDS,l=n.project,f="(item().isVoronoi ? datum.datum : datum)",d=vals((r=e.component.selection)!==null&&r!==void 0?r:{}).reduce((S,T)=>T.type==="interval"?S.concat(T.name+BRUSH):S,[]).map(S=>`indexof(item().mark.name, '${S}') < 0`).join(" && "),p=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${d?` && ${d}`:""}`;let g=`unit: ${unitName(e)}, `;if(n.project.hasSelectionId)g+=`${SELECTION_ID}: ${f}[${$(SELECTION_ID)}]`;else{const S=l.items.map(T=>{const k=e.fieldDef(T.channel);return k!=null&&k.bin?`[${f}[${$(e.vgField(T.channel,{}))}], ${f}[${$(e.vgField(T.channel,{binSuffix:"end"}))}]]`:`${f}[${$(T.field)}]`}).join(", ");g+=`fields: ${o}, values: [${S}]`}const v=n.events;return i.concat([{name:s+TUPLE,on:v?[{events:v,update:`${p} ? {${g}} : null`,force:!0}]:[]}])}};function wrapCondition(e,n,i,r){const s=isConditionalDef(n)&&n.condition,o=r(n);if(s){const f=array$5(s).map(d=>{const p=r(d);if(isConditionalParameter(d)){const{param:g,empty:v}=d,S=parseSelectionPredicate(e,{param:g,empty:v});return Object.assign({test:S},p)}else{const g=expression(e,d.test);return Object.assign({test:g},p)}});return{[i]:[...f,...o!==void 0?[o]:[]]}}else return o!==void 0?{[i]:o}:{}}function text$1(e,n="text"){const i=e.encoding[n];return wrapCondition(e,i,n,r=>textRef(r,e.config))}function textRef(e,n,i="datum"){if(e){if(isValueDef(e))return signalOrValueRef(e.value);if(isFieldOrDatumDef(e)){const{format:r,formatType:s}=getFormatMixins(e);return formatSignalRef({fieldOrDatumDef:e,format:r,formatType:s,expr:i,config:n})}}}function tooltip(e,n={}){const{encoding:i,markDef:r,config:s,stack:o}=e,l=i.tooltip;if(isArray(l))return{tooltip:tooltipRefForEncoding({tooltip:l},o,s,n)};{const f=n.reactiveGeom?"datum.datum":"datum";return wrapCondition(e,l,"tooltip",d=>{const p=textRef(d,s,f);if(p)return p;if(d===null)return;let g=getMarkPropOrConfig("tooltip",r,s);if(g===!0&&(g={content:"encoding"}),isString(g))return{value:g};if(isObject(g))return isSignalRef(g)?g:g.content==="encoding"?tooltipRefForEncoding(i,o,s,n):{signal:f}})}}function tooltipData(e,n,i,{reactiveGeom:r}={}){const s={},o=r?"datum.datum":"datum",l=[];function f(p,g){const v=getMainRangeChannel(g),S=isTypedFieldDef(p)?p:Object.assign(Object.assign({},p),{type:e[v].type}),T=S.title||defaultTitle(S,i),k=array$5(T).join(", ");let O;if(isXorY(g)){const R=g==="x"?"x2":"y2",P=getFieldDef(e[R]);if(isBinned(S.bin)&&P){const F=vgField(S,{expr:o}),I=vgField(P,{expr:o}),{format:L,formatType:N}=getFormatMixins(S);O=binFormatExpression(F,I,L,N,i),s[R]=!0}}if((isXorY(g)||g===THETA||g===RADIUS)&&n&&n.fieldChannel===g&&n.offset==="normalize"){const{format:R,formatType:P}=getFormatMixins(S);O=formatSignalRef({fieldOrDatumDef:S,format:R,formatType:P,expr:o,config:i,normalizeStack:!0}).signal}O??(O=textRef(S,i,o).signal),l.push({channel:g,key:k,value:O})}forEach(e,(p,g)=>{isFieldDef(p)?f(p,g):hasConditionalFieldDef(p)&&f(p.condition,g)});const d={};for(const{channel:p,key:g,value:v}of l)!s[p]&&!d[g]&&(d[g]=v);return d}function tooltipRefForEncoding(e,n,i,{reactiveGeom:r}={}){const s=tooltipData(e,n,i,{reactiveGeom:r}),o=entries$1(s).map(([l,f])=>`"${l}": ${f}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function aria(e){const{markDef:n,config:i}=e,r=getMarkPropOrConfig("aria",n,i);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),ariaRoleDescription(e)),description(e))}function ariaRoleDescription(e){const{mark:n,markDef:i,config:r}=e;if(r.aria===!1)return{};const s=getMarkPropOrConfig("ariaRoleDescription",i,r);return s!=null?{ariaRoleDescription:{value:s}}:n in VG_MARK_INDEX?{}:{ariaRoleDescription:{value:n}}}function description(e){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.description;if(o)return wrapCondition(e,o,"description",d=>textRef(d,e.config));const l=getMarkPropOrConfig("description",i,r);if(l!=null)return{description:signalOrValueRef(l)};if(r.aria===!1)return{};const f=tooltipData(n,s,r);if(!isEmpty(f))return{description:{signal:entries$1(f).map(([d,p],g)=>`"${g>0?"; ":""}${d}: " + (${p})`).join(" + ")}}}function nonPosition(e,n,i={}){const{markDef:r,encoding:s,config:o}=n,{vgChannel:l}=i;let{defaultRef:f,defaultValue:d}=i;f===void 0&&(d??(d=getMarkPropOrConfig(e,r,o,{vgChannel:l,ignoreVgConfig:!0})),d!==void 0&&(f=signalOrValueRef(d)));const p=s[e];return wrapCondition(n,p,l??e,g=>midPoint({channel:e,channelDef:g,markDef:r,config:o,scaleName:n.scaleName(e),scale:n.getScaleComponent(e),stack:null,defaultRef:f}))}function color(e,n={filled:void 0}){var i,r,s,o;const{markDef:l,encoding:f,config:d}=e,{type:p}=l,g=(i=n.filled)!==null&&i!==void 0?i:getMarkPropOrConfig("filled",l,d),v=contains(["bar","point","circle","square","geoshape"],p)?"transparent":void 0,S=(s=(r=getMarkPropOrConfig(g===!0?"color":void 0,l,d,{vgChannel:"fill"}))!==null&&r!==void 0?r:d.mark[g===!0&&"color"])!==null&&s!==void 0?s:v,T=(o=getMarkPropOrConfig(g===!1?"color":void 0,l,d,{vgChannel:"stroke"}))!==null&&o!==void 0?o:d.mark[g===!1&&"color"],k=g?"fill":"stroke",O=Object.assign(Object.assign({},S?{fill:signalOrValueRef(S)}:{}),T?{stroke:signalOrValueRef(T)}:{});return l.color&&(g?l.fill:l.stroke)&&warn(droppingColor("property",{fill:"fill"in l,stroke:"stroke"in l})),Object.assign(Object.assign(Object.assign(Object.assign({},O),nonPosition("color",e,{vgChannel:k,defaultValue:g?S:T})),nonPosition("fill",e,{defaultValue:f.fill?S:void 0})),nonPosition("stroke",e,{defaultValue:f.stroke?T:void 0}))}function zindex(e){const{encoding:n,mark:i}=e,r=n.order;return!isPathMark(i)&&isValueDef(r)?wrapCondition(e,r,"zindex",s=>signalOrValueRef(s.value)):{}}function positionOffset({channel:e,markDef:n,encoding:i={},model:r,bandPosition:s}){const o=`${e}Offset`,l=n[o],f=i[o];if((o==="xOffset"||o==="yOffset")&&f)return{offsetType:"encoding",offset:midPoint({channel:o,channelDef:f,markDef:n,config:r==null?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:signalOrValueRef(l),bandPosition:s})};const d=n[o];return d?{offsetType:"visual",offset:d}:{}}function pointPosition(e,n,{defaultPos:i,vgChannel:r}){const{encoding:s,markDef:o,config:l,stack:f}=n,d=s[e],p=s[getSecondaryRangeChannel(e)],g=n.scaleName(e),v=n.getScaleComponent(e),{offset:S,offsetType:T}=positionOffset({channel:e,markDef:o,encoding:s,model:n,bandPosition:.5}),k=pointPositionDefaultRef({model:n,defaultPos:i,channel:e,scaleName:g,scale:v}),O=!d&&isXorY(e)&&(s.latitude||s.longitude)?{field:n.getName(e)}:positionRef({channel:e,channelDef:d,channel2Def:p,markDef:o,config:l,scaleName:g,scale:v,stack:f,offset:S,defaultRef:k,bandPosition:T==="encoding"?0:void 0});return O?{[r||e]:O}:void 0}function positionRef(e){const{channel:n,channelDef:i,scaleName:r,stack:s,offset:o,markDef:l}=e;if(isFieldOrDatumDef(i)&&s&&n===s.fieldChannel){if(isFieldDef(i)){let f=i.bandPosition;if(f===void 0&&l.type==="text"&&(n==="radius"||n==="theta")&&(f=.5),f!==void 0)return interpolatedSignalRef({scaleName:r,fieldOrDatumDef:i,startSuffix:"start",bandPosition:f,offset:o})}return valueRefForFieldOrDatumDef(i,r,{suffix:"end"},{offset:o})}return midPointRefWithPositionInvalidTest(e)}function pointPositionDefaultRef({model:e,defaultPos:n,channel:i,scaleName:r,scale:s}){const{markDef:o,config:l}=e;return()=>{const f=getMainRangeChannel(i),d=getVgPositionChannel(i),p=getMarkPropOrConfig(i,o,l,{vgChannel:d});if(p!==void 0)return widthHeightValueOrSignalRef(i,p);switch(n){case"zeroOrMin":case"zeroOrMax":if(r){const g=s.get("type");if(!contains([ScaleType.LOG,ScaleType.TIME,ScaleType.UTC],g)){if(s.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(n==="zeroOrMin")return f==="y"?{field:{group:"height"}}:{value:0};switch(f){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const g=e[getSizeChannel(i)];return Object.assign(Object.assign({},g),{mult:.5})}}}}const ALIGNED_X_CHANNEL={left:"x",center:"xc",right:"x2"},BASELINED_Y_CHANNEL={top:"y",middle:"yc",bottom:"y2"};function vgAlignedPositionChannel(e,n,i,r="middle"){if(e==="radius"||e==="theta")return getVgPositionChannel(e);const s=e==="x"?"align":"baseline",o=getMarkPropOrConfig(s,n,i);let l;return isSignalRef(o)?(warn(rangeMarkAlignmentCannotBeExpression(s)),l=void 0):l=o,e==="x"?ALIGNED_X_CHANNEL[l||(r==="top"?"left":"center")]:BASELINED_Y_CHANNEL[l||r]}function pointOrRangePosition(e,n,{defaultPos:i,defaultPos2:r,range:s}){return s?rangePosition(e,n,{defaultPos:i,defaultPos2:r}):pointPosition(e,n,{defaultPos:i})}function rangePosition(e,n,{defaultPos:i,defaultPos2:r}){const{markDef:s,config:o}=n,l=getSecondaryRangeChannel(e),f=getSizeChannel(e),d=pointPosition2OrSize(n,r,l),p=d[f]?vgAlignedPositionChannel(e,s,o):getVgPositionChannel(e);return Object.assign(Object.assign({},pointPosition(e,n,{defaultPos:i,vgChannel:p})),d)}function pointPosition2OrSize(e,n,i){const{encoding:r,mark:s,markDef:o,stack:l,config:f}=e,d=getMainRangeChannel(i),p=getSizeChannel(i),g=getVgPositionChannel(i),v=r[d],S=e.scaleName(d),T=e.getScaleComponent(d),{offset:k}=i in r||i in o?positionOffset({channel:i,markDef:o,encoding:r,model:e}):positionOffset({channel:d,markDef:o,encoding:r,model:e});if(!v&&(i==="x2"||i==="y2")&&(r.latitude||r.longitude)){const R=getSizeChannel(i),P=e.markDef[R];return P!=null?{[R]:{value:P}}:{[g]:{field:e.getName(i)}}}const O=position2Ref({channel:i,channelDef:v,channel2Def:r[i],markDef:o,config:f,scaleName:S,scale:T,stack:l,offset:k,defaultRef:void 0});return O!==void 0?{[g]:O}:position2orSize(i,o)||position2orSize(i,{[i]:getMarkStyleConfig(i,o,f.style),[p]:getMarkStyleConfig(p,o,f.style)})||position2orSize(i,f[s])||position2orSize(i,f.mark)||{[g]:pointPositionDefaultRef({model:e,defaultPos:n,channel:i,scaleName:S,scale:T})()}}function position2Ref({channel:e,channelDef:n,channel2Def:i,markDef:r,config:s,scaleName:o,scale:l,stack:f,offset:d,defaultRef:p}){return isFieldOrDatumDef(n)&&f&&e.charAt(0)===f.fieldChannel.charAt(0)?valueRefForFieldOrDatumDef(n,o,{suffix:"start"},{offset:d}):midPointRefWithPositionInvalidTest({channel:e,channelDef:i,scaleName:o,scale:l,stack:f,markDef:r,config:s,offset:d,defaultRef:p})}function position2orSize(e,n){const i=getSizeChannel(e),r=getVgPositionChannel(e);if(n[r]!==void 0)return{[r]:widthHeightValueOrSignalRef(e,n[r])};if(n[e]!==void 0)return{[r]:widthHeightValueOrSignalRef(e,n[e])};if(n[i]){const s=n[i];if(isRelativeBandSize(s))warn(relativeBandSizeNotSupported(i));else return{[i]:widthHeightValueOrSignalRef(e,s)}}}function rectPosition(e,n){var i,r;const{config:s,encoding:o,markDef:l}=e,f=l.type,d=getSecondaryRangeChannel(n),p=getSizeChannel(n),g=o[n],v=o[d],S=e.getScaleComponent(n),T=S?S.get("type"):void 0,k=l.orient,O=(r=(i=o[p])!==null&&i!==void 0?i:o.size)!==null&&r!==void 0?r:getMarkPropOrConfig("size",l,s,{vgChannel:p}),R=f==="bar"&&(n==="x"?k==="vertical":k==="horizontal");return isFieldDef(g)&&(isBinning(g.bin)||isBinned(g.bin)||g.timeUnit&&!v)&&!(O&&!isRelativeBandSize(O))&&!hasDiscreteDomain(T)?rectBinPosition({fieldDef:g,fieldDef2:v,channel:n,model:e}):(isFieldOrDatumDef(g)&&hasDiscreteDomain(T)||R)&&!v?positionAndSize(g,n,e):rangePosition(n,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function defaultSizeRef(e,n,i,r,s){if(isRelativeBandSize(s))if(i){const l=i.get("type");if(l==="band"){let f=`bandwidth('${n}')`;return s.band!==1&&(f=`${s.band} * ${f}`),{signal:`max(0.25, ${f})`}}else s.band!==1&&(warn(cannotUseRelativeBandSizeWithNonBandScale(l)),s=void 0)}else return{mult:s.band,field:{group:e}};else{if(isSignalRef(s))return s;if(s)return{value:s}}if(i){const l=i.get("range");if(isVgRangeStep(l)&&isNumber$1(l.step))return{value:l.step-2}}return{value:getViewConfigDiscreteStep(r.view,e)-2}}function positionAndSize(e,n,i){const{markDef:r,encoding:s,config:o,stack:l}=i,f=r.orient,d=i.scaleName(n),p=i.getScaleComponent(n),g=getSizeChannel(n),v=getSecondaryRangeChannel(n),S=getOffsetChannel(n),T=i.scaleName(S),k=f==="horizontal"&&n==="y"||f==="vertical"&&n==="x";let O;(s.size||r.size)&&(k?O=nonPosition("size",i,{vgChannel:g,defaultRef:signalOrValueRef(r.size)}):warn(cannotApplySizeToNonOrientedMark(r.type)));const R=!!O,P=getBandSize({channel:n,fieldDef:e,markDef:r,config:o,scaleType:p==null?void 0:p.get("type"),useVlSizeChannel:k});O=O||{[g]:defaultSizeRef(g,T||d,p,o,P)};const F=(p==null?void 0:p.get("type"))==="band"&&isRelativeBandSize(P)&&!R?"top":"middle",I=vgAlignedPositionChannel(n,r,o,F),L=I==="xc"||I==="yc",{offset:N,offsetType:j}=positionOffset({channel:n,markDef:r,encoding:s,model:i,bandPosition:L?.5:0}),z=midPointRefWithPositionInvalidTest({channel:n,channelDef:e,markDef:r,config:o,scaleName:d,scale:p,stack:l,offset:N,defaultRef:pointPositionDefaultRef({model:i,defaultPos:"mid",channel:n,scaleName:d,scale:p}),bandPosition:L?j==="encoding"?0:.5:isSignalRef(P)?{signal:`(1-${P})/2`}:isRelativeBandSize(P)?(1-P.band)/2:0});if(g)return Object.assign({[I]:z},O);{const q=getVgPositionChannel(v),H=O[g],W=N?Object.assign(Object.assign({},H),{offset:N}):H;return{[I]:z,[q]:isArray(z)?[z[0],Object.assign(Object.assign({},z[1]),{offset:W})]:Object.assign(Object.assign({},z),{offset:W})}}}function getBinSpacing(e,n,i,r,s){if(isPolarPositionChannel(e))return 0;const o=e==="x"||e==="y2"?-n/2:n/2;if(isSignalRef(i)||isSignalRef(s)||isSignalRef(r)){const l=signalOrStringValue(i),f=signalOrStringValue(s),d=signalOrStringValue(r),p=d?`${d} + `:"",g=l?`(${l} ? -1 : 1) * `:"",v=f?`(${f} + ${o})`:o;return{signal:p+g+v}}else return s=s||0,r+(i?-s-o:+s+o)}function rectBinPosition({fieldDef:e,fieldDef2:n,channel:i,model:r}){var s,o,l;const{config:f,markDef:d,encoding:p}=r,g=r.getScaleComponent(i),v=r.scaleName(i),S=g?g.get("type"):void 0,T=g.get("reverse"),k=getBandSize({channel:i,fieldDef:e,markDef:d,config:f,scaleType:S}),O=(s=r.component.axes[i])===null||s===void 0?void 0:s[0],R=(o=O==null?void 0:O.get("translate"))!==null&&o!==void 0?o:.5,P=isXorY(i)&&(l=getMarkPropOrConfig("binSpacing",d,f))!==null&&l!==void 0?l:0,F=getSecondaryRangeChannel(i),I=getVgPositionChannel(i),L=getVgPositionChannel(F),{offset:N}=positionOffset({channel:i,markDef:d,encoding:p,model:r,bandPosition:0}),j=isSignalRef(k)?{signal:`(1-${k.signal})/2`}:isRelativeBandSize(k)?(1-k.band)/2:.5;if(isBinning(e.bin)||e.timeUnit)return{[L]:rectBinRef({fieldDef:e,scaleName:v,bandPosition:j,offset:getBinSpacing(F,P,T,R,N)}),[I]:rectBinRef({fieldDef:e,scaleName:v,bandPosition:isSignalRef(j)?{signal:`1-${j.signal}`}:1-j,offset:getBinSpacing(i,P,T,R,N)})};if(isBinned(e.bin)){const z=valueRefForFieldOrDatumDef(e,v,{},{offset:getBinSpacing(F,P,T,R,N)});if(isFieldDef(n))return{[L]:z,[I]:valueRefForFieldOrDatumDef(n,v,{},{offset:getBinSpacing(i,P,T,R,N)})};if(isBinParams(e.bin)&&e.bin.step)return{[L]:z,[I]:{signal:`scale("${v}", ${vgField(e,{expr:"datum"})} + ${e.bin.step})`,offset:getBinSpacing(i,P,T,R,N)}}}warn(channelRequiredForBinned(F))}function rectBinRef({fieldDef:e,scaleName:n,bandPosition:i,offset:r}){return interpolatedSignalRef({scaleName:n,fieldOrDatumDef:e,bandPosition:i,offset:r})}const ALWAYS_IGNORE=new Set(["aria","width","height"]);function baseEncodeEntry(e,n){const{fill:i=void 0,stroke:r=void 0}=n.color==="include"?color(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},markDefProperties(e.markDef,n)),wrapAllFieldsInvalid(e,"fill",i)),wrapAllFieldsInvalid(e,"stroke",r)),nonPosition("opacity",e)),nonPosition("fillOpacity",e)),nonPosition("strokeOpacity",e)),nonPosition("strokeWidth",e)),nonPosition("strokeDash",e)),zindex(e)),tooltip(e)),text$1(e,"href")),aria(e))}function wrapAllFieldsInvalid(e,n,i){const{config:r,mark:s,markDef:o}=e;if(getMarkPropOrConfig("invalid",o,r)==="hide"&&i&&!isPathMark(s)){const f=allFieldsInvalidPredicate$1(e,{invalid:!0,channels:SCALE_CHANNELS});if(f)return{[n]:[{test:f,value:null},...array$5(i)]}}return i?{[n]:i}:{}}function markDefProperties(e,n){return VG_MARK_CONFIGS.reduce((i,r)=>(!ALWAYS_IGNORE.has(r)&&e[r]!==void 0&&n[r]!=="ignore"&&(i[r]=signalOrValueRef(e[r])),i),{})}function allFieldsInvalidPredicate$1(e,{invalid:n=!1,channels:i}){const r=i.reduce((o,l)=>{const f=e.getScaleComponent(l);if(f){const d=f.get("type"),p=e.vgField(l,{expr:"datum"});p&&hasContinuousDomain(d)&&(o[p]=!0)}return o},{}),s=keys$1(r);if(s.length>0){const o=n?"||":"&&";return s.map(l=>fieldInvalidPredicate(l,n)).join(` ${o} `)}}function defined(e){const{config:n,markDef:i}=e;if(getMarkPropOrConfig("invalid",i,n)){const s=allFieldsInvalidPredicate(e,{channels:POSITION_SCALE_CHANNELS});if(s)return{defined:{signal:s}}}return{}}function allFieldsInvalidPredicate(e,{invalid:n=!1,channels:i}){const r=i.reduce((o,l)=>{var f;const d=e.getScaleComponent(l);if(d){const p=d.get("type"),g=e.vgField(l,{expr:"datum",binSuffix:!((f=e.stack)===null||f===void 0)&&f.impute?"mid":void 0});g&&hasContinuousDomain(p)&&(o[g]=!0)}return o},{}),s=keys$1(r);if(s.length>0){const o=n?"||":"&&";return s.map(l=>fieldInvalidPredicate(l,n)).join(` ${o} `)}}function valueIfDefined(e,n){if(n!==void 0)return{[e]:signalOrValueRef(n)}}const VORONOI="voronoi",nearest={defined:e=>e.type==="point"&&e.nearest,parse:(e,n)=>{if(n.events)for(const i of n.events)i.markname=e.getName(VORONOI)},marks:(e,n,i)=>{const{x:r,y:s}=n.project.hasChannel,o=e.mark;if(isPathMark(o))return warn(nearestNotSupportForContinuous(o)),i;const l={name:e.getName(VORONOI),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},tooltip(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!s?"datum.datum.x || 0":"0"},y:{expr:s||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let f=0,d=!1;return i.forEach((p,g)=>{var v;const S=(v=p.name)!==null&&v!==void 0?v:"";S===e.component.mark[0].name?f=g:S.indexOf(VORONOI)>=0&&(d=!0)}),d||i.splice(f+1,0,l),i}},inputBindings={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!isLegendBinding(e.bind),parse:(e,n,i)=>disableDirectManipulation(n,i),topLevelSignals:(e,n,i)=>{const r=n.name,s=n.project,o=n.bind,l=n.init&&n.init[0],f=nearest.defined(n)?"(item().isVoronoi ? datum.datum : datum)":"datum";return s.items.forEach((d,p)=>{var g,v;const S=varName(`${r}_${d.field}`);i.filter(k=>k.name===S).length||i.unshift(Object.assign(Object.assign({name:S},l?{init:assembleInit(l[p])}:{value:null}),{on:n.events?[{events:n.events,update:`datum && item().mark.marktype !== 'group' ? ${f}[${$(d.field)}] : null`}]:[],bind:(v=(g=o[d.field])!==null&&g!==void 0?g:o[d.channel])!==null&&v!==void 0?v:o}))}),i},signals:(e,n,i)=>{const r=n.name,s=n.project,o=i.filter(p=>p.name===r+TUPLE)[0],l=r+TUPLE_FIELDS,f=s.items.map(p=>varName(`${r}_${p.field}`)),d=f.map(p=>`${p} !== null`).join(" && ");return f.length&&(o.update=`${d} ? {fields: ${l}, values: [${f.join(", ")}]} : null`),delete o.value,delete o.on,i}},TOGGLE="_toggle",toggle={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,n,i)=>i.concat({name:n.name+TOGGLE,value:!1,on:[{events:n.events,update:n.toggle}]}),modifyExpr:(e,n)=>{const i=n.name+TUPLE,r=n.name+TOGGLE;return`${r} ? null : ${i}, `+(n.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${unitName(e)}}, `)+`${r} ? ${i} : null`}},clear={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,n)=>{n.clear&&(n.clear=isString(n.clear)?eventSelector(n.clear,"view"):n.clear)},topLevelSignals:(e,n,i)=>{if(inputBindings.defined(n))for(const r of n.project.items){const s=i.findIndex(o=>o.name===varName(`${n.name}_${r.field}`));s!==-1&&i[s].on.push({events:n.clear,update:"null"})}return i},signals:(e,n,i)=>{function r(s,o){s!==-1&&i[s].on&&i[s].on.push({events:n.clear,update:o})}if(n.type==="interval")for(const s of n.project.items){const o=i.findIndex(l=>l.name===s.signals.visual);if(r(o,"[0, 0]"),o===-1){const l=i.findIndex(f=>f.name===s.signals.data);r(l,"null")}}else{let s=i.findIndex(o=>o.name===n.name+TUPLE);r(s,"null"),toggle.defined(n)&&(s=i.findIndex(o=>o.name===n.name+TOGGLE),r(s,"false"))}return i}},legendBindings={defined:e=>{const n=e.resolve==="global"&&e.bind&&isLegendBinding(e.bind),i=e.project.items.length===1&&e.project.items[0].field!==SELECTION_ID;return n&&!i&&warn(LEGEND_BINDINGS_MUST_HAVE_PROJECTION),n&&i},parse:(e,n,i)=>{var r;const s=duplicate(i);if(s.select=isString(s.select)?{type:s.select,toggle:n.toggle}:Object.assign(Object.assign({},s.select),{toggle:n.toggle}),disableDirectManipulation(n,s),isObject(i.select)&&(i.select.on||i.select.clear)){const f='event.item && indexof(event.item.mark.role, "legend") < 0';for(const d of n.events)d.filter=array$5((r=d.filter)!==null&&r!==void 0?r:[]),d.filter.includes(f)||d.filter.push(f)}const o=isLegendStreamBinding(n.bind)?n.bind.legend:"click",l=isString(o)?eventSelector(o,"view"):array$5(o);n.bind={legend:{merge:l}}},topLevelSignals:(e,n,i)=>{const r=n.name,s=isLegendStreamBinding(n.bind)&&n.bind.legend,o=l=>f=>{const d=duplicate(f);return d.markname=l,d};for(const l of n.project.items){if(!l.hasLegend)continue;const f=`${varName(l.field)}_legend`,d=`${r}_${f}`;if(i.filter(g=>g.name===d).length===0){const g=s.merge.map(o(`${f}_symbols`)).concat(s.merge.map(o(`${f}_labels`))).concat(s.merge.map(o(`${f}_entries`)));i.unshift(Object.assign(Object.assign({name:d},n.init?{}:{value:null}),{on:[{events:g,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:s.merge,update:`!event.item || !datum ? null : ${d}`,force:!0}]}))}}return i},signals:(e,n,i)=>{const r=n.name,s=n.project,o=i.find(S=>S.name===r+TUPLE),l=r+TUPLE_FIELDS,f=s.items.filter(S=>S.hasLegend).map(S=>varName(`${r}_${varName(S.field)}_legend`)),p=`${f.map(S=>`${S} !== null`).join(" && ")} ? {fields: ${l}, values: [${f.join(", ")}]} : null`;n.events&&f.length>0?o.on.push({events:f.map(S=>({signal:S})),update:p}):f.length>0&&(o.update=p,delete o.value,delete o.on);const g=i.find(S=>S.name===r+TOGGLE),v=isLegendStreamBinding(n.bind)&&n.bind.legend;return g&&(n.events?g.on.push(Object.assign(Object.assign({},g.on[0]),{events:v})):g.on[0].events=v),i}};function parseInteractiveLegend(e,n,i){var r,s,o,l;const f=(r=e.fieldDef(n))===null||r===void 0?void 0:r.field;for(const d of vals((s=e.component.selection)!==null&&s!==void 0?s:{})){const p=(o=d.project.hasField[f])!==null&&o!==void 0?o:d.project.hasChannel[n];if(p&&legendBindings.defined(d)){const g=(l=i.get("selections"))!==null&&l!==void 0?l:[];g.push(d.name),i.set("selections",g,!1),p.hasLegend=!0}}}const ANCHOR$1="_translate_anchor",DELTA$1="_translate_delta",translate={defined:e=>e.type==="interval"&&e.translate,signals:(e,n,i)=>{const r=n.name,s=scaleBindings.defined(n),o=r+ANCHOR$1,{x:l,y:f}=n.project.hasChannel;let d=eventSelector(n.translate,"scope");return s||(d=d.map(p=>(p.between[0].markname=r+BRUSH,p))),i.push({name:o,value:{},on:[{events:d.map(p=>p.between[0]),update:"{x: x(unit), y: y(unit)"+(l!==void 0?`, extent_x: ${s?domain(e,X):`slice(${l.signals.visual})`}`:"")+(f!==void 0?`, extent_y: ${s?domain(e,Y):`slice(${f.signals.visual})`}`:"")+"}"}]},{name:r+DELTA$1,value:{},on:[{events:d,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),l!==void 0&&onDelta$1(e,n,l,"width",i),f!==void 0&&onDelta$1(e,n,f,"height",i),i}};function onDelta$1(e,n,i,r,s){var o,l;const f=n.name,d=f+ANCHOR$1,p=f+DELTA$1,g=i.channel,v=scaleBindings.defined(n),S=s.filter(z=>z.name===i.signals[v?"data":"visual"])[0],T=e.getSizeSignalRef(r).signal,k=e.getScaleComponent(g),O=k.get("type"),R=k.get("reverse"),P=v?g===X?R?"":"-":R?"-":"":"",F=`${d}.extent_${g}`,I=`${P}${p}.${g} / ${v?`${T}`:`span(${F})`}`,L=v?O==="log"?"panLog":O==="symlog"?"panSymlog":O==="pow"?"panPow":"panLinear":"panLinear",N=v?O==="pow"?`, ${(o=k.get("exponent"))!==null&&o!==void 0?o:1}`:O==="symlog"?`, ${(l=k.get("constant"))!==null&&l!==void 0?l:1}`:"":"",j=`${L}(${F}, ${I}${N})`;S.on.push({events:{signal:p},update:v?j:`clampRange(${j}, 0, ${T})`})}const ANCHOR="_zoom_anchor",DELTA="_zoom_delta",zoom={defined:e=>e.type==="interval"&&e.zoom,signals:(e,n,i)=>{const r=n.name,s=scaleBindings.defined(n),o=r+DELTA,{x:l,y:f}=n.project.hasChannel,d=$(e.scaleName(X)),p=$(e.scaleName(Y));let g=eventSelector(n.zoom,"scope");return s||(g=g.map(v=>(v.markname=r+BRUSH,v))),i.push({name:r+ANCHOR,on:[{events:g,update:s?"{"+[d?`x: invert(${d}, x(unit))`:"",p?`y: invert(${p}, y(unit))`:""].filter(v=>!!v).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:g,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),l!==void 0&&onDelta(e,n,l,"width",i),f!==void 0&&onDelta(e,n,f,"height",i),i}};function onDelta(e,n,i,r,s){var o,l;const f=n.name,d=i.channel,p=scaleBindings.defined(n),g=s.filter(L=>L.name===i.signals[p?"data":"visual"])[0],v=e.getSizeSignalRef(r).signal,S=e.getScaleComponent(d),T=S.get("type"),k=p?domain(e,d):g.name,O=f+DELTA,R=`${f}${ANCHOR}.${d}`,P=p?T==="log"?"zoomLog":T==="symlog"?"zoomSymlog":T==="pow"?"zoomPow":"zoomLinear":"zoomLinear",F=p?T==="pow"?`, ${(o=S.get("exponent"))!==null&&o!==void 0?o:1}`:T==="symlog"?`, ${(l=S.get("constant"))!==null&&l!==void 0?l:1}`:"":"",I=`${P}(${k}, ${R}, ${O}${F})`;g.on.push({events:{signal:O},update:p?I:`clampRange(${I}, 0, ${v})`})}const STORE="_store",TUPLE="_tuple",MODIFY="_modify",VL_SELECTION_RESOLVE="vlSelectionResolve",selectionCompilers=[point$1,interval,project,toggle,inputBindings,scaleBindings,legendBindings,clear,translate,zoom,nearest];function getFacetModel(e){let n=e.parent;for(;n&&!isFacetModel(n);)n=n.parent;return n}function unitName(e,{escape:n}={escape:!0}){let i=n?$(e.name):e.name;const r=getFacetModel(e);if(r){const{facet:s}=r;for(const o of FACET_CHANNELS)s[o]&&(i+=` + '__facet_${o}_' + (facet[${$(r.vgField(o))}])`)}return i}function requiresSelectionId(e){var n;return vals((n=e.component.selection)!==null&&n!==void 0?n:{}).reduce((i,r)=>i||r.project.hasSelectionId,!1)}function disableDirectManipulation(e,n){(isString(n.select)||!n.select.on)&&delete e.events,(isString(n.select)||!n.select.clear)&&delete e.clear,(isString(n.select)||!n.select.toggle)&&delete e.toggle}function getName(e){const n=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(n.push(...getName(e.object)),n.push(...getName(e.property))),n)}function startsWithDatum(e){return e.object.type==="MemberExpression"?startsWithDatum(e.object):e.object.name==="datum"}function getDependentFields(e){const n=parser$1(e),i=new Set;return n.visit(r=>{r.type==="MemberExpression"&&startsWithDatum(r)&&i.add(getName(r).slice(1).join("."))}),i}class FilterNode extends DataFlowNode{constructor(n,i,r){super(n),this.model=i,this.filter=r,this.expr=expression(this.model,this.filter,this),this._dependentFields=getDependentFields(this.expr)}clone(){return new FilterNode(null,this.model,duplicate(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function parseUnitSelection(e,n){var i;const r={},s=e.config.selection;if(!n||!n.length)return r;for(const o of n){const l=varName(o.name),f=o.select,d=isString(f)?f:f.type,p=isObject(f)?duplicate(f):{type:d},g=s[d];for(const S in g)S==="fields"||S==="encodings"||(S==="mark"&&(p[S]=Object.assign(Object.assign({},g[S]),p[S])),(p[S]===void 0||p[S]===!0)&&(p[S]=(i=g[S])!==null&&i!==void 0?i:p[S]));const v=r[l]=Object.assign(Object.assign({},p),{name:l,type:d,init:o.value,bind:o.bind,events:isString(p.on)?eventSelector(p.on,"scope"):array$5(duplicate(p.on))});for(const S of selectionCompilers)S.defined(v)&&S.parse&&S.parse(e,v,o)}return r}function parseSelectionPredicate(e,n,i,r="datum"){const s=isString(n)?n:n.param,o=varName(s),l=$(o+STORE);let f;try{f=e.getSelectionComponent(o,s)}catch{return`!!${o}`}if(f.project.timeUnit){const S=i??e.component.data.raw,T=f.project.timeUnit.clone();S.parent?T.insertAsParentOf(S):S.parent=T}const d=f.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",p=f.resolve==="global"?")":`, ${$(f.resolve)})`,g=`${d}${l}, ${r}${p}`,v=`length(data(${l}))`;return n.empty===!1?`${v} && ${g}`:`!${v} || ${g}`}function parseSelectionExtent(e,n,i){const r=varName(n),s=i.encoding;let o=i.field,l;try{l=e.getSelectionComponent(r,n)}catch{return r}if(!s&&!o)o=l.project.items[0].field,l.project.items.length>1&&warn(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${$(o)}.`);else if(s&&!o){const f=l.project.items.filter(d=>d.channel===s);!f.length||f.length>1?(o=l.project.items[0].field,warn((f.length?"Multiple ":"No ")+`matching ${$(s)} encoding found for selection ${$(i.param)}. Using "field": ${$(o)}.`)):o=f[0].field}return`${l.name}[${$(replacePathInField(o))}]`}function materializeSelections(e,n){var i;for(const[r,s]of entries$1((i=e.component.selection)!==null&&i!==void 0?i:{})){const o=e.getName(`lookup_${r}`);e.component.data.outputNodes[o]=s.materialized=new OutputNode(new FilterNode(n,e,{param:r}),o,DataSourceType.Lookup,e.component.data.outputNodeRefCounts)}}function expression(e,n,i){return logicalExpr(n,r=>isString(r)?r:isSelectionPredicate(r)?parseSelectionPredicate(e,r,i):fieldFilterExpression(r))}var __rest$a=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function assembleTitle(e,n){if(e)return isArray(e)&&!isText(e)?e.map(i=>defaultTitle(i,n)).join(", "):e}function setAxisEncode(e,n,i,r){var s,o,l,f,d;(s=e.encode)!==null&&s!==void 0||(e.encode={}),(o=(f=e.encode)[n])!==null&&o!==void 0||(f[n]={}),(l=(d=e.encode[n]).update)!==null&&l!==void 0||(d.update={}),e.encode[n].update[i]=r}function assembleAxis(e,n,i,r={header:!1}){var s,o;const l=e.combine(),{disable:f,orient:d,scale:p,labelExpr:g,title:v,zindex:S}=l,T=__rest$a(l,["disable","orient","scale","labelExpr","title","zindex"]);if(!f){for(const k in T){const O=AXIS_PROPERTY_TYPE[k],R=T[k];if(O&&O!==n&&O!=="both")delete T[k];else if(isConditionalAxisValue(R)){const{condition:P}=R,F=__rest$a(R,["condition"]),I=array$5(P),L=CONDITIONAL_AXIS_PROP_INDEX[k];if(L){const{vgProp:N,part:j}=L,z=[...I.map(q=>{const{test:H}=q,W=__rest$a(q,["test"]);return Object.assign({test:expression(null,H)},W)}),F];setAxisEncode(T,j,N,z),delete T[k]}else if(L===null){const N={signal:I.map(j=>{const{test:z}=j,q=__rest$a(j,["test"]);return`${expression(null,z)} ? ${exprFromValueRefOrSignalRef(q)} : `}).join("")+exprFromValueRefOrSignalRef(F)};T[k]=N}}else if(isSignalRef(R)){const P=CONDITIONAL_AXIS_PROP_INDEX[k];if(P){const{vgProp:F,part:I}=P;setAxisEncode(T,I,F,R),delete T[k]}}contains(["labelAlign","labelBaseline"],k)&&T[k]===null&&delete T[k]}if(n==="grid"){if(!T.grid)return;if(T.encode){const{grid:k}=T.encode;T.encode=Object.assign({},k?{grid:k}:{}),isEmpty(T.encode)&&delete T.encode}return Object.assign(Object.assign({scale:p,orient:d},T),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:getFirstDefined(S,0)})}else{if(!r.header&&e.mainExtracted)return;if(g!==void 0){let O=g;!((o=(s=T.encode)===null||s===void 0?void 0:s.labels)===null||o===void 0)&&o.update&&isSignalRef(T.encode.labels.update.text)&&(O=replaceAll(g,"datum.label",T.encode.labels.update.text.signal)),setAxisEncode(T,"labels","text",{signal:O})}if(T.labelAlign===null&&delete T.labelAlign,T.encode){for(const O of AXIS_PARTS)e.hasAxisPart(O)||delete T.encode[O];isEmpty(T.encode)&&delete T.encode}const k=assembleTitle(v,i);return Object.assign(Object.assign(Object.assign(Object.assign({scale:p,orient:d,grid:!1},k?{title:k}:{}),T),i.aria===!1?{aria:!1}:{}),{zindex:getFirstDefined(S,0)})}}}function assembleAxisSignals(e){const{axes:n}=e.component,i=[];for(const r of POSITION_SCALE_CHANNELS)if(n[r]){for(const s of n[r])if(!s.get("disable")&&!s.get("gridScale")){const o=r==="x"?"height":"width",l=e.getSizeSignalRef(o).signal;o!==l&&i.push({name:o,update:l})}}return i}function assembleAxes(e,n){const{x:i=[],y:r=[]}=e;return[...i.map(s=>assembleAxis(s,"grid",n)),...r.map(s=>assembleAxis(s,"grid",n)),...i.map(s=>assembleAxis(s,"main",n)),...r.map(s=>assembleAxis(s,"main",n))].filter(s=>s)}function getAxisConfigFromConfigTypes(e,n,i,r){return Object.assign.apply(null,[{},...e.map(s=>{if(s==="axisOrient"){const o=i==="x"?"bottom":"left",l=n[i==="x"?"axisBottom":"axisLeft"]||{},f=n[i==="x"?"axisTop":"axisRight"]||{},d=new Set([...keys$1(l),...keys$1(f)]),p={};for(const g of d.values())p[g]={signal:`${r.signal} === "${o}" ? ${signalOrStringValue(l[g])} : ${signalOrStringValue(f[g])}`};return p}return n[s]})])}function getAxisConfigs(e,n,i,r){const s=n==="band"?["axisDiscrete","axisBand"]:n==="point"?["axisDiscrete","axisPoint"]:isQuantitative(n)?["axisQuantitative"]:n==="time"||n==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",l=isSignalRef(i)?"axisOrient":`axis${titleCase(i)}`,f=[...s,...s.map(p=>o+p.substr(4))],d=["axis",l,o];return{vlOnlyAxisConfig:getAxisConfigFromConfigTypes(f,r,e,i),vgAxisConfig:getAxisConfigFromConfigTypes(d,r,e,i),axisConfigStyle:getAxisConfigStyle([...d,...f],r)}}function getAxisConfigStyle(e,n){var i;const r=[{}];for(const s of e){let o=(i=n[s])===null||i===void 0?void 0:i.style;if(o){o=array$5(o);for(const l of o)r.push(n.style[l])}}return Object.assign.apply(null,r)}function getAxisConfig(e,n,i,r={}){var s;const o=getStyleConfig(e,i,n);if(o!==void 0)return{configFrom:"style",configValue:o};for(const l of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((s=r[l])===null||s===void 0?void 0:s[e])!==void 0)return{configFrom:l,configValue:r[l][e]};return{}}const axisRules={scale:({model:e,channel:n})=>e.scaleName(n),format:({fieldOrDatumDef:e,config:n,axis:i})=>{const{format:r,formatType:s}=i;return guideFormat(e,e.type,r,s,n,!0)},formatType:({axis:e,fieldOrDatumDef:n,scaleType:i})=>{const{formatType:r}=e;return guideFormatType(r,n,i)},grid:({fieldOrDatumDef:e,axis:n,scaleType:i})=>{var r;return(r=n.grid)!==null&&r!==void 0?r:defaultGrid(i,e)},gridScale:({model:e,channel:n})=>gridScale(e,n),labelAlign:({axis:e,labelAngle:n,orient:i,channel:r})=>e.labelAlign||defaultLabelAlign(n,i,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:n,orient:i,channel:r})=>e.labelBaseline||defaultLabelBaseline(n,i,r),labelFlush:({axis:e,fieldOrDatumDef:n,channel:i})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:defaultLabelFlush(n.type,i)},labelOverlap:({axis:e,fieldOrDatumDef:n,scaleType:i})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:defaultLabelOverlap$1(n.type,i,isFieldDef(n)&&!!n.timeUnit,isFieldDef(n)?n.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:n,axis:i,fieldOrDatumDef:r,scaleType:s})=>{var o;const l=e==="x"?"width":e==="y"?"height":void 0,f=l?n.getSizeSignalRef(l):void 0;return(o=i.tickCount)!==null&&o!==void 0?o:defaultTickCount({fieldOrDatumDef:r,scaleType:s,size:f,values:i.values})},title:({axis:e,model:n,channel:i})=>{if(e.title!==void 0)return e.title;const r=getFieldDefTitle(n,i);if(r!==void 0)return r;const s=n.typedFieldDef(i),o=i==="x"?"x2":"y2",l=n.fieldDef(o);return mergeTitleFieldDefs(s?[toFieldDefBase(s)]:[],isFieldDef(l)?[toFieldDefBase(l)]:[])},values:({axis:e,fieldOrDatumDef:n})=>values$2(e,n),zindex:({axis:e,fieldOrDatumDef:n,mark:i})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:defaultZindex(i,n)}};function defaultGrid(e,n){return!hasDiscreteDomain(e)&&isFieldDef(n)&&!isBinning(n==null?void 0:n.bin)&&!isBinned(n==null?void 0:n.bin)}function gridScale(e,n){const i=n==="x"?"y":"x";if(e.getScaleComponent(i))return e.scaleName(i)}function getLabelAngle(e,n,i,r,s){const o=n==null?void 0:n.labelAngle;if(o!==void 0)return isSignalRef(o)?o:normalizeAngle(o);{const{configValue:l}=getAxisConfig("labelAngle",r,n==null?void 0:n.style,s);return l!==void 0?normalizeAngle(l):i===X&&contains([NOMINAL,ORDINAL],e.type)&&!(isFieldDef(e)&&e.timeUnit)?270:void 0}}function normalizeAngleExpr(e){return`(((${e.signal} % 360) + 360) % 360)`}function defaultLabelBaseline(e,n,i,r){if(e!==void 0)if(i==="x"){if(isSignalRef(e)){const s=normalizeAngleExpr(e),o=isSignalRef(n)?`(${n.signal} === "top")`:n==="top";return{signal:`(45 < ${s} && ${s} < 135) || (225 < ${s} && ${s} < 315) ? "middle" :(${s} <= 45 || 315 <= ${s}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(isSignalRef(n)){const s=e<=45||315<=e?"===":"!==";return{signal:`${n.signal} ${s} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(n==="top")?"bottom":"top"}else{if(isSignalRef(e)){const s=normalizeAngleExpr(e),o=isSignalRef(n)?`(${n.signal} === "left")`:n==="left";return{signal:`${s} <= 45 || 315 <= ${s} || (135 <= ${s} && ${s} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${s} && ${s} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(isSignalRef(n)){const s=45<=e&&e<=135?"===":"!==";return{signal:`${n.signal} ${s} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(n==="left")?"top":"bottom"}}function defaultLabelAlign(e,n,i){if(e===void 0)return;const r=i==="x",s=r?0:90,o=r?"bottom":"left";if(isSignalRef(e)){const l=normalizeAngleExpr(e),f=isSignalRef(n)?`(${n.signal} === "${o}")`:n===o;return{signal:`(${s?`(${l} + 90)`:l} % 180 === 0) ? ${r?null:'"center"'} :(${s} < ${l} && ${l} < ${180+s}) === ${f} ? "left" : "right"`}}if((e+s)%180===0)return r?null:"center";if(isSignalRef(n)){const l=s<e&&e<180+s?"===":"!==";return{signal:`${`${n.signal} ${l} "${o}"`} ? "left" : "right"`}}return(s<e&&e<180+s)==(n===o)?"left":"right"}function defaultLabelFlush(e,n){if(n==="x"&&contains(["quantitative","temporal"],e))return!0}function defaultLabelOverlap$1(e,n,i,r){if(i&&!isObject(r)||e!=="nominal"&&e!=="ordinal")return n==="log"||n==="symlog"?"greedy":!0}function defaultOrient(e){return e==="x"?"bottom":"left"}function defaultTickCount({fieldOrDatumDef:e,scaleType:n,size:i,values:r}){var s;if(!r&&!hasDiscreteDomain(n)&&n!=="log"){if(isFieldDef(e)){if(isBinning(e.bin))return{signal:`ceil(${i.signal}/10)`};if(e.timeUnit&&contains(["month","hours","day","quarter"],(s=normalizeTimeUnit(e.timeUnit))===null||s===void 0?void 0:s.unit))return}return{signal:`ceil(${i.signal}/40)`}}}function getFieldDefTitle(e,n){const i=n==="x"?"x2":"y2",r=e.fieldDef(n),s=e.fieldDef(i),o=r?r.title:void 0,l=s?s.title:void 0;if(o&&l)return mergeTitle(o,l);if(o)return o;if(l)return l;if(o!==void 0)return o;if(l!==void 0)return l}function values$2(e,n){const i=e.values;if(isArray(i))return valueArray(n,i);if(isSignalRef(i))return i}function defaultZindex(e,n){return e==="rect"&&isDiscrete(n)?1:0}class CalculateNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i,this._dependentFields=getDependentFields(this.transform.calculate)}clone(){return new CalculateNode(null,duplicate(this.transform))}static parseAllForSortIndex(n,i){return i.forEachFieldDef((r,s)=>{if(isScaleFieldDef(r)&&isSortArray(r.sort)){const{field:o,timeUnit:l}=r,f=r.sort,d=f.map((p,g)=>`${fieldFilterExpression({field:o,timeUnit:l,equal:p})} ? ${g} : `).join("")+f.length;n=new CalculateNode(n,{calculate:d,as:sortArrayIndexField(r,s,{forAs:!0})})}}),n}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${hash(this.transform)}`}}function sortArrayIndexField(e,n,i){return vgField(e,Object.assign({prefix:n,suffix:"sort_index"},i??{}))}function getHeaderChannel(e,n){return contains(["top","bottom"],n)?"column":contains(["left","right"],n)||e==="row"?"row":"column"}function getHeaderProperty(e,n,i,r){const s=r==="row"?i.headerRow:r==="column"?i.headerColumn:i.headerFacet;return getFirstDefined((n||{})[e],s[e],i.header[e])}function getHeaderProperties(e,n,i,r){const s={};for(const o of e){const l=getHeaderProperty(o,n||{},i,r);l!==void 0&&(s[o]=l)}return s}const HEADER_CHANNELS=["row","column"],HEADER_TYPES=["header","footer"];function assembleTitleGroup(e,n){const i=e.component.layoutHeaders[n].title,r=e.config?e.config:void 0,s=e.component.layoutHeaders[n].facetFieldDef?e.component.layoutHeaders[n].facetFieldDef:void 0,{titleAnchor:o,titleAngle:l,titleOrient:f}=getHeaderProperties(["titleAnchor","titleAngle","titleOrient"],s.header,r,n),d=getHeaderChannel(n,f),p=normalizeAngle(l);return{name:`${n}-title`,type:"group",role:`${d}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:i},n==="row"?{orient:"left"}:{}),{style:"guide-title"}),defaultHeaderGuideBaseline(p,d)),defaultHeaderGuideAlign(d,p,o)),assembleHeaderProperties(r,s,n,HEADER_TITLE_PROPERTIES,HEADER_TITLE_PROPERTIES_MAP))}}function defaultHeaderGuideAlign(e,n,i="middle"){switch(i){case"start":return{align:"left"};case"end":return{align:"right"}}const r=defaultLabelAlign(n,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function defaultHeaderGuideBaseline(e,n){const i=defaultLabelBaseline(e,n==="row"?"left":"top",n==="row"?"y":"x",!0);return i?{baseline:i}:{}}function assembleHeaderGroups(e,n){const i=e.component.layoutHeaders[n],r=[];for(const s of HEADER_TYPES)if(i[s])for(const o of i[s]){const l=assembleHeaderGroup(e,n,s,i,o);l!=null&&r.push(l)}return r}function getSort$1(e,n){var i;const{sort:r}=e;return isSortField(r)?{field:vgField(r,{expr:"datum"}),order:(i=r.order)!==null&&i!==void 0?i:"ascending"}:isArray(r)?{field:sortArrayIndexField(e,n,{expr:"datum"}),order:"ascending"}:{field:vgField(e,{expr:"datum"}),order:r??"ascending"}}function assembleLabelTitle(e,n,i){const{format:r,formatType:s,labelAngle:o,labelAnchor:l,labelOrient:f,labelExpr:d}=getHeaderProperties(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,i,n),p=formatSignalRef({fieldOrDatumDef:e,format:r,formatType:s,expr:"parent",config:i}).signal,g=getHeaderChannel(n,f);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:d?replaceAll(replaceAll(d,"datum.label",p),"datum.value",vgField(e,{expr:"parent"})):p}},n==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),defaultHeaderGuideBaseline(o,g)),defaultHeaderGuideAlign(g,o,l)),assembleHeaderProperties(i,e,n,HEADER_LABEL_PROPERTIES,HEADER_LABEL_PROPERTIES_MAP))}function assembleHeaderGroup(e,n,i,r,s){if(s){let o=null;const{facetFieldDef:l}=r,f=e.config?e.config:void 0;if(l&&s.labels){const{labelOrient:v}=getHeaderProperties(["labelOrient"],l.header,f,n);(n==="row"&&!contains(["top","bottom"],v)||n==="column"&&!contains(["left","right"],v))&&(o=assembleLabelTitle(l,n,f))}const d=isFacetModel(e)&&!isFacetMapping(e.facet),p=s.axes,g=(p==null?void 0:p.length)>0;if(o||g){const v=n==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${n}_${i}`),type:"group",role:`${n}-${i}`},r.facetFieldDef?{from:{data:e.getName(`${n}_domain`)},sort:getSort$1(l,n)}:{}),g&&d?{from:{data:e.getName(`facet_domain_${n}`)}}:{}),o?{title:o}:{}),s.sizeSignal?{encode:{update:{[v]:s.sizeSignal}}}:{}),g?{axes:p}:{})}}return null}const LAYOUT_TITLE_BAND={column:{start:0,end:1},row:{start:1,end:0}};function getLayoutTitleBand(e,n){return LAYOUT_TITLE_BAND[n][e]}function assembleLayoutTitleBand(e,n){const i={};for(const r of FACET_CHANNELS){const s=e[r];if(s!=null&&s.facetFieldDef){const{titleAnchor:o,titleOrient:l}=getHeaderProperties(["titleAnchor","titleOrient"],s.facetFieldDef.header,n,r),f=getHeaderChannel(r,l),d=getLayoutTitleBand(o,f);d!==void 0&&(i[f]=d)}}return isEmpty(i)?void 0:i}function assembleHeaderProperties(e,n,i,r,s){const o={};for(const l of r){if(!s[l])continue;const f=getHeaderProperty(l,n==null?void 0:n.header,e,i);f!==void 0&&(o[s[l]]=f)}return o}function assembleLayoutSignals(e){return[...sizeSignals(e,"width"),...sizeSignals(e,"height"),...sizeSignals(e,"childWidth"),...sizeSignals(e,"childHeight")]}function sizeSignals(e,n){const i=n==="width"?"x":"y",r=e.component.layoutSize.get(n);if(!r||r==="merged")return[];const s=e.getSizeSignalRef(n).signal;if(r==="step"){const o=e.getScaleComponent(i);if(o){const l=o.get("type"),f=o.get("range");if(hasDiscreteDomain(l)&&isVgRangeStep(f)){const d=e.scaleName(i);return isFacetModel(e.parent)&&e.parent.component.resolve.scale[i]==="independent"?[stepSignal(d,f)]:[stepSignal(d,f),{name:s,update:sizeExpr(d,o,`domain('${d}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=s.endsWith("width"),l=o?"containerSize()[0]":"containerSize()[1]",f=getViewConfigContinuousSize(e.config.view,o?"width":"height"),d=`isFinite(${l}) ? ${l} : ${f}`;return[{name:s,init:d,on:[{update:d,events:"window:resize"}]}]}else return[{name:s,value:r}]}function stepSignal(e,n){const i=`${e}_step`;return isSignalRef(n.step)?{name:i,update:n.step.signal}:{name:i,value:n.step}}function sizeExpr(e,n,i){const r=n.get("type"),s=n.get("padding"),o=getFirstDefined(n.get("paddingOuter"),s);let l=n.get("paddingInner");return l=r==="band"?l!==void 0?l:s:1,`bandspace(${i}, ${signalOrStringValue(l)}, ${signalOrStringValue(o)}) * ${e}_step`}function getSizeTypeFromLayoutSizeType(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function guideEncodeEntry(e,n){return keys$1(e).reduce((i,r)=>{const s=e[r];return Object.assign(Object.assign({},i),wrapCondition(n,s,r,o=>signalOrValueRef(o.value)))},{})}function defaultScaleResolve(e,n){if(isFacetModel(n))return e==="theta"?"independent":"shared";if(isLayerModel(n))return"shared";if(isConcatModel(n))return isXorY(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function parseGuideResolve(e,n){const i=e.scale[n],r=isXorY(n)?"axis":"legend";return i==="independent"?(e[r][n]==="shared"&&warn(independentScaleMeansIndependentGuide(n)),"independent"):e[r][n]||"shared"}const LEGEND_COMPONENT_PROPERTY_INDEX=Object.assign(Object.assign({},COMMON_LEGEND_PROPERTY_INDEX),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),LEGEND_COMPONENT_PROPERTIES=keys$1(LEGEND_COMPONENT_PROPERTY_INDEX);class LegendComponent extends Split{}const legendEncodeRules={symbols,gradient,labels:labels$1,entries};function symbols(e,{fieldOrDatumDef:n,model:i,channel:r,legendCmpt:s,legendType:o}){var l,f,d,p,g,v,S,T;if(o!=="symbol")return;const{markDef:k,encoding:O,config:R,mark:P}=i,F=k.filled&&P!=="trail";let I=Object.assign(Object.assign({},applyMarkConfig({},i,FILL_STROKE_CONFIG)),color(i,{filled:F}));const L=(l=s.get("symbolOpacity"))!==null&&l!==void 0?l:R.legend.symbolOpacity,N=(f=s.get("symbolFillColor"))!==null&&f!==void 0?f:R.legend.symbolFillColor,j=(d=s.get("symbolStrokeColor"))!==null&&d!==void 0?d:R.legend.symbolStrokeColor,z=L===void 0?(p=getMaxValue(O.opacity))!==null&&p!==void 0?p:k.opacity:void 0;if(I.fill){if(r==="fill"||F&&r===COLOR)delete I.fill;else if(I.fill.field)N?delete I.fill:(I.fill=signalOrValueRef((g=R.legend.symbolBaseFillColor)!==null&&g!==void 0?g:"black"),I.fillOpacity=signalOrValueRef(z??1));else if(isArray(I.fill)){const q=(T=(S=getFirstConditionValue((v=O.fill)!==null&&v!==void 0?v:O.color))!==null&&S!==void 0?S:k.fill)!==null&&T!==void 0?T:F&&k.color;q&&(I.fill=signalOrValueRef(q))}}if(I.stroke){if(r==="stroke"||!F&&r===COLOR)delete I.stroke;else if(I.stroke.field||j)delete I.stroke;else if(isArray(I.stroke)){const q=getFirstDefined(getFirstConditionValue(O.stroke||O.color),k.stroke,F?k.color:void 0);q&&(I.stroke={value:q})}}if(r!==OPACITY){const q=isFieldDef(n)&&selectedCondition(i,s,n);q?I.opacity=[Object.assign({test:q},signalOrValueRef(z??1)),signalOrValueRef(R.legend.unselectedOpacity)]:z&&(I.opacity=signalOrValueRef(z))}return I=Object.assign(Object.assign({},I),e),isEmpty(I)?void 0:I}function gradient(e,{model:n,legendType:i,legendCmpt:r}){var s;if(i!=="gradient")return;const{config:o,markDef:l,encoding:f}=n;let d={};const g=((s=r.get("gradientOpacity"))!==null&&s!==void 0?s:o.legend.gradientOpacity)===void 0?getMaxValue(f.opacity)||l.opacity:void 0;return g&&(d.opacity=signalOrValueRef(g)),d=Object.assign(Object.assign({},d),e),isEmpty(d)?void 0:d}function labels$1(e,{fieldOrDatumDef:n,model:i,channel:r,legendCmpt:s}){const o=i.legend(r)||{},l=i.config,f=isFieldDef(n)?selectedCondition(i,s,n):void 0,d=f?[{test:f,value:1},{value:l.legend.unselectedOpacity}]:void 0,{format:p,formatType:g}=o;let v;isCustomFormatType(g)?v=formatCustomType({fieldOrDatumDef:n,field:"datum.value",format:p,formatType:g,config:l}):p===void 0&&g===void 0&&l.customFormatTypes&&(n.type==="quantitative"&&l.numberFormatType?v=formatCustomType({fieldOrDatumDef:n,field:"datum.value",format:l.numberFormat,formatType:l.numberFormatType,config:l}):n.type==="temporal"&&l.timeFormatType&&isFieldDef(n)&&n.timeUnit===void 0&&(v=formatCustomType({fieldOrDatumDef:n,field:"datum.value",format:l.timeFormat,formatType:l.timeFormatType,config:l})));const S=Object.assign(Object.assign(Object.assign({},d?{opacity:d}:{}),v?{text:v}:{}),e);return isEmpty(S)?void 0:S}function entries(e,{legendCmpt:n}){const i=n.get("selections");return i!=null&&i.length?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function getMaxValue(e){return getConditionValue(e,(n,i)=>Math.max(n,i.value))}function getFirstConditionValue(e){return getConditionValue(e,(n,i)=>getFirstDefined(n,i.value))}function getConditionValue(e,n){if(hasConditionalValueDef(e))return array$5(e.condition).reduce(n,e.value);if(isValueDef(e))return e.value}function selectedCondition(e,n,i){const r=n.get("selections");if(!(r!=null&&r.length))return;const s=$(i.field);return r.map(o=>`(!length(data(${$(varName(o)+STORE)})) || (${o}[${s}] && indexof(${o}[${s}], datum.value) >= 0))`).join(" || ")}const legendRules={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:n,config:i})=>{const{format:r,formatType:s}=n;return guideFormat(e,e.type,r,s,i,!1)},formatType:({legend:e,fieldOrDatumDef:n,scaleType:i})=>{const{formatType:r}=e;return guideFormatType(r,n,i)},gradientLength:e=>{var n,i;const{legend:r,legendConfig:s}=e;return(i=(n=r.gradientLength)!==null&&n!==void 0?n:s.gradientLength)!==null&&i!==void 0?i:defaultGradientLength(e)},labelOverlap:({legend:e,legendConfig:n,scaleType:i})=>{var r,s;return(s=(r=e.labelOverlap)!==null&&r!==void 0?r:n.labelOverlap)!==null&&s!==void 0?s:defaultLabelOverlap(i)},symbolType:({legend:e,markDef:n,channel:i,encoding:r})=>{var s;return(s=e.symbolType)!==null&&s!==void 0?s:defaultSymbolType(n.type,i,r.shape,n.shape)},title:({fieldOrDatumDef:e,config:n})=>title(e,n,{allowDisabling:!0}),type:({legendType:e,scaleType:n,channel:i})=>{if(isColorChannel(i)&&isContinuousToContinuous(n)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:n})=>values$1(n,e)};function values$1(e,n){const i=e.values;if(isArray(i))return valueArray(n,i);if(isSignalRef(i))return i}function defaultSymbolType(e,n,i,r){var s;if(n!=="shape"){const o=(s=getFirstConditionValue(i))!==null&&s!==void 0?s:r;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function getLegendType(e){const{legend:n}=e;return getFirstDefined(n.type,defaultType$1(e))}function defaultType$1({channel:e,timeUnit:n,scaleType:i}){if(isColorChannel(e)){if(contains(["quarter","month","day"],n))return"symbol";if(isContinuousToContinuous(i))return"gradient"}return"symbol"}function getDirection({legendConfig:e,legendType:n,orient:i,legend:r}){var s,o;return(o=(s=r.direction)!==null&&s!==void 0?s:e[n?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:defaultDirection(i,n)}function defaultDirection(e,n){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return n==="gradient"?"horizontal":void 0}}function defaultGradientLength({legendConfig:e,model:n,direction:i,orient:r,scaleType:s}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:l,gradientVerticalMaxLength:f,gradientVerticalMinLength:d}=e;if(isContinuousToContinuous(s))return i==="horizontal"?r==="top"||r==="bottom"?gradientLengthSignal(n,"width",l,o):l:gradientLengthSignal(n,"height",d,f)}function gradientLengthSignal(e,n,i,r){return{signal:`clamp(${e.getSizeSignalRef(n).signal}, ${i}, ${r})`}}function defaultLabelOverlap(e){if(contains(["quantile","threshold","log","symlog"],e))return"greedy"}function parseLegend(e){const n=isUnitModel(e)?parseUnitLegend(e):parseNonUnitLegend(e);return e.component.legends=n,n}function parseUnitLegend(e){const{encoding:n}=e,i={};for(const r of[COLOR,...LEGEND_SCALE_CHANNELS]){const s=getFieldOrDatumDef(n[r]);!s||!e.getScaleComponent(r)||r===SHAPE&&isFieldDef(s)&&s.type===GEOJSON||(i[r]=parseLegendForChannel(e,r))}return i}function getLegendDefWithScale(e,n){const i=e.scaleName(n);if(e.mark==="trail"){if(n==="color")return{stroke:i};if(n==="size")return{strokeWidth:i}}return n==="color"?e.markDef.filled?{fill:i}:{stroke:i}:{[n]:i}}function isExplicit$1(e,n,i,r){switch(n){case"disable":return i!==void 0;case"values":return!!(i!=null&&i.values);case"title":if(n==="title"&&e===(r==null?void 0:r.title))return!0}return e===(i||{})[n]}function parseLegendForChannel(e,n){var i,r,s;let o=e.legend(n);const{markDef:l,encoding:f,config:d}=e,p=d.legend,g=new LegendComponent({},getLegendDefWithScale(e,n));parseInteractiveLegend(e,n,g);const v=o!==void 0?!o:p.disable;if(g.set("disable",v,o!==void 0),v)return g;o=o||{};const S=e.getScaleComponent(n).get("type"),T=getFieldOrDatumDef(f[n]),k=isFieldDef(T)?(i=normalizeTimeUnit(T.timeUnit))===null||i===void 0?void 0:i.unit:void 0,O=o.orient||d.legend.orient||"right",R=getLegendType({legend:o,channel:n,timeUnit:k,scaleType:S}),P=getDirection({legend:o,legendType:R,orient:O,legendConfig:p}),F={legend:o,channel:n,model:e,markDef:l,encoding:f,fieldOrDatumDef:T,legendConfig:p,config:d,scaleType:S,orient:O,legendType:R,direction:P};for(const z of LEGEND_COMPONENT_PROPERTIES){if(R==="gradient"&&z.startsWith("symbol")||R==="symbol"&&z.startsWith("gradient"))continue;const q=z in legendRules?legendRules[z](F):o[z];if(q!==void 0){const H=isExplicit$1(q,z,o,e.fieldDef(n));(H||d.legend[z]===void 0)&&g.set(z,q,H)}}const I=(r=o==null?void 0:o.encoding)!==null&&r!==void 0?r:{},L=g.get("selections"),N={},j={fieldOrDatumDef:T,model:e,channel:n,legendCmpt:g,legendType:R};for(const z of["labels","legend","title","symbols","gradient","entries"]){const q=guideEncodeEntry((s=I[z])!==null&&s!==void 0?s:{},e),H=z in legendEncodeRules?legendEncodeRules[z](q,j):q;H!==void 0&&!isEmpty(H)&&(N[z]=Object.assign(Object.assign(Object.assign({},L!=null&&L.length&&isFieldDef(T)?{name:`${varName(T.field)}_legend_${z}`}:{}),L!=null&&L.length?{interactive:!!L}:{}),{update:H}))}return isEmpty(N)||g.set("encode",N,!!(o!=null&&o.encoding)),g}function parseNonUnitLegend(e){const{legends:n,resolve:i}=e.component;for(const r of e.children){parseLegend(r);for(const s of keys$1(r.component.legends))i.legend[s]=parseGuideResolve(e.component.resolve,s),i.legend[s]==="shared"&&(n[s]=mergeLegendComponent(n[s],r.component.legends[s]),n[s]||(i.legend[s]="independent",delete n[s]))}for(const r of keys$1(n))for(const s of e.children)s.component.legends[r]&&i.legend[r]==="shared"&&delete s.component.legends[r];return n}function mergeLegendComponent(e,n){var i,r,s,o;if(!e)return n.clone();const l=e.getWithExplicit("orient"),f=n.getWithExplicit("orient");if(l.explicit&&f.explicit&&l.value!==f.value)return;let d=!1;for(const p of LEGEND_COMPONENT_PROPERTIES){const g=mergeValuesWithExplicit(e.getWithExplicit(p),n.getWithExplicit(p),p,"legend",(v,S)=>{switch(p){case"symbolType":return mergeSymbolType(v,S);case"title":return mergeTitleComponent(v,S);case"type":return d=!0,makeImplicit("symbol")}return defaultTieBreaker(v,S,p,"legend")});e.setWithExplicit(p,g)}return d&&(!((r=(i=e.implicit)===null||i===void 0?void 0:i.encode)===null||r===void 0)&&r.gradient&&deleteNestedProperty(e.implicit,["encode","gradient"]),!((o=(s=e.explicit)===null||s===void 0?void 0:s.encode)===null||o===void 0)&&o.gradient&&deleteNestedProperty(e.explicit,["encode","gradient"])),e}function mergeSymbolType(e,n){return n.value==="circle"?n:e}var __rest$9=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function setLegendEncode(e,n,i,r){var s,o,l,f,d;(s=e.encode)!==null&&s!==void 0||(e.encode={}),(o=(f=e.encode)[n])!==null&&o!==void 0||(f[n]={}),(l=(d=e.encode[n]).update)!==null&&l!==void 0||(d.update={}),e.encode[n].update[i]=r}function assembleLegends(e){const n=e.component.legends,i={};for(const s of keys$1(n)){const o=e.getScaleComponent(s),l=stringify(o.get("domains"));if(i[l])for(const f of i[l])mergeLegendComponent(f,n[s])||i[l].push(n[s]);else i[l]=[n[s].clone()]}return vals(i).flat().map(s=>assembleLegend(s,e.config)).filter(s=>s!==void 0)}function assembleLegend(e,n){var i,r,s;const o=e.combine(),{disable:l,labelExpr:f,selections:d}=o,p=__rest$9(o,["disable","labelExpr","selections"]);if(!l){if(n.aria===!1&&p.aria==null&&(p.aria=!1),!((i=p.encode)===null||i===void 0)&&i.symbols){const g=p.encode.symbols.update;g.fill&&g.fill.value!=="transparent"&&!g.stroke&&!p.stroke&&(g.stroke={value:"transparent"});for(const v of LEGEND_SCALE_CHANNELS)p[v]&&delete g[v]}if(p.title||delete p.title,f!==void 0){let g=f;!((s=(r=p.encode)===null||r===void 0?void 0:r.labels)===null||s===void 0)&&s.update&&isSignalRef(p.encode.labels.update.text)&&(g=replaceAll(f,"datum.label",p.encode.labels.update.text.signal)),setLegendEncode(p,"labels","text",{signal:g})}return p}}function assembleProjections(e){return isLayerModel(e)||isConcatModel(e)?assembleProjectionsForModelAndChildren(e):assembleProjectionForModel(e)}function assembleProjectionsForModelAndChildren(e){return e.children.reduce((n,i)=>n.concat(i.assembleProjections()),assembleProjectionForModel(e))}function assembleProjectionForModel(e){const n=e.component.projection;if(!n||n.merged)return[];const i=n.combine(),{name:r}=i;if(n.data){const s={signal:`[${n.size.map(l=>l.signal).join(", ")}]`},o=n.data.reduce((l,f)=>{const d=isSignalRef(f)?f.signal:`data('${e.lookupDataSource(f)}')`;return contains(l,d)||l.push(d),l},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:s,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},i)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),i)]}const PROJECTION_PROPERTIES=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class ProjectionComponent extends Split{constructor(n,i,r,s){super(Object.assign({},i),{name:n}),this.specifiedProjection=i,this.size=r,this.data=s,this.merged=!1}get isFit(){return!!this.data}}function parseProjection(e){e.component.projection=isUnitModel(e)?parseUnitProjection(e):parseNonUnitProjections(e)}function parseUnitProjection(e){var n;if(e.hasProjection){const i=replaceExprRef(e.specifiedProjection),r=!(i&&(i.scale!=null||i.translate!=null)),s=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=r?gatherFitData(e):void 0,l=new ProjectionComponent(e.projectionName(!0),Object.assign(Object.assign({},(n=replaceExprRef(e.config.projection))!==null&&n!==void 0?n:{}),i??{}),s,o);return l.get("type")||l.set("type","equalEarth",!1),l}}function gatherFitData(e){const n=[],{encoding:i}=e;for(const r of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]])(getFieldOrDatumDef(i[r[0]])||getFieldOrDatumDef(i[r[1]]))&&n.push({signal:e.getName(`geojson_${n.length}`)});return e.channelHasField(SHAPE)&&e.typedFieldDef(SHAPE).type===GEOJSON&&n.push({signal:e.getName(`geojson_${n.length}`)}),n.length===0&&n.push(e.requestDataName(DataSourceType.Main)),n}function mergeIfNoConflict(e,n){const i=every(PROJECTION_PROPERTIES,s=>!!(!has$1(e.explicit,s)&&!has$1(n.explicit,s)||has$1(e.explicit,s)&&has$1(n.explicit,s)&&deepEqual(e.get(s),n.get(s))));if(deepEqual(e.size,n.size)){if(i)return e;if(deepEqual(e.explicit,{}))return n;if(deepEqual(n.explicit,{}))return e}return null}function parseNonUnitProjections(e){if(e.children.length===0)return;let n;for(const r of e.children)parseProjection(r);const i=every(e.children,r=>{const s=r.component.projection;if(s)if(n){const o=mergeIfNoConflict(n,s);return o&&(n=o),!!o}else return n=s,!0;else return!0});if(n&&i){const r=e.projectionName(!0),s=new ProjectionComponent(r,n.specifiedProjection,n.size,duplicate(n.data));for(const o of e.children){const l=o.component.projection;l&&(l.isFit&&s.data.push(...o.component.projection.data),o.renameProjection(l.get("name"),r),l.merged=!0)}return s}}var __rest$8=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function rangeFormula(e,n,i,r){var s,o;if(binRequiresRange(n,i)){const l=isUnitModel(e)?(o=(s=e.axis(i))!==null&&s!==void 0?s:e.legend(i))!==null&&o!==void 0?o:{}:{},f=vgField(n,{expr:"datum"}),d=vgField(n,{expr:"datum",binSuffix:"end"});return{formulaAs:vgField(n,{binSuffix:"range",forAs:!0}),formula:binFormatExpression(f,d,l.format,l.formatType,r)}}return{}}function binKey(e,n){return`${binToString(e)}_${n}`}function getSignalsFromModel(e,n){return{signal:e.getName(`${n}_bins`),extentSignal:e.getName(`${n}_extent`)}}function getBinSignalName(e,n,i){var r;const s=(r=normalizeBin(i,void 0))!==null&&r!==void 0?r:{},o=binKey(s,n);return e.getName(`${o}_bins`)}function isBinTransform(e){return"as"in e}function createBinComponent(e,n,i){let r,s;isBinTransform(e)?r=isString(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[vgField(e,{forAs:!0}),vgField(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},normalizeBin(n,void 0)),l=binKey(o,e.field),{signal:f,extentSignal:d}=getSignalsFromModel(i,l);if(isParameterExtent(o.extent)){const g=o.extent;s=parseSelectionExtent(i,g.param,g),delete o.extent}const p=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[r]},f?{signal:f}:{}),d?{extentSignal:d}:{}),s?{span:s}:{});return{key:l,binComponent:p}}class BinNode extends DataFlowNode{constructor(n,i){super(n),this.bins=i}clone(){return new BinNode(null,duplicate(this.bins))}static makeFromEncoding(n,i){const r=i.reduceFieldDef((s,o,l)=>{if(isTypedFieldDef(o)&&isBinning(o.bin)){const{key:f,binComponent:d}=createBinComponent(o,o.bin,i);s[f]=Object.assign(Object.assign(Object.assign({},d),s[f]),rangeFormula(i,o,l,i.config))}return s},{});return isEmpty(r)?null:new BinNode(n,r)}static makeFromTransform(n,i,r){const{key:s,binComponent:o}=createBinComponent(i,i.bin,r);return new BinNode(n,{[s]:o})}merge(n,i){for(const r of keys$1(n.bins))r in this.bins?(i(n.bins[r].signal,this.bins[r].signal),this.bins[r].as=unique([...this.bins[r].as,...n.bins[r].as],hash)):this.bins[r]=n.bins[r];for(const r of n.children)n.removeChild(r),r.parent=this;n.remove()}producedFields(){return new Set(vals(this.bins).map(n=>n.as).flat(2))}dependentFields(){return new Set(vals(this.bins).map(n=>n.field))}hash(){return`Bin ${hash(this.bins)}`}assemble(){return vals(this.bins).flatMap(n=>{const i=[],[r,...s]=n.as,o=n.bin,{extent:l}=o,f=__rest$8(o,["extent"]),d=Object.assign(Object.assign(Object.assign({type:"bin",field:replacePathInField(n.field),as:r,signal:n.signal},isParameterExtent(l)?{extent:null}:{extent:l}),n.span?{span:{signal:`span(${n.span})`}}:{}),f);!l&&n.extentSignal&&(i.push({type:"extent",field:replacePathInField(n.field),signal:n.extentSignal}),d.extent={signal:n.extentSignal}),i.push(d);for(const p of s)for(let g=0;g<2;g++)i.push({type:"formula",expr:vgField({field:r[g]},{expr:"datum"}),as:p[g]});return n.formula&&i.push({type:"formula",expr:n.formula,as:n.formulaAs}),i})}}function addDimension(e,n,i,r){var s;const o=isUnitModel(r)?r.encoding[getSecondaryRangeChannel(n)]:void 0;if(isTypedFieldDef(i)&&isUnitModel(r)&&hasBandEnd(i,o,r.markDef,r.config))e.add(vgField(i,{})),e.add(vgField(i,{suffix:"end"})),i.bin&&binRequiresRange(i,n)&&e.add(vgField(i,{binSuffix:"range"}));else if(isGeoPositionChannel(n)){const l=getPositionChannelFromLatLong(n);e.add(r.getName(l))}else e.add(vgField(i));return isScaleFieldDef(i)&&isFieldRange((s=i.scale)===null||s===void 0?void 0:s.range)&&e.add(i.scale.range.field),e}function mergeMeasures(e,n){var i;for(const r of keys$1(n)){const s=n[r];for(const o of keys$1(s))r in e?e[r][o]=new Set([...(i=e[r][o])!==null&&i!==void 0?i:[],...s[o]]):e[r]={[o]:s[o]}}}class AggregateNode extends DataFlowNode{constructor(n,i,r){super(n),this.dimensions=i,this.measures=r}clone(){return new AggregateNode(null,new Set(this.dimensions),duplicate(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(n,i){let r=!1;i.forEachFieldDef(l=>{l.aggregate&&(r=!0)});const s={},o=new Set;return!r||(i.forEachFieldDef((l,f)=>{var d,p,g,v;const{aggregate:S,field:T}=l;if(S)if(S==="count")(d=s["*"])!==null&&d!==void 0||(s["*"]={}),s["*"].count=new Set([vgField(l,{forAs:!0})]);else{if(isArgminDef(S)||isArgmaxDef(S)){const k=isArgminDef(S)?"argmin":"argmax",O=S[k];(p=s[O])!==null&&p!==void 0||(s[O]={}),s[O][k]=new Set([vgField({op:k,field:O},{forAs:!0})])}else(g=s[T])!==null&&g!==void 0||(s[T]={}),s[T][S]=new Set([vgField(l,{forAs:!0})]);isScaleChannel(f)&&i.scaleDomain(f)==="unaggregated"&&((v=s[T])!==null&&v!==void 0||(s[T]={}),s[T].min=new Set([vgField({field:T,aggregate:"min"},{forAs:!0})]),s[T].max=new Set([vgField({field:T,aggregate:"max"},{forAs:!0})]))}else addDimension(o,f,l,i)}),o.size+keys$1(s).length===0)?null:new AggregateNode(n,o,s)}static makeFromTransform(n,i){var r,s,o;const l=new Set,f={};for(const d of i.aggregate){const{op:p,field:g,as:v}=d;p&&(p==="count"?((r=f["*"])!==null&&r!==void 0||(f["*"]={}),f["*"].count=new Set([v||vgField(d,{forAs:!0})])):((s=f[g])!==null&&s!==void 0||(f[g]={}),f[g][p]=new Set([v||vgField(d,{forAs:!0})])))}for(const d of(o=i.groupby)!==null&&o!==void 0?o:[])l.add(d);return l.size+keys$1(f).length===0?null:new AggregateNode(n,l,f)}merge(n){return setEqual(this.dimensions,n.dimensions)?(mergeMeasures(this.measures,n.measures),!0):(debug$2("different dimensions, cannot merge"),!1)}addDimensions(n){n.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...keys$1(this.measures)])}producedFields(){const n=new Set;for(const i of keys$1(this.measures))for(const r of keys$1(this.measures[i])){const s=this.measures[i][r];s.size===0?n.add(`${r}_${i}`):s.forEach(n.add,n)}return n}hash(){return`Aggregate ${hash({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const n=[],i=[],r=[];for(const o of keys$1(this.measures))for(const l of keys$1(this.measures[o]))for(const f of this.measures[o][l])r.push(f),n.push(l),i.push(o==="*"?null:replacePathInField(o));return{type:"aggregate",groupby:[...this.dimensions].map(replacePathInField),ops:n,fields:i,as:r}}}class FacetNode extends DataFlowNode{constructor(n,i,r,s){super(n),this.model=i,this.name=r,this.data=s;for(const o of FACET_CHANNELS){const l=i.facet[o];if(l){const{bin:f,sort:d}=l;this[o]=Object.assign({name:i.getName(`${o}_domain`),fields:[vgField(l),...isBinning(f)?[vgField(l,{binSuffix:"end"})]:[]]},isSortField(d)?{sortField:d}:isArray(d)?{sortIndexField:sortArrayIndexField(l,o)}:{})}}this.childModel=i.child}hash(){let n="Facet";for(const i of FACET_CHANNELS)this[i]&&(n+=` ${i.charAt(0)}:${hash(this[i])}`);return n}get fields(){var n;const i=[];for(const r of FACET_CHANNELS)!((n=this[r])===null||n===void 0)&&n.fields&&i.push(...this[r].fields);return i}dependentFields(){const n=new Set(this.fields);for(const i of FACET_CHANNELS)this[i]&&(this[i].sortField&&n.add(this[i].sortField.field),this[i].sortIndexField&&n.add(this[i].sortIndexField));return n}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const n={};for(const i of POSITION_SCALE_CHANNELS){const r=this.childModel.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(hasDiscreteDomain(s)&&isVgRangeStep(o)){const l=assembleDomain(this.childModel,i),f=getFieldFromDomain(l);f?n[i]=f:warn(unknownField(i))}}}return n}assembleRowColumnHeaderData(n,i,r){const s={row:"y",column:"x",facet:void 0}[n],o=[],l=[],f=[];s&&r&&r[s]&&(i?(o.push(`distinct_${r[s]}`),l.push("max")):(o.push(r[s]),l.push("distinct")),f.push(`distinct_${r[s]}`));const{sortField:d,sortIndexField:p}=this[n];if(d){const{op:g=DEFAULT_SORT_OP,field:v}=d;o.push(v),l.push(g),f.push(vgField(d,{forAs:!0}))}else p&&(o.push(p),l.push("max"),f.push(p));return{name:this[n].name,source:i??this.data,transform:[Object.assign({type:"aggregate",groupby:this[n].fields},o.length?{fields:o,ops:l,as:f}:{})]}}assembleFacetHeaderData(n){var i,r;const{columns:s}=this.model.layout,{layoutHeaders:o}=this.model.component,l=[],f={};for(const g of HEADER_CHANNELS){for(const v of HEADER_TYPES){const S=(i=o[g]&&o[g][v])!==null&&i!==void 0?i:[];for(const T of S)if(((r=T.axes)===null||r===void 0?void 0:r.length)>0){f[g]=!0;break}}if(f[g]){const v=`length(data("${this.facet.name}"))`,S=g==="row"?s?{signal:`ceil(${v} / ${s})`}:1:s?{signal:`min(${v}, ${s})`}:{signal:v};l.push({name:`${this.facet.name}_${g}`,transform:[{type:"sequence",start:0,stop:S}]})}}const{row:d,column:p}=f;return(d||p)&&l.unshift(this.assembleRowColumnHeaderData("facet",null,n)),l}assemble(){var n,i;const r=[];let s=null;const o=this.getChildIndependentFieldsWithStep(),{column:l,row:f,facet:d}=this;if(l&&f&&(o.x||o.y)){s=`cross_${this.column.name}_${this.row.name}`;const p=[].concat((n=o.x)!==null&&n!==void 0?n:[],(i=o.y)!==null&&i!==void 0?i:[]),g=p.map(()=>"distinct");r.push({name:s,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:p,ops:g}]})}for(const p of[COLUMN,ROW])this[p]&&r.push(this.assembleRowColumnHeaderData(p,s,o));if(d){const p=this.assembleFacetHeaderData(o);p&&r.push(...p)}return r}}function unquote(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function parseExpression(e,n){const i=accessPathWithDatum(e);if(n==="number")return`toNumber(${i})`;if(n==="boolean")return`toBoolean(${i})`;if(n==="string")return`toString(${i})`;if(n==="date")return`toDate(${i})`;if(n==="flatten")return i;if(n.startsWith("date:")){const r=unquote(n.slice(5,n.length));return`timeParse(${i},'${r}')`}else if(n.startsWith("utc:")){const r=unquote(n.slice(4,n.length));return`utcParse(${i},'${r}')`}else return warn(unrecognizedParse(n)),null}function getImplicitFromFilterTransform(e){const n={};return forEachLeaf(e.filter,i=>{var r;if(isFieldPredicate(i)){let s=null;isFieldEqualPredicate(i)?s=signalRefOrValue(i.equal):isFieldLTEPredicate(i)?s=signalRefOrValue(i.lte):isFieldLTPredicate(i)?s=signalRefOrValue(i.lt):isFieldGTPredicate(i)?s=signalRefOrValue(i.gt):isFieldGTEPredicate(i)?s=signalRefOrValue(i.gte):isFieldRangePredicate(i)?s=i.range[0]:isFieldOneOfPredicate(i)&&(s=((r=i.oneOf)!==null&&r!==void 0?r:i.in)[0]),s&&(isDateTime(s)?n[i.field]="date":isNumber$1(s)?n[i.field]="number":isString(s)&&(n[i.field]="string")),i.timeUnit&&(n[i.field]="date")}}),n}function getImplicitFromEncoding(e){const n={};function i(r){isFieldOrDatumDefForTimeFormat(r)?n[r.field]="date":r.type==="quantitative"&&isMinMaxOp(r.aggregate)?n[r.field]="number":accessPathDepth(r.field)>1?r.field in n||(n[r.field]="flatten"):isScaleFieldDef(r)&&isSortField(r.sort)&&accessPathDepth(r.sort.field)>1&&(r.sort.field in n||(n[r.sort.field]="flatten"))}if((isUnitModel(e)||isFacetModel(e))&&e.forEachFieldDef((r,s)=>{if(isTypedFieldDef(r))i(r);else{const o=getMainRangeChannel(s),l=e.fieldDef(o);i(Object.assign(Object.assign({},r),{type:l.type}))}}),isUnitModel(e)){const{mark:r,markDef:s,encoding:o}=e;if(isPathMark(r)&&!e.encoding.order){const l=s.orient==="horizontal"?"y":"x",f=o[l];isFieldDef(f)&&f.type==="quantitative"&&!(f.field in n)&&(n[f.field]="number")}}return n}function getImplicitFromSelection(e){const n={};if(isUnitModel(e)&&e.component.selection)for(const i of keys$1(e.component.selection)){const r=e.component.selection[i];for(const s of r.project.items)!s.channel&&accessPathDepth(s.field)>1&&(n[s.field]="flatten")}return n}class ParseNode extends DataFlowNode{constructor(n,i){super(n),this._parse=i}clone(){return new ParseNode(null,duplicate(this._parse))}hash(){return`Parse ${hash(this._parse)}`}static makeExplicit(n,i,r){var s;let o={};const l=i.data;return!isGenerator(l)&&(!((s=l==null?void 0:l.format)===null||s===void 0)&&s.parse)&&(o=l.format.parse),this.makeWithAncestors(n,o,{},r)}static makeWithAncestors(n,i,r,s){for(const f of keys$1(r)){const d=s.getWithExplicit(f);d.value!==void 0&&(d.explicit||d.value===r[f]||d.value==="derived"||r[f]==="flatten"?delete r[f]:warn(differentParse(f,r[f],d.value)))}for(const f of keys$1(i)){const d=s.get(f);d!==void 0&&(d===i[f]?delete i[f]:warn(differentParse(f,i[f],d)))}const o=new Split(i,r);s.copyAll(o);const l={};for(const f of keys$1(o.combine())){const d=o.get(f);d!==null&&(l[f]=d)}return keys$1(l).length===0||s.parseNothing?null:new ParseNode(n,l)}get parse(){return this._parse}merge(n){this._parse=Object.assign(Object.assign({},this._parse),n.parse),n.remove()}assembleFormatParse(){const n={};for(const i of keys$1(this._parse)){const r=this._parse[i];accessPathDepth(i)===1&&(n[i]=r)}return n}producedFields(){return new Set(keys$1(this._parse))}dependentFields(){return new Set(keys$1(this._parse))}assembleTransforms(n=!1){return keys$1(this._parse).filter(i=>n?accessPathDepth(i)>1:!0).map(i=>{const r=parseExpression(i,this._parse[i]);return r?{type:"formula",expr:r,as:removePathFromField(i)}:null}).filter(i=>i!==null)}}class IdentifierNode extends DataFlowNode{clone(){return new IdentifierNode(null)}constructor(n){super(n)}dependentFields(){return new Set}producedFields(){return new Set([SELECTION_ID])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:SELECTION_ID}}}class GraticuleNode extends DataFlowNode{constructor(n,i){super(n),this.params=i}clone(){return new GraticuleNode(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${hash(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class SequenceNode extends DataFlowNode{constructor(n,i){super(n),this.params=i}clone(){return new SequenceNode(null,this.params)}dependentFields(){return new Set}producedFields(){var n;return new Set([(n=this.params.as)!==null&&n!==void 0?n:"data"])}hash(){return`Hash ${hash(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class SourceNode extends DataFlowNode{constructor(n){super(null),n??(n={name:"source"});let i;if(isGenerator(n)||(i=n.format?Object.assign({},omit(n.format,["parse"])):{}),isInlineData(n))this._data={values:n.values};else if(isUrlData(n)){if(this._data={url:n.url},!i.type){let r=/(?:\.([^.]+))?$/.exec(n.url)[1];contains(["json","csv","tsv","dsv","topojson"],r)||(r="json"),i.type=r}}else isSphereGenerator(n)?this._data={values:[{type:"Sphere"}]}:(isNamedData(n)||isGenerator(n))&&(this._data={});this._generator=isGenerator(n),n.name&&(this._name=n.name),i&&!isEmpty(i)&&(this._data.format=i)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(n){this._name=n}set parent(n){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var __classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(e,n,i,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?e!==n||!s:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(e,i):s?s.value=i:n.set(e,i),i},__classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(e,n,i,r){if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?e!==n||!r:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?r:i==="a"?r.call(e):r?r.value:n.get(e)},_Optimizer_modified;function isDataSourceNode(e){return e instanceof SourceNode||e instanceof GraticuleNode||e instanceof SequenceNode}class Optimizer{constructor(){_Optimizer_modified.set(this,void 0),__classPrivateFieldSet(this,_Optimizer_modified,!1,"f")}setModified(){__classPrivateFieldSet(this,_Optimizer_modified,!0,"f")}get modifiedFlag(){return __classPrivateFieldGet(this,_Optimizer_modified,"f")}}_Optimizer_modified=new WeakMap;class BottomUpOptimizer extends Optimizer{getNodeDepths(n,i,r){r.set(n,i);for(const s of n.children)this.getNodeDepths(s,i+1,r);return r}optimize(n){const r=[...this.getNodeDepths(n,0,new Map).entries()].sort((s,o)=>o[1]-s[1]);for(const s of r)this.run(s[0]);return this.modifiedFlag}}class TopDownOptimizer extends Optimizer{optimize(n){this.run(n);for(const i of n.children)this.optimize(i);return this.modifiedFlag}}class MergeIdenticalNodes extends TopDownOptimizer{mergeNodes(n,i){const r=i.shift();for(const s of i)n.removeChild(s),s.parent=r,s.remove()}run(n){const i=n.children.map(s=>s.hash()),r={};for(let s=0;s<i.length;s++)r[i[s]]===void 0?r[i[s]]=[n.children[s]]:r[i[s]].push(n.children[s]);for(const s of keys$1(r))r[s].length>1&&(this.setModified(),this.mergeNodes(n,r[s]))}}class RemoveUnnecessaryIdentifierNodes extends TopDownOptimizer{constructor(n){super(),this.requiresSelectionId=n&&requiresSelectionId(n)}run(n){n instanceof IdentifierNode&&(this.requiresSelectionId&&(isDataSourceNode(n.parent)||n.parent instanceof AggregateNode||n.parent instanceof ParseNode)||(this.setModified(),n.remove()))}}class RemoveDuplicateTimeUnits extends Optimizer{optimize(n){return this.run(n,new Set),this.modifiedFlag}run(n,i){let r=new Set;n instanceof TimeUnitNode&&(r=n.producedFields(),hasIntersection(r,i)&&(this.setModified(),n.removeFormulas(i),n.producedFields.length===0&&n.remove()));for(const s of n.children)this.run(s,new Set([...i,...r]))}}class RemoveUnnecessaryOutputNodes extends TopDownOptimizer{constructor(){super()}run(n){n instanceof OutputNode&&!n.isRequired()&&(this.setModified(),n.remove())}}class MoveParseUp extends BottomUpOptimizer{run(n){if(!isDataSourceNode(n)&&!(n.numChildren()>1)){for(const i of n.children)if(i instanceof ParseNode)if(n instanceof ParseNode)this.setModified(),n.merge(i);else{if(fieldIntersection(n.producedFields(),i.dependentFields()))continue;this.setModified(),i.swapWithParent()}}}}class MergeParse extends BottomUpOptimizer{run(n){const i=[...n.children],r=n.children.filter(s=>s instanceof ParseNode);if(n.numChildren()>1&&r.length>=1){const s={},o=new Set;for(const l of r){const f=l.parse;for(const d of keys$1(f))d in s?s[d]!==f[d]&&o.add(d):s[d]=f[d]}for(const l of o)delete s[l];if(!isEmpty(s)){this.setModified();const l=new ParseNode(n,s);for(const f of i){if(f instanceof ParseNode)for(const d of keys$1(s))delete f.parse[d];n.removeChild(f),f.parent=l,f instanceof ParseNode&&keys$1(f.parse).length===0&&f.remove()}}}}}class RemoveUnusedSubtrees extends BottomUpOptimizer{run(n){n instanceof OutputNode||n.numChildren()>0||n instanceof FacetNode||n instanceof SourceNode||(this.setModified(),n.remove())}}class MergeTimeUnits extends BottomUpOptimizer{run(n){const i=n.children.filter(s=>s instanceof TimeUnitNode),r=i.pop();for(const s of i)this.setModified(),r.merge(s)}}class MergeAggregates extends BottomUpOptimizer{run(n){const i=n.children.filter(s=>s instanceof AggregateNode),r={};for(const s of i){const o=hash(s.groupBy);o in r||(r[o]=[]),r[o].push(s)}for(const s of keys$1(r)){const o=r[s];if(o.length>1){const l=o.pop();for(const f of o)l.merge(f)&&(n.removeChild(f),f.parent=l,f.remove(),this.setModified())}}}}class MergeBins extends BottomUpOptimizer{constructor(n){super(),this.model=n}run(n){const i=!(isDataSourceNode(n)||n instanceof FilterNode||n instanceof ParseNode||n instanceof IdentifierNode),r=[],s=[];for(const o of n.children)o instanceof BinNode&&(i&&!fieldIntersection(n.producedFields(),o.dependentFields())?r.push(o):s.push(o));if(r.length>0){const o=r.pop();for(const l of r)o.merge(l,this.model.renameSignal.bind(this.model));this.setModified(),n instanceof BinNode?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(s.length>1){const o=s.pop();for(const l of s)o.merge(l,this.model.renameSignal.bind(this.model));this.setModified()}}}class MergeOutputs extends BottomUpOptimizer{run(n){const i=[...n.children];if(!some(i,l=>l instanceof OutputNode)||n.numChildren()<=1)return;const s=[];let o;for(const l of i)if(l instanceof OutputNode){let f=l;for(;f.numChildren()===1;){const[d]=f.children;if(d instanceof OutputNode)f=d;else break}s.push(...f.children),o?(n.removeChild(l),l.parent=o.parent,o.parent.removeChild(o),o.parent=f,this.setModified()):o=f}else s.push(l);if(s.length){this.setModified();for(const l of s)l.parent.removeChild(l),l.parent=o}}}class JoinAggregateTransformNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i}clone(){return new JoinAggregateTransformNode(null,duplicate(this.transform))}addDimensions(n){this.transform.groupby=unique(this.transform.groupby.concat(n),i=>i)}dependentFields(){const n=new Set;return this.transform.groupby&&this.transform.groupby.forEach(n.add,n),this.transform.joinaggregate.map(i=>i.field).filter(i=>i!==void 0).forEach(n.add,n),n}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(n){var i;return(i=n.as)!==null&&i!==void 0?i:vgField(n)}hash(){return`JoinAggregateTransform ${hash(this.transform)}`}assemble(){const n=[],i=[],r=[];for(const o of this.transform.joinaggregate)i.push(o.op),r.push(this.getDefaultName(o)),n.push(o.field===void 0?null:o.field);const s=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},s!==void 0?{groupby:s}:{})}}function getStackByFields(e){return e.stack.stackBy.reduce((n,i)=>{const r=i.fieldDef,s=vgField(r);return s&&n.push(s),n},[])}function isValidAsArray(e){return isArray(e)&&e.every(n=>isString(n))&&e.length>1}class StackNode extends DataFlowNode{constructor(n,i){super(n),this._stack=i}clone(){return new StackNode(null,duplicate(this._stack))}static makeFromTransform(n,i){const{stack:r,groupby:s,as:o,offset:l="zero"}=i,f=[],d=[];if(i.sort!==void 0)for(const v of i.sort)f.push(v.field),d.push(getFirstDefined(v.order,"ascending"));const p={field:f,order:d};let g;return isValidAsArray(o)?g=o:isString(o)?g=[o,`${o}_end`]:g=[`${i.stack}_start`,`${i.stack}_end`],new StackNode(n,{dimensionFieldDefs:[],stackField:r,groupby:s,offset:l,sort:p,facetby:[],as:g})}static makeFromEncoding(n,i){const r=i.stack,{encoding:s}=i;if(!r)return null;const{groupbyChannels:o,fieldChannel:l,offset:f,impute:d}=r,p=o.map(T=>{const k=s[T];return getFieldDef(k)}).filter(T=>!!T),g=getStackByFields(i),v=i.encoding.order;let S;return isArray(v)||isFieldDef(v)?S=sortParams(v):S=g.reduce((T,k)=>(T.field.push(k),T.order.push(l==="y"?"descending":"ascending"),T),{field:[],order:[]}),new StackNode(n,{dimensionFieldDefs:p,stackField:i.vgField(l),facetby:[],stackby:g,sort:S,offset:f,impute:d,as:[i.vgField(l,{suffix:"start",forAs:!0}),i.vgField(l,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(n){this._stack.facetby.push(...n)}dependentFields(){const n=new Set;return n.add(this._stack.stackField),this.getGroupbyFields().forEach(n.add,n),this._stack.facetby.forEach(n.add,n),this._stack.sort.field.forEach(n.add,n),n}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${hash(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:n,impute:i,groupby:r}=this._stack;return n.length>0?n.map(s=>s.bin?i?[vgField(s,{binSuffix:"mid"})]:[vgField(s,{}),vgField(s,{binSuffix:"end"})]:[vgField(s)]).flat():r??[]}assemble(){const n=[],{facetby:i,dimensionFieldDefs:r,stackField:s,stackby:o,sort:l,offset:f,impute:d,as:p}=this._stack;if(d)for(const g of r){const{bandPosition:v=.5,bin:S}=g;if(S){const T=vgField(g,{expr:"datum"}),k=vgField(g,{expr:"datum",binSuffix:"end"});n.push({type:"formula",expr:`${v}*${T}+${1-v}*${k}`,as:vgField(g,{binSuffix:"mid",forAs:!0})})}n.push({type:"impute",field:s,groupby:[...o,...i],key:vgField(g,{binSuffix:"mid"}),method:"value",value:0})}return n.push({type:"stack",groupby:[...this.getGroupbyFields(),...i],field:s,sort:l,as:p,offset:f}),n}}class WindowTransformNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i}clone(){return new WindowTransformNode(null,duplicate(this.transform))}addDimensions(n){this.transform.groupby=unique(this.transform.groupby.concat(n),i=>i)}dependentFields(){var n,i;const r=new Set;return((n=this.transform.groupby)!==null&&n!==void 0?n:[]).forEach(r.add,r),((i=this.transform.sort)!==null&&i!==void 0?i:[]).forEach(s=>r.add(s.field)),this.transform.window.map(s=>s.field).filter(s=>s!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(n){var i;return(i=n.as)!==null&&i!==void 0?i:vgField(n)}hash(){return`WindowTransform ${hash(this.transform)}`}assemble(){var n;const i=[],r=[],s=[],o=[];for(const S of this.transform.window)r.push(S.op),s.push(this.getDefaultName(S)),o.push(S.param===void 0?null:S.param),i.push(S.field===void 0?null:S.field);const l=this.transform.frame,f=this.transform.groupby;if(l&&l[0]===null&&l[1]===null&&r.every(S=>isAggregateOp(S)))return Object.assign({type:"joinaggregate",as:s,ops:r,fields:i},f!==void 0?{groupby:f}:{});const d=[],p=[];if(this.transform.sort!==void 0)for(const S of this.transform.sort)d.push(S.field),p.push((n=S.order)!==null&&n!==void 0?n:"ascending");const g={field:d,order:p},v=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:s,ops:r,fields:i,sort:g},v!==void 0?{ignorePeers:v}:{}),f!==void 0?{groupby:f}:{}),l!==void 0?{frame:l}:{})}}function cloneSubtree(e){function n(i){if(!(i instanceof FacetNode)){const r=i.clone();if(r instanceof OutputNode){const s=FACET_SCALE_PREFIX+r.getSource();r.setSource(s),e.model.component.data.outputNodes[s]=r}else(r instanceof AggregateNode||r instanceof StackNode||r instanceof WindowTransformNode||r instanceof JoinAggregateTransformNode)&&r.addDimensions(e.fields);for(const s of i.children.flatMap(n))s.parent=r;return[r]}return i.children.flatMap(n)}return n}function moveFacetDown(e){if(e instanceof FacetNode)if(e.numChildren()===1&&!(e.children[0]instanceof OutputNode)){const n=e.children[0];(n instanceof AggregateNode||n instanceof StackNode||n instanceof WindowTransformNode||n instanceof JoinAggregateTransformNode)&&n.addDimensions(e.fields),n.swapWithParent(),moveFacetDown(e)}else{const n=e.model.component.data.main;moveMainDownToFacet(n);const i=cloneSubtree(e),r=e.children.map(i).flat();for(const s of r)s.parent=n}else e.children.map(moveFacetDown)}function moveMainDownToFacet(e){if(e instanceof OutputNode&&e.type===DataSourceType.Main&&e.numChildren()===1){const n=e.children[0];n instanceof FacetNode||(n.swapWithParent(),moveMainDownToFacet(e))}}const FACET_SCALE_PREFIX="scale_",MAX_OPTIMIZATION_RUNS=5;function checkLinks(e){for(const n of e){for(const i of n.children)if(i.parent!==n)return!1;if(!checkLinks(n.children))return!1}return!0}function runOptimizer(e,n){let i=!1;for(const r of n)i=e.optimize(r)||i;return i}function optimizationDataflowHelper(e,n,i){let r=e.sources,s=!1;return s=runOptimizer(new RemoveUnnecessaryOutputNodes,r)||s,s=runOptimizer(new RemoveUnnecessaryIdentifierNodes(n),r)||s,r=r.filter(o=>o.numChildren()>0),s=runOptimizer(new RemoveUnusedSubtrees,r)||s,r=r.filter(o=>o.numChildren()>0),i||(s=runOptimizer(new MoveParseUp,r)||s,s=runOptimizer(new MergeBins(n),r)||s,s=runOptimizer(new RemoveDuplicateTimeUnits,r)||s,s=runOptimizer(new MergeParse,r)||s,s=runOptimizer(new MergeAggregates,r)||s,s=runOptimizer(new MergeTimeUnits,r)||s,s=runOptimizer(new MergeIdenticalNodes,r)||s,s=runOptimizer(new MergeOutputs,r)||s),e.sources=r,s}function optimizeDataflow(e,n){checkLinks(e.sources);let i=0,r=0;for(let s=0;s<MAX_OPTIMIZATION_RUNS&&optimizationDataflowHelper(e,n,!0);s++)i++;e.sources.map(moveFacetDown);for(let s=0;s<MAX_OPTIMIZATION_RUNS&&optimizationDataflowHelper(e,n,!1);s++)r++;checkLinks(e.sources),Math.max(i,r)===MAX_OPTIMIZATION_RUNS&&warn(`Maximum optimization runs(${MAX_OPTIMIZATION_RUNS}) reached.`)}class SignalRefWrapper{constructor(n){Object.defineProperty(this,"signal",{enumerable:!0,get:n})}static fromName(n,i){return new SignalRefWrapper(()=>n(i))}}var __rest$7=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function parseScaleDomain(e){isUnitModel(e)?parseUnitScaleDomain(e):parseNonUnitScaleDomain(e)}function parseUnitScaleDomain(e){const n=e.component.scales;for(const i of keys$1(n)){const r=parseDomainForChannel(e,i);if(n[i].setWithExplicit("domains",r),parseSelectionDomain(e,i),e.component.data.isFaceted){let o=e;for(;!isFacetModel(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[i]==="shared")for(const f of r.value)isDataRefDomain(f)&&(f.data=FACET_SCALE_PREFIX+f.data.replace(FACET_SCALE_PREFIX,""))}}}function parseNonUnitScaleDomain(e){for(const i of e.children)parseScaleDomain(i);const n=e.component.scales;for(const i of keys$1(n)){let r,s=null;for(const o of e.children){const l=o.component.scales[i];if(l){r===void 0?r=l.getWithExplicit("domains"):r=mergeValuesWithExplicit(r,l.getWithExplicit("domains"),"domains","scale",domainsTieBreaker);const f=l.get("selectionExtent");s&&f&&s.param!==f.param&&warn(NEEDS_SAME_SELECTION),s=f}}n[i].setWithExplicit("domains",r),s&&n[i].set("selectionExtent",s,!0)}}function normalizeUnaggregatedDomain(e,n,i,r){if(e==="unaggregated"){const{valid:s,reason:o}=canUseUnaggregatedDomain(n,i);if(!s){warn(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:s}=canUseUnaggregatedDomain(n,i);if(s)return"unaggregated"}return e}function parseDomainForChannel(e,n){const i=e.getScaleComponent(n).get("type"),{encoding:r}=e,s=normalizeUnaggregatedDomain(e.scaleDomain(n),e.typedFieldDef(n),i,e.config.scale);return s!==e.scaleDomain(n)&&(e.specifiedScales[n]=Object.assign(Object.assign({},e.specifiedScales[n]),{domain:s})),n==="x"&&getFieldOrDatumDef(r.x2)?getFieldOrDatumDef(r.x)?mergeValuesWithExplicit(parseSingleChannelDomain(i,s,e,"x"),parseSingleChannelDomain(i,s,e,"x2"),"domain","scale",domainsTieBreaker):parseSingleChannelDomain(i,s,e,"x2"):n==="y"&&getFieldOrDatumDef(r.y2)?getFieldOrDatumDef(r.y)?mergeValuesWithExplicit(parseSingleChannelDomain(i,s,e,"y"),parseSingleChannelDomain(i,s,e,"y2"),"domain","scale",domainsTieBreaker):parseSingleChannelDomain(i,s,e,"y2"):parseSingleChannelDomain(i,s,e,n)}function mapDomainToDataSignal(e,n,i){return e.map(r=>({signal:`{data: ${valueExpr(r,{timeUnit:i,type:n})}}`}))}function convertDomainIfItIsDateTime(e,n,i){var r;const s=(r=normalizeTimeUnit(i))===null||r===void 0?void 0:r.unit;return n==="temporal"||s?mapDomainToDataSignal(e,n,s):[e]}function parseSingleChannelDomain(e,n,i,r){const{encoding:s}=i,o=getFieldOrDatumDef(s[r]),{type:l}=o,f=o.timeUnit;if(isDomainUnionWith(n)){const v=parseSingleChannelDomain(e,void 0,i,r),S=convertDomainIfItIsDateTime(n.unionWith,l,f);return makeExplicit([...S,...v.value])}else{if(isSignalRef(n))return makeExplicit([n]);if(n&&n!=="unaggregated"&&!isParameterDomain(n))return makeExplicit(convertDomainIfItIsDateTime(n,l,f))}const d=i.stack;if(d&&r===d.fieldChannel){if(d.offset==="normalize")return makeImplicit([[0,1]]);const v=i.requestDataName(DataSourceType.Main);return makeImplicit([{data:v,field:i.vgField(r,{suffix:"start"})},{data:v,field:i.vgField(r,{suffix:"end"})}])}const p=isScaleChannel(r)&&isFieldDef(o)?domainSort(i,r,e):void 0;if(isDatumDef(o)){const v=convertDomainIfItIsDateTime([o.datum],l,f);return makeImplicit(v)}const g=o;if(n==="unaggregated"){const v=i.requestDataName(DataSourceType.Main),{field:S}=o;return makeImplicit([{data:v,field:vgField({field:S,aggregate:"min"})},{data:v,field:vgField({field:S,aggregate:"max"})}])}else if(isBinning(g.bin)){if(hasDiscreteDomain(e))return makeImplicit(e==="bin-ordinal"?[]:[{data:isBoolean(p)?i.requestDataName(DataSourceType.Main):i.requestDataName(DataSourceType.Raw),field:i.vgField(r,binRequiresRange(g,r)?{binSuffix:"range"}:{}),sort:p===!0||!isObject(p)?{field:i.vgField(r,{}),op:"min"}:p}]);{const{bin:v}=g;if(isBinning(v)){const S=getBinSignalName(i,g.field,v);return makeImplicit([new SignalRefWrapper(()=>{const T=i.getSignalName(S);return`[${T}.start, ${T}.stop]`})])}else return makeImplicit([{data:i.requestDataName(DataSourceType.Main),field:i.vgField(r,{})}])}}else if(g.timeUnit&&contains(["time","utc"],e)&&hasBandEnd(g,isUnitModel(i)?i.encoding[getSecondaryRangeChannel(r)]:void 0,i.markDef,i.config)){const v=i.requestDataName(DataSourceType.Main);return makeImplicit([{data:v,field:i.vgField(r)},{data:v,field:i.vgField(r,{suffix:"end"})}])}else return makeImplicit(p?[{data:isBoolean(p)?i.requestDataName(DataSourceType.Main):i.requestDataName(DataSourceType.Raw),field:i.vgField(r),sort:p}]:[{data:i.requestDataName(DataSourceType.Main),field:i.vgField(r)}])}function normalizeSortField(e,n){const{op:i,field:r,order:s}=e;return Object.assign(Object.assign({op:i??(n?"sum":DEFAULT_SORT_OP)},r?{field:replacePathInField(r)}:{}),s?{order:s}:{})}function parseSelectionDomain(e,n){var i;const r=e.component.scales[n],s=e.specifiedScales[n].domain,o=(i=e.fieldDef(n))===null||i===void 0?void 0:i.bin,l=isParameterDomain(s)&&s,f=isBinParams(o)&&isParameterExtent(o.extent)&&o.extent;(l||f)&&r.set("selectionExtent",l??f,!0)}function domainSort(e,n,i){if(!hasDiscreteDomain(i))return;const r=e.fieldDef(n),s=r.sort;if(isSortArray(s))return{op:"min",field:sortArrayIndexField(r,n),order:"ascending"};const{stack:o}=e,l=o?new Set([...o.groupbyFields,...o.stackBy.map(f=>f.fieldDef.field)]):void 0;if(isSortField(s)){const f=o&&!l.has(s.field);return normalizeSortField(s,f)}else if(isSortByEncoding(s)){const{encoding:f,order:d}=s,p=e.fieldDef(f),{aggregate:g,field:v}=p,S=o&&!l.has(v);if(isArgminDef(g)||isArgmaxDef(g))return normalizeSortField({field:vgField(p),order:d},S);if(isAggregateOp(g)||!g)return normalizeSortField({op:g,field:v,order:d},S)}else{if(s==="descending")return{op:"min",field:e.vgField(n),order:"descending"};if(contains(["ascending",void 0],s))return!0}}function canUseUnaggregatedDomain(e,n){const{aggregate:i,type:r}=e;return i?isString(i)&&!SHARED_DOMAIN_OPS.has(i)?{valid:!1,reason:unaggregateDomainWithNonSharedDomainOp(i)}:r==="quantitative"&&n==="log"?{valid:!1,reason:unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:unaggregateDomainHasNoEffectForRawField(e)}}function domainsTieBreaker(e,n,i,r){return e.explicit&&n.explicit&&warn(mergeConflictingDomainProperty(i,r,e.value,n.value)),{explicit:e.explicit,value:[...e.value,...n.value]}}function mergeDomains(e){const n=unique(e.map(l=>isDataRefDomain(l)?__rest$7(l,["sort"]):l),hash),i=unique(e.map(l=>{if(isDataRefDomain(l)){const f=l.sort;return f!==void 0&&!isBoolean(f)&&("op"in f&&f.op==="count"&&delete f.field,f.order==="ascending"&&delete f.order),f}}).filter(l=>l!==void 0),hash);if(n.length===0)return;if(n.length===1){const l=e[0];if(isDataRefDomain(l)&&i.length>0){let f=i[0];if(i.length>1)warn(MORE_THAN_ONE_SORT),f=!0;else if(isObject(f)&&"field"in f){const d=f.field;l.field===d&&(f=f.order?{order:f.order}:!0)}return Object.assign(Object.assign({},l),{sort:f})}return l}const r=unique(i.map(l=>isBoolean(l)||!("op"in l)||isString(l.op)&&l.op in MULTIDOMAIN_SORT_OP_INDEX?l:(warn(domainSortDropped(l)),!0)),hash);let s;r.length===1?s=r[0]:r.length>1&&(warn(MORE_THAN_ONE_SORT),s=!0);const o=unique(e.map(l=>isDataRefDomain(l)?l.data:null),l=>l);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:n.map(f=>f.field)},s?{sort:s}:{}):Object.assign({fields:n},s?{sort:s}:{})}function getFieldFromDomain(e){if(isDataRefDomain(e)&&isString(e.field))return e.field;if(isDataRefUnionedDomain(e)){let n;for(const i of e.fields)if(isDataRefDomain(i)&&isString(i.field)){if(!n)n=i.field;else if(n!==i.field)return warn(FACETED_INDEPENDENT_DIFFERENT_SOURCES),n}return warn(FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),n}else if(isFieldRefUnionDomain(e)){warn(FACETED_INDEPENDENT_SAME_SOURCE);const n=e.fields[0];return isString(n)?n:void 0}}function assembleDomain(e,n){const r=e.component.scales[n].get("domains").map(s=>(isDataRefDomain(s)&&(s.data=e.lookupDataSource(s.data)),s));return mergeDomains(r)}var __rest$6=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function assembleScales(e){return isLayerModel(e)||isConcatModel(e)?e.children.reduce((n,i)=>n.concat(assembleScales(i)),assembleScalesForModel(e)):assembleScalesForModel(e)}function assembleScalesForModel(e){return keys$1(e.component.scales).reduce((n,i)=>{const r=e.component.scales[i];if(r.merged)return n;const s=r.combine(),{name:o,type:l,selectionExtent:f,domains:d,range:p,reverse:g}=s,v=__rest$6(s,["name","type","selectionExtent","domains","range","reverse"]),S=assembleScaleRange(s.range,o,i,e),T=assembleDomain(e,i),k=f?assembleSelectionScaleDomain(e,f,r,T):null;return n.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:l},T?{domain:T}:{}),k?{domainRaw:k}:{}),{range:S}),g!==void 0?{reverse:g}:{}),v)),n},[])}function assembleScaleRange(e,n,i,r){if(isXorY(i)){if(isVgRangeStep(e))return{step:{signal:`${n}_step`}}}else if(isObject(e)&&isDataRefDomain(e))return Object.assign(Object.assign({},e),{data:r.lookupDataSource(e.data)});return e}class ScaleComponent extends Split{constructor(n,i){super({},{name:n}),this.merged=!1,this.setWithExplicit("type",i)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:some(this.get("domains"),n=>isArray(n)&&n.length===2&&n[0]<=0&&n[1]>=0)}}const RANGE_PROPERTIES=["range","scheme"];function parseUnitScaleRange(e){const n=e.component.scales;for(const i of SCALE_CHANNELS){const r=n[i];if(!r)continue;const s=parseRangeForChannel(i,e);r.setWithExplicit("range",s)}}function getBinStepSignal(e,n){const i=e.fieldDef(n);if(i!=null&&i.bin){const{bin:r,field:s}=i,o=getSizeChannel(n),l=e.getName(o);if(isObject(r)&&r.binned&&r.step!==void 0)return new SignalRefWrapper(()=>{const f=e.scaleName(n),d=`(domain("${f}")[1] - domain("${f}")[0]) / ${r.step}`;return`${e.getSignalName(l)} / (${d})`});if(isBinning(r)){const f=getBinSignalName(e,s,r);return new SignalRefWrapper(()=>{const d=e.getSignalName(f),p=`(${d}.stop - ${d}.start) / ${d}.step`;return`${e.getSignalName(l)} / (${p})`})}}}function parseRangeForChannel(e,n){const i=n.specifiedScales[e],{size:r}=n,o=n.getScaleComponent(e).get("type");for(const v of RANGE_PROPERTIES)if(i[v]!==void 0){const S=scaleTypeSupportProperty(o,v),T=channelScalePropertyIncompatability(e,v);if(!S)warn(scalePropertyNotWorkWithScaleType(o,v,e));else if(T)warn(T);else switch(v){case"range":{const k=i.range;if(isArray(k)){if(isXorY(e))return makeExplicit(k.map(O=>{if(O==="width"||O==="height"){const R=n.getName(O),P=n.getSignalName.bind(n);return SignalRefWrapper.fromName(P,R)}return O}))}else if(isObject(k))return makeExplicit({data:n.requestDataName(DataSourceType.Main),field:k.field,sort:{op:"min",field:n.vgField(e)}});return makeExplicit(k)}case"scheme":return makeExplicit(parseScheme(i[v]))}}const l=e===X||e==="xOffset"?"width":"height",f=r[l];if(isStep(f)){if(isXorY(e))if(hasDiscreteDomain(o)){const v=getPositionStep(f,n,e);if(v)return makeExplicit({step:v})}else warn(stepDropped(l));else if(isXorYOffset(e)){const v=e===XOFFSET?"x":"y";if(n.getScaleComponent(v).get("type")==="band"){const k=getOffsetStep(f,o);if(k)return makeExplicit(k)}}}const{rangeMin:d,rangeMax:p}=i,g=defaultRange(e,n);return(d!==void 0||p!==void 0)&&scaleTypeSupportProperty(o,"rangeMin")&&isArray(g)&&g.length===2?makeExplicit([d??g[0],p??g[1]]):makeImplicit(g)}function parseScheme(e){return isExtendedScheme(e)?Object.assign({scheme:e.name},omit(e,["name"])):{scheme:e}}function defaultRange(e,n){const{size:i,config:r,mark:s,encoding:o}=n,l=n.getSignalName.bind(n),{type:f}=getFieldOrDatumDef(o[e]),p=n.getScaleComponent(e).get("type"),{domain:g,domainMid:v}=n.specifiedScales[e];switch(e){case X:case Y:{if(contains(["point","band"],p)){const k=getDiscretePositionSize(e,i,r.view);if(isStep(k))return{step:getPositionStep(k,n,e)}}const S=getSizeChannel(e),T=n.getName(S);return e===Y&&hasContinuousDomain(p)?[SignalRefWrapper.fromName(l,T),0]:[0,SignalRefWrapper.fromName(l,T)]}case XOFFSET:case YOFFSET:return getOffsetRange(e,n,p);case SIZE:{const S=n.component.scales[e].get("zero"),T=sizeRangeMin(s,S,r),k=sizeRangeMax(s,i,n,r);return isContinuousToDiscrete(p)?interpolateRange(T,k,defaultContinuousToDiscreteCount(p,r,g,e)):[T,k]}case THETA:return[0,Math.PI*2];case ANGLE:return[0,360];case RADIUS:return[0,new SignalRefWrapper(()=>{const S=n.getSignalName("width"),T=n.getSignalName("height");return`min(${S},${T})/2`})];case STROKEWIDTH:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case STROKEDASH:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case SHAPE:return"symbol";case COLOR:case FILL:case STROKE:return p==="ordinal"?f==="nominal"?"category":"ordinal":v!==void 0?"diverging":s==="rect"||s==="geoshape"?"heatmap":"ramp";case OPACITY:case FILLOPACITY:case STROKEOPACITY:return[r.scale.minOpacity,r.scale.maxOpacity]}}function getPositionStep(e,n,i){var r,s,o,l,f;const{encoding:d}=n,p=n.getScaleComponent(i),g=getOffsetScaleChannel(i),v=d[g];if(getStepFor({step:e,offsetIsDiscrete:isFieldOrDatumDef(v)&&isDiscrete$1(v.type)})==="offset"&&channelHasFieldOrDatum(d,g)){const T=n.getScaleComponent(g);let O=`domain('${n.scaleName(g)}').length`;if(T.get("type")==="band"){const P=(s=(r=T.get("paddingInner"))!==null&&r!==void 0?r:T.get("padding"))!==null&&s!==void 0?s:0,F=(l=(o=T.get("paddingOuter"))!==null&&o!==void 0?o:T.get("padding"))!==null&&l!==void 0?l:0;O=`bandspace(${O}, ${P}, ${F})`}const R=(f=p.get("paddingInner"))!==null&&f!==void 0?f:p.get("padding");return{signal:`${e.step} * ${O} / (1-${exprFromSignalRefOrValue(R)})`}}else return e.step}function getOffsetStep(e,n){if(getStepFor({step:e,offsetIsDiscrete:hasDiscreteDomain(n)})==="offset")return{step:e.step}}function getOffsetRange(e,n,i){const r=e===XOFFSET?"x":"y",o=n.getScaleComponent(r).get("type"),l=n.scaleName(r);if(o==="band"){const f=getDiscretePositionSize(r,n.size,n.config.view);if(isStep(f)){const d=getOffsetStep(f,i);if(d)return d}return[0,{signal:`bandwidth('${l}')`}]}else return never(`Cannot use ${e} scale if ${r} scale is not discrete.`)}function getDiscretePositionSize(e,n,i){const r=e===X?"width":"height",s=n[r];return s||getViewConfigDiscreteSize(i,r)}function defaultContinuousToDiscreteCount(e,n,i,r){switch(e){case"quantile":return n.scale.quantileCount;case"quantize":return n.scale.quantizeCount;case"threshold":return i!==void 0&&isArray(i)?i.length+1:(warn(domainRequiredForThresholdScale(r)),3)}}function interpolateRange(e,n,i){const r=()=>{const s=signalOrStringValue(n),o=signalOrStringValue(e),l=`(${s} - ${o}) / (${i} - 1)`;return`sequence(${o}, ${s} + ${l}, ${l})`};return isSignalRef(n)?new SignalRefWrapper(r):{signal:r()}}function sizeRangeMin(e,n,i){if(n)return isSignalRef(n)?{signal:`${n.signal} ? 0 : ${sizeRangeMin(e,!1,i)}`}:0;switch(e){case"bar":case"tick":return i.scale.minBandSize;case"line":case"trail":case"rule":return i.scale.minStrokeWidth;case"text":return i.scale.minFontSize;case"point":case"square":case"circle":return i.scale.minSize}throw new Error(incompatibleChannel("size",e))}const MAX_SIZE_RANGE_STEP_RATIO=.95;function sizeRangeMax(e,n,i,r){const s={x:getBinStepSignal(i,"x"),y:getBinStepSignal(i,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=minXYStep(n,s,r.view);return isNumber$1(o)?o-1:new SignalRefWrapper(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=minXYStep(n,s,r.view);return isNumber$1(o)?Math.pow(MAX_SIZE_RANGE_STEP_RATIO*o,2):new SignalRefWrapper(()=>`pow(${MAX_SIZE_RANGE_STEP_RATIO} * ${o.signal}, 2)`)}}throw new Error(incompatibleChannel("size",e))}function minXYStep(e,n,i){const r=isStep(e.width)?e.width.step:getViewConfigDiscreteStep(i,"width"),s=isStep(e.height)?e.height.step:getViewConfigDiscreteStep(i,"height");return n.x||n.y?new SignalRefWrapper(()=>`min(${[n.x?n.x.signal:r,n.y?n.y.signal:s].join(", ")})`):Math.min(r,s)}function parseScaleProperty(e,n){isUnitModel(e)?parseUnitScaleProperty(e,n):parseNonUnitScaleProperty(e,n)}function parseUnitScaleProperty(e,n){const i=e.component.scales,{config:r,encoding:s,markDef:o,specifiedScales:l}=e;for(const f of keys$1(i)){const d=l[f],p=i[f],g=e.getScaleComponent(f),v=getFieldOrDatumDef(s[f]),S=d[n],T=g.get("type"),k=g.get("padding"),O=g.get("paddingInner"),R=scaleTypeSupportProperty(T,n),P=channelScalePropertyIncompatability(f,n);if(S!==void 0&&(R?P&&warn(P):warn(scalePropertyNotWorkWithScaleType(T,n,f))),R&&P===void 0)if(S!==void 0){const F=v.timeUnit,I=v.type;switch(n){case"domainMax":case"domainMin":isDateTime(d[n])||I==="temporal"||F?p.set(n,{signal:valueExpr(d[n],{type:I,timeUnit:F})},!0):p.set(n,d[n],!0);break;default:p.copyKeyFromObject(n,d)}}else{const F=n in scaleRules?scaleRules[n]({model:e,channel:f,fieldOrDatumDef:v,scaleType:T,scalePadding:k,scalePaddingInner:O,domain:d.domain,domainMin:d.domainMin,domainMax:d.domainMax,markDef:o,config:r,hasNestedOffsetScale:channelHasNestedOffsetScale(s,f),hasSecondaryRangeChannel:!!s[getSecondaryRangeChannel(f)]}):r.scale[n];F!==void 0&&p.set(n,F,!1)}}}const scaleRules={bins:({model:e,fieldOrDatumDef:n})=>isFieldDef(n)?bins(e,n):void 0,interpolate:({channel:e,fieldOrDatumDef:n})=>interpolate(e,n.type),nice:({scaleType:e,channel:n,domain:i,domainMin:r,domainMax:s,fieldOrDatumDef:o})=>nice(e,n,i,r,s,o),padding:({channel:e,scaleType:n,fieldOrDatumDef:i,markDef:r,config:s})=>padding(e,n,s.scale,i,r,s.bar),paddingInner:({scalePadding:e,channel:n,markDef:i,scaleType:r,config:s,hasNestedOffsetScale:o})=>paddingInner(e,n,i.type,r,s.scale,o),paddingOuter:({scalePadding:e,channel:n,scaleType:i,scalePaddingInner:r,config:s,hasNestedOffsetScale:o})=>paddingOuter(e,n,i,r,s.scale,o),reverse:({fieldOrDatumDef:e,scaleType:n,channel:i,config:r})=>{const s=isFieldDef(e)?e.sort:void 0;return reverse(n,s,i,r.scale)},zero:({channel:e,fieldOrDatumDef:n,domain:i,markDef:r,scaleType:s,config:o,hasSecondaryRangeChannel:l})=>zero(e,n,i,r,s,o.scale,l)};function parseScaleRange(e){isUnitModel(e)?parseUnitScaleRange(e):parseNonUnitScaleProperty(e,"range")}function parseNonUnitScaleProperty(e,n){const i=e.component.scales;for(const r of e.children)n==="range"?parseScaleRange(r):parseScaleProperty(r,n);for(const r of keys$1(i)){let s;for(const o of e.children){const l=o.component.scales[r];if(l){const f=l.getWithExplicit(n);s=mergeValuesWithExplicit(s,f,n,"scale",tieBreakByComparing((d,p)=>{switch(n){case"range":return d.step&&p.step?d.step-p.step:0}return 0}))}}i[r].setWithExplicit(n,s)}}function bins(e,n){const i=n.bin;if(isBinning(i)){const r=getBinSignalName(e,n.field,i);return new SignalRefWrapper(()=>e.getSignalName(r))}else if(isBinned(i)&&isBinParams(i)&&i.step!==void 0)return{step:i.step}}function interpolate(e,n){if(contains([COLOR,FILL,STROKE],e)&&n!=="nominal")return"hcl"}function nice(e,n,i,r,s,o){var l;if(!(!((l=getFieldDef(o))===null||l===void 0)&&l.bin||isArray(i)||s!=null||r!=null||contains([ScaleType.TIME,ScaleType.UTC],e)))return isXorY(n)?!0:void 0}function padding(e,n,i,r,s,o){if(isXorY(e)){if(isContinuousToContinuous(n)){if(i.continuousPadding!==void 0)return i.continuousPadding;const{type:l,orient:f}=s;if(l==="bar"&&!(isFieldDef(r)&&(r.bin||r.timeUnit))&&(f==="vertical"&&e==="x"||f==="horizontal"&&e==="y"))return o.continuousBandSize}if(n===ScaleType.POINT)return i.pointPadding}}function paddingInner(e,n,i,r,s,o=!1){if(e===void 0){if(isXorY(n)){const{bandPaddingInner:l,barBandPaddingInner:f,rectBandPaddingInner:d,bandWithNestedOffsetPaddingInner:p}=s;return o?p:getFirstDefined(l,i==="bar"?f:d)}else if(isXorYOffset(n)&&r===ScaleType.BAND)return s.offsetBandPaddingInner}}function paddingOuter(e,n,i,r,s,o=!1){if(e===void 0){if(isXorY(n)){const{bandPaddingOuter:l,bandWithNestedOffsetPaddingOuter:f}=s;if(o)return f;if(i===ScaleType.BAND)return getFirstDefined(l,isSignalRef(r)?{signal:`${r.signal}/2`}:r/2)}else if(isXorYOffset(n)){if(i===ScaleType.POINT)return .5;if(i===ScaleType.BAND)return s.offsetBandPaddingOuter}}}function reverse(e,n,i,r){if(i==="x"&&r.xReverse!==void 0)return hasContinuousDomain(e)&&n==="descending"?isSignalRef(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(hasContinuousDomain(e)&&n==="descending")return!0}function zero(e,n,i,r,s,o,l){if(!!i&&i!=="unaggregated"&&hasContinuousDomain(s)){if(isArray(i)){const d=i[0],p=i[i.length-1];if(d<=0&&p>=0)return!0}return!1}if(e==="size"&&n.type==="quantitative"&&!isContinuousToDiscrete(s))return!0;if(!(isFieldDef(n)&&n.bin)&&contains([...POSITION_SCALE_CHANNELS,...POLAR_POSITION_SCALE_CHANNELS],e)){const{orient:d,type:p}=r;return contains(["bar","area","line","trail"],p)&&(d==="horizontal"&&e==="y"||d==="vertical"&&e==="x")?!1:contains(["bar","area"],p)&&!l?!0:o==null?void 0:o.zero}return!1}function scaleType(e,n,i,r,s=!1){const o=defaultType(n,i,r,s),{type:l}=e;return isScaleChannel(n)?l!==void 0?channelSupportScaleType(n,l)?isFieldDef(i)&&!scaleTypeSupportDataType(l,i.type)?(warn(scaleTypeNotWorkWithFieldDef(l,o)),o):l:(warn(scaleTypeNotWorkWithChannel(n,l,o)),o):o:null}function defaultType(e,n,i,r){var s;switch(n.type){case"nominal":case"ordinal":{if(isColorChannel(e)||rangeType(e)==="discrete")return e==="shape"&&n.type==="ordinal"&&warn(discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(isXorY(e)||isXorYOffset(e)){if(contains(["rect","bar","image","rule"],i.type)||r)return"band"}else if(i.type==="arc"&&e in POLAR_POSITION_SCALE_CHANNEL_INDEX)return"band";const o=i[getSizeChannel(e)];return isRelativeBandSize(o)||isPositionFieldOrDatumDef(n)&&(!((s=n.axis)===null||s===void 0)&&s.tickBand)?"band":"point"}case"temporal":return isColorChannel(e)?"time":rangeType(e)==="discrete"?(warn(discreteChannelCannotEncode(e,"temporal")),"ordinal"):isFieldDef(n)&&n.timeUnit&&normalizeTimeUnit(n.timeUnit).utc?"utc":"time";case"quantitative":return isColorChannel(e)?isFieldDef(n)&&isBinning(n.bin)?"bin-ordinal":"linear":rangeType(e)==="discrete"?(warn(discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(invalidFieldType(n.type))}function parseScales(e,{ignoreRange:n}={}){parseScaleCore(e),parseScaleDomain(e);for(const i of NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES)parseScaleProperty(e,i);n||parseScaleRange(e)}function parseScaleCore(e){isUnitModel(e)?e.component.scales=parseUnitScaleCore(e):e.component.scales=parseNonUnitScaleCore(e)}function parseUnitScaleCore(e){const{encoding:n,mark:i,markDef:r}=e,s={};for(const o of SCALE_CHANNELS){const l=getFieldOrDatumDef(n[o]);if(l&&i===GEOSHAPE&&o===SHAPE&&l.type===GEOJSON)continue;let f=l&&l.scale;if(isXorYOffset(o)){const d=getMainChannelFromOffsetChannel(o);if(!channelHasNestedOffsetScale(n,d)){f&&warn(offsetEncodingScaleIgnored(o));continue}}if(l&&f!==null&&f!==!1){f??(f={});const d=channelHasNestedOffsetScale(n,o),p=scaleType(f,o,l,r,d);s[o]=new ScaleComponent(e.scaleName(`${o}`,!0),{value:p,explicit:f.type===p})}}return s}const scaleTypeTieBreaker=tieBreakByComparing((e,n)=>scaleTypePrecedence(e)-scaleTypePrecedence(n));function parseNonUnitScaleCore(e){var n,i;const r=e.component.scales={},s={},o=e.component.resolve;for(const l of e.children){parseScaleCore(l);for(const f of keys$1(l.component.scales))if((n=(i=o.scale)[f])!==null&&n!==void 0||(i[f]=defaultScaleResolve(f,e)),o.scale[f]==="shared"){const d=s[f],p=l.component.scales[f].getWithExplicit("type");d?scaleCompatible(d.value,p.value)?s[f]=mergeValuesWithExplicit(d,p,"type","scale",scaleTypeTieBreaker):(o.scale[f]="independent",delete s[f]):s[f]=p}}for(const l of keys$1(s)){const f=e.scaleName(l,!0),d=s[l];r[l]=new ScaleComponent(f,d);for(const p of e.children){const g=p.component.scales[l];g&&(p.renameScale(g.get("name"),f),g.merged=!0)}}return r}var __rest$5=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class NameMap{constructor(){this.nameMap={}}rename(n,i){this.nameMap[n]=i}has(n){return this.nameMap[n]!==void 0}get(n){for(;this.nameMap[n]&&n!==this.nameMap[n];)n=this.nameMap[n];return n}}function isUnitModel(e){return(e==null?void 0:e.type)==="unit"}function isFacetModel(e){return(e==null?void 0:e.type)==="facet"}function isConcatModel(e){return(e==null?void 0:e.type)==="concat"}function isLayerModel(e){return(e==null?void 0:e.type)==="layer"}class Model{constructor(n,i,r,s,o,l,f){var d,p;this.type=i,this.parent=r,this.config=o,this.correctDataNames=g=>{var v,S,T;return!((v=g.from)===null||v===void 0)&&v.data&&(g.from.data=this.lookupDataSource(g.from.data)),!((T=(S=g.from)===null||S===void 0?void 0:S.facet)===null||T===void 0)&&T.data&&(g.from.facet.data=this.lookupDataSource(g.from.facet.data)),g},this.parent=r,this.config=o,this.view=replaceExprRef(f),this.name=(d=n.name)!==null&&d!==void 0?d:s,this.title=isText(n.title)?{text:n.title}:n.title?replaceExprRef(n.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new NameMap,this.projectionNameMap=r?r.projectionNameMap:new NameMap,this.signalNameMap=r?r.signalNameMap:new NameMap,this.data=n.data,this.description=n.description,this.transforms=normalizeTransform((p=n.transform)!==null&&p!==void 0?p:[]),this.layout=i==="layer"||i==="unit"?{}:extractCompositionLayout(n,i,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:isFacetSpec(n)||(r==null?void 0:r.component.data.isFaceted)&&n.data===void 0},layoutSize:new Split,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},l?duplicate(l):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){parseScales(this)}parseProjection(){parseProjection(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){parseLegend(this)}assembleEncodeFromView(n){const i=__rest$5(n,["style"]),r={};for(const s of keys$1(i)){const o=i[s];o!==void 0&&(r[s]=signalOrValueRef(o))}return r}assembleGroupEncodeEntry(n){let i={};return this.view&&(i=this.assembleEncodeFromView(this.view)),!n&&(this.description&&(i.description=signalOrValueRef(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},i??{}):isEmpty(i)?void 0:i}assembleLayout(){if(!this.layout)return;const n=this.layout,{spacing:i}=n,r=__rest$5(n,["spacing"]),{component:s,config:o}=this,l=assembleLayoutTitleBand(s.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:i},this.assembleDefaultLayout()),r),l?{titleBand:l}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:n}=this.component;let i=[];for(const r of FACET_CHANNELS)n[r].title&&i.push(assembleTitleGroup(this,r));for(const r of HEADER_CHANNELS)i=i.concat(assembleHeaderGroups(this,r));return i}assembleAxes(){return assembleAxes(this.component.axes,this.config)}assembleLegends(){return assembleLegends(this)}assembleProjections(){return assembleProjections(this)}assembleTitle(){var n,i,r;const s=(n=this.title)!==null&&n!==void 0?n:{},{encoding:o}=s,l=__rest$5(s,["encoding"]),f=Object.assign(Object.assign(Object.assign({},extractTitleConfig(this.config.title).nonMarkTitleProperties),l),o?{encode:{update:o}}:{});if(f.text)return contains(["unit","layer"],this.type)?contains(["middle",void 0],f.anchor)&&((i=f.frame)!==null&&i!==void 0||(f.frame="group")):(r=f.anchor)!==null&&r!==void 0||(f.anchor="start"),isEmpty(f)?void 0:f}assembleGroup(n=[]){const i={};n=n.concat(this.assembleSignals()),n.length>0&&(i.signals=n);const r=this.assembleLayout();r&&(i.layout=r),i.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const s=!this.parent||isFacetModel(this.parent)?assembleScales(this):[];s.length>0&&(i.scales=s);const o=this.assembleAxes();o.length>0&&(i.axes=o);const l=this.assembleLegends();return l.length>0&&(i.legends=l),i}getName(n){return varName((this.name?`${this.name}_`:"")+n)}getDataName(n){return this.getName(DataSourceType[n].toLowerCase())}requestDataName(n){const i=this.getDataName(n),r=this.component.data.outputNodeRefCounts;return r[i]=(r[i]||0)+1,i}getSizeSignalRef(n){if(isFacetModel(this.parent)){const i=getSizeTypeFromLayoutSizeType(n),r=getPositionScaleChannel(i),s=this.component.scales[r];if(s&&!s.merged){const o=s.get("type"),l=s.get("range");if(hasDiscreteDomain(o)&&isVgRangeStep(l)){const f=s.get("name"),d=assembleDomain(this,r),p=getFieldFromDomain(d);if(p){const g=vgField({aggregate:"distinct",field:p},{expr:"datum"});return{signal:sizeExpr(f,s,g)}}else return warn(unknownField(r)),null}}}return{signal:this.signalNameMap.get(this.getName(n))}}lookupDataSource(n){const i=this.component.data.outputNodes[n];return i?i.getSource():n}getSignalName(n){return this.signalNameMap.get(n)}renameSignal(n,i){this.signalNameMap.rename(n,i)}renameScale(n,i){this.scaleNameMap.rename(n,i)}renameProjection(n,i){this.projectionNameMap.rename(n,i)}scaleName(n,i){if(i)return this.getName(n);if(isChannel(n)&&isScaleChannel(n)&&this.component.scales[n]||this.scaleNameMap.has(this.getName(n)))return this.scaleNameMap.get(this.getName(n))}projectionName(n){if(n)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(n){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const i=this.component.scales[n];return i&&!i.merged?i:this.parent?this.parent.getScaleComponent(n):void 0}getSelectionComponent(n,i){let r=this.component.selection[n];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(n,i)),!r)throw new Error(selectionNotFound(i));return r}hasAxisOrientSignalRef(){var n,i;return((n=this.component.axes.x)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))||((i=this.component.axes.y)===null||i===void 0?void 0:i.some(r=>r.hasOrientSignalRef()))}}class ModelWithField extends Model{vgField(n,i={}){const r=this.fieldDef(n);if(r)return vgField(r,i)}reduceFieldDef(n,i){return reduce(this.getMapping(),(r,s,o)=>{const l=getFieldDef(s);return l?n(r,l,o):r},i)}forEachFieldDef(n,i){forEach(this.getMapping(),(r,s)=>{const o=getFieldDef(r);o&&n(o,s)},i)}}var __rest$4=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class DensityTransformNode extends DataFlowNode{constructor(n,i){var r,s,o;super(n),this.transform=i,this.transform=duplicate(i);const l=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(s=l[0])!==null&&s!==void 0?s:"value",(o=l[1])!==null&&o!==void 0?o:"density"],i.groupby&&i.minsteps==null&&i.maxsteps==null&&i.steps==null&&(this.transform.steps=200)}clone(){return new DensityTransformNode(null,duplicate(this.transform))}dependentFields(){var n;return new Set([this.transform.density,...(n=this.transform.groupby)!==null&&n!==void 0?n:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${hash(this.transform)}`}assemble(){const n=this.transform,{density:i}=n,r=__rest$4(n,["density"]);return Object.assign({type:"kde",field:i},r)}}class FilterInvalidNode extends DataFlowNode{constructor(n,i){super(n),this.filter=i}clone(){return new FilterInvalidNode(null,Object.assign({},this.filter))}static make(n,i){const{config:r,mark:s,markDef:o}=i;if(getMarkPropOrConfig("invalid",o,r)!=="filter")return null;const f=i.reduceFieldDef((d,p,g)=>{const v=isScaleChannel(g)&&i.getScaleComponent(g);if(v){const S=v.get("type");hasContinuousDomain(S)&&p.aggregate!=="count"&&!isPathMark(s)&&(d[p.field]=p)}return d},{});return keys$1(f).length?new FilterInvalidNode(n,f):null}dependentFields(){return new Set(keys$1(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${hash(this.filter)}`}assemble(){const n=keys$1(this.filter).reduce((i,r)=>{const s=this.filter[r],o=vgField(s,{expr:"datum"});return s!==null&&(s.type==="temporal"?i.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):s.type==="quantitative"&&(i.push(`isValid(${o})`),i.push(`isFinite(+${o})`))),i},[]);return n.length>0?{type:"filter",expr:n.join(" && ")}:null}}class FlattenTransformNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i,this.transform=duplicate(i);const{flatten:r,as:s=[]}=this.transform;this.transform.as=r.map((o,l)=>{var f;return(f=s[l])!==null&&f!==void 0?f:o})}clone(){return new FlattenTransformNode(this.parent,duplicate(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${hash(this.transform)}`}assemble(){const{flatten:n,as:i}=this.transform;return{type:"flatten",fields:n,as:i}}}class FoldTransformNode extends DataFlowNode{constructor(n,i){var r,s,o;super(n),this.transform=i,this.transform=duplicate(i);const l=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(s=l[0])!==null&&s!==void 0?s:"key",(o=l[1])!==null&&o!==void 0?o:"value"]}clone(){return new FoldTransformNode(null,duplicate(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${hash(this.transform)}`}assemble(){const{fold:n,as:i}=this.transform;return{type:"fold",fields:n,as:i}}}class GeoJSONNode extends DataFlowNode{constructor(n,i,r,s){super(n),this.fields=i,this.geojson=r,this.signal=s}clone(){return new GeoJSONNode(null,duplicate(this.fields),this.geojson,this.signal)}static parseAll(n,i){if(i.component.projection&&!i.component.projection.isFit)return n;let r=0;for(const s of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]]){const o=s.map(l=>{const f=getFieldOrDatumDef(i.encoding[l]);return isFieldDef(f)?f.field:isDatumDef(f)?{expr:`${f.datum}`}:isValueDef(f)?{expr:`${f.value}`}:void 0});(o[0]||o[1])&&(n=new GeoJSONNode(n,o,null,i.getName(`geojson_${r++}`)))}if(i.channelHasField(SHAPE)){const s=i.typedFieldDef(SHAPE);s.type===GEOJSON&&(n=new GeoJSONNode(n,null,s.field,i.getName(`geojson_${r++}`)))}return n}dependentFields(){var n;const i=((n=this.fields)!==null&&n!==void 0?n:[]).filter(isString);return new Set([...this.geojson?[this.geojson]:[],...i])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${hash(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class GeoPointNode extends DataFlowNode{constructor(n,i,r,s){super(n),this.projection=i,this.fields=r,this.as=s}clone(){return new GeoPointNode(null,this.projection,duplicate(this.fields),duplicate(this.as))}static parseAll(n,i){if(!i.projectionName())return n;for(const r of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]]){const s=r.map(l=>{const f=getFieldOrDatumDef(i.encoding[l]);return isFieldDef(f)?f.field:isDatumDef(f)?{expr:`${f.datum}`}:isValueDef(f)?{expr:`${f.value}`}:void 0}),o=r[0]===LONGITUDE2?"2":"";(s[0]||s[1])&&(n=new GeoPointNode(n,i.projectionName(),s,[i.getName(`x${o}`),i.getName(`y${o}`)]))}return n}dependentFields(){return new Set(this.fields.filter(isString))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${hash(this.fields)} ${hash(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class ImputeNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i}clone(){return new ImputeNode(null,duplicate(this.transform))}dependentFields(){var n;return new Set([this.transform.impute,this.transform.key,...(n=this.transform.groupby)!==null&&n!==void 0?n:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(n){const{start:i=0,stop:r,step:s}=n;return{signal:`sequence(${[i,r,...s?[s]:[]].join(",")})`}}static makeFromTransform(n,i){return new ImputeNode(n,i)}static makeFromEncoding(n,i){const r=i.encoding,s=r.x,o=r.y;if(isFieldDef(s)&&isFieldDef(o)){const l=s.impute?s:o.impute?o:void 0;if(l===void 0)return;const f=s.impute?o:o.impute?s:void 0,{method:d,value:p,frame:g,keyvals:v}=l.impute,S=pathGroupingFields(i.mark,r);return new ImputeNode(n,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:l.field,key:f.field},d?{method:d}:{}),p!==void 0?{value:p}:{}),g?{frame:g}:{}),v!==void 0?{keyvals:v}:{}),S.length?{groupby:S}:{}))}return null}hash(){return`Impute ${hash(this.transform)}`}assemble(){const{impute:n,key:i,keyvals:r,method:s,groupby:o,value:l,frame:f=[null,null]}=this.transform,d=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:n,key:i},r?{keyvals:isImputeSequence(r)?this.processSequence(r):r}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!s||s==="value"?l:null});if(s&&s!=="value"){const p=Object.assign({type:"window",as:[`imputed_${n}_value`],ops:[s],fields:[n],frame:f,ignorePeers:!1},o?{groupby:o}:{}),g={type:"formula",expr:`datum.${n} === null ? datum.imputed_${n}_value : datum.${n}`,as:n};return[d,p,g]}else return[d]}}var __rest$3=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class LoessTransformNode extends DataFlowNode{constructor(n,i){var r,s,o;super(n),this.transform=i,this.transform=duplicate(i);const l=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(s=l[0])!==null&&s!==void 0?s:i.on,(o=l[1])!==null&&o!==void 0?o:i.loess]}clone(){return new LoessTransformNode(null,duplicate(this.transform))}dependentFields(){var n;return new Set([this.transform.loess,this.transform.on,...(n=this.transform.groupby)!==null&&n!==void 0?n:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${hash(this.transform)}`}assemble(){const n=this.transform,{loess:i,on:r}=n,s=__rest$3(n,["loess","on"]);return Object.assign({type:"loess",x:r,y:i},s)}}class LookupNode extends DataFlowNode{constructor(n,i,r){super(n),this.transform=i,this.secondary=r}clone(){return new LookupNode(null,duplicate(this.transform),this.secondary)}static make(n,i,r,s){const o=i.component.data.sources,{from:l}=r;let f=null;if(isLookupData(l)){let d=findSource(l.data,o);d||(d=new SourceNode(l.data),o.push(d));const p=i.getName(`lookup_${s}`);f=new OutputNode(d,p,DataSourceType.Lookup,i.component.data.outputNodeRefCounts),i.component.data.outputNodes[p]=f}else if(isLookupSelection(l)){const d=l.param;r=Object.assign({as:d},r);let p;try{p=i.getSelectionComponent(varName(d),d)}catch{throw new Error(cannotLookupVariableParameter(d))}if(f=p.materialized,!f)throw new Error(noSameUnitLookup(d))}return new LookupNode(n,r,f.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?array$5(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${hash({transform:this.transform,secondary:this.secondary})}`}assemble(){let n;if(this.transform.from.fields)n=Object.assign({values:this.transform.from.fields},this.transform.as?{as:array$5(this.transform.as)}:{});else{let i=this.transform.as;isString(i)||(warn(NO_FIELDS_NEEDS_AS),i="_lookup"),n={as:[i]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},n),this.transform.default?{default:this.transform.default}:{})}}var __rest$2=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class QuantileTransformNode extends DataFlowNode{constructor(n,i){var r,s,o;super(n),this.transform=i,this.transform=duplicate(i);const l=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(s=l[0])!==null&&s!==void 0?s:"prob",(o=l[1])!==null&&o!==void 0?o:"value"]}clone(){return new QuantileTransformNode(null,duplicate(this.transform))}dependentFields(){var n;return new Set([this.transform.quantile,...(n=this.transform.groupby)!==null&&n!==void 0?n:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${hash(this.transform)}`}assemble(){const n=this.transform,{quantile:i}=n,r=__rest$2(n,["quantile"]);return Object.assign({type:"quantile",field:i},r)}}var __rest$1=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class RegressionTransformNode extends DataFlowNode{constructor(n,i){var r,s,o;super(n),this.transform=i,this.transform=duplicate(i);const l=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(s=l[0])!==null&&s!==void 0?s:i.on,(o=l[1])!==null&&o!==void 0?o:i.regression]}clone(){return new RegressionTransformNode(null,duplicate(this.transform))}dependentFields(){var n;return new Set([this.transform.regression,this.transform.on,...(n=this.transform.groupby)!==null&&n!==void 0?n:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${hash(this.transform)}`}assemble(){const n=this.transform,{regression:i,on:r}=n,s=__rest$1(n,["regression","on"]);return Object.assign({type:"regression",x:r,y:i},s)}}class PivotTransformNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i}clone(){return new PivotTransformNode(null,duplicate(this.transform))}addDimensions(n){var i;this.transform.groupby=unique(((i=this.transform.groupby)!==null&&i!==void 0?i:[]).concat(n),r=>r)}producedFields(){}dependentFields(){var n;return new Set([this.transform.pivot,this.transform.value,...(n=this.transform.groupby)!==null&&n!==void 0?n:[]])}hash(){return`PivotTransform ${hash(this.transform)}`}assemble(){const{pivot:n,value:i,groupby:r,limit:s,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:n,value:i},s!==void 0?{limit:s}:{}),o!==void 0?{op:o}:{}),r!==void 0?{groupby:r}:{})}}class SampleTransformNode extends DataFlowNode{constructor(n,i){super(n),this.transform=i}clone(){return new SampleTransformNode(null,duplicate(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${hash(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function makeWalkTree(e){let n=0;function i(r,s){var o;if(r instanceof SourceNode&&!r.isGenerator&&!isUrlData(r.data)&&(e.push(s),s={name:null,source:s.name,transform:[]}),r instanceof ParseNode&&(r.parent instanceof SourceNode&&!s.source?(s.format=Object.assign(Object.assign({},(o=s.format)!==null&&o!==void 0?o:{}),{parse:r.assembleFormatParse()}),s.transform.push(...r.assembleTransforms(!0))):s.transform.push(...r.assembleTransforms())),r instanceof FacetNode){s.name||(s.name=`data_${n++}`),!s.source||s.transform.length>0?(e.push(s),r.data=s.name):r.data=s.source,e.push(...r.assemble());return}switch((r instanceof GraticuleNode||r instanceof SequenceNode||r instanceof FilterInvalidNode||r instanceof FilterNode||r instanceof CalculateNode||r instanceof GeoPointNode||r instanceof AggregateNode||r instanceof LookupNode||r instanceof WindowTransformNode||r instanceof JoinAggregateTransformNode||r instanceof FoldTransformNode||r instanceof FlattenTransformNode||r instanceof DensityTransformNode||r instanceof LoessTransformNode||r instanceof QuantileTransformNode||r instanceof RegressionTransformNode||r instanceof IdentifierNode||r instanceof SampleTransformNode||r instanceof PivotTransformNode)&&s.transform.push(r.assemble()),(r instanceof BinNode||r instanceof TimeUnitNode||r instanceof ImputeNode||r instanceof StackNode||r instanceof GeoJSONNode)&&s.transform.push(...r.assemble()),r instanceof OutputNode&&(s.source&&s.transform.length===0?r.setSource(s.source):r.parent instanceof OutputNode?r.setSource(s.name):(s.name||(s.name=`data_${n++}`),r.setSource(s.name),r.numChildren()===1&&(e.push(s),s={name:null,source:s.name,transform:[]}))),r.numChildren()){case 0:r instanceof OutputNode&&(!s.source||s.transform.length>0)&&e.push(s);break;case 1:i(r.children[0],s);break;default:{s.name||(s.name=`data_${n++}`);let l=s.name;!s.source||s.transform.length>0?e.push(s):l=s.source;for(const f of r.children)i(f,{name:null,source:l,transform:[]});break}}}return i}function assembleFacetData(e){const n=[],i=makeWalkTree(n);for(const r of e.children)i(r,{source:e.name,name:null,transform:[]});return n}function assembleRootData(e,n){var i,r;const s=[],o=makeWalkTree(s);let l=0;for(const d of e.sources){d.hasName()||(d.dataName=`source_${l++}`);const p=d.assemble();o(d,p)}for(const d of s)d.transform.length===0&&delete d.transform;let f=0;for(const[d,p]of s.entries())((i=p.transform)!==null&&i!==void 0?i:[]).length===0&&!p.source&&s.splice(f++,0,s.splice(d,1)[0]);for(const d of s)for(const p of(r=d.transform)!==null&&r!==void 0?r:[])p.type==="lookup"&&(p.from=e.outputNodes[p.from].getSource());for(const d of s)d.name in n&&(d.values=n[d.name]);return s}function getHeaderType(e){return e==="top"||e==="left"||isSignalRef(e)?"header":"footer"}function parseFacetHeaders(e){for(const n of FACET_CHANNELS)parseFacetHeader(e,n);mergeChildAxis(e,"x"),mergeChildAxis(e,"y")}function parseFacetHeader(e,n){var i;const{facet:r,config:s,child:o,component:l}=e;if(e.channelHasField(n)){const f=r[n],d=getHeaderProperty("title",null,s,n);let p=title(f,s,{allowDisabling:!0,includeDefault:d===void 0||!!d});o.component.layoutHeaders[n].title&&(p=isArray(p)?p.join(", "):p,p+=` / ${o.component.layoutHeaders[n].title}`,o.component.layoutHeaders[n].title=null);const g=getHeaderProperty("labelOrient",f.header,s,n),v=f.header!==null?getFirstDefined((i=f.header)===null||i===void 0?void 0:i.labels,s.header.labels,!0):!1,S=contains(["bottom","right"],g)?"footer":"header";l.layoutHeaders[n]={title:f.header!==null?p:null,facetFieldDef:f,[S]:n==="facet"?[]:[makeHeaderComponent(e,n,v)]}}}function makeHeaderComponent(e,n,i){const r=n==="row"?"height":"width";return{labels:i,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function mergeChildAxis(e,n){var i;const{child:r}=e;if(r.component.axes[n]){const{layoutHeaders:s,resolve:o}=e.component;if(o.axis[n]=parseGuideResolve(o,n),o.axis[n]==="shared"){const l=n==="x"?"column":"row",f=s[l];for(const d of r.component.axes[n]){const p=getHeaderType(d.get("orient"));(i=f[p])!==null&&i!==void 0||(f[p]=[makeHeaderComponent(e,l,!1)]);const g=assembleAxis(d,"main",e.config,{header:!0});g&&f[p][0].axes.push(g),d.mainExtracted=!0}}}}function parseLayerLayoutSize(e){parseChildrenLayoutSize(e),parseNonUnitLayoutSizeForChannel(e,"width"),parseNonUnitLayoutSizeForChannel(e,"height")}function parseConcatLayoutSize(e){parseChildrenLayoutSize(e);const n=e.layout.columns===1?"width":"childWidth",i=e.layout.columns===void 0?"height":"childHeight";parseNonUnitLayoutSizeForChannel(e,n),parseNonUnitLayoutSizeForChannel(e,i)}function parseChildrenLayoutSize(e){for(const n of e.children)n.parseLayoutSize()}function parseNonUnitLayoutSizeForChannel(e,n){var i;const r=getSizeTypeFromLayoutSizeType(n),s=getPositionScaleChannel(r),o=e.component.resolve,l=e.component.layoutSize;let f;for(const d of e.children){const p=d.component.layoutSize.getWithExplicit(r),g=(i=o.scale[s])!==null&&i!==void 0?i:defaultScaleResolve(s,e);if(g==="independent"&&p.value==="step"){f=void 0;break}if(f){if(g==="independent"&&f.value!==p.value){f=void 0;break}f=mergeValuesWithExplicit(f,p,r,"")}else f=p}if(f){for(const d of e.children)e.renameSignal(d.getName(r),e.getName(n)),d.component.layoutSize.set(r,"merged",!1);l.setWithExplicit(n,f)}else l.setWithExplicit(n,{explicit:!1,value:void 0})}function parseUnitLayoutSize(e){const{size:n,component:i}=e;for(const r of POSITION_SCALE_CHANNELS){const s=getSizeChannel(r);if(n[s]){const o=n[s];i.layoutSize.set(s,isStep(o)?"step":o,!0)}else{const o=defaultUnitSize(e,s);i.layoutSize.set(s,o,!1)}}}function defaultUnitSize(e,n){const i=n==="width"?"x":"y",r=e.config,s=e.getScaleComponent(i);if(s){const o=s.get("type"),l=s.get("range");if(hasDiscreteDomain(o)){const f=getViewConfigDiscreteSize(r.view,n);return isVgRangeStep(l)||isStep(f)?"step":f}else return getViewConfigContinuousSize(r.view,n)}else{if(e.hasProjection||e.mark==="arc")return getViewConfigContinuousSize(r.view,n);{const o=getViewConfigDiscreteSize(r.view,n);return isStep(o)?o.step:o}}}function facetSortFieldName(e,n,i){return vgField(n,Object.assign({suffix:`by_${vgField(e)}`},i??{}))}class FacetModel extends ModelWithField{constructor(n,i,r,s){super(n,"facet",i,r,s,n.resolve),this.child=buildModel(n.spec,this,this.getName("child"),void 0,s),this.children=[this.child],this.facet=this.initFacet(n.facet)}initFacet(n){if(!isFacetMapping(n))return{facet:this.initFacetFieldDef(n,"facet")};const i=keys$1(n),r={};for(const s of i){if(![ROW,COLUMN].includes(s)){warn(incompatibleChannel(s,"facet"));break}const o=n[s];if(o.field===void 0){warn(emptyFieldDef(o,s));break}r[s]=this.initFacetFieldDef(o,s)}return r}initFacetFieldDef(n,i){const r=initFieldDef(n,i);return r.header?r.header=replaceExprRef(r.header):r.header===null&&(r.header=null),r}channelHasField(n){return!!this.facet[n]}fieldDef(n){return this.facet[n]}parseData(){this.component.data=parseData(this),this.child.parseData()}parseLayoutSize(){parseChildrenLayoutSize(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),parseFacetHeaders(this)}assembleSelectionTopLevelSignals(n){return this.child.assembleSelectionTopLevelSignals(n)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(n){return this.child.assembleSelectionData(n)}getHeaderLayoutMixins(){var n,i,r;const s={};for(const o of FACET_CHANNELS)for(const l of HEADER_TYPES){const f=this.component.layoutHeaders[o],d=f[l],{facetFieldDef:p}=f;if(p){const g=getHeaderProperty("titleOrient",p.header,this.config,o);if(["right","bottom"].includes(g)){const v=getHeaderChannel(o,g);(n=s.titleAnchor)!==null&&n!==void 0||(s.titleAnchor={}),s.titleAnchor[v]="end"}}if(d!=null&&d[0]){const g=o==="row"?"height":"width",v=l==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(g)&&((i=s[v])!==null&&i!==void 0||(s[v]={}),s[v][o]=.5),f.title&&((r=s.offset)!==null&&r!==void 0||(s.offset={}),s.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return s}assembleDefaultLayout(){const{column:n,row:i}=this.facet,r=n?this.columnDistinctSignal():i?1:void 0;let s="all";return(!i&&this.component.resolve.scale.x==="independent"||!n&&this.component.resolve.scale.y==="independent")&&(s="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:s})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof FacetModel))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(n){return this.parent&&this.parent instanceof FacetModel?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:vgField(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(n)):super.assembleGroup(n)}getCardinalityAggregateForChild(){const n=[],i=[],r=[];if(this.child instanceof FacetModel){if(this.child.channelHasField("column")){const s=vgField(this.child.facet.column);n.push(s),i.push("distinct"),r.push(`distinct_${s}`)}}else for(const s of POSITION_SCALE_CHANNELS){const o=this.child.component.scales[s];if(o&&!o.merged){const l=o.get("type"),f=o.get("range");if(hasDiscreteDomain(l)&&isVgRangeStep(f)){const d=assembleDomain(this.child,s),p=getFieldFromDomain(d);p?(n.push(p),i.push("distinct"),r.push(`distinct_${p}`)):warn(unknownField(s))}}}return{fields:n,ops:i,as:r}}assembleFacet(){const{name:n,data:i}=this.component.data.facetRoot,{row:r,column:s}=this.facet,{fields:o,ops:l,as:f}=this.getCardinalityAggregateForChild(),d=[];for(const g of FACET_CHANNELS){const v=this.facet[g];if(v){d.push(vgField(v));const{bin:S,sort:T}=v;if(isBinning(S)&&d.push(vgField(v,{binSuffix:"end"})),isSortField(T)){const{field:k,op:O=DEFAULT_SORT_OP}=T,R=facetSortFieldName(v,T);r&&s?(o.push(R),l.push("max"),f.push(R)):(o.push(k),l.push(O),f.push(R))}else if(isArray(T)){const k=sortArrayIndexField(v,g);o.push(k),l.push("max"),f.push(k)}}}const p=!!r&&!!s;return Object.assign({name:n,data:i,groupby:d},p||o.length>0?{aggregate:Object.assign(Object.assign({},p?{cross:p}:{}),o.length?{fields:o,ops:l,as:f}:{})}:{})}facetSortFields(n){const{facet:i}=this,r=i[n];return r?isSortField(r.sort)?[facetSortFieldName(r,r.sort,{expr:"datum"})]:isArray(r.sort)?[sortArrayIndexField(r,n,{expr:"datum"})]:[vgField(r,{expr:"datum"})]:[]}facetSortOrder(n){const{facet:i}=this,r=i[n];if(r){const{sort:s}=r;return[(isSortField(s)?s.order:!isArray(s)&&s)||"ascending"]}return[]}assembleLabelTitle(){var n;const{facet:i,config:r}=this;if(i.facet)return assembleLabelTitle(i.facet,"facet",r);const s={row:["top","bottom"],column:["left","right"]};for(const o of HEADER_CHANNELS)if(i[o]){const l=getHeaderProperty("labelOrient",(n=i[o])===null||n===void 0?void 0:n.header,r,o);if(s[o].includes(l))return assembleLabelTitle(i[o],o,r)}}assembleMarks(){const{child:n}=this,i=this.component.data.facetRoot,r=assembleFacetData(i),s=n.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||n.assembleTitle(),l=n.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),l?{style:l}:{}),{from:{facet:this.assembleFacet()},sort:{field:FACET_CHANNELS.map(d=>this.facetSortFields(d)).flat(),order:FACET_CHANNELS.map(d=>this.facetSortOrder(d)).flat()}}),r.length>0?{data:r}:{}),s?{encode:{update:s}}:{}),n.assembleGroup(assembleFacetSignals(this,[])))]}getMapping(){return this.facet}}function makeJoinAggregateFromFacet(e,n){const{row:i,column:r}=n;if(i&&r){let s=null;for(const o of[i,r])if(isSortField(o.sort)){const{field:l,op:f=DEFAULT_SORT_OP}=o.sort;e=s=new JoinAggregateTransformNode(e,{joinaggregate:[{op:f,field:l,as:facetSortFieldName(o,o.sort,{forAs:!0})}],groupby:[vgField(o)]})}return s}return null}function findSource(e,n){var i,r,s,o;for(const l of n){const f=l.data;if(e.name&&l.hasName()&&e.name!==l.dataName)continue;const d=(i=e.format)===null||i===void 0?void 0:i.mesh,p=(r=f.format)===null||r===void 0?void 0:r.feature;if(d&&p)continue;const g=(s=e.format)===null||s===void 0?void 0:s.feature;if((g||p)&&g!==p)continue;const v=(o=f.format)===null||o===void 0?void 0:o.mesh;if(!((d||v)&&d!==v)){if(isInlineData(e)&&isInlineData(f)){if(deepEqual(e.values,f.values))return l}else if(isUrlData(e)&&isUrlData(f)){if(e.url===f.url)return l}else if(isNamedData(e)&&e.name===l.dataName)return l}}return null}function parseRoot(e,n){if(e.data||!e.parent){if(e.data===null){const r=new SourceNode({values:[]});return n.push(r),r}const i=findSource(e.data,n);if(i)return isGenerator(e.data)||(i.data.format=mergeDeep({},e.data.format,i.data.format)),!i.hasName()&&e.data.name&&(i.dataName=e.data.name),i;{const r=new SourceNode(e.data);return n.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function parseTransformArray(e,n,i){var r,s;let o=0;for(const l of n.transforms){let f,d;if(isCalculate(l))d=e=new CalculateNode(e,l),f="derived";else if(isFilter(l)){const p=getImplicitFromFilterTransform(l);d=e=(r=ParseNode.makeWithAncestors(e,{},p,i))!==null&&r!==void 0?r:e,e=new FilterNode(e,n,l.filter)}else if(isBin(l))d=e=BinNode.makeFromTransform(e,l,n),f="number";else if(isTimeUnit(l))f="date",i.getWithExplicit(l.field).value===void 0&&(e=new ParseNode(e,{[l.field]:f}),i.set(l.field,f,!1)),d=e=TimeUnitNode.makeFromTransform(e,l);else if(isAggregate(l))d=e=AggregateNode.makeFromTransform(e,l),f="number",requiresSelectionId(n)&&(e=new IdentifierNode(e));else if(isLookup(l))d=e=LookupNode.make(e,n,l,o++),f="derived";else if(isWindow(l))d=e=new WindowTransformNode(e,l),f="number";else if(isJoinAggregate(l))d=e=new JoinAggregateTransformNode(e,l),f="number";else if(isStack(l))d=e=StackNode.makeFromTransform(e,l),f="derived";else if(isFold(l))d=e=new FoldTransformNode(e,l),f="derived";else if(isFlatten(l))d=e=new FlattenTransformNode(e,l),f="derived";else if(isPivot(l))d=e=new PivotTransformNode(e,l),f="derived";else if(isSample(l))e=new SampleTransformNode(e,l);else if(isImpute(l))d=e=ImputeNode.makeFromTransform(e,l),f="derived";else if(isDensity(l))d=e=new DensityTransformNode(e,l),f="derived";else if(isQuantile(l))d=e=new QuantileTransformNode(e,l),f="derived";else if(isRegression(l))d=e=new RegressionTransformNode(e,l),f="derived";else if(isLoess(l))d=e=new LoessTransformNode(e,l),f="derived";else{warn(invalidTransformIgnored(l));continue}if(d&&f!==void 0)for(const p of(s=d.producedFields())!==null&&s!==void 0?s:[])i.set(p,f,!1)}return e}function parseData(e){var n,i,r,s,o,l,f,d,p,g;let v=parseRoot(e,e.component.data.sources);const{outputNodes:S,outputNodeRefCounts:T}=e.component.data,k=e.data,R=!(k&&(isGenerator(k)||isUrlData(k)||isInlineData(k)))&&e.parent?e.parent.component.data.ancestorParse.clone():new AncestorParse;isGenerator(k)?(isSequenceGenerator(k)?v=new SequenceNode(v,k.sequence):isGraticuleGenerator(k)&&(v=new GraticuleNode(v,k.graticule)),R.parseNothing=!0):((n=k==null?void 0:k.format)===null||n===void 0?void 0:n.parse)===null&&(R.parseNothing=!0),v=(i=ParseNode.makeExplicit(v,e,R))!==null&&i!==void 0?i:v,v=new IdentifierNode(v);const P=e.parent&&isLayerModel(e.parent);(isUnitModel(e)||isFacetModel(e))&&P&&(v=(r=BinNode.makeFromEncoding(v,e))!==null&&r!==void 0?r:v),e.transforms.length>0&&(v=parseTransformArray(v,e,R));const F=getImplicitFromSelection(e),I=getImplicitFromEncoding(e);v=(s=ParseNode.makeWithAncestors(v,{},Object.assign(Object.assign({},F),I),R))!==null&&s!==void 0?s:v,isUnitModel(e)&&(v=GeoJSONNode.parseAll(v,e),v=GeoPointNode.parseAll(v,e)),(isUnitModel(e)||isFacetModel(e))&&(P||(v=(o=BinNode.makeFromEncoding(v,e))!==null&&o!==void 0?o:v),v=(l=TimeUnitNode.makeFromEncoding(v,e))!==null&&l!==void 0?l:v,v=CalculateNode.parseAllForSortIndex(v,e));const L=e.getDataName(DataSourceType.Raw),N=new OutputNode(v,L,DataSourceType.Raw,T);if(S[L]=N,v=N,isUnitModel(e)){const H=AggregateNode.makeFromEncoding(v,e);H&&(v=H,requiresSelectionId(e)&&(v=new IdentifierNode(v))),v=(f=ImputeNode.makeFromEncoding(v,e))!==null&&f!==void 0?f:v,v=(d=StackNode.makeFromEncoding(v,e))!==null&&d!==void 0?d:v}isUnitModel(e)&&(v=(p=FilterInvalidNode.make(v,e))!==null&&p!==void 0?p:v);const j=e.getDataName(DataSourceType.Main),z=new OutputNode(v,j,DataSourceType.Main,T);S[j]=z,v=z,isUnitModel(e)&&materializeSelections(e,z);let q=null;if(isFacetModel(e)){const H=e.getName("facet");v=(g=makeJoinAggregateFromFacet(v,e.facet))!==null&&g!==void 0?g:v,q=new FacetNode(v,e,H,z.getSource()),S[H]=q}return Object.assign(Object.assign({},e.component.data),{outputNodes:S,outputNodeRefCounts:T,raw:N,main:z,facetRoot:q,ancestorParse:R})}class ConcatModel extends Model{constructor(n,i,r,s){var o,l,f,d;super(n,"concat",i,r,s,n.resolve),(((l=(o=n.resolve)===null||o===void 0?void 0:o.axis)===null||l===void 0?void 0:l.x)==="shared"||((d=(f=n.resolve)===null||f===void 0?void 0:f.axis)===null||d===void 0?void 0:d.y)==="shared")&&warn(CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(n).map((p,g)=>buildModel(p,this,this.getName(`concat_${g}`),void 0,s))}parseData(){this.component.data=parseData(this);for(const n of this.children)n.parseData()}parseSelections(){this.component.selection={};for(const n of this.children){n.parseSelections();for(const i of keys$1(n.component.selection))this.component.selection[i]=n.component.selection[i]}}parseMarkGroup(){for(const n of this.children)n.parseMarkGroup()}parseAxesAndHeaders(){for(const n of this.children)n.parseAxesAndHeaders()}getChildren(n){return isVConcatSpec(n)?n.vconcat:isHConcatSpec(n)?n.hconcat:n.concat}parseLayoutSize(){parseConcatLayoutSize(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(n){return this.children.reduce((i,r)=>r.assembleSelectionTopLevelSignals(i),n)}assembleSignals(){return this.children.forEach(n=>n.assembleSignals()),[]}assembleLayoutSignals(){const n=assembleLayoutSignals(this);for(const i of this.children)n.push(...i.assembleLayoutSignals());return n}assembleSelectionData(n){return this.children.reduce((i,r)=>r.assembleSelectionData(i),n)}assembleMarks(){return this.children.map(n=>{const i=n.assembleTitle(),r=n.assembleGroupStyle(),s=n.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:n.getName("group")},i?{title:i}:{}),r?{style:r}:{}),s?{encode:{update:s}}:{}),n.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const n=this.layout.columns;return Object.assign(Object.assign({},n!=null?{columns:n}:{}),{bounds:"full",align:"each"})}}function isFalseOrNull(e){return e===!1||e===null}const AXIS_COMPONENT_PROPERTIES_INDEX=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},COMMON_AXIS_PROPERTIES_INDEX),{labelExpr:1,encode:1}),AXIS_COMPONENT_PROPERTIES=keys$1(AXIS_COMPONENT_PROPERTIES_INDEX);class AxisComponent extends Split{constructor(n={},i={},r=!1){super(),this.explicit=n,this.implicit=i,this.mainExtracted=r}clone(){return new AxisComponent(duplicate(this.explicit),duplicate(this.implicit),this.mainExtracted)}hasAxisPart(n){return n==="axis"?!0:n==="grid"||n==="title"?!!this.get(n):!isFalseOrNull(this.get(n))}hasOrientSignalRef(){return isSignalRef(this.explicit.orient)}}function labels(e,n,i){var r;const{encoding:s,config:o}=e,l=(r=getFieldOrDatumDef(s[n]))!==null&&r!==void 0?r:getFieldOrDatumDef(s[getSecondaryRangeChannel(n)]),f=e.axis(n)||{},{format:d,formatType:p}=f;if(isCustomFormatType(p))return Object.assign({text:formatCustomType({fieldOrDatumDef:l,field:"datum.value",format:d,formatType:p,config:o})},i);if(d===void 0&&p===void 0&&o.customFormatTypes){if(channelDefType(l)==="quantitative"){if(isPositionFieldOrDatumDef(l)&&l.stack==="normalize"&&o.normalizedNumberFormatType)return Object.assign({text:formatCustomType({fieldOrDatumDef:l,field:"datum.value",format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,config:o})},i);if(o.numberFormatType)return Object.assign({text:formatCustomType({fieldOrDatumDef:l,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o})},i)}if(channelDefType(l)==="temporal"&&o.timeFormatType&&isFieldDef(l)&&!l.timeUnit)return Object.assign({text:formatCustomType({fieldOrDatumDef:l,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o})},i)}return i}function parseUnitAxes(e){return POSITION_SCALE_CHANNELS.reduce((n,i)=>(e.component.scales[i]&&(n[i]=[parseAxis(i,e)]),n),{})}const OPPOSITE_ORIENT={bottom:"top",top:"bottom",left:"right",right:"left"};function parseLayerAxes(e){var n;const{axes:i,resolve:r}=e.component,s={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const l of keys$1(o.component.axes))r.axis[l]=parseGuideResolve(e.component.resolve,l),r.axis[l]==="shared"&&(i[l]=mergeAxisComponents(i[l],o.component.axes[l]),i[l]||(r.axis[l]="independent",delete i[l]))}for(const o of POSITION_SCALE_CHANNELS){for(const l of e.children)if(l.component.axes[o]){if(r.axis[o]==="independent"){i[o]=((n=i[o])!==null&&n!==void 0?n:[]).concat(l.component.axes[o]);for(const f of l.component.axes[o]){const{value:d,explicit:p}=f.getWithExplicit("orient");if(!isSignalRef(d)){if(s[d]>0&&!p){const g=OPPOSITE_ORIENT[d];s[d]>s[g]&&f.set("orient",g,!1)}s[d]++}}}delete l.component.axes[o]}if(r.axis[o]==="independent"&&i[o]&&i[o].length>1)for(const l of i[o])l.get("grid")&&!l.explicit.grid&&(l.implicit.grid=!1)}}function mergeAxisComponents(e,n){if(e){if(e.length!==n.length)return;const i=e.length;for(let r=0;r<i;r++){const s=e[r],o=n[r];if(!!s!=!!o)return;if(s&&o){const l=s.getWithExplicit("orient"),f=o.getWithExplicit("orient");if(l.explicit&&f.explicit&&l.value!==f.value)return;e[r]=mergeAxisComponent(s,o)}}}else return n.map(i=>i.clone());return e}function mergeAxisComponent(e,n){for(const i of AXIS_COMPONENT_PROPERTIES){const r=mergeValuesWithExplicit(e.getWithExplicit(i),n.getWithExplicit(i),i,"axis",(s,o)=>{switch(i){case"title":return mergeTitleComponent(s,o);case"gridScale":return{explicit:s.explicit,value:getFirstDefined(s.value,o.value)}}return defaultTieBreaker(s,o,i,"axis")});e.setWithExplicit(i,r)}return e}function isExplicit(e,n,i,r,s){if(n==="disable")return i!==void 0;switch(i=i||{},n){case"titleAngle":case"labelAngle":return e===(isSignalRef(i.labelAngle)?i.labelAngle:normalizeAngle(i.labelAngle));case"values":return!!i.values;case"encode":return!!i.encoding||!!i.labelAngle;case"title":if(e===getFieldDefTitle(r,s))return!0}return e===i[n]}const propsToAlwaysIncludeConfig=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function parseAxis(e,n){var i,r,s;let o=n.axis(e);const l=new AxisComponent,f=getFieldOrDatumDef(n.encoding[e]),{mark:d,config:p}=n,g=(o==null?void 0:o.orient)||((i=p[e==="x"?"axisX":"axisY"])===null||i===void 0?void 0:i.orient)||((r=p.axis)===null||r===void 0?void 0:r.orient)||defaultOrient(e),v=n.getScaleComponent(e).get("type"),S=getAxisConfigs(e,v,g,n.config),T=o!==void 0?!o:getAxisConfig("disable",p.style,o==null?void 0:o.style,S).configValue;if(l.set("disable",T,o!==void 0),T)return l;o=o||{};const k=getLabelAngle(f,o,e,p.style,S),O={fieldOrDatumDef:f,axis:o,channel:e,model:n,scaleType:v,orient:g,labelAngle:k,mark:d,config:p};for(const F of AXIS_COMPONENT_PROPERTIES){const I=F in axisRules?axisRules[F](O):isAxisProperty(F)?o[F]:void 0,L=I!==void 0,N=isExplicit(I,F,o,n,e);if(L&&N)l.set(F,I,N);else{const{configValue:j=void 0,configFrom:z=void 0}=isAxisProperty(F)&&F!=="values"?getAxisConfig(F,p.style,o.style,S):{},q=j!==void 0;L&&!q?l.set(F,I,N):(z!=="vgAxisConfig"||propsToAlwaysIncludeConfig.has(F)&&q||isConditionalAxisValue(j)||isSignalRef(j))&&l.set(F,j,!1)}}const R=(s=o.encoding)!==null&&s!==void 0?s:{},P=AXIS_PARTS.reduce((F,I)=>{var L;if(!l.hasAxisPart(I))return F;const N=guideEncodeEntry((L=R[I])!==null&&L!==void 0?L:{},n),j=I==="labels"?labels(n,e,N):N;return j!==void 0&&!isEmpty(j)&&(F[I]={update:j}),F},{});return isEmpty(P)||l.set("encode",P,!!o.encoding||o.labelAngle!==void 0),l}function initLayoutSize({encoding:e,size:n}){for(const i of POSITION_SCALE_CHANNELS){const r=getSizeChannel(i);isStep(n[r])&&isContinuousFieldOrDatumDef(e[i])&&(delete n[r],warn(stepDropped(r)))}return n}function initMarkdef(e,n,i){const r=replaceExprRef(e),s=getMarkPropOrConfig("orient",r,i);if(r.orient=orient(r.type,n,s),s!==void 0&&s!==r.orient&&warn(orientOverridden(r.orient,s)),r.type==="bar"&&r.orient){const f=getMarkPropOrConfig("cornerRadiusEnd",r,i);if(f!==void 0){const d=r.orient==="horizontal"&&n.x2||r.orient==="vertical"&&n.y2?["cornerRadius"]:BAR_CORNER_RADIUS_INDEX[r.orient];for(const p of d)r[p]=f;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}return getMarkPropOrConfig("opacity",r,i)===void 0&&(r.opacity=opacity(r.type,n)),getMarkPropOrConfig("cursor",r,i)===void 0&&(r.cursor=cursor(r,n,i)),r}function cursor(e,n,i){return n.href||e.href||getMarkPropOrConfig("href",e,i)?"pointer":e.cursor}function opacity(e,n){if(contains([POINT,TICK,CIRCLE,SQUARE],e)&&!isAggregate$1(n))return .7}function defaultFilled(e,n,{graticule:i}){if(i)return!1;const r=getMarkConfig("filled",e,n),s=e.type;return getFirstDefined(r,s!==POINT&&s!==LINE&&s!==RULE)}function orient(e,n,i){switch(e){case POINT:case CIRCLE:case SQUARE:case TEXT:case RECT:case IMAGE:return}const{x:r,y:s,x2:o,y2:l}=n;switch(e){case BAR:if(isFieldDef(r)&&(isBinned(r.bin)||isFieldDef(s)&&s.aggregate&&!r.aggregate))return"vertical";if(isFieldDef(s)&&(isBinned(s.bin)||isFieldDef(r)&&r.aggregate&&!s.aggregate))return"horizontal";if(l||o){if(i)return i;if(!o)return(isFieldDef(r)&&r.type===QUANTITATIVE&&!isBinning(r.bin)||isNumericDataDef(r))&&isFieldDef(s)&&isBinned(s.bin)?"horizontal":"vertical";if(!l)return(isFieldDef(s)&&s.type===QUANTITATIVE&&!isBinning(s.bin)||isNumericDataDef(s))&&isFieldDef(r)&&isBinned(r.bin)?"vertical":"horizontal"}case RULE:if(o&&!(isFieldDef(r)&&isBinned(r.bin))&&l&&!(isFieldDef(s)&&isBinned(s.bin)))return;case AREA:if(l)return isFieldDef(s)&&isBinned(s.bin)?"horizontal":"vertical";if(o)return isFieldDef(r)&&isBinned(r.bin)?"vertical":"horizontal";if(e===RULE){if(r&&!s)return"vertical";if(s&&!r)return"horizontal"}case LINE:case TICK:{const f=isContinuousFieldOrDatumDef(r),d=isContinuousFieldOrDatumDef(s);if(i)return i;if(f&&!d)return e!=="tick"?"horizontal":"vertical";if(!f&&d)return e!=="tick"?"vertical":"horizontal";if(f&&d){const p=r,g=s,v=p.type===TEMPORAL,S=g.type===TEMPORAL;return v&&!S?e!=="tick"?"vertical":"horizontal":!v&&S?e!=="tick"?"horizontal":"vertical":!p.aggregate&&g.aggregate?e!=="tick"?"vertical":"horizontal":p.aggregate&&!g.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const arc={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),pointPosition("x",e,{defaultPos:"mid"})),pointPosition("y",e,{defaultPos:"mid"})),rectPosition(e,"radius")),rectPosition(e,"theta"))},area={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),pointOrRangePosition("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),pointOrRangePosition("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),defined(e))},bar={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),rectPosition(e,"x")),rectPosition(e,"y"))},geoshape={vgMark:"shape",encodeEntry:e=>Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:n}=e,i=n.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},i&&isFieldDef(i)&&i.type===GEOJSON?{field:vgField(i,{expr:"datum"})}:{})]}},image={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),rectPosition(e,"x")),rectPosition(e,"y")),text$1(e,"url"))},line={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),pointPosition("x",e,{defaultPos:"mid"})),pointPosition("y",e,{defaultPos:"mid"})),nonPosition("size",e,{vgChannel:"strokeWidth"})),defined(e))},trail={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),pointPosition("x",e,{defaultPos:"mid"})),pointPosition("y",e,{defaultPos:"mid"})),nonPosition("size",e)),defined(e))};function encodeEntry(e,n){const{config:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),pointPosition("x",e,{defaultPos:"mid"})),pointPosition("y",e,{defaultPos:"mid"})),nonPosition("size",e)),nonPosition("angle",e)),shapeMixins(e,i,n))}function shapeMixins(e,n,i){return i?{shape:{value:i}}:nonPosition("shape",e)}const point={vgMark:"symbol",encodeEntry:e=>encodeEntry(e)},circle={vgMark:"symbol",encodeEntry:e=>encodeEntry(e,"circle")},square={vgMark:"symbol",encodeEntry:e=>encodeEntry(e,"square")},rect={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),rectPosition(e,"x")),rectPosition(e,"y"))},rule={vgMark:"rule",encodeEntry:e=>{const{markDef:n}=e,i=n.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),pointOrRangePosition("x",e,{defaultPos:i==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:i!=="vertical"})),pointOrRangePosition("y",e,{defaultPos:i==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:i!=="horizontal"})),nonPosition("size",e,{vgChannel:"strokeWidth"}))}},text={vgMark:"text",encodeEntry:e=>{const{config:n,encoding:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),pointPosition("x",e,{defaultPos:"mid"})),pointPosition("y",e,{defaultPos:"mid"})),text$1(e)),nonPosition("size",e,{vgChannel:"fontSize"})),nonPosition("angle",e)),valueIfDefined("align",align(e.markDef,i,n))),valueIfDefined("baseline",baseline(e.markDef,i,n))),pointPosition("radius",e,{defaultPos:null})),pointPosition("theta",e,{defaultPos:null}))}};function align(e,n,i){if(getMarkPropOrConfig("align",e,i)===void 0)return"center"}function baseline(e,n,i){if(getMarkPropOrConfig("baseline",e,i)===void 0)return"middle"}const tick={vgMark:"rect",encodeEntry:e=>{const{config:n,markDef:i}=e,r=i.orient,s=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),pointPosition("x",e,{defaultPos:"mid",vgChannel:"xc"})),pointPosition("y",e,{defaultPos:"mid",vgChannel:"yc"})),nonPosition("size",e,{defaultValue:defaultSize(e),vgChannel:s})),{[o]:signalOrValueRef(getMarkPropOrConfig("thickness",i,n))})}};function defaultSize(e){var n;const{config:i,markDef:r}=e,{orient:s}=r,o=s==="horizontal"?"width":"height",l=e.getScaleComponent(s==="horizontal"?"x":"y"),f=(n=getMarkPropOrConfig("size",r,i,{vgChannel:o}))!==null&&n!==void 0?n:i.tick.bandSize;if(f!==void 0)return f;{const d=l?l.get("range"):void 0;return d&&isVgRangeStep(d)&&isNumber$1(d.step)?d.step*3/4:getViewConfigDiscreteStep(i.view,o)*3/4}}const markCompiler={arc,area,bar,circle,geoshape,image,line,point,rect,rule,square,text,tick,trail};function parseMarkGroups(e){if(contains([LINE,AREA,TRAIL],e.mark)){const n=pathGroupingFields(e.mark,e.encoding);if(n.length>0)return getPathGroups(e,n)}else if(e.mark===BAR){const n=VG_CORNERRADIUS_CHANNELS.some(i=>getMarkPropOrConfig(i,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&n)return getGroupsForStackedBarWithCornerRadius(e)}return getMarkGroup(e)}const FACETED_PATH_PREFIX="faceted_path_";function getPathGroups(e,n){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:FACETED_PATH_PREFIX+e.requestDataName(DataSourceType.Main),data:e.requestDataName(DataSourceType.Main),groupby:n}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:getMarkGroup(e,{fromPrefix:FACETED_PATH_PREFIX})}]}const STACK_GROUP_PREFIX="stack_group_";function getGroupsForStackedBarWithCornerRadius(e){var n;const[i]=getMarkGroup(e,{fromPrefix:STACK_GROUP_PREFIX}),r=e.scaleName(e.stack.fieldChannel),s=(g={})=>e.vgField(e.stack.fieldChannel,g),o=(g,v)=>{const S=[s({prefix:"min",suffix:"start",expr:v}),s({prefix:"max",suffix:"start",expr:v}),s({prefix:"min",suffix:"end",expr:v}),s({prefix:"max",suffix:"end",expr:v})];return`${g}(${S.map(T=>`scale('${r}',${T})`).join(",")})`};let l,f;e.stack.fieldChannel==="x"?(l=Object.assign(Object.assign({},pick(i.encode.update,["y","yc","y2","height",...VG_CORNERRADIUS_CHANNELS])),{x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}}),f={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},i.encode.update=Object.assign(Object.assign({},omit(i.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(l=Object.assign(Object.assign({},pick(i.encode.update,["x","xc","x2","width"])),{y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}}),f={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},i.encode.update=Object.assign(Object.assign({},omit(i.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const g of VG_CORNERRADIUS_CHANNELS){const v=getMarkConfig(g,e.markDef,e.config);i.encode.update[g]?(l[g]=i.encode.update[g],delete i.encode.update[g]):v&&(l[g]=signalOrValueRef(v)),v&&(i.encode.update[g]={value:0})}const d=[];if(((n=e.stack.groupbyChannels)===null||n===void 0?void 0:n.length)>0)for(const g of e.stack.groupbyChannels){const v=e.fieldDef(g),S=vgField(v);S&&d.push(S),(v!=null&&v.bin||v!=null&&v.timeUnit)&&d.push(vgField(v,{binSuffix:"end"}))}return l=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((g,v)=>{if(i.encode.update[v])return Object.assign(Object.assign({},g),{[v]:i.encode.update[v]});{const S=getMarkConfig(v,e.markDef,e.config);return S!==void 0?Object.assign(Object.assign({},g),{[v]:signalOrValueRef(S)}):g}},l),l.stroke&&(l.strokeForeground={value:!0},l.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(DataSourceType.Main),name:STACK_GROUP_PREFIX+e.requestDataName(DataSourceType.Main),groupby:d,aggregate:{fields:[s({suffix:"start"}),s({suffix:"start"}),s({suffix:"end"}),s({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:l},marks:[{type:"group",encode:{update:f},marks:[i]}]}]}function getSort(e){var n;const{encoding:i,stack:r,mark:s,markDef:o,config:l}=e,f=i.order;if(!(!isArray(f)&&isValueDef(f)&&isNullOrFalse(f.value)||!f&&isNullOrFalse(getMarkPropOrConfig("order",o,l)))){if((isArray(f)||isFieldDef(f))&&!r)return sortParams(f,{expr:"datum"});if(isPathMark(s)){const d=o.orient==="horizontal"?"y":"x",p=i[d];if(isFieldDef(p)){const g=p.sort;if(isArray(g))return{field:vgField(p,{prefix:d,suffix:"sort_index",expr:"datum"})};if(isSortField(g))return{field:vgField({aggregate:isAggregate$1(e.encoding)?g.op:void 0,field:g.field},{expr:"datum"})};if(isSortByEncoding(g)){const v=e.fieldDef(g.encoding);return{field:vgField(v,{expr:"datum"}),order:g.order}}else return g===null?void 0:{field:vgField(p,{binSuffix:!((n=e.stack)===null||n===void 0)&&n.impute?"mid":void 0,expr:"datum"})}}return}}}function getMarkGroup(e,n={fromPrefix:""}){const{mark:i,markDef:r,encoding:s,config:o}=e,l=getFirstDefined(r.clip,scaleClip(e),projectionClip(e)),f=getStyles(r),d=s.key,p=getSort(e),g=interactiveFlag(e),v=getMarkPropOrConfig("aria",r,o),S=markCompiler[i].postEncodingTransform?markCompiler[i].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:markCompiler[i].vgMark},l?{clip:!0}:{}),f?{style:f}:{}),d?{key:d.field}:{}),p?{sort:p}:{}),g||{}),v===!1?{aria:v}:{}),{from:{data:n.fromPrefix+e.requestDataName(DataSourceType.Main)},encode:{update:markCompiler[i].encodeEntry(e)}}),S?{transform:S}:{})]}function scaleClip(e){const n=e.getScaleComponent("x"),i=e.getScaleComponent("y");return n!=null&&n.get("selectionExtent")||i!=null&&i.get("selectionExtent")?!0:void 0}function projectionClip(e){const n=e.component.projection;return n&&!n.isFit?!0:void 0}function interactiveFlag(e){if(!e.component.selection)return null;const n=keys$1(e.component.selection).length;let i=n,r=e.parent;for(;r&&i===0;)i=keys$1(r.component.selection).length,r=r.parent;return i?{interactive:n>0||!!e.encoding.tooltip}:null}class UnitModel extends ModelWithField{constructor(n,i,r,s={},o){var l;super(n,"unit",i,r,o,void 0,isFrameMixins(n)?n.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const f=isMarkDef(n.mark)?Object.assign({},n.mark):{type:n.mark},d=f.type;f.filled===void 0&&(f.filled=defaultFilled(f,o,{graticule:n.data&&isGraticuleGenerator(n.data)}));const p=this.encoding=initEncoding(n.encoding||{},d,f.filled,o);this.markDef=initMarkdef(f,p,o),this.size=initLayoutSize({encoding:p,size:isFrameMixins(n)?Object.assign(Object.assign(Object.assign({},s),n.width?{width:n.width}:{}),n.height?{height:n.height}:{}):s}),this.stack=stack(d,p),this.specifiedScales=this.initScales(d,p),this.specifiedAxes=this.initAxes(p),this.specifiedLegends=this.initLegends(p),this.specifiedProjection=n.projection,this.selection=((l=n.params)!==null&&l!==void 0?l:[]).filter(g=>isSelectionParameter(g))}get hasProjection(){const{encoding:n}=this,i=this.mark===GEOSHAPE,r=n&&GEOPOSITION_CHANNELS.some(s=>isFieldOrDatumDef(n[s]));return i||r}scaleDomain(n){const i=this.specifiedScales[n];return i?i.domain:void 0}axis(n){return this.specifiedAxes[n]}legend(n){return this.specifiedLegends[n]}initScales(n,i){return SCALE_CHANNELS.reduce((r,s)=>{var o;const l=getFieldOrDatumDef(i[s]);return l&&(r[s]=this.initScale((o=l.scale)!==null&&o!==void 0?o:{})),r},{})}initScale(n){const{domain:i,range:r}=n,s=replaceExprRef(n);return isArray(i)&&(s.domain=i.map(signalRefOrValue)),isArray(r)&&(s.range=r.map(signalRefOrValue)),s}initAxes(n){return POSITION_SCALE_CHANNELS.reduce((i,r)=>{const s=n[r];if(isFieldOrDatumDef(s)||r===X&&isFieldOrDatumDef(n.x2)||r===Y&&isFieldOrDatumDef(n.y2)){const o=isFieldOrDatumDef(s)?s.axis:void 0;i[r]=o&&this.initAxis(Object.assign({},o))}return i},{})}initAxis(n){const i=keys$1(n),r={};for(const s of i){const o=n[s];r[s]=isConditionalAxisValue(o)?signalOrValueRefWithCondition(o):signalRefOrValue(o)}return r}initLegends(n){return NONPOSITION_SCALE_CHANNELS.reduce((i,r)=>{const s=getFieldOrDatumDef(n[r]);if(s&&supportLegend(r)){const o=s.legend;i[r]=o&&replaceExprRef(o)}return i},{})}parseData(){this.component.data=parseData(this)}parseLayoutSize(){parseUnitLayoutSize(this)}parseSelections(){this.component.selection=parseUnitSelection(this,this.selection)}parseMarkGroup(){this.component.mark=parseMarkGroups(this)}parseAxesAndHeaders(){this.component.axes=parseUnitAxes(this)}assembleSelectionTopLevelSignals(n){return assembleTopLevelSignals(this,n)}assembleSignals(){return[...assembleAxisSignals(this),...assembleUnitSelectionSignals(this,[])]}assembleSelectionData(n){return assembleUnitSelectionData(this,n)}assembleLayout(){return null}assembleLayoutSignals(){return assembleLayoutSignals(this)}assembleMarks(){var n;let i=(n=this.component.mark)!==null&&n!==void 0?n:[];return(!this.parent||!isLayerModel(this.parent))&&(i=assembleUnitSelectionMarks(this,i)),i.map(this.correctDataNames)}assembleGroupStyle(){const{style:n}=this.view||{};if(n!==void 0)return n;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(n){return channelHasField(this.encoding,n)}fieldDef(n){const i=this.encoding[n];return getFieldDef(i)}typedFieldDef(n){const i=this.fieldDef(n);return isTypedFieldDef(i)?i:null}}class LayerModel extends Model{constructor(n,i,r,s,o){super(n,"layer",i,r,o,n.resolve,n.view);const l=Object.assign(Object.assign(Object.assign({},s),n.width?{width:n.width}:{}),n.height?{height:n.height}:{});this.children=n.layer.map((f,d)=>{if(isLayerSpec(f))return new LayerModel(f,this,this.getName(`layer_${d}`),l,o);if(isUnitSpec(f))return new UnitModel(f,this,this.getName(`layer_${d}`),l,o);throw new Error(invalidSpec(f))})}parseData(){this.component.data=parseData(this);for(const n of this.children)n.parseData()}parseLayoutSize(){parseLayerLayoutSize(this)}parseSelections(){this.component.selection={};for(const n of this.children){n.parseSelections();for(const i of keys$1(n.component.selection))this.component.selection[i]=n.component.selection[i]}}parseMarkGroup(){for(const n of this.children)n.parseMarkGroup()}parseAxesAndHeaders(){parseLayerAxes(this)}assembleSelectionTopLevelSignals(n){return this.children.reduce((i,r)=>r.assembleSelectionTopLevelSignals(i),n)}assembleSignals(){return this.children.reduce((n,i)=>n.concat(i.assembleSignals()),assembleAxisSignals(this))}assembleLayoutSignals(){return this.children.reduce((n,i)=>n.concat(i.assembleLayoutSignals()),assembleLayoutSignals(this))}assembleSelectionData(n){return this.children.reduce((i,r)=>r.assembleSelectionData(i),n)}assembleGroupStyle(){const n=new Set;for(const r of this.children)for(const s of array$5(r.assembleGroupStyle()))n.add(s);const i=Array.from(n);return i.length>1?i:i.length===1?i[0]:void 0}assembleTitle(){let n=super.assembleTitle();if(n)return n;for(const i of this.children)if(n=i.assembleTitle(),n)return n}assembleLayout(){return null}assembleMarks(){return assembleLayerSelectionMarks(this,this.children.flatMap(n=>n.assembleMarks()))}assembleLegends(){return this.children.reduce((n,i)=>n.concat(i.assembleLegends()),assembleLegends(this))}}function buildModel(e,n,i,r,s){if(isFacetSpec(e))return new FacetModel(e,n,i,s);if(isLayerSpec(e))return new LayerModel(e,n,i,r,s);if(isUnitSpec(e))return new UnitModel(e,n,i,r,s);if(isAnyConcatSpec(e))return new ConcatModel(e,n,i,s);throw new Error(invalidSpec(e))}var __rest=globalThis&&globalThis.__rest||function(e,n){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};function compile(e,n={}){n.logger&&set(n.logger),n.fieldTitle&&setTitleFormatter(n.fieldTitle);try{const i=initConfig(mergeConfig(n.config,e.config)),r=normalize(e,i),s=buildModel(r,null,"",void 0,i);return s.parse(),optimizeDataflow(s.component.data,s),{spec:assembleTopLevelModel(s,getTopLevelProperties(e,r.autosize,i,s),e.datasets,e.usermeta),normalized:r}}finally{n.logger&&reset(),n.fieldTitle&&resetTitleFormatter()}}function getTopLevelProperties(e,n,i,r){const s=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(n===void 0?(n={type:"pad"},r.hasAxisOrientSignalRef()&&(n.resize=!0)):isString(n)&&(n={type:n}),s&&o&&isFitType(n.type)){if(s==="step"&&o==="step")warn(droppingFit()),n.type="pad";else if(s==="step"||o==="step"){const l=s==="step"?"width":"height";warn(droppingFit(getPositionScaleChannel(l)));const f=l==="width"?"height":"width";n.type=getFitType(f)}}return Object.assign(Object.assign(Object.assign({},keys$1(n).length===1&&n.type?n.type==="pad"?{}:{autosize:n.type}:{autosize:n}),extractTopLevelProperties(i,!1)),extractTopLevelProperties(e,!0))}function assembleTopLevelModel(e,n,i={},r){const s=e.config?stripAndRedirectConfig(e.config):void 0,o=[].concat(e.assembleSelectionData([]),assembleRootData(e.component.data,i)),l=e.assembleProjections(),f=e.assembleTitle(),d=e.assembleGroupStyle(),p=e.assembleGroupEncodeEntry(!0);let g=e.assembleLayoutSignals();g=g.filter(T=>(T.name==="width"||T.name==="height")&&T.value!==void 0?(n[T.name]=+T.value,!1):!0);const{params:v}=n,S=__rest(n,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),S),f?{title:f}:{}),d?{style:d}:{}),p?{encode:{update:p}}:{}),{data:o}),l.length>0?{projections:l}:{}),e.assembleGroup([...g,...e.assembleSelectionTopLevelSignals([]),...assembleParameterSignals(v)])),s?{config:s}:{}),r?{usermeta:r}:{})}const version=pkg.version,vegaLiteImport=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth,accessPathWithDatum,compile,contains,deepEqual,deleteNestedProperty,duplicate,entries:entries$1,every,fieldIntersection,flatAccessWithDatum,getFirstDefined,hasIntersection,hash,internalField,isBoolean,isEmpty,isEqual,isInternalField,isNullOrFalse,isNumeric,keys:keys$1,logicalExpr,mergeDeep,never,normalize,normalizeAngle,omit,pick,prefixGenerator,removePathFromField,replaceAll,replacePathInField,resetIdCounter,setEqual,some,stringify,titleCase,unique,uniqueId,vals,varName,version},Symbol.toStringTag,{value:"Module"}));var Op=Object.prototype,hasOwn=Op.hasOwnProperty,undefined$1,$Symbol=typeof Symbol=="function"?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function wrap(e,n,i,r){var s=n&&n.prototype instanceof Generator?n:Generator,o=Object.create(s.prototype),l=new Context(r||[]);return o._invoke=makeInvokeMethod(e,i,l),o}function tryCatch(e,n,i){try{return{type:"normal",arg:e.call(n,i)}}catch(r){return{type:"throw",arg:r}}}var GenStateSuspendedStart="suspendedStart",GenStateSuspendedYield="suspendedYield",GenStateExecuting="executing",GenStateCompleted="completed",ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(e){["next","throw","return"].forEach(function(n){e[n]=function(i){return this._invoke(n,i)}})}function isGeneratorFunction(e){var n=typeof e=="function"&&e.constructor;return n?n===GeneratorFunction||(n.displayName||n.name)==="GeneratorFunction":!1}function mark(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,toStringTagSymbol in e||(e[toStringTagSymbol]="GeneratorFunction")),e.prototype=Object.create(Gp),e}function awrap(e){return{__await:e}}function AsyncIterator(e,n){function i(o,l,f,d){var p=tryCatch(e[o],e,l);if(p.type==="throw")d(p.arg);else{var g=p.arg,v=g.value;return v&&typeof v=="object"&&hasOwn.call(v,"__await")?n.resolve(v.__await).then(function(S){i("next",S,f,d)},function(S){i("throw",S,f,d)}):n.resolve(v).then(function(S){g.value=S,f(g)},function(S){return i("throw",S,f,d)})}}var r;function s(o,l){function f(){return new n(function(d,p){i(o,l,d,p)})}return r=r?r.then(f,f):f()}this._invoke=s}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};function async(e,n,i,r,s){s===void 0&&(s=Promise);var o=new AsyncIterator(wrap(e,n,i,r),s);return isGeneratorFunction(n)?o:o.next().then(function(l){return l.done?l.value:o.next()})}function makeInvokeMethod(e,n,i){var r=GenStateSuspendedStart;return function(o,l){if(r===GenStateExecuting)throw new Error("Generator is already running");if(r===GenStateCompleted){if(o==="throw")throw l;return doneResult()}for(i.method=o,i.arg=l;;){var f=i.delegate;if(f){var d=maybeInvokeDelegate(f,i);if(d){if(d===ContinueSentinel)continue;return d}}if(i.method==="next")i.sent=i._sent=i.arg;else if(i.method==="throw"){if(r===GenStateSuspendedStart)throw r=GenStateCompleted,i.arg;i.dispatchException(i.arg)}else i.method==="return"&&i.abrupt("return",i.arg);r=GenStateExecuting;var p=tryCatch(e,n,i);if(p.type==="normal"){if(r=i.done?GenStateCompleted:GenStateSuspendedYield,p.arg===ContinueSentinel)continue;return{value:p.arg,done:i.done}}else p.type==="throw"&&(r=GenStateCompleted,i.method="throw",i.arg=p.arg)}}}function maybeInvokeDelegate(e,n){var i=e.iterator[n.method];if(i===undefined$1){if(n.delegate=null,n.method==="throw"){if(e.iterator.return&&(n.method="return",n.arg=undefined$1,maybeInvokeDelegate(e,n),n.method==="throw"))return ContinueSentinel;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var r=tryCatch(i,e.iterator,n.arg);if(r.type==="throw")return n.method="throw",n.arg=r.arg,n.delegate=null,ContinueSentinel;var s=r.arg;if(!s)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,ContinueSentinel;if(s.done)n[e.resultName]=s.value,n.next=e.nextLoc,n.method!=="return"&&(n.method="next",n.arg=undefined$1);else return s;return n.delegate=null,ContinueSentinel}defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function resetTryEntry(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function keys(e){var n=[];for(var i in e)n.push(i);return n.reverse(),function r(){for(;n.length;){var s=n.pop();if(s in e)return r.value=s,r.done=!1,r}return r.done=!0,r}}function values(e){if(e){var n=e[iteratorSymbol];if(n)return n.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var i=-1,r=function s(){for(;++i<e.length;)if(hasOwn.call(e,i))return s.value=e[i],s.done=!1,s;return s.value=undefined$1,s.done=!0,s};return r.next=r}}return{next:doneResult}}function doneResult(){return{value:undefined$1,done:!0}}Context.prototype={constructor:Context,reset:function e(n){if(this.prev=0,this.next=0,this.sent=this._sent=undefined$1,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined$1,this.tryEntries.forEach(resetTryEntry),!n)for(var i in this)i.charAt(0)==="t"&&hasOwn.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=undefined$1)},stop:function e(){this.done=!0;var n=this.tryEntries[0],i=n.completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function e(n){if(this.done)throw n;var i=this;function r(p,g){return l.type="throw",l.arg=n,i.next=p,g&&(i.method="next",i.arg=undefined$1),!!g}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],l=o.completion;if(o.tryLoc==="root")return r("end");if(o.tryLoc<=this.prev){var f=hasOwn.call(o,"catchLoc"),d=hasOwn.call(o,"finallyLoc");if(f&&d){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(f){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else if(d){if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function e(n,i){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&hasOwn.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&(n==="break"||n==="continue")&&o.tryLoc<=i&&i<=o.finallyLoc&&(o=null);var l=o?o.completion:{};return l.type=n,l.arg=i,o?(this.method="next",this.next=o.finallyLoc,ContinueSentinel):this.complete(l)},complete:function e(n,i){if(n.type==="throw")throw n.arg;return n.type==="break"||n.type==="continue"?this.next=n.arg:n.type==="return"?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):n.type==="normal"&&i&&(this.next=i),ContinueSentinel},finish:function e(n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.finallyLoc===n)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),ContinueSentinel}},catch:function e(n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc===n){var s=r.completion;if(s.type==="throw"){var o=s.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function e(n,i,r){return this.delegate={iterator:values(n),resultName:i,nextLoc:r},this.method==="next"&&(this.arg=undefined$1),ContinueSentinel}};var _regeneratorRuntime={wrap,isGeneratorFunction,AsyncIterator,mark,awrap,async,keys,values},yallist=Yallist$1;Yallist$1.Node=Node;Yallist$1.create=Yallist$1;function Yallist$1(e){var n=this;if(n instanceof Yallist$1||(n=new Yallist$1),n.tail=null,n.head=null,n.length=0,e&&typeof e.forEach=="function")e.forEach(function(s){n.push(s)});else if(arguments.length>0)for(var i=0,r=arguments.length;i<r;i++)n.push(arguments[i]);return n}Yallist$1.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var n=e.next,i=e.prev;return n&&(n.prev=i),i&&(i.next=n),e===this.head&&(this.head=n),e===this.tail&&(this.tail=i),e.list.length--,e.next=null,e.prev=null,e.list=null,n};Yallist$1.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var n=this.head;e.list=this,e.next=n,n&&(n.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};Yallist$1.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var n=this.tail;e.list=this,e.prev=n,n&&(n.next=e),this.tail=e,this.head||(this.head=e),this.length++}};Yallist$1.prototype.push=function(){for(var e=0,n=arguments.length;e<n;e++)push(this,arguments[e]);return this.length};Yallist$1.prototype.unshift=function(){for(var e=0,n=arguments.length;e<n;e++)unshift(this,arguments[e]);return this.length};Yallist$1.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};Yallist$1.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};Yallist$1.prototype.forEach=function(e,n){n=n||this;for(var i=this.head,r=0;i!==null;r++)e.call(n,i.value,r,this),i=i.next};Yallist$1.prototype.forEachReverse=function(e,n){n=n||this;for(var i=this.tail,r=this.length-1;i!==null;r--)e.call(n,i.value,r,this),i=i.prev};Yallist$1.prototype.get=function(e){for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;if(n===e&&i!==null)return i.value};Yallist$1.prototype.getReverse=function(e){for(var n=0,i=this.tail;i!==null&&n<e;n++)i=i.prev;if(n===e&&i!==null)return i.value};Yallist$1.prototype.map=function(e,n){n=n||this;for(var i=new Yallist$1,r=this.head;r!==null;)i.push(e.call(n,r.value,this)),r=r.next;return i};Yallist$1.prototype.mapReverse=function(e,n){n=n||this;for(var i=new Yallist$1,r=this.tail;r!==null;)i.push(e.call(n,r.value,this)),r=r.prev;return i};Yallist$1.prototype.reduce=function(e,n){var i,r=this.head;if(arguments.length>1)i=n;else if(this.head)r=this.head.next,i=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;r!==null;s++)i=e(i,r.value,s),r=r.next;return i};Yallist$1.prototype.reduceReverse=function(e,n){var i,r=this.tail;if(arguments.length>1)i=n;else if(this.tail)r=this.tail.prev,i=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;r!==null;s--)i=e(i,r.value,s),r=r.prev;return i};Yallist$1.prototype.toArray=function(){for(var e=new Array(this.length),n=0,i=this.head;i!==null;n++)e[n]=i.value,i=i.next;return e};Yallist$1.prototype.toArrayReverse=function(){for(var e=new Array(this.length),n=0,i=this.tail;i!==null;n++)e[n]=i.value,i=i.prev;return e};Yallist$1.prototype.slice=function(e,n){n=n||this.length,n<0&&(n+=this.length),e=e||0,e<0&&(e+=this.length);var i=new Yallist$1;if(n<e||n<0)return i;e<0&&(e=0),n>this.length&&(n=this.length);for(var r=0,s=this.head;s!==null&&r<e;r++)s=s.next;for(;s!==null&&r<n;r++,s=s.next)i.push(s.value);return i};Yallist$1.prototype.sliceReverse=function(e,n){n=n||this.length,n<0&&(n+=this.length),e=e||0,e<0&&(e+=this.length);var i=new Yallist$1;if(n<e||n<0)return i;e<0&&(e=0),n>this.length&&(n=this.length);for(var r=this.length,s=this.tail;s!==null&&r>n;r--)s=s.prev;for(;s!==null&&r>e;r--,s=s.prev)i.push(s.value);return i};Yallist$1.prototype.splice=function(e,n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(var s=[],i=0;r&&i<n;i++)s.push(r.value),r=this.removeNode(r);r===null&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(var i=0;i<(arguments.length<=2?0:arguments.length-2);i++)r=insert(this,r,i+2<2||arguments.length<=i+2?void 0:arguments[i+2]);return s};Yallist$1.prototype.reverse=function(){for(var e=this.head,n=this.tail,i=e;i!==null;i=i.prev){var r=i.prev;i.prev=i.next,i.next=r}return this.head=n,this.tail=e,this};function insert(e,n,i){var r=n===e.head?new Node(i,null,n,e):new Node(i,n,n.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function push(e,n){e.tail=new Node(n,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function unshift(e,n){e.head=new Node(n,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Node(e,n,i,r){if(!(this instanceof Node))return new Node(e,n,i,r);this.list=r,this.value=e,n?(n.next=this,this.prev=n):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}try{Yallist$1.prototype[Symbol.iterator]=_regeneratorRuntime.mark(function e(){var n;return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=this.head;case 1:if(!n){r.next=7;break}return r.next=4,n.value;case 4:n=n.next,r.next=1;break;case 7:case"end":return r.stop()}},e,this)})}catch(e){}var Yallist=yallist,MAX=Symbol("max"),LENGTH=Symbol("length"),LENGTH_CALCULATOR=Symbol("lengthCalculator"),ALLOW_STALE=Symbol("allowStale"),MAX_AGE=Symbol("maxAge"),DISPOSE=Symbol("dispose"),NO_DISPOSE_ON_SET=Symbol("noDisposeOnSet"),LRU_LIST=Symbol("lruList"),CACHE=Symbol("cache"),UPDATE_AGE_ON_GET=Symbol("updateAgeOnGet"),naiveLength=()=>1;class LRUCache{constructor(n){if(typeof n=="number"&&(n={max:n}),n||(n={}),n.max&&(typeof n.max!="number"||n.max<0))throw new TypeError("max must be a non-negative number");this[MAX]=n.max||1/0;var i=n.length||naiveLength;if(this[LENGTH_CALCULATOR]=typeof i!="function"?naiveLength:i,this[ALLOW_STALE]=n.stale||!1,n.maxAge&&typeof n.maxAge!="number")throw new TypeError("maxAge must be a number");this[MAX_AGE]=n.maxAge||0,this[DISPOSE]=n.dispose,this[NO_DISPOSE_ON_SET]=n.noDisposeOnSet||!1,this[UPDATE_AGE_ON_GET]=n.updateAgeOnGet||!1,this.reset()}set max(n){if(typeof n!="number"||n<0)throw new TypeError("max must be a non-negative number");this[MAX]=n||1/0,trim(this)}get max(){return this[MAX]}set allowStale(n){this[ALLOW_STALE]=!!n}get allowStale(){return this[ALLOW_STALE]}set maxAge(n){if(typeof n!="number")throw new TypeError("maxAge must be a non-negative number");this[MAX_AGE]=n,trim(this)}get maxAge(){return this[MAX_AGE]}set lengthCalculator(n){typeof n!="function"&&(n=naiveLength),n!==this[LENGTH_CALCULATOR]&&(this[LENGTH_CALCULATOR]=n,this[LENGTH]=0,this[LRU_LIST].forEach(i=>{i.length=this[LENGTH_CALCULATOR](i.value,i.key),this[LENGTH]+=i.length})),trim(this)}get lengthCalculator(){return this[LENGTH_CALCULATOR]}get length(){return this[LENGTH]}get itemCount(){return this[LRU_LIST].length}rforEach(n,i){i=i||this;for(var r=this[LRU_LIST].tail;r!==null;){var s=r.prev;forEachStep(this,n,r,i),r=s}}forEach(n,i){i=i||this;for(var r=this[LRU_LIST].head;r!==null;){var s=r.next;forEachStep(this,n,r,i),r=s}}keys(){return this[LRU_LIST].toArray().map(n=>n.key)}values(){return this[LRU_LIST].toArray().map(n=>n.value)}reset(){this[DISPOSE]&&this[LRU_LIST]&&this[LRU_LIST].length&&this[LRU_LIST].forEach(n=>this[DISPOSE](n.key,n.value)),this[CACHE]=new Map,this[LRU_LIST]=new Yallist,this[LENGTH]=0}dump(){return this[LRU_LIST].map(n=>isStale(this,n)?!1:{k:n.key,v:n.value,e:n.now+(n.maxAge||0)}).toArray().filter(n=>n)}dumpLru(){return this[LRU_LIST]}set(n,i,r){if(r=r||this[MAX_AGE],r&&typeof r!="number")throw new TypeError("maxAge must be a number");var s=r?Date.now():0,o=this[LENGTH_CALCULATOR](i,n);if(this[CACHE].has(n)){if(o>this[MAX])return del(this,this[CACHE].get(n)),!1;var l=this[CACHE].get(n),f=l.value;return this[DISPOSE]&&(this[NO_DISPOSE_ON_SET]||this[DISPOSE](n,f.value)),f.now=s,f.maxAge=r,f.value=i,this[LENGTH]+=o-f.length,f.length=o,this.get(n),trim(this),!0}var d=new Entry(n,i,o,s,r);return d.length>this[MAX]?(this[DISPOSE]&&this[DISPOSE](n,i),!1):(this[LENGTH]+=d.length,this[LRU_LIST].unshift(d),this[CACHE].set(n,this[LRU_LIST].head),trim(this),!0)}has(n){if(!this[CACHE].has(n))return!1;var i=this[CACHE].get(n).value;return!isStale(this,i)}get(n){return get(this,n,!0)}peek(n){return get(this,n,!1)}pop(){var n=this[LRU_LIST].tail;return n?(del(this,n),n.value):null}del(n){del(this,this[CACHE].get(n))}load(n){this.reset();for(var i=Date.now(),r=n.length-1;r>=0;r--){var s=n[r],o=s.e||0;if(o===0)this.set(s.k,s.v);else{var l=o-i;l>0&&this.set(s.k,s.v,l)}}}prune(){this[CACHE].forEach((n,i)=>get(this,i,!1))}}var get=(e,n,i)=>{var r=e[CACHE].get(n);if(r){var s=r.value;if(isStale(e,s)){if(del(e,r),!e[ALLOW_STALE])return}else i&&(e[UPDATE_AGE_ON_GET]&&(r.value.now=Date.now()),e[LRU_LIST].unshiftNode(r));return s.value}},isStale=(e,n)=>{if(!n||!n.maxAge&&!e[MAX_AGE])return!1;var i=Date.now()-n.now;return n.maxAge?i>n.maxAge:e[MAX_AGE]&&i>e[MAX_AGE]},trim=e=>{if(e[LENGTH]>e[MAX])for(var n=e[LRU_LIST].tail;e[LENGTH]>e[MAX]&&n!==null;){var i=n.prev;del(e,n),n=i}},del=(e,n)=>{if(n){var i=n.value;e[DISPOSE]&&e[DISPOSE](i.key,i.value),e[LENGTH]-=i.length,e[CACHE].delete(i.key),e[LRU_LIST].removeNode(n)}};class Entry{constructor(n,i,r,s,o){this.key=n,this.value=i,this.length=r,this.now=s,this.maxAge=o||0}}var forEachStep=(e,n,i,r)=>{var s=i.value;isStale(e,s)&&(del(e,i),e[ALLOW_STALE]||(s=void 0)),s&&n.call(r,s.value,s.key,e)},lruCache=LRUCache,opts=["includePrerelease","loose","rtl"],parseOptions$1=e=>e?typeof e!="object"?{loose:!0}:opts.filter(n=>e[n]).reduce((n,i)=>(n[i]=!0,n),{}):{},parseOptions_1=parseOptions$1,re$1={exports:{}},SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,constants={SEMVER_SPEC_VERSION,MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,MAX_SAFE_COMPONENT_LENGTH},debug$1=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return console.error("SEMVER",...n)}:()=>{},debug_1=debug$1;(function(e,n){var i=constants.MAX_SAFE_COMPONENT_LENGTH,r=debug_1;n=e.exports={};var s=n.re=[],o=n.src=[],l=n.t={},f=0,d=(p,g,v)=>{var S=f++;r(p,S,g),l[p]=S,o[S]=g,s[S]=new RegExp(g,v?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","[0-9]+"),d("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),d("MAINVERSION","(".concat(o[l.NUMERICIDENTIFIER],")\\.")+"(".concat(o[l.NUMERICIDENTIFIER],")\\.")+"(".concat(o[l.NUMERICIDENTIFIER],")")),d("MAINVERSIONLOOSE","(".concat(o[l.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[l.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[l.NUMERICIDENTIFIERLOOSE],")")),d("PRERELEASEIDENTIFIER","(?:".concat(o[l.NUMERICIDENTIFIER],"|").concat(o[l.NONNUMERICIDENTIFIER],")")),d("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[l.NUMERICIDENTIFIERLOOSE],"|").concat(o[l.NONNUMERICIDENTIFIER],")")),d("PRERELEASE","(?:-(".concat(o[l.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[l.PRERELEASEIDENTIFIER],")*))")),d("PRERELEASELOOSE","(?:-?(".concat(o[l.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[l.PRERELEASEIDENTIFIERLOOSE],")*))")),d("BUILDIDENTIFIER","[0-9A-Za-z-]+"),d("BUILD","(?:\\+(".concat(o[l.BUILDIDENTIFIER],"(?:\\.").concat(o[l.BUILDIDENTIFIER],")*))")),d("FULLPLAIN","v?".concat(o[l.MAINVERSION]).concat(o[l.PRERELEASE],"?").concat(o[l.BUILD],"?")),d("FULL","^".concat(o[l.FULLPLAIN],"$")),d("LOOSEPLAIN","[v=\\s]*".concat(o[l.MAINVERSIONLOOSE]).concat(o[l.PRERELEASELOOSE],"?").concat(o[l.BUILD],"?")),d("LOOSE","^".concat(o[l.LOOSEPLAIN],"$")),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE","".concat(o[l.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),d("XRANGEIDENTIFIER","".concat(o[l.NUMERICIDENTIFIER],"|x|X|\\*")),d("XRANGEPLAIN","[v=\\s]*(".concat(o[l.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[l.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[l.XRANGEIDENTIFIER],")")+"(?:".concat(o[l.PRERELEASE],")?").concat(o[l.BUILD],"?")+")?)?"),d("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[l.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[l.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[l.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[l.PRERELEASELOOSE],")?").concat(o[l.BUILD],"?")+")?)?"),d("XRANGE","^".concat(o[l.GTLT],"\\s*").concat(o[l.XRANGEPLAIN],"$")),d("XRANGELOOSE","^".concat(o[l.GTLT],"\\s*").concat(o[l.XRANGEPLAINLOOSE],"$")),d("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(i,"})")+"(?:\\.(\\d{1,".concat(i,"}))?")+"(?:\\.(\\d{1,".concat(i,"}))?")+"(?:$|[^\\d])"),d("COERCERTL",o[l.COERCE],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM","(\\s*)".concat(o[l.LONETILDE],"\\s+"),!0),n.tildeTrimReplace="$1~",d("TILDE","^".concat(o[l.LONETILDE]).concat(o[l.XRANGEPLAIN],"$")),d("TILDELOOSE","^".concat(o[l.LONETILDE]).concat(o[l.XRANGEPLAINLOOSE],"$")),d("LONECARET","(?:\\^)"),d("CARETTRIM","(\\s*)".concat(o[l.LONECARET],"\\s+"),!0),n.caretTrimReplace="$1^",d("CARET","^".concat(o[l.LONECARET]).concat(o[l.XRANGEPLAIN],"$")),d("CARETLOOSE","^".concat(o[l.LONECARET]).concat(o[l.XRANGEPLAINLOOSE],"$")),d("COMPARATORLOOSE","^".concat(o[l.GTLT],"\\s*(").concat(o[l.LOOSEPLAIN],")$|^$")),d("COMPARATOR","^".concat(o[l.GTLT],"\\s*(").concat(o[l.FULLPLAIN],")$|^$")),d("COMPARATORTRIM","(\\s*)".concat(o[l.GTLT],"\\s*(").concat(o[l.LOOSEPLAIN],"|").concat(o[l.XRANGEPLAIN],")"),!0),n.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE","^\\s*(".concat(o[l.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[l.XRANGEPLAIN],")")+"\\s*$"),d("HYPHENRANGELOOSE","^\\s*(".concat(o[l.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[l.XRANGEPLAINLOOSE],")")+"\\s*$"),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(re$1,re$1.exports);var numeric=/^[0-9]+$/,compareIdentifiers$1=(e,n)=>{var i=numeric.test(e),r=numeric.test(n);return i&&r&&(e=+e,n=+n),e===n?0:i&&!r?-1:r&&!i?1:e<n?-1:1},rcompareIdentifiers=(e,n)=>compareIdentifiers$1(n,e),identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers},debug=debug_1,MAX_LENGTH=constants.MAX_LENGTH,MAX_SAFE_INTEGER=constants.MAX_SAFE_INTEGER,re=re$1.exports.re,t=re$1.exports.t,parseOptions=parseOptions_1,compareIdentifiers=identifiers.compareIdentifiers;class SemVer$1{constructor(n,i){if(i=parseOptions(i),n instanceof SemVer$1){if(n.loose===!!i.loose&&n.includePrerelease===!!i.includePrerelease)return n;n=n.version}else if(typeof n!="string")throw new TypeError("Invalid Version: ".concat(n));if(n.length>MAX_LENGTH)throw new TypeError("version is longer than ".concat(MAX_LENGTH," characters"));debug("SemVer",n,i),this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease;var r=n.trim().match(i.loose?re[t.LOOSE]:re[t.FULL]);if(!r)throw new TypeError("Invalid Version: ".concat(n));if(this.raw=n,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){var o=+s;if(o>=0&&o<MAX_SAFE_INTEGER)return o}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(n){if(debug("SemVer.compare",this.version,this.options,n),!(n instanceof SemVer$1)){if(typeof n=="string"&&n===this.version)return 0;n=new SemVer$1(n,this.options)}return n.version===this.version?0:this.compareMain(n)||this.comparePre(n)}compareMain(n){return n instanceof SemVer$1||(n=new SemVer$1(n,this.options)),compareIdentifiers(this.major,n.major)||compareIdentifiers(this.minor,n.minor)||compareIdentifiers(this.patch,n.patch)}comparePre(n){if(n instanceof SemVer$1||(n=new SemVer$1(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;var i=0;do{var r=this.prerelease[i],s=n.prerelease[i];if(debug("prerelease compare",i,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return compareIdentifiers(r,s)}while(++i)}compareBuild(n){n instanceof SemVer$1||(n=new SemVer$1(n,this.options));var i=0;do{var r=this.build[i],s=n.build[i];if(debug("prerelease compare",i,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return compareIdentifiers(r,s)}while(++i)}inc(n,i){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",i),this.inc("pre",i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",i),this.inc("pre",i);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}i&&(compareIdentifiers(this.prerelease[0],i)===0?isNaN(this.prerelease[1])&&(this.prerelease=[i,0]):this.prerelease=[i,0]);break;default:throw new Error("invalid increment argument: ".concat(n))}return this.format(),this.raw=this.version,this}}var semver=SemVer$1,SemVer=semver,compare$6=(e,n,i)=>new SemVer(e,i).compare(new SemVer(n,i)),compare_1=compare$6,compare$5=compare_1,eq$1=(e,n,i)=>compare$5(e,n,i)===0,eq_1=eq$1,compare$4=compare_1,neq$1=(e,n,i)=>compare$4(e,n,i)!==0,neq_1=neq$1,compare$3=compare_1,gt$1=(e,n,i)=>compare$3(e,n,i)>0,gt_1=gt$1,compare$2=compare_1,gte$1=(e,n,i)=>compare$2(e,n,i)>=0,gte_1=gte$1,compare$1=compare_1,lt$1=(e,n,i)=>compare$1(e,n,i)<0,lt_1=lt$1,compare=compare_1,lte$1=(e,n,i)=>compare(e,n,i)<=0,lte_1=lte$1,eq=eq_1,neq=neq_1,gt=gt_1,gte=gte_1,lt=lt_1,lte=lte_1,cmp=(e,n,i,r)=>{switch(n){case"===":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e===i;case"!==":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e!==i;case"":case"=":case"==":return eq(e,i,r);case"!=":return neq(e,i,r);case">":return gt(e,i,r);case">=":return gte(e,i,r);case"<":return lt(e,i,r);case"<=":return lte(e,i,r);default:throw new TypeError("Invalid operator: ".concat(n))}},cmp_1=cmp,comparator,hasRequiredComparator;function requireComparator(){if(hasRequiredComparator)return comparator;hasRequiredComparator=1;var e=Symbol("SemVer ANY");class n{static get ANY(){return e}constructor(g,v){if(v=i(v),g instanceof n){if(g.loose===!!v.loose)return g;g=g.value}l("comparator",g,v),this.options=v,this.loose=!!v.loose,this.parse(g),this.semver===e?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(g){var v=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],S=g.match(v);if(!S)throw new TypeError("Invalid comparator: ".concat(g));this.operator=S[1]!==void 0?S[1]:"",this.operator==="="&&(this.operator=""),S[2]?this.semver=new f(S[2],this.options.loose):this.semver=e}toString(){return this.value}test(g){if(l("Comparator.test",g,this.options.loose),this.semver===e||g===e)return!0;if(typeof g=="string")try{g=new f(g,this.options)}catch{return!1}return o(g,this.operator,this.semver,this.options)}intersects(g,v){if(!(g instanceof n))throw new TypeError("a Comparator is required");if((!v||typeof v!="object")&&(v={loose:!!v,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new d(g.value,v).test(this.value);if(g.operator==="")return g.value===""?!0:new d(this.value,v).test(g.semver);var S=(this.operator===">="||this.operator===">")&&(g.operator===">="||g.operator===">"),T=(this.operator==="<="||this.operator==="<")&&(g.operator==="<="||g.operator==="<"),k=this.semver.version===g.semver.version,O=(this.operator===">="||this.operator==="<=")&&(g.operator===">="||g.operator==="<="),R=o(this.semver,"<",g.semver,v)&&(this.operator===">="||this.operator===">")&&(g.operator==="<="||g.operator==="<"),P=o(this.semver,">",g.semver,v)&&(this.operator==="<="||this.operator==="<")&&(g.operator===">="||g.operator===">");return S||T||k&&O||R||P}}comparator=n;var i=parseOptions_1,r=re$1.exports.re,s=re$1.exports.t,o=cmp_1,l=debug_1,f=semver,d=requireRange();return comparator}function _createForOfIteratorHelper$1(e,n){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray$1(e))||n&&e&&typeof e.length=="number"){i&&(e=i);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(p){throw p},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,f;return{s:function(){i=i.call(e)},n:function(){var p=i.next();return o=p.done,p},e:function(p){l=!0,f=p},f:function(){try{!o&&i.return!=null&&i.return()}finally{if(l)throw f}}}}function _unsupportedIterableToArray$1(e,n){if(e){if(typeof e=="string")return _arrayLikeToArray$1(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray$1(e,n)}}function _arrayLikeToArray$1(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}var range,hasRequiredRange;function requireRange(){if(hasRequiredRange)return range;hasRequiredRange=1;class e{constructor(Q,J){if(J=r(J),Q instanceof e)return Q.loose===!!J.loose&&Q.includePrerelease===!!J.includePrerelease?Q:new e(Q.raw,J);if(Q instanceof s)return this.raw=Q.value,this.set=[[Q]],this.format(),this;if(this.options=J,this.loose=!!J.loose,this.includePrerelease=!!J.includePrerelease,this.raw=Q,this.set=Q.split("||").map(oe=>this.parseRange(oe.trim())).filter(oe=>oe.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(Q));if(this.set.length>1){var ne=this.set[0];if(this.set=this.set.filter(oe=>!S(oe[0])),this.set.length===0)this.set=[ne];else if(this.set.length>1){var G=_createForOfIteratorHelper$1(this.set),Z;try{for(G.s();!(Z=G.n()).done;){var ae=Z.value;if(ae.length===1&&T(ae[0])){this.set=[ae];break}}}catch(oe){G.e(oe)}finally{G.f()}}}this.format()}format(){return this.range=this.set.map(Q=>Q.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(Q){Q=Q.trim();var J=Object.keys(this.options).join(","),ne="parseRange:".concat(J,":").concat(Q),G=i.get(ne);if(G)return G;var Z=this.options.loose,ae=Z?f[d.HYPHENRANGELOOSE]:f[d.HYPHENRANGE];Q=Q.replace(ae,H(this.options.includePrerelease)),o("hyphen replace",Q),Q=Q.replace(f[d.COMPARATORTRIM],p),o("comparator trim",Q),Q=Q.replace(f[d.TILDETRIM],g),Q=Q.replace(f[d.CARETTRIM],v),Q=Q.split(/\s+/).join(" ");var oe=Q.split(" ").map(fe=>O(fe,this.options)).join(" ").split(/\s+/).map(fe=>q(fe,this.options));Z&&(oe=oe.filter(fe=>(o("loose invalid filter",fe,this.options),!!fe.match(f[d.COMPARATORLOOSE])))),o("range list",oe);var pe=new Map,Se=oe.map(fe=>new s(fe,this.options)),ue=_createForOfIteratorHelper$1(Se),ee;try{for(ue.s();!(ee=ue.n()).done;){var V=ee.value;if(S(V))return[V];pe.set(V.value,V)}}catch(fe){ue.e(fe)}finally{ue.f()}pe.size>1&&pe.has("")&&pe.delete("");var se=[...pe.values()];return i.set(ne,se),se}intersects(Q,J){if(!(Q instanceof e))throw new TypeError("a Range is required");return this.set.some(ne=>k(ne,J)&&Q.set.some(G=>k(G,J)&&ne.every(Z=>G.every(ae=>Z.intersects(ae,J)))))}test(Q){if(!Q)return!1;if(typeof Q=="string")try{Q=new l(Q,this.options)}catch{return!1}for(var J=0;J<this.set.length;J++)if(W(this.set[J],Q,this.options))return!0;return!1}}range=e;var n=lruCache,i=new n({max:1e3}),r=parseOptions_1,s=requireComparator(),o=debug_1,l=semver,f=re$1.exports.re,d=re$1.exports.t,p=re$1.exports.comparatorTrimReplace,g=re$1.exports.tildeTrimReplace,v=re$1.exports.caretTrimReplace,S=U=>U.value==="<0.0.0-0",T=U=>U.value==="",k=(U,Q)=>{for(var J=!0,ne=U.slice(),G=ne.pop();J&&ne.length;)J=ne.every(Z=>G.intersects(Z,Q)),G=ne.pop();return J},O=(U,Q)=>(o("comp",U,Q),U=I(U,Q),o("caret",U),U=P(U,Q),o("tildes",U),U=N(U,Q),o("xrange",U),U=z(U,Q),o("stars",U),U),R=U=>!U||U.toLowerCase()==="x"||U==="*",P=(U,Q)=>U.trim().split(/\s+/).map(J=>F(J,Q)).join(" "),F=(U,Q)=>{var J=Q.loose?f[d.TILDELOOSE]:f[d.TILDE];return U.replace(J,(ne,G,Z,ae,oe)=>{o("tilde",U,ne,G,Z,ae,oe);var pe;return R(G)?pe="":R(Z)?pe=">=".concat(G,".0.0 <").concat(+G+1,".0.0-0"):R(ae)?pe=">=".concat(G,".").concat(Z,".0 <").concat(G,".").concat(+Z+1,".0-0"):oe?(o("replaceTilde pr",oe),pe=">=".concat(G,".").concat(Z,".").concat(ae,"-").concat(oe," <").concat(G,".").concat(+Z+1,".0-0")):pe=">=".concat(G,".").concat(Z,".").concat(ae," <").concat(G,".").concat(+Z+1,".0-0"),o("tilde return",pe),pe})},I=(U,Q)=>U.trim().split(/\s+/).map(J=>L(J,Q)).join(" "),L=(U,Q)=>{o("caret",U,Q);var J=Q.loose?f[d.CARETLOOSE]:f[d.CARET],ne=Q.includePrerelease?"-0":"";return U.replace(J,(G,Z,ae,oe,pe)=>{o("caret",U,G,Z,ae,oe,pe);var Se;return R(Z)?Se="":R(ae)?Se=">=".concat(Z,".0.0").concat(ne," <").concat(+Z+1,".0.0-0"):R(oe)?Z==="0"?Se=">=".concat(Z,".").concat(ae,".0").concat(ne," <").concat(Z,".").concat(+ae+1,".0-0"):Se=">=".concat(Z,".").concat(ae,".0").concat(ne," <").concat(+Z+1,".0.0-0"):pe?(o("replaceCaret pr",pe),Z==="0"?ae==="0"?Se=">=".concat(Z,".").concat(ae,".").concat(oe,"-").concat(pe," <").concat(Z,".").concat(ae,".").concat(+oe+1,"-0"):Se=">=".concat(Z,".").concat(ae,".").concat(oe,"-").concat(pe," <").concat(Z,".").concat(+ae+1,".0-0"):Se=">=".concat(Z,".").concat(ae,".").concat(oe,"-").concat(pe," <").concat(+Z+1,".0.0-0")):(o("no pr"),Z==="0"?ae==="0"?Se=">=".concat(Z,".").concat(ae,".").concat(oe).concat(ne," <").concat(Z,".").concat(ae,".").concat(+oe+1,"-0"):Se=">=".concat(Z,".").concat(ae,".").concat(oe).concat(ne," <").concat(Z,".").concat(+ae+1,".0-0"):Se=">=".concat(Z,".").concat(ae,".").concat(oe," <").concat(+Z+1,".0.0-0")),o("caret return",Se),Se})},N=(U,Q)=>(o("replaceXRanges",U,Q),U.split(/\s+/).map(J=>j(J,Q)).join(" ")),j=(U,Q)=>{U=U.trim();var J=Q.loose?f[d.XRANGELOOSE]:f[d.XRANGE];return U.replace(J,(ne,G,Z,ae,oe,pe)=>{o("xRange",U,ne,G,Z,ae,oe,pe);var Se=R(Z),ue=Se||R(ae),ee=ue||R(oe),V=ee;return G==="="&&V&&(G=""),pe=Q.includePrerelease?"-0":"",Se?G===">"||G==="<"?ne="<0.0.0-0":ne="*":G&&V?(ue&&(ae=0),oe=0,G===">"?(G=">=",ue?(Z=+Z+1,ae=0,oe=0):(ae=+ae+1,oe=0)):G==="<="&&(G="<",ue?Z=+Z+1:ae=+ae+1),G==="<"&&(pe="-0"),ne="".concat(G+Z,".").concat(ae,".").concat(oe).concat(pe)):ue?ne=">=".concat(Z,".0.0").concat(pe," <").concat(+Z+1,".0.0-0"):ee&&(ne=">=".concat(Z,".").concat(ae,".0").concat(pe," <").concat(Z,".").concat(+ae+1,".0-0")),o("xRange return",ne),ne})},z=(U,Q)=>(o("replaceStars",U,Q),U.trim().replace(f[d.STAR],"")),q=(U,Q)=>(o("replaceGTE0",U,Q),U.trim().replace(f[Q.includePrerelease?d.GTE0PRE:d.GTE0],"")),H=U=>(Q,J,ne,G,Z,ae,oe,pe,Se,ue,ee,V,se)=>(R(ne)?J="":R(G)?J=">=".concat(ne,".0.0").concat(U?"-0":""):R(Z)?J=">=".concat(ne,".").concat(G,".0").concat(U?"-0":""):ae?J=">=".concat(J):J=">=".concat(J).concat(U?"-0":""),R(Se)?pe="":R(ue)?pe="<".concat(+Se+1,".0.0-0"):R(ee)?pe="<".concat(Se,".").concat(+ue+1,".0-0"):V?pe="<=".concat(Se,".").concat(ue,".").concat(ee,"-").concat(V):U?pe="<".concat(Se,".").concat(ue,".").concat(+ee+1,"-0"):pe="<=".concat(pe),"".concat(J," ").concat(pe).trim()),W=(U,Q,J)=>{for(var ne=0;ne<U.length;ne++)if(!U[ne].test(Q))return!1;if(Q.prerelease.length&&!J.includePrerelease){for(var G=0;G<U.length;G++)if(o(U[G].semver),U[G].semver!==s.ANY&&U[G].semver.prerelease.length>0){var Z=U[G].semver;if(Z.major===Q.major&&Z.minor===Q.minor&&Z.patch===Q.patch)return!0}return!1}return!0};return range}requireRange();String.prototype.startsWith||(String.prototype.startsWith=function(e,n){return this.substr(!n||n<0?0:+n,e.length)===e});var _w$vl,vega=vegaImport,_vegaLite=vegaLiteImport,w=typeof window<"u"?window:void 0;_vegaLite===void 0&&w!==null&&w!==void 0&&(_w$vl=w.vl)!==null&&_w$vl!==void 0&&_w$vl.compile&&(_vegaLite=w.vl);vega.version,_vegaLite&&_vegaLite.version;const Website_svelte_svelte_type_style_lang="";function create_default_slot_22(e){let n,i,r,s,o,l,f,d,p,g,v,S,T,k,O,R,P,F,I,L,N,j,z,q,H,W,U,Q,J,ne;return n=new SidebarDropdownItem({props:{label:"Button"}}),r=new SidebarDropdownItem({props:{label:"Checkbox"}}),o=new SidebarDropdownItem({props:{label:"File Upload"}}),f=new SidebarDropdownItem({props:{label:"Image"}}),p=new SidebarDropdownItem({props:{label:"Json"}}),v=new SidebarDropdownItem({props:{label:"Markdown"}}),T=new SidebarDropdownItem({props:{label:"Slider"}}),O=new SidebarDropdownItem({props:{label:"Toggle"}}),P=new SidebarDropdownItem({props:{label:"Text"}}),I=new SidebarDropdownItem({props:{label:"Textbox"}}),N=new SidebarDropdownItem({props:{label:"Radio"}}),z=new SidebarDropdownItem({props:{label:"Radio Group"}}),H=new SidebarDropdownItem({props:{label:"Select"}}),U=new SidebarDropdownItem({props:{label:"Tabs"}}),J=new SidebarDropdownItem({props:{label:"Stats"}}),{c(){create_component(n.$$.fragment),i=space(),create_component(r.$$.fragment),s=space(),create_component(o.$$.fragment),l=space(),create_component(f.$$.fragment),d=space(),create_component(p.$$.fragment),g=space(),create_component(v.$$.fragment),S=space(),create_component(T.$$.fragment),k=space(),create_component(O.$$.fragment),R=space(),create_component(P.$$.fragment),F=space(),create_component(I.$$.fragment),L=space(),create_component(N.$$.fragment),j=space(),create_component(z.$$.fragment),q=space(),create_component(H.$$.fragment),W=space(),create_component(U.$$.fragment),Q=space(),create_component(J.$$.fragment)},l(G){claim_component(n.$$.fragment,G),i=claim_space(G),claim_component(r.$$.fragment,G),s=claim_space(G),claim_component(o.$$.fragment,G),l=claim_space(G),claim_component(f.$$.fragment,G),d=claim_space(G),claim_component(p.$$.fragment,G),g=claim_space(G),claim_component(v.$$.fragment,G),S=claim_space(G),claim_component(T.$$.fragment,G),k=claim_space(G),claim_component(O.$$.fragment,G),R=claim_space(G),claim_component(P.$$.fragment,G),F=claim_space(G),claim_component(I.$$.fragment,G),L=claim_space(G),claim_component(N.$$.fragment,G),j=claim_space(G),claim_component(z.$$.fragment,G),q=claim_space(G),claim_component(H.$$.fragment,G),W=claim_space(G),claim_component(U.$$.fragment,G),Q=claim_space(G),claim_component(J.$$.fragment,G)},m(G,Z){mount_component(n,G,Z),insert_hydration(G,i,Z),mount_component(r,G,Z),insert_hydration(G,s,Z),mount_component(o,G,Z),insert_hydration(G,l,Z),mount_component(f,G,Z),insert_hydration(G,d,Z),mount_component(p,G,Z),insert_hydration(G,g,Z),mount_component(v,G,Z),insert_hydration(G,S,Z),mount_component(T,G,Z),insert_hydration(G,k,Z),mount_component(O,G,Z),insert_hydration(G,R,Z),mount_component(P,G,Z),insert_hydration(G,F,Z),mount_component(I,G,Z),insert_hydration(G,L,Z),mount_component(N,G,Z),insert_hydration(G,j,Z),mount_component(z,G,Z),insert_hydration(G,q,Z),mount_component(H,G,Z),insert_hydration(G,W,Z),mount_component(U,G,Z),insert_hydration(G,Q,Z),mount_component(J,G,Z),ne=!0},p:noop$6,i(G){ne||(transition_in(n.$$.fragment,G),transition_in(r.$$.fragment,G),transition_in(o.$$.fragment,G),transition_in(f.$$.fragment,G),transition_in(p.$$.fragment,G),transition_in(v.$$.fragment,G),transition_in(T.$$.fragment,G),transition_in(O.$$.fragment,G),transition_in(P.$$.fragment,G),transition_in(I.$$.fragment,G),transition_in(N.$$.fragment,G),transition_in(z.$$.fragment,G),transition_in(H.$$.fragment,G),transition_in(U.$$.fragment,G),transition_in(J.$$.fragment,G),ne=!0)},o(G){transition_out(n.$$.fragment,G),transition_out(r.$$.fragment,G),transition_out(o.$$.fragment,G),transition_out(f.$$.fragment,G),transition_out(p.$$.fragment,G),transition_out(v.$$.fragment,G),transition_out(T.$$.fragment,G),transition_out(O.$$.fragment,G),transition_out(P.$$.fragment,G),transition_out(I.$$.fragment,G),transition_out(N.$$.fragment,G),transition_out(z.$$.fragment,G),transition_out(H.$$.fragment,G),transition_out(U.$$.fragment,G),transition_out(J.$$.fragment,G),ne=!1},d(G){destroy_component(n,G),G&&detach(i),destroy_component(r,G),G&&detach(s),destroy_component(o,G),G&&detach(l),destroy_component(f,G),G&&detach(d),destroy_component(p,G),G&&detach(g),destroy_component(v,G),G&&detach(S),destroy_component(T,G),G&&detach(k),destroy_component(O,G),G&&detach(R),destroy_component(P,G),G&&detach(F),destroy_component(I,G),G&&detach(L),destroy_component(N,G),G&&detach(j),destroy_component(z,G),G&&detach(q),destroy_component(H,G),G&&detach(W),destroy_component(U,G),G&&detach(Q),destroy_component(J,G)}}}function create_default_slot_21(e){let n,i,r,s,o,l,f,d,p,g,v,S,T,k,O,R;return n=new SidebarDropdownItem({props:{label:"Bar Plot"}}),r=new SidebarDropdownItem({props:{label:"Document"}}),o=new SidebarDropdownItem({props:{label:"Filter"}}),f=new SidebarDropdownItem({props:{label:"Gallery"}}),p=new SidebarDropdownItem({props:{label:"Match"}}),v=new SidebarDropdownItem({props:{label:"Plot"}}),T=new SidebarDropdownItem({props:{label:"Sort"}}),O=new SidebarDropdownItem({props:{label:"Table"}}),{c(){create_component(n.$$.fragment),i=space(),create_component(r.$$.fragment),s=space(),create_component(o.$$.fragment),l=space(),create_component(f.$$.fragment),d=space(),create_component(p.$$.fragment),g=space(),create_component(v.$$.fragment),S=space(),create_component(T.$$.fragment),k=space(),create_component(O.$$.fragment)},l(P){claim_component(n.$$.fragment,P),i=claim_space(P),claim_component(r.$$.fragment,P),s=claim_space(P),claim_component(o.$$.fragment,P),l=claim_space(P),claim_component(f.$$.fragment,P),d=claim_space(P),claim_component(p.$$.fragment,P),g=claim_space(P),claim_component(v.$$.fragment,P),S=claim_space(P),claim_component(T.$$.fragment,P),k=claim_space(P),claim_component(O.$$.fragment,P)},m(P,F){mount_component(n,P,F),insert_hydration(P,i,F),mount_component(r,P,F),insert_hydration(P,s,F),mount_component(o,P,F),insert_hydration(P,l,F),mount_component(f,P,F),insert_hydration(P,d,F),mount_component(p,P,F),insert_hydration(P,g,F),mount_component(v,P,F),insert_hydration(P,S,F),mount_component(T,P,F),insert_hydration(P,k,F),mount_component(O,P,F),R=!0},p:noop$6,i(P){R||(transition_in(n.$$.fragment,P),transition_in(r.$$.fragment,P),transition_in(o.$$.fragment,P),transition_in(f.$$.fragment,P),transition_in(p.$$.fragment,P),transition_in(v.$$.fragment,P),transition_in(T.$$.fragment,P),transition_in(O.$$.fragment,P),R=!0)},o(P){transition_out(n.$$.fragment,P),transition_out(r.$$.fragment,P),transition_out(o.$$.fragment,P),transition_out(f.$$.fragment,P),transition_out(p.$$.fragment,P),transition_out(v.$$.fragment,P),transition_out(T.$$.fragment,P),transition_out(O.$$.fragment,P),R=!1},d(P){destroy_component(n,P),P&&detach(i),destroy_component(r,P),P&&detach(s),destroy_component(o,P),P&&detach(l),destroy_component(f,P),P&&detach(d),destroy_component(p,P),P&&detach(g),destroy_component(v,P),P&&detach(S),destroy_component(T,P),P&&detach(k),destroy_component(O,P)}}}function create_default_slot_20(e){let n,i,r,s,o,l,f,d;return n=new SidebarDropdownWrapper({props:{label:"The Basics",$$slots:{default:[create_default_slot_22]},$$scope:{ctx:e}}}),r=new SidebarDropdownWrapper({props:{label:"Dataframe Components",$$slots:{default:[create_default_slot_21]},$$scope:{ctx:e}}}),o=new SidebarItem({props:{label:"Flowbite Components"}}),f=new SidebarItem({props:{label:"HTML Tags"}}),{c(){create_component(n.$$.fragment),i=space(),create_component(r.$$.fragment),s=space(),create_component(o.$$.fragment),l=space(),create_component(f.$$.fragment)},l(p){claim_component(n.$$.fragment,p),i=claim_space(p),claim_component(r.$$.fragment,p),s=claim_space(p),claim_component(o.$$.fragment,p),l=claim_space(p),claim_component(f.$$.fragment,p)},m(p,g){mount_component(n,p,g),insert_hydration(p,i,g),mount_component(r,p,g),insert_hydration(p,s,g),mount_component(o,p,g),insert_hydration(p,l,g),mount_component(f,p,g),d=!0},p(p,g){const v={};g&2&&(v.$$scope={dirty:g,ctx:p}),n.$set(v);const S={};g&2&&(S.$$scope={dirty:g,ctx:p}),r.$set(S)},i(p){d||(transition_in(n.$$.fragment,p),transition_in(r.$$.fragment,p),transition_in(o.$$.fragment,p),transition_in(f.$$.fragment,p),d=!0)},o(p){transition_out(n.$$.fragment,p),transition_out(r.$$.fragment,p),transition_out(o.$$.fragment,p),transition_out(f.$$.fragment,p),d=!1},d(p){destroy_component(n,p),p&&detach(i),destroy_component(r,p),p&&detach(s),destroy_component(o,p),p&&detach(l),destroy_component(f,p)}}}function create_default_slot_19(e){let n,i;return n=new SidebarGroup({props:{$$slots:{default:[create_default_slot_20]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s&2&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_default_slot_18(e){let n,i;return n=new SidebarWrapper({props:{$$slots:{default:[create_default_slot_19]},$$scope:{ctx:e}}}),{c(){create_component(n.$$.fragment)},l(r){claim_component(n.$$.fragment,r)},m(r,s){mount_component(n,r,s),i=!0},p(r,s){const o={};s&2&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){destroy_component(n,r)}}}function create_default_slot_17(e){let n;return{c(){n=text$3("Button")},l(i){n=claim_text(i,"Button")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_16(e){let n;return{c(){n=text$3("Checkbox")},l(i){n=claim_text(i,"Checkbox")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_15(e){let n;return{c(){n=text$3("Text")},l(i){n=claim_text(i,"Text")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_14(e){let n;return{c(){n=text$3("Textbox")},l(i){n=claim_text(i,"Textbox")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_13(e){let n;return{c(){n=text$3("Slider")},l(i){n=claim_text(i,"Slider")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_12(e){let n;return{c(){n=text$3("Radio")},l(i){n=claim_text(i,"Radio")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_11(e){let n;return{c(){n=text$3("RawHTML")},l(i){n=claim_text(i,"RawHTML")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_10(e){let n;return{c(){n=text$3("RadioGroup")},l(i){n=claim_text(i,"RadioGroup")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_9(e){let n;return{c(){n=text$3("FileUpload")},l(i){n=claim_text(i,"FileUpload")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_8(e){let n;return{c(){n=text$3("Stats")},l(i){n=claim_text(i,"Stats")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_7(e){let n;return{c(){n=text$3("Toggle")},l(i){n=claim_text(i,"Toggle")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_6(e){let n;return{c(){n=text$3("Code")},l(i){n=claim_text(i,"Code")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_5(e){let n;return{c(){n=text$3("Image")},l(i){n=claim_text(i,"Image")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_4(e){let n;return{c(){n=text$3("Markdown")},l(i){n=claim_text(i,"Markdown")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_3(e){let n;return{c(){n=text$3("Json")},l(i){n=claim_text(i,"Json")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_2(e){let n;return{c(){n=text$3("Tabs")},l(i){n=claim_text(i,"Tabs")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot_1(e){let n;return{c(){n=text$3("Select")},l(i){n=claim_text(i,"Select")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_default_slot(e){let n;return{c(){n=text$3("Chat")},l(i){n=claim_text(i,"Chat")},m(i,r){insert_hydration(i,n,r)},d(i){i&&detach(n)}}}function create_fragment(e){let n,i,r,s,o,l,f,d,p,g,v,S,T,k,O,R,P,F,I,L,N,j,z,q,H,W,U,Q,J,ne,G,Z,ae,oe,pe,Se,ue,ee,V,se,fe,he,be,xe,ye,we,$e,ve,Te,te,ie,ce,ge,de,Ae,Oe,Re,Ie,ke,je,Me,Be,ze,Ve,Qe,Ge,me,_e,Ee,Ne,We,st,Ce,Fe,qe,He,Xe,tt,Je,Ye,Ke,et,ct,ot,rt,ut,it,dt,ft,_t,ht,Et,pt,yt,mt,$t,St,vt,jn,At,Xt,wt,Bn,Yt,Nt,zn,Tt,Kt,Ct,Un,Qt,It,qn,kt,Jt,Ot,Hn,Zt,Mt,Gn,Dt,en,Rt,Vn,Lt,Wn,Pt,tn,Ft,Kn,jt,Qn,nn,Bt,xn;return r=new Nav({props:{page:"components"}}),f=new Sidebar({props:{$$slots:{default:[create_default_slot_18]},$$scope:{ctx:e}}}),S=new Label$2({props:{$$slots:{default:[create_default_slot_17]},$$scope:{ctx:e}}}),O=new Button({props:{title:"Hello"}}),I=new Label$2({props:{$$slots:{default:[create_default_slot_16]},$$scope:{ctx:e}}}),j=new Checkbox_1({props:{checked:!0}}),W=new Label$2({props:{$$slots:{default:[create_default_slot_15]},$$scope:{ctx:e}}}),J=new Text({props:{data:"A quick brown fox jumped over a lazy dog."}}),ae=new Label$2({props:{$$slots:{default:[create_default_slot_14]},$$scope:{ctx:e}}}),Se=new Textbox({props:{text:"Write."}}),se=new Label$2({props:{$$slots:{default:[create_default_slot_13]},$$scope:{ctx:e}}}),be=new Slider({props:{min:0,max:10}}),$e=new Label$2({props:{$$slots:{default:[create_default_slot_12]},$$scope:{ctx:e}}}),te=new Radio_1({}),de=new Label$2({props:{$$slots:{default:[create_default_slot_11]},$$scope:{ctx:e}}}),Re=new RawHTML({props:{html:`
<div>
    <h1>Hello</h1>
    <p>World</p>
</div>
`}}),Me=new Label$2({props:{$$slots:{default:[create_default_slot_10]},$$scope:{ctx:e}}}),Ve=new RadioGroup({props:{values:[1,2,3]}}),_e=new Label$2({props:{$$slots:{default:[create_default_slot_9]},$$scope:{ctx:e}}}),We=new FileUpload({props:{files:[],filenames:[],contents:[]}}),qe=new Label$2({props:{$$slots:{default:[create_default_slot_8]},$$scope:{ctx:e}}}),tt=new Stats({props:{data:{"Temperature (C)":13,"Altitude (ft)":12345}}}),et=new Label$2({props:{$$slots:{default:[create_default_slot_7]},$$scope:{ctx:e}}}),rt=new Toggle({props:{value:!1}}),ft=new Label$2({props:{$$slots:{default:[create_default_slot_6]},$$scope:{ctx:e}}}),ht=new Code({props:{body:"import meerkat as mk"}}),mt=new Label$2({props:{$$slots:{default:[create_default_slot_5]},$$scope:{ctx:e}}}),vt=new Image$1({props:{data:"http://placekitten.com/200/200"}}),wt=new Label$2({props:{$$slots:{default:[create_default_slot_4]},$$scope:{ctx:e}}}),Nt=new Markdown({props:{body:`
# Github Flavored Markdown
## Hello from Meerkat
### Table
| A | B |
|---|---|
| 1 | 2 |
`}}),Ct=new Label$2({props:{$$slots:{default:[create_default_slot_3]},$$scope:{ctx:e}}}),It=new Json({props:{body:e[0]}}),Ot=new Label$2({props:{$$slots:{default:[create_default_slot_2]},$$scope:{ctx:e}}}),Mt=new Tabs({props:{tabs:[{label:"Tab 1",id:"tab1",component:{name:"Text",props:{data:"This is a component in Tab 1"}}},{label:"Tab 2",id:"tab2",component:{name:"Text",props:{data:"This is a component in Tab 2"}}},{label:"Tab 3",id:"tab3",component:{name:"Text",props:{data:"This is a component in Tab 3"}}}]}}),Rt=new Label$2({props:{$$slots:{default:[create_default_slot_1]},$$scope:{ctx:e}}}),Lt=new Select({props:{values:[1,2,3,4],labels:["Option 1","Option 2","Option 3","Option 4"],value:"1"}}),Ft=new Label$2({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),jt=new Chat({props:{df:{refId:"mock"}}}),Bt=new Footer({}),{c(){n=element$2("div"),i=element$2("header"),create_component(r.$$.fragment),s=space(),o=element$2("main"),l=element$2("div"),create_component(f.$$.fragment),d=space(),p=element$2("div"),g=element$2("div"),v=element$2("div"),create_component(S.$$.fragment),T=space(),k=element$2("div"),create_component(O.$$.fragment),R=space(),P=element$2("div"),F=element$2("div"),create_component(I.$$.fragment),L=space(),N=element$2("div"),create_component(j.$$.fragment),z=space(),q=element$2("div"),H=element$2("div"),create_component(W.$$.fragment),U=space(),Q=element$2("div"),create_component(J.$$.fragment),ne=space(),G=element$2("div"),Z=element$2("div"),create_component(ae.$$.fragment),oe=space(),pe=element$2("div"),create_component(Se.$$.fragment),ue=space(),ee=element$2("div"),V=element$2("div"),create_component(se.$$.fragment),fe=space(),he=element$2("div"),create_component(be.$$.fragment),xe=space(),ye=element$2("div"),we=element$2("div"),create_component($e.$$.fragment),ve=space(),Te=element$2("div"),create_component(te.$$.fragment),ie=space(),ce=element$2("div"),ge=element$2("div"),create_component(de.$$.fragment),Ae=space(),Oe=element$2("div"),create_component(Re.$$.fragment),Ie=space(),ke=element$2("div"),je=element$2("div"),create_component(Me.$$.fragment),Be=space(),ze=element$2("div"),create_component(Ve.$$.fragment),Qe=space(),Ge=element$2("div"),me=element$2("div"),create_component(_e.$$.fragment),Ee=space(),Ne=element$2("div"),create_component(We.$$.fragment),st=space(),Ce=element$2("div"),Fe=element$2("div"),create_component(qe.$$.fragment),He=space(),Xe=element$2("div"),create_component(tt.$$.fragment),Je=space(),Ye=element$2("div"),Ke=element$2("div"),create_component(et.$$.fragment),ct=space(),ot=element$2("div"),create_component(rt.$$.fragment),ut=space(),it=element$2("div"),dt=element$2("div"),create_component(ft.$$.fragment),_t=space(),create_component(ht.$$.fragment),Et=space(),pt=element$2("div"),yt=element$2("div"),create_component(mt.$$.fragment),$t=space(),St=element$2("div"),create_component(vt.$$.fragment),jn=space(),At=element$2("div"),Xt=element$2("div"),create_component(wt.$$.fragment),Bn=space(),Yt=element$2("div"),create_component(Nt.$$.fragment),zn=space(),Tt=element$2("div"),Kt=element$2("div"),create_component(Ct.$$.fragment),Un=space(),Qt=element$2("div"),create_component(It.$$.fragment),qn=space(),kt=element$2("div"),Jt=element$2("div"),create_component(Ot.$$.fragment),Hn=space(),Zt=element$2("div"),create_component(Mt.$$.fragment),Gn=space(),Dt=element$2("div"),en=element$2("div"),create_component(Rt.$$.fragment),Vn=space(),create_component(Lt.$$.fragment),Wn=space(),Pt=element$2("div"),tn=element$2("div"),create_component(Ft.$$.fragment),Kn=space(),create_component(jt.$$.fragment),Qn=space(),nn=element$2("footer"),create_component(Bt.$$.fragment),this.h()},l(Le){n=claim_element(Le,"DIV",{class:!0});var Ze=children$2(n);i=claim_element(Ze,"HEADER",{class:!0});var sn=children$2(i);claim_component(r.$$.fragment,sn),sn.forEach(detach),s=claim_space(Ze),o=claim_element(Ze,"MAIN",{class:!0});var ln=children$2(o);l=claim_element(ln,"DIV",{class:!0});var zt=children$2(l);claim_component(f.$$.fragment,zt),d=claim_space(zt),p=claim_element(zt,"DIV",{});var nt=children$2(p);g=claim_element(nt,"DIV",{class:!0});var Ut=children$2(g);v=claim_element(Ut,"DIV",{class:!0});var un=children$2(v);claim_component(S.$$.fragment,un),un.forEach(detach),T=claim_space(Ut),k=claim_element(Ut,"DIV",{class:!0});var cn=children$2(k);claim_component(O.$$.fragment,cn),cn.forEach(detach),Ut.forEach(detach),R=claim_space(nt),P=claim_element(nt,"DIV",{class:!0});var qt=children$2(P);F=claim_element(qt,"DIV",{class:!0});var fn=children$2(F);claim_component(I.$$.fragment,fn),fn.forEach(detach),L=claim_space(qt),N=claim_element(qt,"DIV",{class:!0});var dn=children$2(N);claim_component(j.$$.fragment,dn),dn.forEach(detach),qt.forEach(detach),z=claim_space(nt),q=claim_element(nt,"DIV",{class:!0});var Ht=children$2(q);H=claim_element(Ht,"DIV",{class:!0});var hn=children$2(H);claim_component(W.$$.fragment,hn),hn.forEach(detach),U=claim_space(Ht),Q=claim_element(Ht,"DIV",{class:!0});var pn=children$2(Q);claim_component(J.$$.fragment,pn),pn.forEach(detach),Ht.forEach(detach),ne=claim_space(nt),G=claim_element(nt,"DIV",{class:!0});var Gt=children$2(G);Z=claim_element(Gt,"DIV",{class:!0});var gn=children$2(Z);claim_component(ae.$$.fragment,gn),gn.forEach(detach),oe=claim_space(Gt),pe=claim_element(Gt,"DIV",{class:!0});var mn=children$2(pe);claim_component(Se.$$.fragment,mn),mn.forEach(detach),Gt.forEach(detach),ue=claim_space(nt),ee=claim_element(nt,"DIV",{class:!0});var Vt=children$2(ee);V=claim_element(Vt,"DIV",{class:!0});var bn=children$2(V);claim_component(se.$$.fragment,bn),bn.forEach(detach),fe=claim_space(Vt),he=claim_element(Vt,"DIV",{class:!0});var _n=children$2(he);claim_component(be.$$.fragment,_n),_n.forEach(detach),Vt.forEach(detach),xe=claim_space(nt),ye=claim_element(nt,"DIV",{class:!0});var Sn=children$2(ye);we=claim_element(Sn,"DIV",{class:!0});var xi=children$2(we);claim_component($e.$$.fragment,xi),xi.forEach(detach),ve=claim_space(Sn),Te=claim_element(Sn,"DIV",{class:!0});var Si=children$2(Te);claim_component(te.$$.fragment,Si),Si.forEach(detach),Sn.forEach(detach),ie=claim_space(nt),ce=claim_element(nt,"DIV",{class:!0});var En=children$2(ce);ge=claim_element(En,"DIV",{class:!0});var Ei=children$2(ge);claim_component(de.$$.fragment,Ei),Ei.forEach(detach),Ae=claim_space(En),Oe=claim_element(En,"DIV",{class:!0});var $i=children$2(Oe);claim_component(Re.$$.fragment,$i),$i.forEach(detach),En.forEach(detach),Ie=claim_space(nt),ke=claim_element(nt,"DIV",{class:!0});var $n=children$2(ke);je=claim_element($n,"DIV",{class:!0});var Ai=children$2(je);claim_component(Me.$$.fragment,Ai),Ai.forEach(detach),Be=claim_space($n),ze=claim_element($n,"DIV",{class:!0});var wi=children$2(ze);claim_component(Ve.$$.fragment,wi),wi.forEach(detach),$n.forEach(detach),Qe=claim_space(nt),Ge=claim_element(nt,"DIV",{class:!0});var An=children$2(Ge);me=claim_element(An,"DIV",{class:!0});var Ti=children$2(me);claim_component(_e.$$.fragment,Ti),Ti.forEach(detach),Ee=claim_space(An),Ne=claim_element(An,"DIV",{class:!0});var Ci=children$2(Ne);claim_component(We.$$.fragment,Ci),Ci.forEach(detach),An.forEach(detach),st=claim_space(nt),Ce=claim_element(nt,"DIV",{class:!0});var wn=children$2(Ce);Fe=claim_element(wn,"DIV",{class:!0});var ki=children$2(Fe);claim_component(qe.$$.fragment,ki),ki.forEach(detach),He=claim_space(wn),Xe=claim_element(wn,"DIV",{class:!0});var Oi=children$2(Xe);claim_component(tt.$$.fragment,Oi),Oi.forEach(detach),wn.forEach(detach),Je=claim_space(nt),Ye=claim_element(nt,"DIV",{class:!0});var Tn=children$2(Ye);Ke=claim_element(Tn,"DIV",{class:!0});var Di=children$2(Ke);claim_component(et.$$.fragment,Di),Di.forEach(detach),ct=claim_space(Tn),ot=claim_element(Tn,"DIV",{class:!0});var Ri=children$2(ot);claim_component(rt.$$.fragment,Ri),Ri.forEach(detach),Tn.forEach(detach),ut=claim_space(nt),it=claim_element(nt,"DIV",{class:!0});var Cn=children$2(it);dt=claim_element(Cn,"DIV",{class:!0});var Pi=children$2(dt);claim_component(ft.$$.fragment,Pi),Pi.forEach(detach),_t=claim_space(Cn),claim_component(ht.$$.fragment,Cn),Cn.forEach(detach),Et=claim_space(nt),pt=claim_element(nt,"DIV",{class:!0});var kn=children$2(pt);yt=claim_element(kn,"DIV",{class:!0});var Fi=children$2(yt);claim_component(mt.$$.fragment,Fi),Fi.forEach(detach),$t=claim_space(kn),St=claim_element(kn,"DIV",{class:!0});var Ni=children$2(St);claim_component(vt.$$.fragment,Ni),Ni.forEach(detach),kn.forEach(detach),jn=claim_space(nt),At=claim_element(nt,"DIV",{class:!0});var On=children$2(At);Xt=claim_element(On,"DIV",{class:!0});var Ii=children$2(Xt);claim_component(wt.$$.fragment,Ii),Ii.forEach(detach),Bn=claim_space(On),Yt=claim_element(On,"DIV",{class:!0});var Mi=children$2(Yt);claim_component(Nt.$$.fragment,Mi),Mi.forEach(detach),On.forEach(detach),zn=claim_space(nt),Tt=claim_element(nt,"DIV",{class:!0});var Dn=children$2(Tt);Kt=claim_element(Dn,"DIV",{class:!0});var Li=children$2(Kt);claim_component(Ct.$$.fragment,Li),Li.forEach(detach),Un=claim_space(Dn),Qt=claim_element(Dn,"DIV",{class:!0});var ji=children$2(Qt);claim_component(It.$$.fragment,ji),ji.forEach(detach),Dn.forEach(detach),qn=claim_space(nt),kt=claim_element(nt,"DIV",{class:!0});var Rn=children$2(kt);Jt=claim_element(Rn,"DIV",{class:!0});var Bi=children$2(Jt);claim_component(Ot.$$.fragment,Bi),Bi.forEach(detach),Hn=claim_space(Rn),Zt=claim_element(Rn,"DIV",{class:!0});var zi=children$2(Zt);claim_component(Mt.$$.fragment,zi),zi.forEach(detach),Rn.forEach(detach),Gn=claim_space(nt),Dt=claim_element(nt,"DIV",{class:!0});var Pn=children$2(Dt);en=claim_element(Pn,"DIV",{class:!0});var Ui=children$2(en);claim_component(Rt.$$.fragment,Ui),Ui.forEach(detach),Vn=claim_space(Pn),claim_component(Lt.$$.fragment,Pn),Pn.forEach(detach),Wn=claim_space(nt),Pt=claim_element(nt,"DIV",{class:!0});var Fn=children$2(Pt);tn=claim_element(Fn,"DIV",{class:!0});var qi=children$2(tn);claim_component(Ft.$$.fragment,qi),qi.forEach(detach),Kn=claim_space(Fn),claim_component(jt.$$.fragment,Fn),Fn.forEach(detach),nt.forEach(detach),zt.forEach(detach),ln.forEach(detach),Qn=claim_space(Ze),nn=claim_element(Ze,"FOOTER",{class:!0});var Hi=children$2(nn);claim_component(Bt.$$.fragment,Hi),Hi.forEach(detach),Ze.forEach(detach),this.h()},h(){attr$6(i,"class","fixed w-full top-0 z-50"),attr$6(v,"class","flex flex-col items-center mt-4 mb-4"),attr$6(k,"class","w-20"),attr$6(g,"class","flex flex-col items-center mb-4"),attr$6(F,"class","flex flex-col items-center mt-4 mb-4"),attr$6(N,"class","w-fit"),attr$6(P,"class","flex flex-col items-center mb-4"),attr$6(H,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Q,"class","w-fit"),attr$6(q,"class","flex flex-col items-center mb-4"),attr$6(Z,"class","flex flex-col items-center mt-4 mb-4"),attr$6(pe,"class","w-fit"),attr$6(G,"class","flex flex-col items-center mb-4"),attr$6(V,"class","flex flex-col items-center mt-4 mb-4"),attr$6(he,"class","w-fit"),attr$6(ee,"class","flex flex-col items-center mb-4"),attr$6(we,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Te,"class","w-fit"),attr$6(ye,"class","flex flex-col items-center mb-4"),attr$6(ge,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Oe,"class","w-fit"),attr$6(ce,"class","flex flex-col items-center mb-4"),attr$6(je,"class","flex flex-col items-center mt-4 mb-4"),attr$6(ze,"class","w-fit"),attr$6(ke,"class","flex flex-col items-center mb-4"),attr$6(me,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Ne,"class","w-fit"),attr$6(Ge,"class","flex flex-col items-center mb-4"),attr$6(Fe,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Xe,"class","w-fit"),attr$6(Ce,"class","flex flex-col items-center mb-4"),attr$6(Ke,"class","flex flex-col items-center mt-4 mb-4"),attr$6(ot,"class","w-fit"),attr$6(Ye,"class","flex flex-col items-center mb-4"),attr$6(dt,"class","flex flex-col items-center mt-4 mb-4"),attr$6(it,"class","flex flex-col items-center mb-4"),attr$6(yt,"class","flex flex-col items-center mt-4 mb-4"),attr$6(St,"class","w-fit"),attr$6(pt,"class","flex flex-col items-center mb-4"),attr$6(Xt,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Yt,"class","w-fit"),attr$6(At,"class","flex flex-col items-center mb-4"),attr$6(Kt,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Qt,"class","w-fit"),attr$6(Tt,"class","flex flex-col items-center mb-4"),attr$6(Jt,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Zt,"class","w-fit"),attr$6(kt,"class","flex flex-col items-center mb-4"),attr$6(en,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Dt,"class","flex flex-col items-center mb-4"),attr$6(tn,"class","flex flex-col items-center mt-4 mb-4"),attr$6(Pt,"class","flex flex-col items-center mb-4 h-64"),attr$6(l,"class","flex flex-row"),attr$6(o,"class","mt-20 relative grow"),attr$6(nn,"class","sticky bottom-0 z-50"),attr$6(n,"class","flex flex-col h-screen")},m(Le,Ze){insert_hydration(Le,n,Ze),append_hydration(n,i),mount_component(r,i,null),append_hydration(n,s),append_hydration(n,o),append_hydration(o,l),mount_component(f,l,null),append_hydration(l,d),append_hydration(l,p),append_hydration(p,g),append_hydration(g,v),mount_component(S,v,null),append_hydration(g,T),append_hydration(g,k),mount_component(O,k,null),append_hydration(p,R),append_hydration(p,P),append_hydration(P,F),mount_component(I,F,null),append_hydration(P,L),append_hydration(P,N),mount_component(j,N,null),append_hydration(p,z),append_hydration(p,q),append_hydration(q,H),mount_component(W,H,null),append_hydration(q,U),append_hydration(q,Q),mount_component(J,Q,null),append_hydration(p,ne),append_hydration(p,G),append_hydration(G,Z),mount_component(ae,Z,null),append_hydration(G,oe),append_hydration(G,pe),mount_component(Se,pe,null),append_hydration(p,ue),append_hydration(p,ee),append_hydration(ee,V),mount_component(se,V,null),append_hydration(ee,fe),append_hydration(ee,he),mount_component(be,he,null),append_hydration(p,xe),append_hydration(p,ye),append_hydration(ye,we),mount_component($e,we,null),append_hydration(ye,ve),append_hydration(ye,Te),mount_component(te,Te,null),append_hydration(p,ie),append_hydration(p,ce),append_hydration(ce,ge),mount_component(de,ge,null),append_hydration(ce,Ae),append_hydration(ce,Oe),mount_component(Re,Oe,null),append_hydration(p,Ie),append_hydration(p,ke),append_hydration(ke,je),mount_component(Me,je,null),append_hydration(ke,Be),append_hydration(ke,ze),mount_component(Ve,ze,null),append_hydration(p,Qe),append_hydration(p,Ge),append_hydration(Ge,me),mount_component(_e,me,null),append_hydration(Ge,Ee),append_hydration(Ge,Ne),mount_component(We,Ne,null),append_hydration(p,st),append_hydration(p,Ce),append_hydration(Ce,Fe),mount_component(qe,Fe,null),append_hydration(Ce,He),append_hydration(Ce,Xe),mount_component(tt,Xe,null),append_hydration(p,Je),append_hydration(p,Ye),append_hydration(Ye,Ke),mount_component(et,Ke,null),append_hydration(Ye,ct),append_hydration(Ye,ot),mount_component(rt,ot,null),append_hydration(p,ut),append_hydration(p,it),append_hydration(it,dt),mount_component(ft,dt,null),append_hydration(it,_t),mount_component(ht,it,null),append_hydration(p,Et),append_hydration(p,pt),append_hydration(pt,yt),mount_component(mt,yt,null),append_hydration(pt,$t),append_hydration(pt,St),mount_component(vt,St,null),append_hydration(p,jn),append_hydration(p,At),append_hydration(At,Xt),mount_component(wt,Xt,null),append_hydration(At,Bn),append_hydration(At,Yt),mount_component(Nt,Yt,null),append_hydration(p,zn),append_hydration(p,Tt),append_hydration(Tt,Kt),mount_component(Ct,Kt,null),append_hydration(Tt,Un),append_hydration(Tt,Qt),mount_component(It,Qt,null),append_hydration(p,qn),append_hydration(p,kt),append_hydration(kt,Jt),mount_component(Ot,Jt,null),append_hydration(kt,Hn),append_hydration(kt,Zt),mount_component(Mt,Zt,null),append_hydration(p,Gn),append_hydration(p,Dt),append_hydration(Dt,en),mount_component(Rt,en,null),append_hydration(Dt,Vn),mount_component(Lt,Dt,null),append_hydration(p,Wn),append_hydration(p,Pt),append_hydration(Pt,tn),mount_component(Ft,tn,null),append_hydration(Pt,Kn),mount_component(jt,Pt,null),append_hydration(n,Qn),append_hydration(n,nn),mount_component(Bt,nn,null),xn=!0},p(Le,[Ze]){const sn={};Ze&2&&(sn.$$scope={dirty:Ze,ctx:Le}),f.$set(sn);const ln={};Ze&2&&(ln.$$scope={dirty:Ze,ctx:Le}),S.$set(ln);const zt={};Ze&2&&(zt.$$scope={dirty:Ze,ctx:Le}),I.$set(zt);const nt={};Ze&2&&(nt.$$scope={dirty:Ze,ctx:Le}),W.$set(nt);const Ut={};Ze&2&&(Ut.$$scope={dirty:Ze,ctx:Le}),ae.$set(Ut);const un={};Ze&2&&(un.$$scope={dirty:Ze,ctx:Le}),se.$set(un);const cn={};Ze&2&&(cn.$$scope={dirty:Ze,ctx:Le}),$e.$set(cn);const qt={};Ze&2&&(qt.$$scope={dirty:Ze,ctx:Le}),de.$set(qt);const fn={};Ze&2&&(fn.$$scope={dirty:Ze,ctx:Le}),Me.$set(fn);const dn={};Ze&2&&(dn.$$scope={dirty:Ze,ctx:Le}),_e.$set(dn);const Ht={};Ze&2&&(Ht.$$scope={dirty:Ze,ctx:Le}),qe.$set(Ht);const hn={};Ze&2&&(hn.$$scope={dirty:Ze,ctx:Le}),et.$set(hn);const pn={};Ze&2&&(pn.$$scope={dirty:Ze,ctx:Le}),ft.$set(pn);const Gt={};Ze&2&&(Gt.$$scope={dirty:Ze,ctx:Le}),mt.$set(Gt);const gn={};Ze&2&&(gn.$$scope={dirty:Ze,ctx:Le}),wt.$set(gn);const mn={};Ze&2&&(mn.$$scope={dirty:Ze,ctx:Le}),Ct.$set(mn);const Vt={};Ze&2&&(Vt.$$scope={dirty:Ze,ctx:Le}),Ot.$set(Vt);const bn={};Ze&2&&(bn.$$scope={dirty:Ze,ctx:Le}),Rt.$set(bn);const _n={};Ze&2&&(_n.$$scope={dirty:Ze,ctx:Le}),Ft.$set(_n)},i(Le){xn||(transition_in(r.$$.fragment,Le),transition_in(f.$$.fragment,Le),transition_in(S.$$.fragment,Le),transition_in(O.$$.fragment,Le),transition_in(I.$$.fragment,Le),transition_in(j.$$.fragment,Le),transition_in(W.$$.fragment,Le),transition_in(J.$$.fragment,Le),transition_in(ae.$$.fragment,Le),transition_in(Se.$$.fragment,Le),transition_in(se.$$.fragment,Le),transition_in(be.$$.fragment,Le),transition_in($e.$$.fragment,Le),transition_in(te.$$.fragment,Le),transition_in(de.$$.fragment,Le),transition_in(Re.$$.fragment,Le),transition_in(Me.$$.fragment,Le),transition_in(Ve.$$.fragment,Le),transition_in(_e.$$.fragment,Le),transition_in(We.$$.fragment,Le),transition_in(qe.$$.fragment,Le),transition_in(tt.$$.fragment,Le),transition_in(et.$$.fragment,Le),transition_in(rt.$$.fragment,Le),transition_in(ft.$$.fragment,Le),transition_in(ht.$$.fragment,Le),transition_in(mt.$$.fragment,Le),transition_in(vt.$$.fragment,Le),transition_in(wt.$$.fragment,Le),transition_in(Nt.$$.fragment,Le),transition_in(Ct.$$.fragment,Le),transition_in(It.$$.fragment,Le),transition_in(Ot.$$.fragment,Le),transition_in(Mt.$$.fragment,Le),transition_in(Rt.$$.fragment,Le),transition_in(Lt.$$.fragment,Le),transition_in(Ft.$$.fragment,Le),transition_in(jt.$$.fragment,Le),transition_in(Bt.$$.fragment,Le),xn=!0)},o(Le){transition_out(r.$$.fragment,Le),transition_out(f.$$.fragment,Le),transition_out(S.$$.fragment,Le),transition_out(O.$$.fragment,Le),transition_out(I.$$.fragment,Le),transition_out(j.$$.fragment,Le),transition_out(W.$$.fragment,Le),transition_out(J.$$.fragment,Le),transition_out(ae.$$.fragment,Le),transition_out(Se.$$.fragment,Le),transition_out(se.$$.fragment,Le),transition_out(be.$$.fragment,Le),transition_out($e.$$.fragment,Le),transition_out(te.$$.fragment,Le),transition_out(de.$$.fragment,Le),transition_out(Re.$$.fragment,Le),transition_out(Me.$$.fragment,Le),transition_out(Ve.$$.fragment,Le),transition_out(_e.$$.fragment,Le),transition_out(We.$$.fragment,Le),transition_out(qe.$$.fragment,Le),transition_out(tt.$$.fragment,Le),transition_out(et.$$.fragment,Le),transition_out(rt.$$.fragment,Le),transition_out(ft.$$.fragment,Le),transition_out(ht.$$.fragment,Le),transition_out(mt.$$.fragment,Le),transition_out(vt.$$.fragment,Le),transition_out(wt.$$.fragment,Le),transition_out(Nt.$$.fragment,Le),transition_out(Ct.$$.fragment,Le),transition_out(It.$$.fragment,Le),transition_out(Ot.$$.fragment,Le),transition_out(Mt.$$.fragment,Le),transition_out(Rt.$$.fragment,Le),transition_out(Lt.$$.fragment,Le),transition_out(Ft.$$.fragment,Le),transition_out(jt.$$.fragment,Le),transition_out(Bt.$$.fragment,Le),xn=!1},d(Le){Le&&detach(n),destroy_component(r),destroy_component(f),destroy_component(S),destroy_component(O),destroy_component(I),destroy_component(j),destroy_component(W),destroy_component(J),destroy_component(ae),destroy_component(Se),destroy_component(se),destroy_component(be),destroy_component($e),destroy_component(te),destroy_component(de),destroy_component(Re),destroy_component(Me),destroy_component(Ve),destroy_component(_e),destroy_component(We),destroy_component(qe),destroy_component(tt),destroy_component(et),destroy_component(rt),destroy_component(ft),destroy_component(ht),destroy_component(mt),destroy_component(vt),destroy_component(wt),destroy_component(Nt),destroy_component(Ct),destroy_component(It),destroy_component(Ot),destroy_component(Mt),destroy_component(Rt),destroy_component(Lt),destroy_component(Ft),destroy_component(jt),destroy_component(Bt)}}}function instance(e){return setContext("Components",{Text}),[{columnInfos:[{name:"id",type:"number",cellComponent:"Cell",cellProps:{},cellDataProp:"data"},{name:"message",type:"string",cellComponent:"Cell",cellProps:{},cellDataProp:"data"},{name:"name",type:"string",cellComponent:"Cell",cellProps:{},cellDataProp:"data"},{name:"time",type:"string",cellComponent:"Cell",cellProps:{},cellDataProp:"data"},{name:"sender",type:"string",cellComponent:"Cell",cellProps:{},cellDataProp:"data"}],posidxs:[0,1,2,3],rows:[[0,"hello","chatbot","2021-01-01 00:00:00"],[1,"hi","user","2021-01-01 00:00:00"],[2,"how can i help","chatbot","2021-01-01 00:00:00"],[3,"im good thanks","user","2021-01-01 00:00:00"]],fullLength:4,primaryKey:"id"}]}class Page extends SvelteComponent{constructor(n){super(),init$1(this,n,instance,create_fragment,safe_not_equal,{})}}export{Page as default};
