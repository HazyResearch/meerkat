<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-MJKM3TDQ7C"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'G-MJKM3TDQ7C');
		</script>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta http-equiv="content-security-policy" content="">
		<link href="./_app/immutable/assets/_layout-86b96a58.css" rel="stylesheet">
		<link href="./_app/immutable/assets/Content-4e2c0d97.css" rel="stylesheet">
		<link href="./_app/immutable/assets/Footer-1d121e74.css" rel="stylesheet">
		<link href="./_app/immutable/assets/Website-f0c41ff0.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/start-6f643b92.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index-7605b856.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/singletons-a50d324f.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index-44203cbd.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/shared-23917130.js">
		<link rel="modulepreload" href="./_app/immutable/components/pages/_layout.svelte-24d86774.js">
		<link rel="modulepreload" href="./_app/immutable/modules/pages/_layout.js-9cbb603b.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/_layout-da46b06b.js">
		<link rel="modulepreload" href="./_app/immutable/components/pages/blog/_page.svelte-10de2918.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/Footer-a5ee01cc.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/Website.svelte_svelte_type_style_lang-60d8fba5.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">


<div class="flex flex-col h-screen"><header class="fixed w-full top-0 z-50"><nav class="bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-200 border-gray-100 dark:border-gray-700 font-rubik px-2 sm:px-4 py-2.5 border-b !border-b-1 !bg-slate-50 drop-shadow-sm"><div class="mx-auto flex flex-wrap justify-between items-center container"><a href="/" class="flex items-center"><img src="/favicon.png" class="mr-3 h-10" alt="Meerkat Logo">
		<span class="text-violet-700 self-center whitespace-nowrap text-2xl font-light dark:text-white">Meerkat
		</span></a>
	<div class="flex flex-wrap my-1 sm:my-0 md:order-2"><a href="https://github.com/hazyresearch/meerkat" target="_blank" class="ml-4 mr-8 my-1 sm:my-0 self-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a>
		<a href="/docs/index.html" class="bg-gradient-to-r from-violet-600 via-pink-500 to-orange-400 hover:from-violet-500 hover:via-red-500 hover:to-orange-500 text-white focus:ring-4 focus:outline-none focus:ring-violet-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-3 md:mr-0 dark:bg-violet-600 dark:hover:bg-violet-700 dark:focus:ring-violet-800">Get started
		</a>
		
		<button type="button" class="focus:outline-none whitespace-normal rounded-lg focus:ring-2 p-1.5 hover:text-gray-900 hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 ml-3 md:hidden" aria-label="Open main menu"><span class="sr-only">Open main menu</span>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="h-6 w-6 shrink-0" aria-label="bars 3" fill="none" viewBox="0 0 24 24" stroke-width="2"><!-- HTML_TAG_START --><path d="M3.75 6.75H20.25M3.75 12H20.25M3.75 17.25H20.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <!-- HTML_TAG_END --></svg></button></div>
	<div class="w-full md:block md:w-auto" hidden><ul class="flex flex-col p-4 mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium"><li><a href="/" class="block py-2 pr-4 pl-3 md:p-0 rounded md:border-0 text-gray-700 hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 dark:text-gray-400 md:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"><span class="hover:text-violet-800">Home </span></a></li>
		<li><a href="/blog" class="block py-2 pr-4 pl-3 md:p-0 rounded md:border-0 text-white bg-blue-700 md:bg-transparent md:text-blue-700 md:dark:text-white dark:bg-blue-600 md:dark:bg-transparent"><span class="text-violet-500 hover:text-violet-800 text-violet-500">Blog
			</span></a></li>
		<li><a href="/docs/index.html" class="block py-2 pr-4 pl-3 md:p-0 rounded md:border-0 text-gray-700 hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 dark:text-gray-400 md:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"><span class="text-violet-500 hover:text-violet-800">Documentation
			</span></a></li></ul></div></div></nav></header>
	<main class="relative grow"><div class="w-full flex flex-col items-center flex-wrap mt-28 mb-16"><div class="prose "><!-- HTML_TAG_START --><h1 id="interactive-data-frames-and-meerkat-a-path-to-foundation-models-as-a-reliable-software-abstraction">Interactive Data Frames and Meerkat: A Path to Foundation Models as a Reliable Software Abstraction</h1>
<p><em>The Meerkat Team</em></p>
<h2 id="the-rise-of-unstructured-data">The Rise of Unstructured Data</h2>
<p>Recent progress in machine learning shows that <a href="https://crfm.stanford.edu/assets/report.pdf">foundation models</a>—large machine learning models trained on massive amounts of data—can perform a remarkably wide range of tasks with reasonable proficiency. These models can even be taught to perform entirely new tasks through <em>in-context learning</em> with a small number of examples, e.g. using text prompts with a large language model. Foundation models range from text-only models like <a href="https://arxiv.org/pdf/2005.14165.pdf">GPT-3</a>, to multi-modal models that involve training on images, text, audio and video data e.g. vision-language models like <a href="https://openai.com/research/clip">CLIP</a>.</p>
<p>Over the past year, we’ve been thinking about how foundation models will impact the workflow of <em>technical teams</em> spanning software engineering, data science, and machine learning. The lines are blurring between these roles—software engineers and data scientists must now contend day-to-day with how to instruct and evaluate model APIs, and integrate these APIs into their workflows.</p>
<p>All of these teams routinely interact with unstructured data types (e.g videos, images, free text, etc.). However, deriving insights from unstructured data requires significant time and human effort for gathering annotations and performing quality control. These investments are out of reach for most teams. </p>
<p>Our bet is this: <em>FMs will lower the barrier to entry for working with unstructured data, and technical teams will increasingly interact with these models to build new tools, surface insights, and deploy software.</em></p>
<ul>
<li><em>Data Science Teams.</em> Organizations invest people-hours in order to extract insights from unstructured data. For example, one large hospital system calculated the fraction of preventable adverse events by hiring medical providers to scour clinical notes (<a href="https://www.nejm.org/doi/full/10.1056/NEJMsa2206117">Bates et al., 2023</a>). FMs have the potential to bring this resource-intensive process within reach of more hospitals (<a href="https://arxiv.org/pdf/2205.12689.pdf">Agrawal et al., 2022</a>).</li>
<li><em>Software Engineering Teams.</em> Until this year, only highly-resourced teams could build autocomplete features over unstructured text  (<em>e.g.</em> <a href="https://support.google.com/docs/answer/9643962?hl=en#zippy=%2Csmart-compose-in-google-docs-slides-sheets-drawings">Google Docs Smart Compose</a>, <a href="https://www.notion.so/Release-Blogpost-4df54aa98ee04dc3b04314db78dbc0a9">Microsoft Word AutoCorrect</a>). Now, we see <em>much</em> smaller teams produce autocomplete features with FMs that are <em>much</em> more expressive (<em>e.g.</em> <a href="https://www.notion.so/product/ai">Notion AI</a>, <a href="https://lex.page/">Lex</a>).</li>
<li><em>Machine Learning Teams.</em> Well-resourced organizations use large labeling teams to identify groups of unstructured data points where the model is making mistakes (<em>e.g.</em> <a href="https://www.braincreators.com/insights/teslas-data-engine-and-what-we-should-all-learn-from-it">Tesla’s data engine</a>). But, last year we showed that foundation models can help machine learning teams identify systematic errors made by models, potentially reducing the labeling burden (<a href="https://ai.stanford.edu/blog/domino/">Eyuboglu et al. 2022</a>).</li>
</ul>
<h2 id="building-interactive-data-frames-for-unstructured-data">Building Interactive Data Frames for Unstructured Data</h2>
<p>As unstructured data permeates the work of technical teams, it’s critical that they have the right toolbox for wrangling it. For structured data, teams swear by data frames, like those provided by Pandas and R. Back in 2021, <a href="https://www.notion.so/64891aca2c584f1889eb0129bb747863">we started wondering</a>: <em>why doesn’t something similar exist for unstructured data?</em></p>
<p>One reason is that the reliable software abstractions (<em>e.g.</em> NumPy) that power traditional DataFrame operations fall flat when applied to unstructured data. A filter over a structured column (<em>e.g.</em> <code>df[df[”age”] &gt; 18]</code>) can be implemented with one line of NumPy code, but there is no simple abstraction that could implement a semantic  filter over unstructured data (<em>e.g.</em> <code>df[df[”image”].contains(”person”)]</code>).</p>
<p>What if we viewed foundation models as a software abstraction that processes unstructured data? Much like NumPy is to Pandas, this software abstraction would power a data frame for unstructured data.</p>
<p><strong>The problem?</strong> FMs are a terrible software abstraction, and we’re not the first to notice this (<a href="https://crfm.stanford.edu/2022/11/17/helm.html">Bommasani et al.</a>, <a href="https://www.vldb.org/pvldb/vol16/p738-narayan.pdf">Narayan et al.</a>). FMs are hard to control (e.g. brittle to prompt wording <a href="https://arxiv.org/abs/2210.02441">[Arora, et al.]</a>), often produce undesired outputs (e.g. hallucinate knowledge, perpetuate social biases), and require careful evaluation. The process of using a traditional software abstraction (<em>i.e.</em> reading the documentation and writing code) is very different than the process of using FMs, which lack the predictability of a good software abstraction.</p>
<p>People have found success using FMs by carefully instructing and testing them. But this process is miserable when done in code alone:</p>
<ul>
<li>Say we’re trying to filter a dataset of paintings based on artistic style. A vision-language FM can produce scores to filter on, but how do we verify that the FM is correct if we can’t see and label the images?</li>
<li>Imagine we’re trying to extract structured data from PDFs using a foundation model, but it’s not working as expected. How do we provide feedback to the model if we can’t annotate or highlight the PDFs?</li>
<li>FMs can be used to identify slices of data where a different machine learning model is systematically making mistakes. But, how can we interpret the discovered slices if we can’t inspect the data inside them?</li>
</ul>
<p>Code is a poor interface for inspecting and annotating data, which are critical for providing feedback to and iterating on FMs. <em><strong>Interactive systems</strong></em> could enable us to control FMs, turning them from unpredictable actors into usable software abstractions. </p>
<h2 id="meerkat-towards-interactive-data-systems">Meerkat: Towards Interactive Data Systems</h2>
<p>We’re excited to introduce <a href="https://github.com/hazyresearch/meerkat">Meerkat</a>, a Python library that teams can use to interactively wrangle their unstructured data with foundation models.</p>
<p>Meerkat’s approach is based on two pillars:</p>
<ol>
<li><p><strong>Heterogeneous data frames with extended API.</strong> At the heart of Meerkat is a data frame that can store structured fields (e.g. numbers, strings, and dates) alongside complex objects (<em>e.g.</em> images, web pages, audio) and their tensor representations (<em>e.g.</em> embeddings, logits) in a single table. 
Meerkat&#39;s data frame API goes beyond structured data analysis libraries like Pandas by providing a set of FM-backed unstructured data operations. For example, we can search a data frame for images of people using the Meerkat code below:</p>
<pre><code class="language-python">import meerkat as mk
mk.search(
    df, 
    query=mk.embed(&quot;A photo of a person&quot;, engine=&quot;clip&quot;),
    by=mk.embed(df[&quot;image&quot;], engine=&quot;clip&quot;)
)
</code></pre>
</li>
<li><p><strong>Interactive framework.</strong> Meerkat provides graphical user interfaces that allow users to verify the outputs of FM operations (<em>e.g.</em> search) and provide feedback via further instruction or labeling.
Critically, Meerkat GUIs are remarkably composable — users can build custom data applications all from within Python. These apps can also be used within Notebook environments, allowing users to transition easily between code and GUIs, and streamlining the process of instructing and evaluating FMs.</p>
</li>
</ol>
<p>Without Meerkat, you would use existing tools that either prioritize high-quality interactive components and force you to write your own data abstractions (e.g. Streamlit), or prioritize data abstractions with no support for interactive workflows (e.g. pandas), forcing you to write an interactive application from scratch. With Meerkat, you can use a <em>single</em> data frame to spin up interfaces, store data gathered from user interaction, and conduct analyses that require running FMs, regardless of data modality! </p>
<p>Overall, we’re optimistic that these two pillars will simplify the process of working with foundation models and unstructured data, and make it it easier for technical teams to extract insights and meaning from complex and diverse datasets.</p>
<p>Let’s see how these principles look in practice with a few examples.</p>
<h2 id="demos-meerkat-in-practice">Demos: Meerkat In Practice</h2>
<p>We&#39;ll go through three demos, where each demo will be loosely oriented around the workflow of a different technical team.</p>
<h3 id="demo-1-data-science-analyzing-a-dataset-of-paintings-in-a-notebook">Demo 1 (Data Science): Analyzing a Dataset of Paintings in a Notebook</h3>
<p>Identifying patterns in image data is challenging without visualization and interactivity. Here’s a demo where Meerkat makes the analysis of art data possible in a notebook alone.</p>
<!-- HTML_TAG_END --></div>
  <iframe class="mt-4 md:w-[512px] md:h-[280px] sm:w-[256px] sm:h-[140px]" src="https://youtube.com/embed/a8FBT33QACQ"></iframe>
  <div class="prose "><!-- HTML_TAG_START --><p><em>A demo of Meerkat on a dataset of art images in a Jupyter notebook. We spin up interactive interfaces powered by vision-language FMs to explore this data, and create an on-the-fly interface in Python that combines data exploration and plotting.</em></p>
<h3 id="demo-2-software-engineering-using-spreadsheet-style-flash-fill-to-analyze-pdfs">Demo 2 (Software Engineering): Using Spreadsheet-Style Flash Fill to Analyze PDFs</h3>
<p>Software teams that want to build products around unstructured data will need to program and control these models, as well as evaluate and check if they work correctly on internal validation data. Here’s a demo where Meerkat simplifies this process by mixing code and user interaction.</p>
<!-- HTML_TAG_END --></div>
  <iframe class="mt-4 md:w-[512px] md:h-[280px] sm:w-[256px] sm:h-[140px]" src="https://youtube.com/embed/3ItA70qoe-o"></iframe>
  <div class="prose "><!-- HTML_TAG_START --><p><em>A demo of Meerkat where we take on the role of a software engineer working on a bibliography manager. We analyze a dataset of scientific papers, using the flash fill component to fill in missing metadata. This component was built using the Meerkat framework in &lt; 300 lines of pure Python code.</em></p>
<h3 id="demo-3-machine-learning-interactive-error-analysis-of-an-image-classifier">Demo 3 (Machine Learning): Interactive Error Analysis of an Image Classifier</h3>
<p>Machine learning teams routinely perform error analyses when building models, but often struggle to extract nuanced information about the errors. Here’s a demo that shows how Meerkat can be used to perform fine-grained error analyses. (Meerkat is already being used by this community, and we’re continuing to support this set of users as a finalist of the Stanford HAI AI Audit challenge.)</p>
<!-- HTML_TAG_END --></div>
  <iframe class="mt-4 md:w-[512px] md:h-[280px] sm:w-[256px] sm:h-[140px]" src="https://youtube.com/embed/4Kk_LZbNWNs"></iframe>
  <div class="prose "><!-- HTML_TAG_START --><p><em>A standalone Meerkat application for fine-grained error analysis of image classification models. Combining traditional dataframe and new FM-powered components can help us get a deeper understanding of the errors made by an image classifier.</em></p>
<h2 id="conclusion">Conclusion</h2>
<p>Meerkat is new Python library that makes it easier to work with unstructured data and foundation models by bringing them into close proximity via interactive data frames.
We’re excited to see what the community can do with Meerkat. <a href="https://discord.gg/pw8E4Q26Tq">Join our Discord</a> if you want to talk to us, use Meerkat or build on top of it, and definitely give Meerkat a try!</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>Thanks to all the readers who provided feedback on this post and this release: Dean Stratakos, Geoff Angus, Shreya Rajpal, Dan Fu, Brandon Yang, Neel Guha, Sarah Hooper, Simran Arora, Mayee Chen, Michael Zhang, Khaled Saab, Kabir Goel, Gordon Downs, Joel Johnson and Zachary Marion.</p>
<!-- HTML_TAG_END --></div></div></main>
	<footer class="sticky bottom-0 z-50">
<div class="flex px-4 justify-center items-center gap-8 font-rubik text-center pb-2 pt-4 bg-slate-50 bottom-0 sticky dark:bg-gray-900 border-t border-gray-200 dark:border-gray-600"><div class="text-md animate-[bounce_3s_ease-in-out_infinite] flex"><a href="https://github.com/hazyresearch/meerkat" class="text-gray-700 dark:text-gray-200 bg-purple-50 hover:bg-purple-200 border border-purple-200 rounded-lg py-1 px-2 shadow-md shadow-purple-900 "><span>🌟</span> Star us on GitHub!
		</a></div>
	<div class="text-md animate-[bounce_3s_ease-in-out_infinite] flex"><a href="https://discord.gg/pw8E4Q26Tq" class="text-gray-700 dark:text-gray-200 bg-purple-50 hover:bg-purple-200 border border-purple-200 rounded-lg py-1 px-2 shadow-md shadow-purple-900 "><span><svg class="inline h-5 w-5 items-center mr-1 mb-[2px]" viewBox="0 -28.5 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><g><path d="M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z" fill="#5865F2" fill-rule="nonzero"></path></g></g></svg>
				Join our Discord!
			</span></a></div></div></footer></div>


		<script type="module" data-sveltekit-hydrate="1bz1lsy">
			import { start } from "./_app/immutable/start-6f643b92.js";

			start({
				env: {},
				paths: {"assets":"","base":""},
				target: document.querySelector('[data-sveltekit-hydrate="1bz1lsy"]').parentNode,
				version: "1677760576736",
				hydrate: {
					node_ids: [0, 3],
					data: [null,null],
					form: null,
					error: null
				}
			});
		</script>
	</div>
		<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.3/flowbite.min.js"></script> -->
	</body>
</html>
